XU.prototype.Yra=ga(240,function(a){this.O=Rb(arguments,0)});lf.prototype.KC=ga(30,function(){return Ac(this,3)});function mV(a,b){return B(a,2,b)}function Jgc(a,b){D(a,6,b)}function Kgc(a,b){D(a,3,b)}function Lgc(a,b){D(a,1,b)}function Mgc(a,b,c,d,e){return Cob(a,v(function(){return this.C.calculateArrayFormulaResultPreview(b,c,d,e,!1,this.L,!0)},a))}function nV(a){sj(this,a,0,-1,null)}y(nV,N);function oV(a){sj(this,a,0,-1,null)}y(oV,N);
function Ngc(a,b){var c=b.width;b=b.height;for(var d=a.width<=c?1:Math.floor(a.width/c),e=a.height<=b?1:Math.floor(a.height/b),f=[],h=0;h<d;h++)for(var k=a.left+h*c,l=0;l<e;l++){var m=a.top+l*b;f.push(new xh(m,k,m+b,k+c))}return f}var Ogc=[1],Pgc=[1],Qgc=[1],Rgc=[1],Sgc=[2];function Tgc(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c}function Ugc(a){return nc(rfc,function(b){return b.match(a)}).getName()}function Vgc(a){sj(this,a,0,-1,null)}y(Vgc,N);
Vgc.prototype.wg=function(){return O(this,2)};function Wgc(a){sj(this,a,0,-1,null)}y(Wgc,N);function Xgc(a){sj(this,a,0,-1,null)}y(Xgc,N);function Ygc(a){sj(this,a,0,-1,null)}y(Ygc,N);function Zgc(a){sj(this,a,0,-1,null)}y(Zgc,N);Zgc.prototype.getChartType=function(){return O(this,1)};function $gc(a){sj(this,a,0,-1,Ogc)}y($gc,N);function ahc(a){sj(this,a,0,-1,Pgc)}y(ahc,N);function bhc(a){sj(this,a,0,-1,Qgc)}y(bhc,N);function chc(a){sj(this,a,0,-1,Rgc)}y(chc,N);var dhc={mtc:0,vza:1,Yza:2};
function ehc(a){sj(this,a,0,-1,Sgc)}y(ehc,N);function fhc(a,b,c){function d(){f=ma.setTimeout(e,b);a.apply(c,k)}function e(){f=0;h&&(h=!1,d())}var f=0,h=!1,k=[];return function(a){k=arguments;f?h=!0:d()}}var ghc={UNKNOWN_ERROR:0,Itc:1,clc:2,P8b:3},hhc={ytc:0,d9b:1,kea:2,jk:3,rtc:4,k1b:5,q$b:6},ihc={wtc:0,jE:1,ilc:2,Okc:3,qnc:4},jhc={stc:0,elc:1,eK:2,zic:3},khc={ktc:0,Wsc:1,Ubc:2,asc:3,$rc:4,V3b:5},lhc={erc:0,TQ:1,lYa:2,Ssc:3,Qpc:4,M0a:5};function pV(){A.call(this)}y(pV,A);var mhc=null;pV.prototype.vm=function(){return B(this,1)};function qV(){A.call(this)}y(qV,A);var nhc=null;qV.prototype.getText=function(){return B(this,1)};qV.prototype.Qr=function(){return Ac(this,1)};function rV(){A.call(this)}y(rV,A);var ohc=null;rV.prototype.getStatus=function(){return B(this,1)};rV.prototype.getError=function(){return B(this,9)};function sV(){A.call(this)}y(sV,A);var phc=null;sV.prototype.N$=function(){return Ac(this,1)};
sV.prototype.getType=function(){return B(this,3)};sV.prototype.setType=function(a){D(this,3,a)};sV.prototype.Hf=function(){return Ac(this,3)};pV.prototype.Ea=function(){var a=mhc;a||(mhc=a=Hc(pV,{0:{name:"Error",xb:"ritz.assistant.Error"},1:{name:"message",Ca:9,type:String},2:{name:"code",Ca:14,defaultValue:0,type:ghc},3:{name:"unsupported_op_reason",Ca:14,defaultValue:0,type:hhc}}));return a};pV.Ea=pV.prototype.Ea;
qV.prototype.Ea=function(){var a=nhc;a||(nhc=a=Hc(qV,{0:{name:"AnswerQueryPhrase",xb:"ritz.assistant.AnswerQueryPhrase"},1:{name:"text",Ca:9,type:String},2:{name:"start_byte",Ca:5,type:Number},3:{name:"num_bytes",Ca:5,type:Number}}));return a};qV.Ea=qV.prototype.Ea;
rV.prototype.Ea=function(){var a=ohc;a||(ohc=a=Hc(rV,{0:{name:"AnswerResponse",xb:"ritz.assistant.AnswerResponse"},1:{name:"status",Ca:5,type:Number},10:{name:"parse_status",Ca:14,defaultValue:0,type:ihc},11:{name:"answer_status",Ca:14,defaultValue:0,type:jhc},2:{name:"formula",Ca:9,type:String},3:{name:"debug_parse_response",Ca:9,type:String},4:{name:"interpretation",Ca:9,type:String},5:{name:"debug_interpretation_response",Ca:9,type:String},6:{name:"unused_phrase",kd:!0,Ca:11,type:qV},7:{name:"used_entity_phrase",
kd:!0,Ca:11,type:qV},8:{name:"unused_entity_phrase",kd:!0,Ca:11,type:qV},9:{name:"error",Ca:11,type:pV},12:{name:"alternate_suggestion",kd:!0,Ca:11,type:sV},14:{name:"formula_builder_used",Ca:9,type:String},15:{name:"answer_visualization_type",kd:!0,Ca:14,defaultValue:0,type:lhc}}));return a};rV.Ea=rV.prototype.Ea;
sV.prototype.Ea=function(){var a=phc;a||(phc=a=Hc(sV,{0:{name:"QuerySuggestion",xb:"ritz.assistant.QuerySuggestion"},1:{name:"query",Ca:9,type:String},2:{name:"formula",Ca:9,type:String},3:{name:"type",Ca:14,defaultValue:0,type:khc},4:{name:"formula_builder_used",Ca:9,type:String}}));return a};sV.Ea=sV.prototype.Ea;function tV(a,b,c,d,e,f){I.call(this,a,b);this.C=b;this.Ka=c;this.Ia=d||null;this.Qa=e||null;this.D=f||null}y(tV,I);tV.prototype.qk=g("Ka");tV.prototype.hf=g("Ia");function qhc(a,b,c,d,e,f){tV.call(this,"assistant-sidepane-insert-chart",null,d,e,f);this.F=a;this.ea=b;this.vc=c}y(qhc,tV);qhc.prototype.He=g("vc");function rhc(a){a=""+('<div class="waffle-assistant-feature-section"><div class="waffle-assistant-section-header"><div class="waffle-assistant-section-title">'+U(a.title)+"</div>"+U(Kt({Ke:"waffle-assistant-section-more-button",content:Fs("More"),style:4}))+'</div><div class="waffle-assistant-section-content"></div><div class="waffle-assistant-section-card-holder"></div></div>');return V(a)};function uV(a,b,c){a&&(t(b)||(b=a.hasAttribute("title")?a.getAttribute("title"):""),b=Ya(b),Jt(a,b,void 0),ucc(a),a.setAttribute("data-tooltip-delay",500),vcc(a,t(c)?c:1))};function shc(a){return V('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0" y="0" height="'+W(a.iconSize)+'px" width="'+W(a.iconSize)+'px" viewBox="0 0 24 24" preserveAspectRatio="none"><path fill="'+W(a.color)+'" d="M19,2 L5,2 C3.9,2 3,2.9 3,4 L3,18 C3,19.1 3.9,20 5,20 L9,20 L12,23 L15,20 L19,20 C20.1,20 21,19.1 21,18 L21,4 C21,2.9 20.1,2 19,2 L19,2 Z M13.88,12.88 L12,17 L10.12,12.88 L6,11 L10.12,9.12 L12,5 L13.88,9.12 L18,11 L13.88,12.88 L13.88,12.88 Z"/></svg>')}
;function thc(){var a=V,b;b=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content">'+U(shc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div aria-live="polite"><div class="waffle-assistant-empty-list-title">Nothing interesting here right now</div><div class="waffle-assistant-empty-list-body">Try selecting different data. Information with numbers works best.</div></div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try an example</a></div></div></div>');
b=V(b);return a('<div class="waffle-assistant-scroll-pane" style="display: none;"><div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-panel-pane">'+b+'<div class="waffle-assistant-panel-content-container"><div class="waffle-assistant-panel-card-holder"></div></div></div></div>')}
function uhc(a){return V('<div class="waffle-assistant-panel-title-bar">'+U(Kt({Ke:"waffle-assistant-panel-back-button",content:Fs(""+U(cv({icon:"docs-icon-img-container docs-explore-img docs-explore-back-white"}))),style:4}))+'<div class="waffle-assistant-title-text" role="heading">'+U(a.title)+"</div></div>")};function vV(a){T.call(this,a);this.fd=new dV(!1,"#4285f4");this.Na(this.fd);this.R=new T(this.oa());this.Na(this.R);this.C=[];this.Jf=this.wf=!1;this.Md=this.Fd=this.Qa=this.ma=null;this.Gb=new Mt("",a,4);Tr(this.Gb,2);this.Na(this.Gb)}y(vV,T);var vhc={defaultHelpArticleId:"6280499"};q=vV.prototype;q.va=function(){vV.$.va.call(this);this.Da=ms(thc);this.Fd=this.$a("waffle-assistant-panel-content-container");this.Md=this.$a("waffle-assistant-empty-list")};
q.Ja=function(){vV.$.Ja.call(this);var a=this.$a("waffle-assistant-spinner-container");this.fd.render(a);this.R.Xa(this.$a("waffle-assistant-panel-card-holder"));this.Gb.Xa(this.$a("waffle-assistant-empty-list-learn-more"));this.getHandler().V(this.Gb,"action",this.fZb).V(this.Da,"scroll",fhc(this.AWa,10,this))};q.setVisible=function(a){R(this.Da,a);z(this.C,function(a){if(!a.Gc()){var b=this.R.Dd();a.Z=b;this.R.Na(a,!0);a.rF()}},this);this.wf=a};
q.mra=function(a,b){var c=this.oa();this.ma&&this.k7();this.ma=new T;this.Na(this.ma);a=ks(a,uhc,{title:b});this.Qa=new Mt("",this.oa());this.ma.Na(this.Qa);this.Qa.Xa(c.$a("waffle-assistant-panel-back-button",a));uV(this.Qa.Da,"Back");this.ma.getHandler().V(this.Qa,"action",this.Rkb)};q.k7=function(){this.ma.dispose();this.ma=null};function whc(a,b){a.fd.setActive(b);R(a.$a("waffle-assistant-panel-pane"),!b)}q.oI=function(a){R(this.Md,a);R(this.Fd,!a)};
function xhc(a,b){Mb(a.C,b);a.R.removeChild(b);a.R.Ni(b,0);a.C.push(b)}q.cO=function(a){Mb(this.C,a);-1!=kr(this.R,a)&&this.R.removeChild(a,!0)};q.C6=function(){this.R.Rd(!0);Jc(this.C);this.C=[]};q.AWa=function(){for(var a=this.Da,a=a.scrollTop+Hq(a).height,b=0,c=0;c<this.C.length;c++){var d=this.C[c];b<a?(wV(d,!0),b+=Hq(d.Da).height):wV(d,!1)}};q.nf=function(a){this.Jf=a;z(this.C,function(b){b.nf(a)})};q.Pd=g("Jf");q.fZb=function(){Q.Fo.Hb(vhc)};q.Rkb=function(){this.dispatchEvent("assistant-sidepane-back-button-clicked")};function xV(a,b,c,d){T.call(this,d);this.R=a;this.Oa=b;this.Z=new Mt("",this.oa());this.Na(this.Z);this.J=new T(this.oa());this.Na(this.J);this.D=null;this.Ka=[];this.Ia=this.Fa=!1;this.O=c}y(xV,T);q=xV.prototype;q.HMa=Sf;q.zsa=Tf;q.va=function(){xV.$.va.call(this);this.Da=ms(rhc,{title:this.getTitle()})};
q.Ja=function(){xV.$.Ja.call(this);this.J.Xa(this.$a("waffle-assistant-section-card-holder"));this.Z.Xa(this.$a("waffle-assistant-section-more-button"));this.getHandler().V(this.Z,"action",this.nvb);this.D=this.yCa();F(this,this.D);R(yhc(this),this.HMa());this.setVisible(!1)};q.setVisible=function(a){if(this.Gc()&&this.Va()!=a&&(R(this.Da,a),a)){R(this.Z.Da,this.WTa());a=new Xgc;P(a,4,this.Fua());var b=new ip;zj(b,58,a);a=Np(Mp(new Lp,10),b).Ha();this.O.Tb(2774,a)}};
q.Va=function(){return this.Gc()&&Lq(this.Da)};q.WTa=function(){return this.Ka.length>this.R};q.yCa=function(){return new vV(this.oa())};q.nf=function(a){this.Ia=a;z(zhc(this),function(b){b.nf(a)});this.D.nf(a)};q.Pd=g("Ia");q.Wh=pa;
q.Eua=function(a){this.Ka=a;for(var b=0;b<a.length;b++){Gc(a[b],1);if(this.J.Dd()<this.R){var c=this.V6(a[b]);c.nf(this.Ia);var d=this.J.Dd();c.Z=d;this.J.Na(c,!0)}if(this.zsa()&&(this.D.oI(!1),c=this.D,d=this.V6(a[b]),c.C.push(d),c.wf)){whc(c,!1);var e=c.R.Dd();d.Z=e;c.R.Na(d,!0);d.rF()}}};function zhc(a){var b=[];a.J.Bg(function(a){b.push(a)});return b}function yhc(a){return a.$a("waffle-assistant-section-content")}q.Ena=function(){return this.J.H$()};
q.NW=function(){this.Ka=[];Jc(this.J.Rd(!0));this.setVisible(!1);this.zsa()&&(this.D.C6(),this.D.oI(!0))};function Ahc(a){a.J.Bg(function(a,c){c<this.R&&a.rF()},a)}q.Gua=function(a){var b=0;if(this.Fa)this.D.AWa();else if(this.Ena()){this.setVisible(!0);for(var b=Hq(this.$a("waffle-assistant-section-header")).height+Hq(yhc(this)).height,c=zhc(this),d=0;d<c.length;d++)b<a&&d<this.R?(this.LJa(c[d]),wV(c[d],!0),b+=Hq(c[d].Da).height):wV(c[d],!1)}else this.setVisible(!1);return a-b};q.LJa=pa;
q.setActive=function(a){(this.Fa=a)||this.D.k7()};q.Wb=g("Fa");function Bhc(a,b){a.D.mra(b,a.getTitle())}q.nvb=function(){this.setActive(!0);this.dispatchEvent("assistant-sidepane-set-active-panel")};function Chc(){return V('<div class="waffle-assistant-card" tabindex="0" role="region">'+(ym?'<div class="waffle-assistant-card-feedback-container waffle-assistant-feedback-card-hidden"></div>':"")+'<div class="waffle-assistant-card-spinner-container"></div><div class="waffle-assistant-card-inner"><div class="waffle-assistant-button-holder waffle-assistant-card-options"></div><div class="waffle-assistant-card-content-container"></div>'+(ym?'<div class="waffle-assistant-thumbs-container"></div>':"")+
"</div></div>")};function yV(){}y(yV,qI);qa(yV);yV.prototype.Tc=n("waffle-assistant-link-button");function Dhc(){return V('<div class="waffle-assistant-feedback-card waffle-assistant-feedback-card-hidden"><div class="waffle-assistant-feedback-card-content"><div class="waffle-assistant-feedback-card-text">Tell us what could be improved.</div><div class="waffle-assistant-feedback-card-link">Send feedback</div></div></div>')};function Ehc(a,b){T.call(this,b);this.D=a;this.C=new Dt("",new yV,this.oa());this.Na(this.C)}y(Ehc,T);q=Ehc.prototype;q.va=function(){this.Da=ms(Dhc)};q.Ja=function(){Ehc.$.Ja.call(this);var a=this.$a("waffle-assistant-feedback-card-link");this.C.Xa(a);this.getHandler().V(this.Da,"mousedown",this.Wg).V(this.C,"action",this.jqb);this.show(!1)};q.Wg=function(a){a.stopPropagation()};
q.show=function(a){var b=this.Da,c=this.$a("waffle-assistant-feedback-card-link");mq(b,"waffle-assistant-feedback-card-hidden",!a);Un(c,a)};q.jqb=function(){Q.Qy.Hb({source:this.D});this.show(!1);this.dispatchEvent(new I("feedback-dialog-opened"))};function zV(){}y(zV,Bt);qa(zV);zV.prototype.Tc=n("waffle-assistant-button");function Fhc(){var a;a=""+('<div class="waffle-assistant-thumbs"><div class="waffle-assistant-thumbs-text">Was this useful?</div><div class="waffle-assistant-thumbs-button-holder"><div class="waffle-assistant-thumbs-up-button">'+U(cv({icon:"docs-icon-img docs-icon-thumb-up"}))+'</div><div class="waffle-assistant-thumbs-down-button">'+U(cv({icon:"docs-icon-img docs-icon-thumb-down"}))+"</div></div></div>");return V(a)};function AV(a){T.call(this,a);this.C=new Dt("",new zV,this.oa());this.Na(this.C);this.D=new Dt("",new zV,this.oa());this.Na(this.D)}y(AV,T);AV.prototype.va=function(){this.Da=ms(Fhc)};AV.prototype.Ja=function(){AV.$.Ja.call(this);var a=this.$a("waffle-assistant-thumbs-down-button");this.C.Xa(a);uV(a,"Not useful");a=this.$a("waffle-assistant-thumbs-up-button");this.D.Xa(a);uV(a,"Useful");this.getHandler().V(this.C,"action",this.F).V(this.D,"action",this.J)};
function Ghc(a,b){a.oa().Yf(a.$a("waffle-assistant-thumbs-text"),b)}AV.prototype.F=function(){this.dispatchEvent(new I("thumbs-down"));R(this.Da,!1)};AV.prototype.J=function(){this.dispatchEvent(new I("thumbs-up"));R(this.Da,!1)};function BV(a,b){T.call(this,b);this.D=a;this.R=this.O=this.Z=null;this.Ua=new dV(!0,"#4285f4");this.Na(this.Ua);this.bb=this.Qb=this.Uc=!1;this.ma=null;this.Md=this.Gb=!1}y(BV,T);q=BV.prototype;q.$Na=Sf;q.LW=Sf;q.P$=Tf;q.kG=Uf;q.jG=Uf;q.i9=Uf;q.ala=Uf;q.$ka=Uf;q.nf=da("Md");q.Pd=g("Md");q.p$=pa;q.va=function(){this.Da=ms(Chc)};
q.Ja=function(){BV.$.Ja.call(this);var a=this.$a("waffle-assistant-card-spinner-container");this.Ua.render(a);pq(this.$a("waffle-assistant-card-inner"),"visibility","hidden");if(this.LW()){var a=this.Da,b=new fr(a);F(this,b);this.getHandler().V(b,"focusin",this.vlb).V(b,"focusout",this.ulb).V(a,"mouseenter",this.ina).V(a,"mouseleave",this.v$)}Hhc(this,!1);ym&&(this.R=new Ehc(this.mC(),this.oa()),this.R.render(this.$a("waffle-assistant-card-feedback-container")),this.getHandler().V(this.R,"feedback-dialog-opened",
this.kqb).V(this,"trigger_feedback",this.BTb),this.P$()?(this.O=new AV(this.oa()),this.O.render(this.$a("waffle-assistant-thumbs-container")),Ihc(this,!0),a=Va(this.i9()),Ta(a)||Ghc(this.O,a),a=Va(this.ala()),Ta(a)||uV(this.O.$a("waffle-assistant-thumbs-up-button"),a),a=Va(this.$ka()),Ta(a)||uV(this.O.$a("waffle-assistant-thumbs-down-button"),a),this.getHandler().V(this.O,"thumbs-down",this.dZb).V(this.O,"thumbs-up",this.eZb)):Ihc(this,!1));this.ZD()};
function CV(a){return a.$a("waffle-assistant-card-content-container")}function Jhc(a){a.LW();return a.$a("waffle-assistant-card-options")}function Ihc(a,b){ym&&R(a.$a("waffle-assistant-thumbs-container"),a.P$()&&b)}q.rF=function(){this.isDisposed()||(this.Uc=!0,Khc(this))};function wV(a,b){!a.Qb&&b&&(a.Qb=!0,Khc(a))}function Khc(a){if(a.Uc&&a.Qb){var b=v(a.cZb,a);a.bE(b)}}q.ina=function(){this.bb||(Hhc(this,!0),this.bb=!0,nl(this.ma),this.ma=ml(this.JBa,100,this))};
q.JBa=function(){this.isDisposed()||(nl(this.ma),this.ma=null,this.Da.parentNode.querySelector(":hover")==this.Da?this.ma=ml(this.JBa,100,this):this.v$())};q.v$=function(){Hhc(this,!1);this.bb=!1};q.vlb=function(){Hhc(this,!0)};q.ulb=function(){ml(function(){this.isDisposed()||Pn(this.Da,document.activeElement)||this.Da.parentNode.querySelector(":hover")==this.Da||Hhc(this,!1)},0,this)};
q.dZb=function(){Lhc(this,!0);Ihc(this,!1);var a=this.jG();this.dispatchEvent(new tV("assistant-sidepane-thumbs",this,a))};q.eZb=function(){Ihc(this,!1);var a=this.kG();this.dispatchEvent(new tV("assistant-sidepane-thumbs",this,a))};q.kqb=function(){Lhc(this,!1)};q.BTb=function(){Lhc(this,!0)};function Hhc(a,b){var c=a.$a("waffle-assistant-card-options");a=a.LW();R(c,a&&b)}q.cZb=function(){this.Ua.setActive(!1);R(this.Ua.Da,!1);pq(this.$a("waffle-assistant-card-inner"),"visibility","visible");this.dispatchEvent(new I("content-rendered"))};
function Lhc(a,b){mq(a.$a("waffle-assistant-card-feedback-container"),"waffle-assistant-feedback-card-hidden",!b);a.R.show(b)};var Mhc={options:{hAxis:{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},vAxes:[{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0}],fontName:"Roboto",legacyContinuousAxisRemoved:!0,booleanRole:"certainty",theme:"material",width:null,height:null}};function Nhc(a){var b=new MD(uc(Mhc));return vfc(a,b)}
function Ohc(a,b){a.setOption("legend.position","none");a.setOption("hAxis.slantedText",!1);a.setOption("hAxis.textStyle.fontSize",11);a.setOption("vAxes.0.textStyle.fontSize",11);a.setOption("vAxes.1.textStyle.fontSize",11);a.setOption("fontStyle.size",10);a.setOption("fontStyle.italic",!1);a.setOption("titleTextStyle.bold",!1);a.setOption("titleTextStyle.fontSize",12);a.setOption("async",40);!1!==a.dc("useFirstColumnAsDomain")&&a.He()&&"number"===a.He().ud(0)&&a.setOption("hAxis.gridlines.count",
-1);var c=15;if(!1!==a.dc("useFirstColumnAsDomain")&&a.He()&&"string"===a.He().ud(0)){var c=0,d=Bn("span");d.style.fontSize="11px";d.style.fontFamily="Roboto,Arial";b.appendChild(d);for(b=0;b<a.He().getNumberOfRows();b++)Sn(d,a.He().Zf(b,0)),c=Math.max(c,Pq(d).width);In(d);c=Math.min(27,Math.max(15,10+100*c/271))}a.setOption("chartArea.top","15%");b=a.dc("hAxis.title");a.setOption("chartArea.height",Ta(Va(b))?"80%":"65%");a.setOption("chartArea.left",c+"%");a.setOption("chartArea.width",95-c+"%");
"PieChart"==a.getChartType()&&(a.setOption("chartArea.top",Ta(Va(a.dc("title")))?"12%":"15%"),a.setOption("chartArea.height","70%"),a.setOption("chartArea.left","0%"),a.setOption("chartArea.width","100%"),a.setOption("pieSliceText","none"),a.setOption("legend.position","labeled"),a.setOption("legend.textStyle.fontSize",10));return a};function Phc(){return V('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-before-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-preview"></div><div class="waffle-assistant-after-chart-preview"  tabindex="0"></div><div class="waffle-assistant-chart-highlights"></div></div>')}
function Qhc(){return V(U(Kt({Ke:"waffle-assistant-insert-chart-button waffle-assistant-readonly-hidden",content:Fs(""+U(cv({icon:"docs-icon-img docs-icon-insert-autovis-chart"}))),style:4}))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+U(Kt({Ke:"waffle-assistant-zoom-button",content:Fs(""+U(cv({icon:"docs-icon-img docs-icon-zoom-in"}))),style:4})))};function Rhc(a){var b="",c='By <span class="waffle-assistant-facet-title">'+(U(a.A5a)+"</span>"),d=0==a.MFa.length,b=b+('<div class="waffle-assistant-facet-section"><div class="waffle-assistant-facet-header"><div class="waffle-assistant-pie-icon"></div><div class="waffle-assistant-facet-top-text">'+c+'</div><div class="waffle-assistant-facet-toggle" tabindex="0"></div></div>');if(d)c=V('<div class="waffle-assistant-facet-by-color-container"><div class="waffle-assistant-faceted-chart waffle-assistant-facet-by-color"></div></div>');
else{c='<div class="waffle-assistant-facet-charts-container">\x3c!-- Create chart containers with two in each row. --\x3e';a=a.MFa;for(var e=a.length,f=0;f<e;f++)var h=a[f],c=c+((0==f%2?'<div class="waffle-assistant-facet-chart-row">':"")+'<div class="waffle-assistant-single-facet"><div class="waffle-assistant-single-facet-title">'),c=h?c+U(h):c+"(empty)",c=c+('</div><div class="waffle-assistant-faceted-chart"></div></div>'+(1==f%2||f==e-1?"</div>":""));c=V(c+"</div>")}b+='<div class="waffle-assistant-facet-content-wrapper'+
(d?" waffle-assistant-facet-white-section":"")+'">'+c+(ym?'<div class="waffle-assistant-facet-feedback-container"></div><div class="waffle-assistant-facet-thumbs-container"></div>':"")+"</div></div>";return V(b)};function Shc(a,b,c,d,e,f,h){T.call(this,h);this.F=a;this.D=b;this.O=e;this.L=f;this.C=this.vc=null;this.J=Mp(new Lp,10).Ha()}y(Shc,T);q=Shc.prototype;q.Ja=function(){Shc.$.Ja.call(this);(new jU(bE,this.D.Vf)).send(v(this.Gnb,this,this.D))};q.p$=function(a,b){a=new qhc(this.F.clone(),this.O,this.vc,2746,a,b);this.dispatchEvent(a)};q.Gnb=function(a,b){b&&(b.Ki()?AD.DB(this.Da,b):(b=b.He(),a.If(b),FU(a,b),BD(a,"ready",v(this.WYb,this,a)),NU(a,this.Da,Lm),this.vc=b))};
q.WYb=function(a){a.Um()&&(BD(a.Um(),"onmouseover",v(this.UYb,this)),BD(a.Um(),"onmouseout",v(this.VYb,this)))};q.UYb=function(){this.C=Ja()};q.VYb=function(){Ba(this.C)&&500<Ja()-this.C&&this.L.Tb(2750,this.J);this.C=null};function Thc(a,b,c,d,e){T.call(this,e);this.L=a;this.Ia=b;this.Aa=c;this.R=d;this.O=Fc(this.L,23);this.Fa=B(this.L,22);this.D=B(this.L,26);this.qa=[];this.Ae=new cj;this.Z=this.F=this.C=null;this.ea=!1;this.ma=new Mt("",this.oa());this.Na(this.ma);this.J=null}y(Thc,T);q=Thc.prototype;q.va=function(){Thc.$.va.call(this);this.Da=ms(Rhc,{A5a:this.D,MFa:this.O});this.Da.style.visibility="hidden"};
q.Ja=function(){Thc.$.Ja.call(this);var a=this.$a("waffle-assistant-facet-toggle");this.ma.Xa(a);this.getHandler().V(this.Da,"mousedown",this.Wg).V(this.ma,"action",this.aDb);ym&&(this.Z=new Ehc("assistantAutovisFacetFeedback",this.oa()),this.Z.render(this.$a("waffle-assistant-facet-feedback-container")),this.C=new AV(this.oa()),this.Na(this.C),this.C.render(this.$a("waffle-assistant-facet-thumbs-container")),Ghc(this.C,this.O.length?"Were these charts useful?":"Was this chart useful?"),this.getHandler().V(this.C,
"thumbs-up",this.TYb).V(this.C,"thumbs-down",this.SYb));Uhc(this,zoa)};q.Pd=g("ea");q.nf=function(a){this.ea=a;Vhc(this)};q.Wg=function(a){a.stopPropagation()};q.aDb=function(){var a=hq(this.$a("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden");Uhc(this,a);Whc(this,a?2647:2646)};
function Uhc(a,b){var c=a.$a("waffle-assistant-facet-toggle");Sn(c,b?"HIDE":"SHOW");mq(a.$a("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden",!b);z(a.Cj("waffle-assistant-faceted-chart"),function(a){Un(a,b)});a.C&&R(a.C.Da,b);var d='Show chart broken down by "'+(a.D+'"');a='Hide chart broken down by "'+(a.D+'"');uV(c,b?a:d)}
function Xhc(a){a.setOption("legend","top");a.setOption("titleTextStyle.fontSize",10);a.setOption("allowAsync",!0);a.setOption("applyAggregateData",void 0);a.setOption("pieSliceTextStyle.fontSize",11);a.setOption("tooltip.textStyle.fontSize",11);"BarChart"==a.getChartType()&&a.setOption("isStacked",!0)}function Yhc(a){"BarChart"==a.getChartType()&&a.setOption("isStacked",!0);a.setOption("applyAggregateData",void 0)}
function Vhc(a){a.R&&!a.ea&&z(a.qa,v(function(a){var b=a.Da;if(!this.R.contains(b)){var d=this.R;a=new Zhc(b,a);Bcb(d,a)}},a))}q.TYb=function(){Whc(this,2649)};q.SYb=function(){Whc(this,2648);this.Z.show(!0)};function Whc(a,b){var c=a.Aa,d=new bgc,e=a.J.getChartType();d.F=e;e=a.J.He();d.D=e?e.clone():null;yfc(c,b,d,10,a.J,a.J.Vf)};function DV(a,b,c,d,e,f){BV.call(this,a,f);this.C=B(a,8);this.Fd=b;this.fd=c;this.L=d;this.Qa=e;this.ea=new Mt("",this.oa());this.Na(this.ea);this.Aa=new Mt("",this.oa());this.Na(this.Aa);this.Ae=new cj;this.Nc=null;this.Ka=!1;this.hc=[];this.Ub=[];this.ib=[];this.Oa=this.Ia=this.F=this.J=this.Fa=null;this.qa=Mp(new Lp,10).Ha()}y(DV,BV);
var EV={kXa:"waffle-assistant-after-chart-preview",HXa:"waffle-assistant-before-chart-preview",TXa:"waffle-assistant-card-draggable",X4:"waffle-assistant-chart-highlights",u_a:"waffle-assistant-insert-chart-button",jfa:"waffle-assistant-chart-preview",z1a:"waffle-assistant-button-separator",X1a:"waffle-assistant-styled-border",Y1a:"waffle-assistant-styled-rect",V2a:"waffle-assistant-zoom-button"};q=DV.prototype;q.bE=function(a){this.Nc=a;$hc(this)};
q.ZD=function(){aic(this,v(function(a){a=xfc(this.Fd,a);fq(this.Da,a)},this),!1)};q.$Na=Tf;q.LW=Tf;q.mC=n("autovisFeedback");q.kG=n(2208);q.jG=n(2207);q.i9=n("Was this chart useful?");q.va=function(){DV.$.va.call(this);CV(this).appendChild(ms(Phc));Jhc(this).appendChild(ms(Qhc));Ac(this.C,22)&&(this.F=new Thc(this.C,this.Z,this.L,this.Qa,this.oa()),this.Na(this.F,!0),this.F.nf(this.Pd()))};
q.Ja=function(){DV.$.Ja.call(this);iq(this.Da,EV.TXa);var a=this.$a(EV.u_a);this.ea.Xa(a);uV(a,"Insert chart");a=this.$a(EV.V2a);this.Aa.Xa(a);uV(a,"View full size");var a=this.$a(EV.HXa),b=this.$a(EV.jfa),c=this.$a(EV.kXa);this.getHandler().V(this.Da,"keydown",this.PYb).V(b,"click",this.$lb).V(a,"focus",this.Zkb).V(c,"focus",this.Tjb).V(this.ea,"action",this.Qsb).V(this.ea.Da,"mousedown",this.Wg).V(this.Aa,"action",this.OEb).V(this.Aa.Da,"mousedown",this.Wg).V(this.$a(EV.X4),"mousedown",this.Wg).V(rw(this.Fd),
"Ib",this.QYb);bic(this);this.L.Tb(2790,this.qa);this.F&&this.L.Tb(2791,this.qa)};q.nf=function(a){DV.$.nf.call(this,a);bic(this);this.Gc()&&cic(this)};function bic(a){if(a.Gc()){var b=a.Pd();a.ea.setVisible(!b);a=a.oa().$a(EV.z1a,Jhc(a));R(a,!b)}}q.PYb=function(a){13==a.keyCode&&a.target==this.Da&&(a.preventDefault(),a.stopPropagation(),dic(this,2255))};
function eic(a){for(var b=a.getChartType(),c=!!B(a.C,14),d=B(a.C,16),e=!!B(a.C,15),f="Histogram"==b,h="PieChart"==b,k=fic(a),l=1<k.length,m=[],b=0;b<k.length;b++){var p=gic(k[b].rect,c!=h);Qb(m,p)}var b=AC(a.fd).Gd(),r=yb(ic(eh),b.i4,b),c=yb(m,function(a){return yb(r,Ga(Bh,a))});f&&e&&(c=Rb(c,1));a.ib=hic(c.length,h&&0<d||!f&&!h&&e,h&&l);d=AC(a.fd);for(b=0;b<c.length;b++)for(e=a.ib[b],f=0;f<c[b].length;f++)c[b][f]&&Kh(c[b][f])&&(h=TS(d,c[b][f],EV.Y1a),F(a,h),WG(mI(d),h,!0),pq(h.Da,"background-color",
e),h.setVisible(!0),a.hc.push(h),h=TH(d,c[b][f],EV.X1a,1,0),F(a,h),d7a(h,e),h.setVisible(!0),a.Ub.push(h))}function iic(a){Jc(a.hc);Jc(a.Ub);a.hc=[];a.Ub=[];a.ib=[]}q.QYb=function(){this.Ka&&(iic(this),eic(this))};q.ina=function(){DV.$.ina.call(this);this.Ia=Ja();this.Ka||(eic(this),this.Ka=!0)};q.v$=function(){DV.$.v$.call(this);Ba(this.Ia)&&500<Ja()-this.Ia&&this.L.Tb(2789,this.qa);this.Ia=null;iic(this);this.Ka=!1};q.$lb=function(){this.Da.focus()};
q.Zkb=function(){var a=this.$a(EV.X4);Lq(a)?a.focus():this.Da.nextSibling&&this.Da.nextSibling.focus()};q.Tjb=function(){var a;if(a=this.R)a=this.R,a.gb("waffle-assistant-feedback-card-hidden")?a=!1:(a.$a("waffle-assistant-feedback-card-link").focus(),a=!0);a||this.Aa.Da.focus()};q.Qsb=function(){this.L.Tb(2255,this.qa);dic(this,2255)};q.Wg=function(a){a.stopPropagation()};q.OEb=function(){X.w4.Hb(this)};q.p$=function(a,b){dic(this,2257,a,b)};
function dic(a,b,c,d){aic(a,v(function(a){a=new qhc(a,this.Z,this.J&&this.J.He(),b,c,d);this.dispatchEvent(a)},a),!1)}
q.RYb=function(a,b){if(b){var c=this.$a(EV.jfa);if(b.Ki())AD.DB(c,b);else{a.If(b.He());FU(a,a.He());kT(a,"ready",v(this.OYb,this,a));b=[];try{var d=new nf;d.setContext(a.toJSON());var e=!!B(this.C,14);D(d,3,e);var f=B(this.C,16);D(d,4,f);D(d,5,"ROWS"==(e?"ROWS":"COLS"));D(d,8,0);if(B(this.C,24)){var h=B(this.C,25);D(d,9,h)}for(var k=fic(this),e=0;e<k.length;e++)d.addRange(Ph(k[e].rect,k[e].zd));var l=this.Ae.serialize(d);b=yb(ggc(Ga(ritz_api.RitzModelApi.getVerbalHighlightsForProto,l),a).call(),dgc)}catch(m){b=
[]}d=this.$a(EV.X4);R(d,0<b.length);0<b.length&&(d.appendChild(b[0]),Un(d,!0));this.J=a;NU(a,c,Lm)}}};q.OYb=function(a){null!==this.Fa&&(yJ(wJ.getInstance(),this.Fa),this.Fa=null);this.isDisposed()||(a.Um()&&(BD(a.Um(),"onmouseover",v(this.MYb,this)),BD(a.Um(),"onmouseout",v(this.NYb,this))),this.Nc(),cic(this))};q.MYb=function(){this.Oa=Ja()};q.NYb=function(){Ba(this.Oa)&&500<Ja()-this.Oa&&this.L.Tb(2795,this.qa);this.Oa=null};
function cic(a){if(a.Qa&&!a.Pd()){var b=a.$a(EV.jfa);if(!a.Qa.contains(b)){var c=a.Qa;a=new Zhc(b,a);Bcb(c,a)}}}
function jic(a){a.Gb&&(a.Fa=xJ(wJ.getInstance(),Fj.lva),a.Gb=!1);B(a.C,16);var b=Nhc(a.C);b.zca(bE);var c=fic(a),d=!!B(a.C,14),e=B(a.C,16)||0,d=Vl(gXa("/gviz/tq"),"").Ab("transpose",d?"1":"0").Ab("headers",e.toString()).Ab("hds",0).Ab("merge",d?"ROWS":"COLS").Ab("authkey",Vm("authKey"));B(a.C,24)&&d.Ab("dt",encodeURIComponent(JSON.stringify(a.Ae.serialize(B(a.C,25)))));kXa(d,c);b.Ci(d.toString());a.F&&(c=d.clone(),a.F.F=c);return b}
function $hc(a){var b=jic(a),b=Ohc(b,a.$a("waffle-assistant-card-inner"));(new jU(bE,b.Vf)).send(v(a.RYb,a,b));a.F&&aic(a,v(function(a){var c=this.F,e=b;a=new MD(a.toJSON());var e=new MD(e.toJSON()),f=c.Cj("waffle-assistant-faceted-chart");if(1<f.length){Yhc(a);var h=e;Xhc(h);h.setOption("pieSliceText","percentage");h.setOption("axisFontSize",0);h.setOption("hAxis.title",null);h.setOption("hAxis.textPosition","none");h.setOption("vAxes.0.title",null);h.setOption("vAxes.0.textPosition","none");h.setOption("vAxes.1.title",
null);h.setOption("vAxes.1.textPosition","none");h.setOption("chartArea",{left:"5%",top:"5%",width:"90%",height:"90%"});h.setOption("legend","none");h.setOption("titleTextStyle.fontSize",0)}else h=a,Yhc(h),h.setOption("applyAggregateData",void 0),h.setOption("legend","right"),Xhc(e);for(var h=kXa,k=c.F,l=Fc(c.L,27),m=[],p=0;p<l.length;p++)m.push(QS(l[p]));h(k,m);h=B(c.L,25);for(k=0;k<f.length;k++){var l=za(c.O[k])?c.O[k]:null,p=m=h.clone(),r=c.Fa,u=l,w=new sf;D(w,1,r);za(u)&&w.Wa(u);D(p,7,w);c.F.Ab("dt",
encodeURIComponent(JSON.stringify(c.Ae.serialize(m))));p=new MD(a.toJSON());p.Ci(c.F.toString());m=e.clone();m.Ci(c.F.toString());var u=c,x=p,r=l;(w=x.dc("title"))||(w=Ugc(x));x=w+(' when "'+(u.D+('" is "'+(r+'"'))));u=w+(' by "'+(u.D+'"'));r=r?x:u;p.setOption("title",r);m.setOption("title",r);r=new Shc(p,m,0,0,c.Ia,c.Aa,c.oa());c.Na(r);u=f[k];r.Xa(u);c.qa.push(r);r=c;w=Ugc(p);p=w+(' broken down by "'+(r.D+('" for "'+(l+'"'))));r=w+(' broken down by "'+(r.D+'"'));fq(u,l?p:r);c.J=m}Vhc(c);c.Da.style.visibility=
"visible"},a),!1)}function aic(a,b,c){var d=jic(a);(new jU(bE,d.Vf)).send(function(a){a?(a=a.He(),c&&d.If(a),FU(d,a),b(d)):b(null)})}function fic(a){a=Fc(a.D,4);for(var b=[],c=0;c<a.length;c++)b.push(QS(a[c]));return b}q.getChartType=function(){return this.C.getChartType()};function hic(a,b,c){var d=b?["#666"]:[];c&&(a/=2);b&&--a;b=Idc("material").colors;for(var e=0;e<a;e++)d.push(b[e%b.length].color);c&&Qb(d,d);return d}
function gic(a,b){return b?Ngc(a,new qh(a.width,1)):Ngc(a,new qh(1,a.height))};function kic(){HI.call(this);this.Ia.push(this);this.qa=this.Aa=!0;this.Ua="waffle-assistant-dragged-card"}y(kic,Acb);kic.prototype.contains=function(a){return!!z(this.O,function(b){if(b.element==a)return!0})};kic.prototype.nla=function(a){var b=kic.$.nla.call(this,a);if(Km||Lm){a=a.querySelectorAll("CANVAS");for(var c=b.querySelectorAll("CANVAS"),d=0;d<a.length;d++)c[d].getContext("2d").drawImage(a[d],0,0)}else a=yb(b.querySelectorAll("clippath"),function(a){return a.id}),lic(b,a);return b};
function lic(a,b){for(var c=a.getAttribute&&a.getAttribute("clip-path"),d=0;d<b.length;d++){var e=b[d];za(c)&&eb(c,e)&&a.setAttribute("clip-path",c.replace(e,e+"-clone"));e==a.id&&(a.id=e+"-clone")}a=Kn(a);for(d=0;d<a.length;d++)lic(a[d],b)}function Zhc(a,b){JI.call(this,a,b)}y(Zhc,JI);Zhc.prototype.pla=g("element");function mic(){return V('<div class="waffle-assistant-word-cloud-card"><div class="waffle-assistant-word-cloud-title"></div><div class="waffle-assistant-word-cloud-words-container"></div></div>')};function FV(a,b){BV.call(this,a,b);this.C=B(a,8)}y(FV,BV);q=FV.prototype;q.ZD=pa;q.mC=n("assistantWordCloudFeedback");q.kG=n(2634);q.jG=n(2633);q.va=function(){FV.$.va.call(this);CV(this).appendChild(ms(mic));iq(CV(this),"waffle-assistant-word-cloud-content-container")};
q.bE=function(a){for(var b=Fc(this.C,19),c=Fc(this.C,20),d=this.$a("waffle-assistant-word-cloud-words-container"),e=0;e<b.length;e++)if(this.Hl(b,c,e),120<d.clientHeight){this.Hl(b,c,e-1);break}b=this.oa();c=B(this.C,2);c=eo(b,c);d=this.$a("waffle-assistant-word-cloud-title");b.appendChild(d,c);a()};
q.Hl=function(a,b,c){for(var d=this.$a("waffle-assistant-word-cloud-words-container"),e=this.oa();d.firstChild;)d.removeChild(d.firstChild);for(var f=b[c],h=b[0],k=0;k<=c;k++){0!=k&&d.appendChild(eo(e," "));var l=e.createElement("SPAN");e.appendChild(l,eo(e,a[k]));e.appendChild(d,l);iq(l,"waffle-assistant-word-cloud-word");var m=b[k];l.style.color=0==k%2?"#00695C":"#61443C";l.style.fontSize=(m-f)/(h-f)*15+9+"px"}};function GV(a,b,c,d,e){xV.call(this,20,d,c,e);this.qa=a;this.ma=b;this.C=new kic;F(this,this.C);this.F=null;this.ea=0}y(GV,xV);q=GV.prototype;q.Ja=function(){GV.$.Ja.call(this);this.C.jf();this.getHandler().V(this.C,"drag",this.LYb).V(this.C,"dragend",this.Vm)};q.getTitle=n("Analysis");q.iha=function(a){return 0==a};q.V6=function(a){return"WordCloud"==B(a,8).getChartType()?new FV(a,this.oa()):new DV(a,this.qa,this.ma,this.O,this.C,this.oa())};q.nf=function(a){GV.$.nf.call(this,a);a&&icb(this.C)};
q.LJa=function(a){this.getHandler().Hc(a,"content-rendered",this.KYb);this.ea++};q.KYb=function(){0==--this.ea&&this.dispatchEvent("assistant-done-rendering")};q.LYb=function(){this.F=Dq(this.C.ld.target)};q.Vm=function(a){var b=this.F,c=AC(this.ma).ye();if(uh(UF(c,"page",!1,!1)).contains(b)){var d=SF(c,b.x,b.y,"page"),c=WF(c,zh(d),"page"),b=new L(b.x-c.left,b.y-c.top);a.C.getData().p$(d,b)}this.F=null};q.Fua=n(2);function nic(a){var b=a.type;if(!t(b))return null;switch(b.toLowerCase()){case "checkbox":case "radio":return a.checked?a.value:null;case "select-one":return b=a.selectedIndex,0<=b?a.options[b].value:null;case "select-multiple":for(var b=[],c,d=0;c=a.options[d];d++)c.selected&&b.push(c.value);return b.length?b:null;default:return t(a.value)?a.value:null}}
function oic(a,b){var c=a.type;if(t(c))switch(c.toLowerCase()){case "checkbox":case "radio":a.checked=b;break;case "select-one":a.selectedIndex=-1;if(za(b))for(var d=0;c=a.options[d];d++)if(c.value==b){c.selected=!0;break}break;case "select-multiple":za(b)&&(b=[b]);for(d=0;c=a.options[d];d++)if(c.selected=!1,b)for(var e,f=0;e=b[f];f++)c.value==e&&(c.selected=!0);break;default:a.value=null!=b?b:""}};var pic="help;how can;how do i;how do you;how do u;how to;what can;what does;what is this;how does this".split(";"),qic=[{Zj:["Thank you","Thankyou","Thanks"],Xg:"No problem"},{Zj:["you are amazing","This is great","omg"],Xg:"Happy to help"},{Zj:["I love you"],Xg:"Must be in the air"},{Zj:["How do you know","How are you so smart"],Xg:"It's all in the data"},{Zj:["Are you sure"],Xg:"Send feedback if this doesn't seem correct to help improve accuracy"},{Zj:["How are you"],Xg:"Pretty good, thanks"},
{Zj:["Hi","Hello","Hey"],Xg:"Hi, there. Try asking a question about your data."},{Zj:["You are stupid","This is dumb","You are wrong"],Xg:"Help improve this experience by sending feedback"},{Zj:["How smart are you"],Xg:"Pretty smart"}];function ric(a){for(var b=0;b<qic.length;++b)if(-1!=Db(qic[b].Zj,function(b){return Pa(a,b)}))return b;return-1};function sic(a,b,c,d,e){this.C=a;this.oz=b;this.D=d;this.Qo=c;this.L=d?Fc(d,6):[];this.O=d?Fc(d,7):[];this.J=d?Fc(d,8):[];this.error=e||1;this.interpretation=d&&Ac(d,4)?B(d,4):null;this.F=d?Fc(d,12):[]}function tic(a){return{$N:uic(a),interpretation:a.interpretation,oz:a.oz,Qo:a.Qo,z1:1<a.oz.length&&1<a.oz[0].length,KC:a.KC()}}
sic.prototype.KC=function(){if(0==Fc(this.D,15).length)return!1;var a;switch(Fc(this.D,15)[0]){case 2:case 3:case 4:case 5:a=!0;break;default:a=!1}return soa&&1<this.oz.length&&1<this.oz[0].length&&a};sic.prototype.getChartType=function(){switch(Fc(this.D,15)[0]){case 2:return"ColumnChart";case 3:return"Timeline";case 4:return"ScatterChart";case 5:return"PieChart";default:throw Error("Unknown chart type.");}};function vic(a){a.KC();return a.oz[0][0]}function wic(a){a.KC();return a.oz[0][1]}
function xic(a){return{$N:uic(a),error:yic(a)}}
function zic(a){if(!Ac(a.D,9))return"";if(Ac(a.D.getError(),3))switch(B(a.D.getError(),3)){case 1:return"Sorry, questions related to formatting are not supported at this time.";case 2:return"Answers provides formulas based on your data. Charts are currently not supported. Please use the menus to create a chart.";case 3:return"Sorry, this action is not supported at this time.";case 4:return"Sorry, this function is not supported at this time.";case 5:return"Sorry, your question is too generic. Please ask a more specific question.";default:return"Sorry, this function is not supported at this time."}return a.D.getError().vm()||
""}function yic(a){switch(a.error){case 2:return"Looks like you are offline. Try again when you reconnect.";case 3:return"There was a problem getting your answer at this time. Please try again later.";case 4:return"Sorry, couldn't understand your question.";case 5:return"Answers lets you ask question and learn more about your data.";case 6:return zic(a)||"Sorry, couldn't understand your question.";case 7:return a=ric(a.C),-1!=a?qic[a].Xg:""}return""}
function uic(a){var b=[];if(1==a.error&&null!=a.Qo){var c=[];z(Ob(a.L,a.J),function(a){c.push(Aic(a,"waffle-assistant-answercard-question-unused-phrase"))},a);z(a.O,function(a){c.push(Aic(a,"waffle-assistant-answercard-question-used-entity"))},a);Vb(c,function(a,b){return a.pW>b.pW?1:-1});var d=0;z(c,function(a){var c=a.length,e=a.pW;e>d?b.push({text:this.C.substring(d,e),className:null}):(c-=d-e,e=d);0<c&&(d=e+c,b.push({text:this.C.substring(e,d),className:a.ll}))},a);d<a.C.length&&b.push({text:a.C.substring(d),
className:null})}else b.push({text:a.C,className:null});return b}function Aic(a,b){return{pW:B(a,2),length:B(a,3),ll:b}}function Bic(a,b,c){return new sic(a,null,null,c||null,b)};function HV(a,b,c,d){J.call(this);this.R=a;this.Z=b;this.ma=c;this.Ia=d;this.Ba=new K(this);F(this,this.Ba);this.C=new XU;F(this,this.C);this.O="";this.L=[];this.F=this.D=this.J=null;this.ea=!1;Nfc(this.C,this.R);this.C.Z=10;this.C.Aa=!0;this.C.L=!1;this.C.Yra("waffle-assistant-visible");this.C.R=Ya("waffle-assistant-dragged-formula").split(" ");this.C.jf();this.Ba.V(this.C,"beforedragstart",this.Aa).V(this.C,"dragmove",this.Fa).V(this.C,"beforedragend",this.qa)}y(HV,J);HV.prototype.nf=da("ea");
HV.prototype.Aa=function(a){a=vb(this.R.childNodes,a.C);this.O=this.L[a]};
HV.prototype.Fa=function(a){var b=a.event instanceof er?a.event.D:a.event;this.ea?(a.F.Ox(b,!0),a.preventDefault()):(vq(a.D,a.event.clientX,a.event.clientY),a=wq(a.D),b=AC(this.Z).ye(),uh(UF(b,"page",!1,!1)).contains(a)?(a=SF(b,a.x,a.y,"page"),(b=Lx(tw(this.ma),a.y,a.x))?a=new L(b.mc(),b.rc()):b=zh(a),this.J=a,this.D&&this.D.Pc().equals(b)||(a=AC(this.Z),H(this.D),this.D=TS(a,b,"waffle-assistant-formula-insertion-rect"),F(this,this.D),WG(mI(a),this.D),H(this.F),this.F=TH(a,b,"waffle-assistant-formula-insertion-border",
2,0),F(this,this.F),d7a(this.F,"#000"),this.F.setVisible(!0))):Cic(this))};HV.prototype.qa=function(a){if(this.J){var b=this.J,c=tw(this.ma),b=new lG(c,b,this.O);this.Ia.C(b);this.dispatchEvent(new I("formula_inserted"))}a.F.Ox(null,!0);a.preventDefault();this.O="";Cic(this)};function Cic(a){a.J=null;H(a.D);a.D=null;H(a.F);a.F=null};function Dic(a){var b=V,c='<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+Eic({$N:a.dR.$N}),d;d=a.dR.oz;var e=a.dR.Qo,f=a.dR.interpretation,h=a.dR.z1;a=a.dR.KC;null==d||ua(d);var k;k=""+('<div class="waffle-assistant-answercard-answer-container"><div class="waffle-assistant-answercard-answer-header" role="heading" aria-label="'+Is("Answer")+'"><span aria-hidden="true">Answer</span></div>'+(f?'<div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret">'+
U(f)+"</div></div>":"")+'<div class="waffle-assistant-answercard-answer-content">');if(d){a&&(k+='<div class="waffle-assistant-answercard-tabs"><div class="waffle-assistant-answercard-formula-tab">FORMULA</div><div class="waffle-assistant-answercard-chart-tab">CHART</div></div>');k+='<div class="waffle-assistant-answercard-answer">';if(h){k+='<div class="waffle-assistant-answercard-answer-rowheader">';for(var f=d[0],l=f.length,m=0;m<l;m++)k+='<span class="waffle-assistant-answercard-answer-col">'+
U(f[m])+"</span>";k+="</div>"}k+='<div class="waffle-assistant-answercard-answer-rows">';f=Es("waffle-assistant-answercard-answer-row"+(h?" waffle-assistant-answercard-answer-list-row":""));l=d.length;for(m=0;m<l;m++){var p=d[m];if(h&&0==m)p="";else{var r=f;ua(p);for(var r='<div class="'+W(r)+'">',u=p.length,w=0;w<u;w++)var x=p[w],r=x?r+('<span class="waffle-assistant-answercard-answer-col">'+U(x)+"</span>"):r+('<span class="'+W("waffle-assistant-answercard-answer-col waffle-assistant-answercard-answer-empty")+
'">N/A</span>');p=V(r+"</div>")}k+=p}k+="</div></div>"+(a?'<div class="waffle-assistant-answercard-chart-container"><div class="waffle-assistant-answercard-chart"></div></div>':"")}k+='<div class="waffle-assistant-answercard-formula-holder"><div class="waffle-assistant-answercard-see-formula-link">See formula</div><div class="waffle-assistant-answercard-hide-formula-link">Hide formula</div><div class="waffle-assistant-answercard-formula"><div class="waffle-assistant-answercard-formula-icon">'+U(cv({icon:"docs-icon-img docs-icon-insert-formula"}))+
'</div><div class="waffle-assistant-answercard-formula-text-container"><div class="waffle-assistant-answercard-formula-text" tabindex="0">'+U(e)+"</div></div></div></div></div></div>";d=V(k);return b(c+d+"</div></div>")}
function Eic(a){ua(a.$N);a=a.$N;var b;b=""+('<div class="waffle-assistant-answercard-question-container"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+Is("Question")+'"><span aria-hidden="true">Question</span></div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">');for(var c=a.length,d=0;d<c;d++){var e=a[d];b+=e.className?'<span class="'+W(e.className)+'">'+U(e.text)+"</span>":U(e.text)}return V(b+
"</div></div></div>")}function Fic(){return V(U(V('<div class="waffle-assistant-answers-card-remove">'+U(cv({icon:"docs-icon-img docs-icon-trash"}))+"</div>")))};function Gic(a,b,c,d,e,f){I.call(this,"sqc");this.Ia=a;this.F=f||"";this.ea=b;this.D=d;this.Ka=e;this.C=c}y(Gic,I);function IV(a,b,c,d,e,f,h,k){BV.call(this,new UU,k);this.C=a;this.Ia=a.KC();this.Fa=!1;this.Ka=b;this.Ub=c;this.ib=d;this.hc=f;this.qa=e;this.Oa=h;this.Qa=Mp(new Lp,10).Ha();this.Aa=new Dt("",new zV,this.oa());this.Na(this.Aa);this.L=null;this.J=new Dt("",new yV,this.oa());this.Na(this.J);this.ea=new Dt("",new yV,this.oa());this.Na(this.ea);this.F=new RT;this.Na(this.F)}y(IV,BV);q=IV.prototype;q.oka=g("Oa");q.va=function(){IV.$.va.call(this);Jhc(this).appendChild(ms(Fic))};
q.Ja=function(){IV.$.Ja.call(this);var a=this.$a("waffle-assistant-answers-card-remove");this.Aa.Xa(a);uV(a,"Remove card",0);this.getHandler().Hc(this.Aa,"action",this.YYb).V(this.J,"action",this.uAb).V(this.ea,"action",this.Qrb).Hc(this.J,"action",v(this.POa,this,!0)).Hc(this.ea,"action",v(this.POa,this,!1))};
q.bE=function(a){CV(this).appendChild(ms(Dic,{dR:tic(this.C)}));this.J.Xa(this.$a("waffle-assistant-answercard-see-formula-link"));this.ea.Xa(this.$a("waffle-assistant-answercard-hide-formula-link"));this.L=new HV(this.$a("waffle-assistant-answercard-formula-text-container"),this.Ka,this.Ub,this.ib);this.L.nf(this.Pd());this.L.L=[this.C.Qo];F(this,this.L);var b=this.$a("waffle-assistant-answercard-formula-text");fq(b,"Formula: "+(this.C.Qo+". Click/Press ENTER to copy or drag to insert on to sheet."));
Qf(this.getHandler().V(this.L,"formula_inserted",this.XYb),this.$a("waffle-assistant-answercard-formula-text"),qd,this.drb);Hic(this,!1);if(this.Ia){this.F.Xa(this.$a("waffle-assistant-answercard-tabs"));b=new PT("");b.Xa(this.$a("waffle-assistant-answercard-formula-tab"));this.F.Na(b);this.F.KA(b);var c=new PT("");c.Xa(this.$a("waffle-assistant-answercard-chart-tab"));this.F.Na(c);this.getHandler().V(this.F,"select",this.ECb).Hc(b,"action",v(this.NOa,this,0)).Hc(c,"action",v(this.NOa,this,1));Iic(this,
!1)}a()};
function Jic(a){var b=new OU;Lgc(b,a.C.getChartType());Kgc(b,vic(a.C));Jgc(b,wic(a.C));var c=Rb(a.C.oz,1),d=yb(c,function(a){return sb(a[1])}),e=Math.min.apply(Math,[].concat(d instanceof Array?d:Tgc(iaa(d)))),d=Math.max.apply(Math,[].concat(d instanceof Array?d:Tgc(iaa(d)))),d=Math.floor(1.1*d),e=Math.min(e,0);D(b,7,e);D(b,8,d);b=Nhc(b);e=new sD;e.Lr("string",vic(a.C));e.Lr("number",wic(a.C));for(d=0;d<c.length;++d)e.ix([c[d][0],sb(c[d][1])]);b.If(e);c=a.$a("waffle-assistant-answercard-chart");b=
Ohc(b,c);FU(b,b.He());NU(b,c,Lm);a.Fa=!0}q.ZD=function(){fq(this.Da,"Answer Card for question: "+this.C.C)};q.LW=Tf;q.mC=n("assistantAnswersFeedback");q.kG=n(2628);q.jG=n(2627);q.i9=n("Was this answer correct?");q.ala=n("Correct");q.$ka=n("Incorrect");q.r8=g("C");q.nf=function(a){IV.$.nf.call(this,a);this.L&&this.L.nf(a)};q.ECb=function(){switch(fdc(this.F)){case 0:Iic(this,!1);break;case 1:Iic(this,!0);break;default:fdc(this.F)}};
function Iic(a,b){R(a.$a("waffle-assistant-answercard-chart-container"),b);R(a.$a("waffle-assistant-answercard-answer"),!b);!a.Fa&&b&&Jic(a)}function Hic(a,b){a.J.setVisible(!b);a.ea.setVisible(b);R(a.$a("waffle-assistant-answercard-formula"),b);b?a.$a("waffle-assistant-answercard-formula-text").focus():(a.J.Da.focus(),a.J.fs(!0))}q.YYb=function(){var a=new oV;P(a,8,Rm);P(a,3,!0);var b=new XS;zj(b,4,a);a=new ip;zj(a,46,b);b=Np(Mp(new Lp,10),a).Ha();this.qa.Tb(2753,b);this.dispatchEvent(new I("rc"))};
q.uAb=function(){Hic(this,!0)};q.Qrb=function(){Hic(this,!1)};q.POa=function(a){var b=new oV;P(b,9,a);a=new XS;zj(a,4,b);b=new ip;zj(b,46,a);b=Np(Mp(new Lp,10),b).Ha();this.qa.Tb(2849,b)};q.NOa=function(a){var b=Fc(this.C.D,15)[0],c=new Zgc;P(c,1,b);b=new Ygc;zj(b,1,c);switch(a){case 0:P(b,2,2);break;case 1:P(b,2,1);break;default:P(b,2,0)}a=new oV;zj(a,10,b);c=new XS;zj(c,4,a);a=new ip;zj(a,46,c);a=Np(Mp(new Lp,10),a).Ha();this.qa.Tb(2850,a)};q.XYb=function(){this.qa.Tb(2709,this.Qa)};
q.drb=function(){var a=this.oa().Pb(),b=a.createElement("textarea");b.textContent=this.C.Qo;b.style.position="fixed";a.body.appendChild(b);b.select();var c=!1;try{c=a.execCommand("copy")}catch(d){}finally{a.body.removeChild(b)}c&&Kic(this.hc,"Formula copied to clipboard",this.oa())};function Lic(){var a;a=Es("Ask a question about your data");a='<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container">'+('<input type="text" class="waffle-assistant-answers-input-box" placeholder="'+W(a)+'" aria-label="'+W(a)+'"/></div><div class="waffle-assistant-answers-input-controls"><div class="waffle-assistant-answers-button-container">');a+='<div class="'+W("waffle-assistant-answers-query-box-button waffle-assistant-answers-clear-query-button")+
'">'+U(cv({icon:"docs-icon-img docs-icon-cancel"}))+'</div></div><div class="waffle-assistant-answers-spinner-container" style="display:none"></div></div></form></div>';return V(a)};function Mic(a){var b=V,c='<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+U(Eic({$N:a.zFa.$N})),d;d=a.zFa.error;var e=a.showHelp;a='<div class="waffle-assistant-answercard-error-container"><div class="waffle-assistant-answercard-error-image">'+U(cv({icon:"docs-icon-img docs-icon-unsupported-black"}))+'</div><div class="waffle-assistant-errorcard-content">';e?(d=U(d)+' Look in <div class="waffle-assistant-answers-helpcenter-link">Sheets help</div> instead?',
a+='<div class="waffle-assistant-errorcard-text">'+d+"</div>"):a+='<div class="waffle-assistant-errorcard-text">'+U(d)+"</div>";d=V(a+"</div></div>");return b(c+d+"</div></div>")}function Nic(){return V('<div class="waffle-assistant-answercard-feedback-container"><div class="waffle-assistant-answercard-feedback-link">Send feedback</div></div>')};function JV(a,b,c,d,e){BV.call(this,new UU,e);this.L=a;this.qa=b;this.J=d;this.Aa=c;this.ea=new Dt("",new zV,this.oa());this.Na(this.ea);this.F=new Dt("",new yV,this.oa());this.Na(this.F);this.C=new Dt("",new yV,this.oa());this.Na(this.C)}y(JV,BV);q=JV.prototype;q.ZD=function(){fq(this.Da,"Error Card for question: "+this.L.C)};q.mC=n("assistantAnswersFeedback");q.LW=Tf;q.P$=Sf;q.va=function(){JV.$.va.call(this);Jhc(this).appendChild(ms(Fic))};
q.Ja=function(){JV.$.Ja.call(this);var a=this.$a("waffle-assistant-answers-card-remove");this.ea.Xa(a);this.C.setVisible(this.J);uV(a,"Remove card",0);this.getHandler().Hc(this.ea,"action",this.bZb).Hc(this.F,"action",this.IAb).V(this.C,"action",this.Mrb)};
q.bE=function(a){CV(this).appendChild(ms(Mic,{zFa:xic(this.L),showHelp:this.J}));if(ym){var b=ms(Nic);this.oa().appendChild(this.Da,b);this.F.Xa(this.$a("waffle-assistant-answercard-feedback-link"))}this.J&&this.C.Xa(this.$a("waffle-assistant-answers-helpcenter-link"));a()};q.oka=g("qa");q.r8=g("L");q.IAb=function(){this.F.setVisible(!1);R(this.$a("waffle-assistant-answercard-feedback-container"),!1);this.dispatchEvent(new I("trigger_feedback"))};
q.bZb=function(){var a=new oV;P(a,3,!1);P(a,8,Rm);var b=new XS;zj(b,4,a);a=new ip;zj(a,46,b);b=Np(Mp(new Lp,10),a).Ha();this.Aa.Tb(2753,b);this.dispatchEvent(new I("rc"))};q.Mrb=function(){Q.Fo.Hb()};function Oic(a,b,c,d){var e=new $gc;P(e,2,c);z(b,function(a){O(e,1).push(a)});P(e,3,d);d=new nV;P(d,1,a);P(d,3,b[c]);zj(d,11,e);return d}function Pic(a,b,c,d){var e=new bhc;P(e,2,c);z(b,function(a){O(e,1).push(a)});P(e,3,d);d=new nV;P(d,1,a);P(d,2,b[c]);zj(d,10,e);return d}function Qic(a){var b=new chc;z(a,function(a){a=a.type;O(b,1).push(a)});return b}function Ric(a){var b=new ahc;z(a,function(a){a=a.type;O(b,1).push(a)});return b};function Sic(a){BV.call(this,new UU,a);this.C=this.oa().createElement("div");Sn(this.C,"Previous")}y(Sic,BV);q=Sic.prototype;q.ZD=function(){fq(this.Da,"Previous questions below")};q.va=function(){Sic.$.va.call(this);kq(this.Da,"waffle-assistant-card");iq(this.Da,"waffle-assistant-answers-previousheadercard")};q.bE=function(a){0<this.oa().ri(CV(this)).length||CV(this).appendChild(this.C);a()};q.P$=Sf;q.mC=n("assistantAnswersFeedback");function Tic(a){var b;b=""+(a.title?'<div class="waffle-assistant-suggestionscard-header">'+U(a.title)+"</div>":"");var c;c=Es("Suggested question");b+='<div class="waffle-assistant-suggested-questions">';a=a.ISb;for(var d=a.length,e=0;e<d;e++){var f=a[e];b+='<div class="waffle-assistant-answercard-question-container" tabindex="0"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+W(c)+'">'+U(cv({icon:"docs-icon-img docs-icon-help"}))+'</div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">'+
U(f)+"</div></div></div>"}return V(b+"</div>")};function KV(a,b,c,d,e){BV.call(this,a,e);this.F=c;this.C=d;this.J=b}y(KV,BV);q=KV.prototype;q.kG=function(){return Eb([Uic,LV],this.C)?2799:Eb([Vic,MV],this.C)?2801:null};q.jG=function(){return Eb([Uic,LV],this.C)?2798:Eb([Vic,MV],this.C)?2800:null};q.i9=n("Were these interesting?");q.ala=n("Interesting");q.$ka=n("Not interesting");q.mC=n("assistantAnswersFeedback");q.ZD=function(){var a=this.C.title;a&&this.F?fq(this.Da,a+(" for question : "+this.F)):fq(this.Da,"Suggested questions")};
q.bE=function(a){this.J.then(function(b){if(0==b.length)R(this.Da,!1);else{var c=this.oa(),d=CV(this);if(0==c.ri(d).length){var e=ms(Tic,{title:this.C.title,ISb:yb(b,function(a){return a.query})});d.appendChild(e);var f=yb(b,function(a){return a.type}),d=this.Cj("waffle-assistant-answercard-question-container");z(d,function(a,d){var e=new Dt("",new zV,c);this.Na(e);e.Xa(a);this.getHandler().V(e,"action",v(this.pCb,this,b[d],f,d))},this)}}a()},null,this)};
q.pCb=function(a,b,c){this.dispatchEvent(new Gic(this.C.s3,a.Qo||null,b,c,this.C.nZ,a.query))};var Wic={title:"",nZ:0,s3:null},Uic={title:"",nZ:5,s3:1},LV={title:"Suggested questions",nZ:5,s3:1},MV={title:"Did you mean?",nZ:2,s3:4},Vic={title:"Related questions",nZ:4,s3:4};function Xic(a,b){var c=[],d={};if(a>b*b)for(var e=0;e<b;e++){var f;do f=Math.floor(Math.random()*a);while(d[f]);d[f]=1;c.push(f)}else{for(e=0;e<a;e++)c.push(e);for(e=0;e<b;e++)d=Math.floor(Math.random()*(a-e)+e),f=c[e],c[e]=c[d],c[d]=f}return c.slice(0,b)}function NV(a){return Xic(a,1)[0]}function Yic(a){var b=0;z(a,function(c,d){c.length>a[b].length&&(b=d)});return yb(a[b],function(b,d){return yb(a,function(a){return a[d]})})};function Zic(a){this.F=[];this.D={};this.L=a;this.C=new sO}function $ic(a,b,c,d){function e(a){return a.toLowerCase()}Sb(b,void 0,e);Sb(c,void 0,e);Sb(d,void 0,e);z(b,a.J,a);z(c,a.J,a);z(d,a.J,a)}Zic.prototype.J=function(a){var b=a.toLocaleLowerCase(),c=0;if(100>b.length)for(var d=0;d<b.length&&3>c;++d)if(0==d||/[^a-zA-Z0-9]/.test(b[d-1])&&!/[^a-zA-Z0-9]/.test(b[d])){++c;var e=a,f=b.substr(d),h=this.C.get(f);h||(h=[],this.C.add(f,h));h.push(e)}};
function ajc(a,b){a.D[b.toLowerCase()]||(a.D[b.toLowerCase()]=b)}Zic.prototype.aI=function(a,b,c){var d;if(Ya(a||"")){d=this.L.Rm();d=bjc(this,a.substring(0,d));var e=cjc(this,b-d.length,a);d=Ob(d,e)}else d=cjc(this,b);d.length>b&&(d=Rb(d,0,b));c(a,d)};
function cjc(a,b,c){var d=c||"";c=dc(a.D,function(a){return Pa(a,d)});var e=djc(ic(c),d?1:2,1);a=xb(a.F,function(a){return Pa(a.query,d)&&!e[a.query.toLowerCase()]});b=djc(a,b-hc(e),2);b=ic(b);var f=yb(b,function(a,b){a.rta=b;return a.MUa});z(b,function(a){a.pta=f});return Ob(b,ic(e))}
function bjc(a,b){for(var c=[],d=3,e={},f=b.toLowerCase(),h=0;h<f.length&&0<d;++h)if(0==h||" "==f[h-1]&&" "!=f[h]){var k={},l=0,m=f.substr(h),p=a.C.Le(m);z(p,function(a){var b=a.length-m.length;l=Math.max(b,l);a=this.C.get(a);k[b]||(k[b]=[]);Qb(k[b],a)},a);for(p=0;p<=l&&0<d;++p){var r=k[p];if(r)for(var u=0;u<r.length&&0<d;++u){var w=r[u];eb(b.toLowerCase(),w.toLowerCase())||e[w]||(--d,c.push({text:w,Qo:"",RA:0,FBa:f.length-h,MUa:void 0,pta:[],rta:-1}),e[w]=!0)}}}return c}
function djc(a,b,c){b=Xic(a.length,Math.min(a.length,b));var d={};z(b,function(b){b=a[b];var e=za(b)?b:b.query;d[e.toLowerCase()]={text:e,Qo:za(b)?"":b.Qo,RA:c,FBa:0,MUa:za(b)?void 0:b.type,pta:[],rta:-1}});return d};function OV(){MG.call(this,"",null,!1)}y(OV,MG);OV.prototype.vD=function(a,b){if(2==a.RA||1==a.RA)return OV.$.vD.call(this,a.text,b);var c=this.La(),d=this.Rm(),e=" "==c[d];void 0==c[d]&&(c=c.trim(),d>c.length&&(d=c.length));var f=c.substring(0,d-a.FBa)+a.text;e||(f+=" ");a=OV.$.vD.call(this,{toString:function(){return f+c.substring(d)}},b);this.Y2(f.length);b=this.lk;b.blur();b.focus();return a};
OV.prototype.hh=function(a){var b=OV.$.hh.call(this,a);b||39!=a.keyCode||a.ctrlKey||a.shiftKey||(b=this.C,L5a(b)&&b.wG()&&a.preventDefault(),b=!0);return b};function ejc(){return V('<div class="waffle-assistant-answers-ac-suggestion"><div class="waffle-assistant-answers-ac-suggestion-icon-container"><div class="waffle-assistant-answers-ac-suggested-query-icon">'+U(cv({icon:"docs-icon-img docs-icon-help"}))+'</div><div class="waffle-assistant-answers-ac-session-query-icon">'+U(cv({icon:"docs-icon-img docs-icon-clock"}))+'</div><div class="waffle-assistant-answers-ac-entity-icon">'+U(cv({icon:"docs-icon-img docs-icon-arrow-tilted"}))+'</div></div><span class="waffle-assistant-answers-ac-suggestion-text"></span></div>')}
;function fjc(a){this.Za=a||on()}
fjc.prototype.dO=function(a,b,c){b=ms(ejc);var d=this.Za.$a("waffle-assistant-answers-ac-suggestion-text",b);a=a.data;this.Za.Yf(d,a.text);var d=this.Za.$a("waffle-assistant-answers-ac-entity-icon",b),e=this.Za.$a("waffle-assistant-answers-ac-suggested-query-icon",b),f=this.Za.$a("waffle-assistant-answers-ac-session-query-icon",b);R(d,0==a.RA);R(e,2==a.RA);R(f,1==a.RA);d="";switch(a.RA){case 0:d="waffle-assistant-answers-ac-row-entity";break;case 1:d="waffle-assistant-answers-ac-row-session-query";break;
case 2:d="waffle-assistant-answers-ac-row-suggested-query"}d&&iq(c,d);this.Za.appendChild(c,b)};function PV(a,b,c,d,e,f,h,k,l,m){vV.call(this,m);this.ue=c;this.Hg=d;this.ag=e;this.bf=a;this.ib=h;this.Rg=l;this.Aa=this.Z=this.L=this.eb=null;this.qa=new OV;this.qa.oGa=!0;this.qa.Aa=!0;this.Fa=new Zic(this.qa);a=new KG(null,new fjc(m));this.J=new GG(this.Fa,a,this.qa);F(this,this.J);this.F=f;this.Oa=this.O=null;this.Ub=k;this.Ua=!1;this.Ka=Mp(new Lp,10).Ha();this.Ae=new cj;this.Ia={};this.ea=this.hc=this.D=this.Qb=null;this.Uc=[];this.Nc=[];this.Je=wJ.getInstance();this.bb=""}y(PV,vV);q=PV.prototype;
q.va=function(){PV.$.va.call(this);var a=this.J.Oe();a.className="waffle-assistant-answers-ac-renderer";a.VV="waffle-assistant-answers-ac-row";a.V5="waffle-assistant-answers-ac-active";a.Ona="waffle-assistant-answers-ac-highlighted"};q.Ja=function(){PV.$.Ja.call(this);this.qa.C=this.J;this.J.p6=!1;this.J.Saa=6;this.getHandler().V(this.J,"update",this.Dkb);this.oI(null==this.O)};
q.mra=function(a,b){PV.$.mra.call(this,a,b);b=this.oa();var c=this.ma;b.appendChild(a,ms(Lic));this.hc=b.$a("waffle-assistant-answers-input",a);this.ea=b.$a("waffle-assistant-answers-query-box",a);this.L=new Dt("",new zV,this.oa());c.Na(this.L);this.L.Xa(b.$a("waffle-assistant-answers-clear-query-button",this.ea));this.Aa=new dV(!1,"#4285f4");c.Na(this.Aa);this.Qb=b.$a("waffle-assistant-answers-spinner-container",this.ea);this.Aa.render(this.Qb);this.D=b.$a("waffle-assistant-answers-input-box",this.ea);
$5a(this.qa,this.D);uV(this.L.getElement(),"Clear query");c.getHandler().V(this.ea,"submit",v(this.YDb,this)).V(this.ea,"focus",v(this.tFa,this,!0),!0).V(this.ea,"blur",v(this.tFa,this,!1),!0).V(this.L,"action",v(this.r5a,this)).V(this.D,"input",v(this.VTb,this)).V(this.D,"focus",v(this.kPb,this));this.L.setVisible(!1)};q.k7=function(){b6a(this.qa,this.D);this.L.setVisible(!1);this.Aa.dispose();this.Aa=null;PV.$.k7.call(this)};
q.oI=function(a){if(this.hc){R(this.hc,!a);var b=Zv;b&&b.dispatchEvent("resize")}a?ml(function(){PV.$.oI.call(this,a)},300,this):PV.$.oI.call(this,a)};q.Wh=da("eb");function gjc(a,b,c){var d=yb(Fc(c,1),function(a){return a.getName()}),e=[],f=[];z(Fc(c,2),function(a){e.push(a.getName());f=f.concat(Fc(a,2))});$ic(a.Fa,d,e,f);hjc(a.bf).then(function(a){this.Fa.F=a},null,a);a.O=b;a.Oa=c;a.oI(null==b)}q.reset=function(){xT(this.Ia);xT(this.Fa.D);var a=this.Fa;a.F=[];a.C.clear();this.Z=null};
function ijc(a){if(a.Gc()&&(jjc(a),null!=a.O))for(var b=AC(a.ue),c=b.Gd(),c=yb(ic(eh),c.i4,c),c=yb(c,Ga(Bh,a.O.rect)),d=0;d<c.length;d++)if(c[d]&&Kh(c[d])){var e=TS(b,c[d],"waffle-assistant-answers-styled-rect");F(a,e);WG(mI(b),e,!0);e.setVisible(!0);a.Uc.push(e);e=TH(b,c[d],"waffle-assistant-answers-styled-border",1,0);F(a,e);e.setVisible(!0);a.Nc.push(e)}}function jjc(a){Jc(a.Uc);Jc(a.Nc);a.Uc=[];a.Nc=[]}
q.Dkb=function(a){if(a.row)if(a=a.row,2==a.RA){var b=Oic(1,a.pta,a.rta,2);kjc(this,b,a.Qo);this.F.Tb(2652,this.Ka)}else 0==a.RA?(this.Ua=!0,this.F.Tb(2651,this.Ka)):1==a.RA&&(b=new nV,P(b,1,3),kjc(this,b))};q.tFa=function(a){mq(this.ea,"waffle-assistant-answers-query-box-focused",a);this.J.jg()&&!a&&this.J.Sj()};q.VTb=function(){this.L.setVisible(!!nic(this.D))};q.kPb=function(){this.J.Ew(this.D);var a=Va(nic(this.D));this.qa.Y2(a.length);I5a(this.J,a||"  ");this.J.update(!0)};
function kjc(a,b,c){var d=a.Rg.L.Er();P(b,13,d);var e=new oV;zj(e,5,b);d=Ya(nic(a.D));if(!a.eb||3<=a.eb.getStatus().getState().C)c=Bic(d,2),ljc(a,c,!1,e);else{if(d&&a.O)if(a.Ia[d])a.F.Tb(2681,a.Ka),c=a.Ia[d],c!=ub(a.C)&&(1<a.C.length&&mjc(a),njc(a,c.r8()),xhc(a,c));else{var f=ojc(),h=wj(wj(f,XS,46),oV,4);P(h,2,a.Ua);f=Np(Mp(new Lp,10),f).Ha();a.F.Tb(2635,f);a.Ua=!1;f=Mw(a.O.rect);b=hl(Jj(il(Lj(Mj(a.eb.eg("/answers/parse").vg("q",d,"qt",O(b,1),"gid",a.O.zd,"range",f),v(a.Kk,a,d,e)),v(a.ZYb,a,d,e)),
"POST"),2));c&&b.vg("sgfml",c);b.rf();a.bb=xJ(a.Je,Fj.hva);pjc(a,!0)}else oic(a.D,"");a.D.blur();a.L.setVisible(!!d);a.J.jg()&&a.J.Sj()}}q.YDb=function(a){a.stopPropagation();a.preventDefault();a=new nV;P(a,1,2);kjc(this,a)};q.r5a=function(){oic(this.D,"");this.L.setVisible(!1)};q.ZYb=function(a,b){if(this.O){var c=O(wj(b,nV,5),1),c=1==c||4==c?dhc.vza:dhc.Yza,d=ojc(),e=wj(wj(d,XS,46),oV,4);P(e,1,c);P(b,1,c);c=Np(Mp(new Lp,10),d).Ha();this.F.Tb(2640,c);qjc(this,a,b)}};
function qjc(a,b,c){pjc(a,!1);b=Bic(b,3);ljc(a,b,!1,c);rjc(a)}
q.Kk=function(a,b,c){this.O&&this.Ub.C.D.De.then(function(){var d=null,e=null,f=!1,h=wj(b,nV,5),k=O(h,1),l=ojc(),k=1==k||4==k?dhc.vza:dhc.Yza,m=wj(wj(l,XS,46),oV,4);P(m,1,k);P(b,1,k);l=Np(Mp(new Lp,10),l).Ha();if(c.El()){e=this.Ae.yd(rV.Ea(),c.xg());if(f=e.getStatus()){var p;switch(f){case 1:p=2639;break;case 2:p=2643;break;case 3:p=2644;break;case 4:p=2638;break;case 5:p=2707;break;case 6:p=2706}p&&this.F.Tb(p,l)}p=B(e,10);P(h,4,p);p=B(e,11);P(h,5,p);if(1==f){qjc(this,a,b);return}if(2==f){e=-1!=
sjc(a);h=-1!=ric(a);d=4;f=wj(b,nV,5);e?(d=5,P(f,8,2)):h&&(d=7,P(f,8,1));h=Bic(a,d);e?(e=new JV(h,!0,this.F,!0,this.oa()),tjc(this,h,e,b)):ljc(this,h,!0,b);pjc(this,!1);rjc(this);return}p=Ac(e,2)?B(e,2):null;f=!0;if(p){d=ujc(this.Ub,p,this.O,!!this.Oa&&!!B(this.Oa,4));P(h,14,!!d);if(!d){if(k=p.match(/([A-Z]*)\(/))m=wj(wj(qua(l),XS,46),oV,4),P(m,7,k[1]),P(b,7,k[1]);this.F.Tb(2645,l)}d=new sic(a,d,"="!=p[0]?"="+p:p,e,null);d.KC()&&(l=new Zgc,p=Fc(d.D,15)[0],P(l,1,p),zj(h,15,l))}else Ac(e,9)&&(l=e.getError(),
d=Bic(a,6,e),p=B(l,2),P(h,6,p),Ac(l,3)&&(l=B(l,3),P(h,12,l)))}else this.F.Tb(2640,l);d||(d=Bic(a,4,e));pjc(this,!1);1==d.error&&null!=d.Qo?vjc(this,d,f,b):ljc(this,d,f,b);rjc(this)},function(){qjc(this,a,b)},this)};function rjc(a){""!=a.bb&&(yJ(a.Je,a.bb),a.bb="")}function wjc(a){if(null!=a.Qo)return Vic;switch(a.error){case 4:return 0<a.F.length?MV:LV;case 5:return LV;case 6:return MV}return Wic}function ojc(){var a=new oV;P(a,8,Rm);var b=new XS;zj(b,4,a);a=new ip;zj(a,46,b);return a}
function sjc(a){return Db(pic,function(b){return Pa(a,b)})}function xjc(a,b){var c=[];b=b.F;for(var d=0;d<b.length&&3>c.length;++d)if(yjc(a.Ub,B(b[d],2),a.O,!!a.Oa&&!!B(a.Oa,4))){var e={query:B(b[d],1),Qo:B(b[d],2),type:b[d].getType()};c.push(e)}return Wj(c)}function vjc(a,b,c,d){c=new IV(b,a.ue,a.Hg,a.ag,a.F,a.ib,c,a.oa());tjc(a,b,c,d)}function ljc(a,b,c,d){c=new JV(b,c,a.F,!1,a.oa());tjc(a,b,c,d)}
function tjc(a,b,c,d){mjc(a);njc(a,b,d).then(function(){if(d){var a=ojc(),b=wj(a,XS,46);zj(b,4,d);a=Np(Mp(new Lp,10),a).Ha();this.F.Tb(2781,a)}},null,a);zjc(a,c);Ajc(a);1==b.error&&null!=b.Qo&&ajc(a.Fa,b.C);c.oka()&&(a.Ia[b.C]=c);a.getHandler().V(c,"rc",a.dzb)}function mjc(a){Bjc(a);0!=a.C.length&&(a.Z?xhc(a,a.Z):(a.Z=new Sic(a.oa()),zjc(a,a.Z)))}function Bjc(a){z(a.C,function(a){a instanceof IV||a instanceof JV||a==this.Z||this.cO(a)},a)}
function njc(a,b,c){var d=wjc(b),e=null;d==Vic||d==MV?0<b.F.length&&(e=xjc(a,b)):d==LV&&(e=Cjc(a.bf));if(e){var f=new KV(new UU,e,b.C,d,a.oa());zjc(a,f);a.F.Tb(2769,a.Ka);a.getHandler().V(f,"sqc",v(a.oCb,a));return e.then(function(a){if(c){var b=wj(c,nV,5);Eb([Vic,MV],f.C)?(a=Qic(a),zj(b,7,a)):Eb([Uic,LV],f.C)&&(a=Ric(a),zj(b,9,a))}},null,a)}return Wj()}q.oCb=function(a){oic(this.D,a.F);this.D.focus();var b=a.Ia,b=1==b?Oic(b,a.C,a.D,3):Pic(b,a.C,a.D,a.Ka);kjc(this,b,a.ea);this.F.Tb(2762,this.Ka)};
function pjc(a,b){R(a.Qb,b);R(a.oa().$a("waffle-assistant-answers-button-container",a.ea),!b);a.Aa&&a.Aa.setActive(b)}function zjc(a,b){b.nf(a.Pd());a.C.push(b);a.wf&&(a.R.Ni(b,0,!0),b.rF());wV(b,!0)}function Ajc(a){for(var b=a.C;5<b.length;)a.cO(b[0])}q.C6=function(){PV.$.C6.call(this);this.reset()};
q.dzb=function(a){var b=this.oa();a=a.target;a instanceof IV?(this.cO(a),Kic(this.ib,"Answer removed",b,v(this.ezb,this,a))):a instanceof JV&&(this.cO(a),Kic(this.ib,"Card removed",b));b=this.C;!this.Z||b[0]!=this.Z&&b[b.length-1]!=this.Z||(this.cO(this.Z),this.Z=null)};q.ezb=function(a){vjc(this,a.r8(),a.oka());Kic(this.ib,"Remove answer undone",this.oa())};q.cO=function(a){if(a.Gc()){if(a instanceof IV||a instanceof JV)delete this.Ia[a.r8().C],a==ub(this.C)&&Bjc(this);PV.$.cO.call(this,a)}H(a)};function Djc(){var a;a=""+(V('<div class="waffle-assistant-answers-logging-message-container"><div class="waffle-assistant-answers-logging-message"><span class="waffle-assistant-answers-logging-text">We\'re logging your queries and data to improve the feature.</span><div class="waffle-assistant-answers-learn-more">Learn More</div><div class="waffle-assistant-answers-logging-opt-out">Opt-out for this file</div></div></div>')+'<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container"><div class="waffle-assistant-answers-search-icon">'+
U(cv({icon:"docs-icon-img docs-icon-search-this-document"}))+'</div><input class="waffle-assistant-answers-input-box" placeholder="'+Is("Ask a question about your data")+'" /></div></form></div>');return V(a)};function Ejc(a,b){this.C=a;this.D=b}function ujc(a,b,c,d){b="="!=b[0]?"="+b:b;var e=nw(a.D),e=null!=e?e.toString():"0",f=0,h=0;ritz_api.RitzModelApi.getActiveFilterId(e)&&c&&(c=c.rect,ritz_api.RitzModelApi.getNumberOfRows(e)>c.Zc()+1?f=c.Zc()+1:ritz_api.RitzModelApi.getNumberOfColumns(e)>c.jd()+1&&(h=c.jd()+1));(a=Mgc(a.C,b,e,f,h))&&d&&(a=Yic(a));return a}
function yjc(a,b,c,d){if(a=ujc(a,b,c,d))for(b=1<a.length?1:0;b<a.length;b++){c=!1;d=a[b];for(var e=0;e<d.length;e++)if(!d[e]){c=!0;break}if(!c)return!0}return!1};function Fjc(a){var b=[];if(Ac(a,25)&&(a=B(a,25)))for(var c=0;c<Bc(a,1);c++){var d=B(a,1,c);if(Ac(d,2)){var e=B(d,2);e&&b.push(Gjc(e,Hjc(d)))}}return b}function Ijc(a){var b=Fjc(a);Ac(a,6)&&(a=B(a,6))&&b.push(Gjc(a,0));return b}function Hjc(a){return(a=Ac(a,4)?B(a,4):0)?a:0}function Gjc(a,b){return{name:a,tAa:b}};function Jjc(a,b,c){this.qa=a;this.Aa=b;this.D=[];this.F=[];this.O=[];this.R=[];this.Z=[];this.ea=[];this.C=new tg;this.L=new tg;this.ma=new tg;this.J=new tg;Kjc(this,c)}function Ljc(a,b){return vg(a,b)?a.get(b).values.Id():[]}
function Kjc(a,b){for(var c=new Ag,d=new Ag,e=0;e<b.length;e++){for(var f=Ijc(b[e]),h=[],k=[],l=0;l<f.length;l++){var m=f[l].name.toLowerCase();if(vg(a.qa,m)){var p=a.qa.get(m);c.add(p);h.push(p)}vg(a.Aa,m)&&(m=a.Aa.get(m),d.add(m),k.push(m))}Mjc(a,h,k)}a.D=c.Id();a.F=d.Id();Vb(a.D);Vb(a.F);a.O=yb(a.C.Id(),function(a){return a.key});Vb(a.O);a.R=yb(a.L.Id(),function(a){return a.key});Vb(a.R);a.Z=yb(a.ma.Id(),function(a){return a.key});Vb(a.Z);a.ea=yb(a.J.Id(),function(a){return a.key});Vb(a.ea)}
function Mjc(a,b,c){for(var d=0;d<b.length;d++)for(var e=d+1;e<b.length;e++)QV(a.C,b[d],b[e]),QV(a.C,b[e],b[d]);for(d=0;d<b.length;d++)for(e=0;e<c.length;e++)QV(a.L,b[d],c[e]),QV(a.ma,c[e],b[d]);for(d=0;d<c.length;d++)for(e=d+1;e<c.length;e++)QV(a.J,c[d],c[e]),QV(a.J,c[e],c[d])}function QV(a,b,c){var d;vg(a,b)?d=a.get(b).values:d=new Ag;d.add(c);a.set(b,{key:b,values:d})};function Njc(a,b){this.C=a;for(var c=new tg,d=0;d<Bc(a,2);d++)c.set(a.Od(d).getName().toLowerCase(),d);this.R=c;c=new tg;for(d=0;d<Bc(a,1);d++)c.set(B(a,1,d).getName().toLowerCase(),d);this.qa=c;c=[];for(d=0;d<Bc(a,2);d++)RV(a.Od(d).getName())&&c.push(d);this.L=c;c=[];for(d=0;d<Bc(a,1);d++)RV(B(a,1,d).getName())&&c.push(d);this.O=c;c=[];for(d=0;d<Bc(a,1);d++){for(var e=B(a,1,d).getName(),f=!0,h=0;h<Ojc.length;h++)if(-1!=e.search(new RegExp("(\\b|_)"+Ojc[h]+"(\\b|_)","i"))){f=!1;break}f&&c.push(d)}this.Aa=
c;this.ma=Pjc(a,0);this.Z=Pjc(a,1);c=[];for(d=0;d<Bc(a,2);d++).8<=B(a.Od(d),6)&&c.push(d);this.ea=c;c=[];for(d=0;d<Bc(a,2);d++)e=a.Od(d),.95<=Fc(e,2).length/B(e,8)&&c.push(d);this.Ia=c;c=[];for(d=0;d<Bc(a,3);d++)f=a.Od(B(a,3,d)),e=Fc(f,2).length/B(f,8),f=Bc(f,3)/Bc(f,2),.5<e||.3>f||c.push(B(a,3,d));this.Fa=c;this.F=Qjc(Bc(a,2));this.J=Qjc(Bc(a,1));this.D=new Jjc(this.R,this.qa,b)}function Qjc(a){for(var b=[],c=0;c<a;c++)b.push(c);return b}
function Pjc(a,b){for(var c=[],d=0;d<Bc(a,2);d++)a.Od(d).getType()==b&&c.push(d);return c}function Rjc(a,b){if(0==a.length&&0==b.length)return-1;for(var c=0<a.length?a[0]:b[0],d=1;d<a.length;d++)c=Sjc(c,a[d]);for(d=0;d<b.length;d++)a=c,c=Sjc(a,b[d]),c=0<c.length?c:a;return 0<c.length?c[NV(c.length)]:-1}function SV(a,b,c,d,e,f){var h=[a.L,a.D.D],k=[a.F];b&&(k.push(a.ma),k.push(a.ea));c&&k.push(a.Fa);d&&k.push(a.Ia);null!=f&&-1!=f?h.push(Ljc(a.D.L,f)):e&&h.push(a.D.R);return Rjc(k,h)}
function TV(a,b,c){var d=[a.O,a.D.F],e=[a.J];b&&e.push(a.Aa);c&&d.push(a.D.Z);return Rjc(e,d)}function Tjc(a,b){for(var c=5;;){var d=a.C.Od(b),e=NV(Bc(d,2));c--;if(RV(mV(d,e))||0==c)return e}}function Ujc(a,b){for(var c=5;;){var d=a.C.Od(b),e=NV(Bc(d,3)),e=B(d,3,e);c--;if(RV(mV(d,e))||0==c)return e}}function UV(a,b){b=a.C.Od(b);a=b.getName();RV(a)||(b=Vjc(Fc(b,7)),a=null==b?a:b);return a}function VV(a,b){b=B(a.C,1,b);a=b.getName();RV(a)||(b=Vjc(Fc(b,2)),a=null==b?a:b);return a}
function Vjc(a){for(var b=0;b<a.length;b++)if(RV(a[b]))return a[b];return null}function RV(a){return null==a?!1:50>=a.length}function Wjc(a){for(var b=Xic(a.length,2),c=[],d=0;d<b.length;d++)c.push(a[b[d]]);return c}function Sjc(a,b){for(var c=[],d=0,e=0;d<a.length&&e<b.length;)a[d]==b[e]?(c.push(a[d]),d++,e++):a[d]<b[e]?d++:e++;return c}var Ojc=["average","total","sum","mean","median"];function Xjc(a,b){this.C=[];this.F=[];this.J=this.Z=this.L=this.D=null;this.R=new Ag;this.O=new Ag;this.ea=a;this.qa=b;this.ma=Mp(new Lp,10).Ha()}Xjc.prototype.reset=function(){this.C=[];this.F=[];this.D&&(this.D.cancel(),this.D=null);this.O=new Ag;this.R=new Ag};Xjc.prototype.Wh=da("J");function hjc(a){return qoa&&a.D?a.D.then(function(){return this.F.slice()},null,a):Wj(a.C.slice())}
function Yjc(a){if(!a.C)throw Error("Suggestions not generated. Must call generate() at the top level");return 0<a.C.length?a.C[0].query:""}function Zjc(a){Vb(a,function(a,c){return c.weight-a.weight});return yb(a,function(a){return a.qta})}
function $jc(a){switch(a){case 13:return.69;case 3:return.34;case 12:return.25;case 5:return.29;case 2:return.46;case 8:return.64;case 9:return.33;case 14:return.49;case 11:return.47;case 7:return.38;case 10:return.33;case 1:return.41;case 15:return.3;case 16:return.3;case 17:return.3;default:return.3}}function WV(a,b,c,d,e){e=Math.pow(Math.random(),1/($jc(d)*(void 0===e?1:e)));a.O.contains(c)||(b.push({qta:{query:c,Qo:void 0,type:d},weight:e}),a.R.add(d),a.O.add(c))}
function XV(a,b){return!a.R.contains(b)}function Cjc(a){return hjc(a).then(function(a){return 3>=a.length?a:Rb(a,0,3)},null,a)}function akc(a,b){var c=[];b=Fjc(b);for(var d=0;d<b.length&&-1!=a.qa.get(b[d].name.toLowerCase(),-1);d++)c.push(b[d]);return c}function bkc(a){switch(a){case 6:return"Sum";case 1:return"Average";case 4:return"Count"}return null}function ckc(a){a:{if(0<a.length)for(var b=0;b<a.length;b++)switch(a[b]){case 5:a=dkc;break a;case 4:a=ekc;break a}a=fkc}return a[NV(a.length)]}
function gkc(a){var b=null;a.D=new Uj(function(a){if(!this.J||3<=this.J.getStatus().getState().C)this.F=this.C,a();var c=Mw(this.L.rect),e=yb(this.C,function(a){return a.query});b=il(hl(Jj(Lj(Mj(this.J.eg("/answers/parsesuggestions").vg("gid",this.L.zd,"range",c),v(function(b){hkc(this,b).then(a)},this)),v(function(b){8==b.errorCode&&this.qa.Tb(2833,this.ma);this.F=this.C;a()},this)).setContent(["queries",pj(e)]).setTimeout(2E3),1)),"POST").rf()},a);bk(a.D,function(){b&&b.dispose()})}
function hkc(a,b){return a.ea.C.D.De.then(function(){var a=[];if(b.El())for(var d=b.xg(),e=0;e<d.length;e++)d[e]&&yjc(this.ea,d[e],this.L,!!this.Z&&!!B(this.Z,4))&&(this.C[e].Qo=d[e],a.push(this.C[e]));this.F=a},function(){this.F.length=0},a)}var ikc="Minimum Maximum Most Least Highest Lowest".split(" "),fkc=["Average","Median"],dkc=["Total","Average","Median"],ekc=["Median"],jkc=["before","after"];function YV(a,b,c,d,e,f,h,k){xV.call(this,1,f,e,k);this.Ua=c;this.qa=null;this.ea=new Dt("",new yV,this.oa());this.Na(this.ea);this.ma=new Dt("",new yV,this.oa());this.Na(this.ma);a=new Aob(a,!0,!0);a=new Ejc(a,c);this.L=new Xjc(a,e);this.C=new PV(this.L,0,b,c,d,e,this.Oa,a,h,k);this.F=this.Aa=null;this.Qa=Mp(new Lp,10).Ha()}y(YV,xV);
var kkc={s_a:"waffle-assistant-answers-input-box",Z0a:"waffle-assistant-answers-query-box",Xnc:"waffle-assistant-answers-query-box-focused",H_a:"waffle-assistant-answers-learn-more",gjc:"waffle-assistant-answers-logging-message-container",C0a:"waffle-assistant-answers-logging-opt-out"};q=YV.prototype;q.va=function(){YV.$.va.call(this);var a=ms(Djc);this.oa().appendChild(yhc(this),a)};
q.Ja=function(){YV.$.Ja.call(this);var a=this.$a(kkc.Z0a),b=this.$a(kkc.s_a);this.ma.Xa(this.$a(kkc.C0a));this.ea.Xa(this.$a(kkc.H_a));this.getHandler().V(a,"focus",this.tyb,!0).V(a,"blur",this.ryb,!0).V(a,"mouseover",this.vyb).V(a,"mouseout",this.uyb).V(a,"click",this.syb).V(b,"input",this.$Yb).V(this.ma,"action",this.Qwb).V(this.ea,"action",this.Btb).V(rw(this.Ua),"Ib",fhc(this.aZb,25,this));this.setVisible(null!=this.Aa);lkc(this,poa&&toa&&Vm("showAnswersLoggingOptOut"))};q.WTa=Sf;q.HMa=Tf;
q.zsa=Sf;q.getTitle=n("Answers");q.Fua=n(1);q.iha=function(a){return 3==a||0==a};q.Eua=function(a,b){Vb(a,function(a,b){return B(b,2)-B(a,2)});for(var c=[],d=null,e=0;e<a.length;e++){var f=Gc(a[e],1);3==f?d=a[e]:0==f&&c.push(B(a[e],8))}d&&B(d,2)?(e=b||null,0<Bc(d,4)?mkc(this,QS(B(d,4,0)),B(d,9),c):mkc(this,e,B(d,9),c),this.F||(YV.$.Eua.call(this,a,b),this.getHandler().V(this.F,"sqc",this.nCb))):this.NW(!0)};q.V6=function(a){if(!this.F){var b=Cjc(this.L);this.F=new KV(a,b,"",Uic,this.oa())}return this.F};
q.yCa=g("C");q.Ena=function(){return this.Va()};q.NW=function(a,b,c){this.L.reset();(a||b)&&this.F&&(YV.$.NW.call(this,a,b,c),this.F.dispose(),this.F=null);if(a||t(b)&&!b)this.F&&(YV.$.NW.call(this,a,b,c),this.F.dispose(),this.F=null),this.Gc()&&(this.L.reset(),this.Aa=null,a=this.C,a.Gc()&&(b=a.Fa,b.F=[],b.C.clear(),a.D&&oic(a.D),a.C6(),a.O=null,a.oI(!0),a.L&&!a.L.isDisposed()&&a.L.setVisible(!1),a.Ua=!1),this.setVisible(!1),this.Wb()&&jjc(this.C));c&&this.C.reset()};
q.Wh=function(a){this.qa=a;this.C.Wh(a);this.L.Wh(a)};q.setActive=function(a){YV.$.setActive.call(this,a);a?ijc(this.C):jjc(this.C)};function lkc(a,b){R(a.$a("waffle-assistant-answers-logging-message-container"),b)}function nkc(a,b){a=a.$a("waffle-assistant-answers-query-box");mq(a,"waffle-assistant-answers-query-box-focused",b)}q.aZb=function(){this.Wb()&&ijc(this.C)};q.tyb=function(){nkc(this,!0);ijc(this.C)};q.ryb=function(){nkc(this,!1);this.Wb()||jjc(this.C)};q.vyb=function(){ijc(this.C)};
q.uyb=function(){this.Wb()||jjc(this.C)};q.syb=function(){okc(this,"")};q.$Yb=function(){var a=this.$a("waffle-assistant-answers-input-box");okc(this,a.value);a.value=""};q.nCb=function(a){okc(this,a.F);var b=Oic(1,a.C,a.D,1);ml(v(function(a){kjc(this.C,b,a)},this,a.ea),300,this);this.O.Tb(2652,this.Qa)};function okc(a,b){a.setActive(!0);a.dispatchEvent("assistant-sidepane-set-active-panel");ml(function(){var a=this.C;oic(a.D,b);a.D.focus()},300,a)}
function mkc(a,b,c,d){var e=c||new RU;a.Aa=b;var f=a.L,h=d;f.reset();var h=roa?h:[],k=[],l=new Njc(e,h);if(roa)for(var m=h,p=0;p<m.length;p++){var r=m[p];switch(r.getChartType()){case "BarChart":var u=f,w=l,x=r,C=k;if(XV(u,13)||XV(u,2)){var G=B(x,6);if(G&&-1!=w.R.get(G.toLowerCase(),-1)){var M=akc(w,x);if(0<M.length){var S=M[NV(M.length)],Y=bkc(S.tAa);Y&&XV(u,13)&&WV(u,C,Y+" of "+S.name+" by "+G,13,1.5)}1<M.length&&XV(u,2)&&WV(u,C,"Correlation of "+M[0].name+" and "+M[1].name,2,1.5)}}break;case "ScatterChart":var ea=
f,ka=l,ca=r,xa=k;if(XV(ea,2)){var ra=akc(ka,ca);1<ra.length&&WV(ea,xa,"Correlation between "+ra[0].name+" and "+ra[1].name,2,1.5)}break;case "PieChart":var Ca=f,Ha=l,Da=r,ib=k;if(XV(Ca,14)){for(var La,ob=Ha,Nc=[],Xc=Fjc(Da),fd=0;fd<Xc.length&&-1!=ob.R.get(Xc[fd].name.toLowerCase(),-1);fd++)Nc.push(Xc[fd]);La=Nc;1==La.length&&4==La[0].tAa&&WV(Ca,ib,"Distribution of "+La[0].name,14,1.5)}}}if(XV(f,1)){var Gd=l.C,Hb=TV(l,!1,!0),zf=SV(l,!0,!1,!0,!0,Hb);if(-1!=zf&&-1!=Hb){var db=10<=Bc(Gd.Od(zf),2)?"5 ":
"",Cd=UV(l,zf),ld=VV(l,Hb);Cd!=ld&&WV(f,k,"Top "+db+Cd+" by "+ld,1)}}if(XV(f,2)&&1<Bc(l.C,1)){var $f;a:if(2>l.J.length)$f=[-1,-1];else{var Jg=Rjc([l.J],[l.O,l.D.F,l.D.ea]);if(-1!=Jg){var Fh=Ljc(l.D.J,Jg);if(0<Fh.length){var xj=[Jg],hk=NV(Fh.length);xj.push(Fh[hk]);$f=xj;break a}}$f=Wjc(2<=l.O.length?l.O:l.J)}var Sj=VV(l,$f[0]),Tj=VV(l,$f[1]);Sj!=Tj&&WV(f,k,"Correlation between "+Sj+" and "+Tj,2)}if(XV(f,3)){var cm=l.C,ql=TV(l,!0);-1!=ql&&WV(f,k,ckc(Fc(B(cm,1,ql),3))+" of "+VV(l,ql),3)}if(XV(f,5)){var Kk=
l.C,Zm=TV(l,!0,!0),ho=SV(l,!0,!0,!1,!0,Zm);if(-1!=Zm&&-1!=ho){var rl=VV(l,Zm),$m=Kk.Od(ho),Ki=UV(l,ho);if(0<Bc($m,3)&&Ki!=rl){var dj=Ujc(l,ho);WV(f,k,ckc(Fc(B(Kk,1,Zm),3))+" of "+rl+" when "+Ki+" is "+mV($m,dj),5)}}}if(XV(f,9)){var Li=TV(l,!1,!0),ik=SV(l,!0,!1,!1,!0,Li);if(-1!=ik&&-1!=Li){var jk=VV(l,Li),an=UV(l,ik);an!=jk&&WV(f,k,an+" with "+ikc[NV(ikc.length)]+" "+jk,9)}}if(XV(f,10)&&0<Bc(l.C,1)){var Mi=VV(l,TV(l));WV(f,k,ikc[NV(ikc.length)]+" "+Mi,10)}if(XV(f,11)){var Lt=l.C,sl=SV(l,!0,!0,!1,!1,
-1);if(-1!=sl){var Iq=UV(l,sl);0<Bc(Lt.Od(sl),3)&&WV(f,k,"Most frequent "+Iq,11)}}if(XV(f,12)){var io=l.C,qb=TV(l,!0),dm;a:{if(1==l.Z.length){var Qq=l.Z[0];if(!B(l.C.Od(Qq),5)){dm=Qq;break a}}dm=-1}if(-1!=dm&&-1!=qb){var ts=VV(l,qb),yA=io.Od(dm);if(0<Bc(yA,2)){var zA=Tjc(l,dm);WV(f,k,ckc(Fc(B(io,1,qb),3))+" of "+ts+" "+jkc[NV(jkc.length)]+" "+mV(yA,zA),12)}}}if(XV(f,15)){var Xw=l.C,us=TV(l,!0),Rq=SV(l,!1,!0,!1,!0,us);if(-1!=us&&-1!=Rq){var Yw=VV(l,us),Zw=UV(l,Rq);if(Zw!=Yw){var vs=Xw.Od(Rq);if(2<=
Bc(vs,3)){var yl=Xic(Bc(vs,3),2);WV(f,k,"Compare "+ckc(Fc(B(Xw,1,us),3))+" "+Yw+" for "+Zw+" "+mV(vs,B(vs,3,yl[0]))+" and "+mV(vs,B(vs,3,yl[1])),15)}}}}if(XV(f,16)){var gu=l.C,yo=SV(l,!0,!0,!1,!1);if(-1!=yo){var $w=UV(l,yo);gu.Od(yo);WV(f,k,"List unique values in "+$w,16)}}if(XV(f,17)){var hu=l.C,zo=SV(l,!0,!0,!1,!1);if(-1!=zo){var Ao=hu.Od(zo),ws=UV(l,zo);if(!(1>Bc(Ao,3))){var xs=Ujc(l,zo);WV(f,k,"What percentage of "+ws+" is "+mV(Ao,xs),17)}}}var Sq=3>k.length;if((Sq||0==NV(5))&&XV(f,7)){var ys=
l.C,zs=TV(l,!1,!0),kn=SV(l,!1,!1,!1,!0,zs);if(-1!=kn&&-1!=zs){var ln=ys.Od(kn),iu=UV(l,kn),As=VV(l,zs);if(0<Bc(ln,2)&&iu!=As){var Tq=Tjc(l,kn);WV(f,k,"Show "+As+" for "+iu+" "+mV(ln,Tq),7)}}}if((Sq||0==NV(5))&&XV(f,8)){var ju=l.C,mn;a:if(2>l.F.length)mn=[-1,-1];else{var FE=[l.L,l.D.D,l.D.O],ku=[l.F];ku.push(l.ma);ku.push(l.ea);var Uq=Rjc(ku,FE);if(-1!=Uq){var Vq=Ljc(l.D.C,Uq);if(0<Vq.length){var Bo=[Uq],I9a=NV(Vq.length);Bo.push(Vq[I9a]);mn=Bo;break a}}Bo=Wjc(2<=l.L.length?l.L:l.F);Bo[0]!=Uq&&(Bo[1]=
Bo[0],Bo[0]=Uq);mn=Bo}var Qfa=mn[0];if(1<Bc(ju,2)&&-1!=Qfa){var A1=mn[1],B1=ju.Od(A1),eK=UV(l,A1),C1=UV(l,Qfa);if(0<Bc(B1,2)&&eK!=C1){var J9a=Tjc(l,A1);WV(f,k,"What is "+C1+" where "+eK+" is "+mV(B1,J9a),8)}}}f.C=Zjc(k);f.L=b;f.Z=e;qoa&&gkc(f);a.setVisible(null!=b);gjc(a.C,b,e);a.Wb()&&ijc(a.C)}q.Qwb=function(a){a.stopPropagation();a.preventDefault();this.qa&&(il(Lj(Mj(this.qa.eg("/answers/logoptout"),v(this.kub,this)),v(this.jub,this)),"POST").rf(),this.O.Tb(2663,this.Qa))};
q.Btb=function(a){a.stopPropagation();a.preventDefault();Qp("https://docs.google.com/document/d/1VxpmAx5RTnwmeXyj3IuPPYIXg9DYzTS8nz8pi1E_ZJk/preview",{target:"_blank"})};q.kub=function(a){a.El()&&lkc(this,!1)};q.jub=ba();function pkc(){var a;a=""+('<div class="waffle-assistant-banding-recommendation"><div class="waffle-assistant-banding-color-picker-container"></div><div class="waffle-assistant-banding-range-wrapper">Alternating colors for <span class="waffle-assistant-banding-range"></span></div>'+qkc()+"</div>");return V(a)}
function rkc(){return V('<div class="waffle-assistant-conditionalformat-rule-group"><div class="waffle-assistant-conditionalformat-rule-holder" tabindex="0"></div><div class="waffle-assistant-conditionalformat-description"></div>'+qkc()+"</div>")}function qkc(){var a;a=""+U(Kt({Ke:"waffle-assistant-formatting-edit-button",content:Es("Edit"),style:4}));return V(a)};function ZV(a,b,c){BV.call(this,a,c);a=yb(Fc(this.D,7),Rcc);this.C=new KT(!1,a,7);this.Na(this.C);this.L=new Mt("",this.oa());this.Na(this.L);this.ea=b;this.J=!1;this.F=-1}y(ZV,BV);var skc={nea:"waffle-assistant-banding-color-picker-container",xea:"waffle-assistant-formatting-edit-button",PJ:"waffle-assistant-banding-range"};q=ZV.prototype;q.va=function(){ZV.$.va.call(this);CV(this).appendChild(ms(pkc))};
q.Ja=function(){ZV.$.Ja.call(this);this.getHandler().V(this.L,"action",this.Apb).V(this.C,"banding-scheme-changed",this.Ukb);this.ea.Tb(2768,void 0)};q.bE=function(a){var b=this.$a(skc.nea);this.C.render(b);Xcc(this.C);var b=this.$a(skc.PJ),c=B(this.D,4,0),d=Rh(c);Sn(b,Mw(d));tkc(this,c);b=this.$a(skc.xea);this.L.Xa(b);a()};q.ZD=function(){fq(this.Da,"Suggested alternating background colors");Pr(this.C,"Choose a color scheme")};q.mC=n("assistantBandingFeedback");q.kG=n(2672);q.jG=n(2671);
q.Apb=function(a){Do.dispatchEvent({type:"show-banding-pane-recommendation",YRa:this.D,o6a:Ycc(this.C)});a.stopPropagation()};q.Ukb=function(a){if(!this.J&&LT(this.C)){var b=this.F;this.F=this.C.Zi();this.F==b?this.dispatchEvent(new tV("assistant-sidepane-remove-banding",this,2797)):this.dispatchEvent(new tV("assistant-sidepane-apply-banding",this,2673));a.stopPropagation()}};
function tkc(a,b){a.J=!0;var c;c=b.mb();b=Rh(b);c=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(c,b.rc(),b.mc(),b.Zc(),b.jd(),7,!1);c.length?(c=ritz_api.RitzModelApi.getBandedRangeByWorkbookRangeId(c[0]),c=(new cj).yd(Kd.Ea(),c),c=Rcc(c)):c=null;c?(c=Zcc(a.C,c),wI(a.C,c?c.getElement():null)):wI(a.C,null);a.F=a.C.Zi();a.J=!1};function $V(a,b){BV.call(this,a,b);this.C=new Mt("",this.oa());this.Na(this.C);this.eb=Fc(a,6)}y($V,BV);var aW={xea:"waffle-assistant-formatting-edit-button",UZa:"waffle-assistant-conditionalformat-format-preview",u1a:"waffle-assistant-conditionalformat-rule-holder",E4:"waffle-assistant-conditionalformat-description",z0a:"one-rule",s2a:"two-rules",g2a:"three-rules",S0a:"waffle-assistant-conditionalformat-format-preview-label"};q=$V.prototype;q.va=function(){$V.$.va.call(this);CV(this).appendChild(ms(rkc))};
q.Ja=function(){$V.$.Ja.call(this);var a=this.$a(aW.xea);this.C.Xa(a);uV(a,"Apply and edit conditional format rules");this.getHandler().V(this.C,"action",this.qkb)};q.bE=function(a){Sn(this.$a(aW.E4),Gc(this.D,3));var b=this.$a(aW.u1a),c=new ukc(this,this.oa());this.Na(c);c.Xa(b);uV(b,"Apply conditional format rules");a()};q.ZD=pa;q.mC=n("assistantConditionalFormatFeedback");q.kG=n(2630);q.jG=n(2629);
q.qkb=function(){vkc(this);this.dispatchEvent(new tV("assistant-sidepane-change-selection",this,2670,void 0,void 0,Rh(B(this.eb[0],1,0))));Io()};function vkc(a){a.dispatchEvent(new tV("assistant-sidepane-apply-conditional-format-rules",a,2563))}function ukc(a,b){Mr.call(this,void 0,void 0,b);this.C=a}y(ukc,Mr);
ukc.prototype.Te=function(a){ukc.$.Te.call(this,a);var b=this.C.eb,c;switch(b.length){case 0:break;case 1:c=aW.z0a;break;case 2:case 4:c=aW.s2a;break;default:c=aW.g2a}for(var d=0;d<b.length;d++){var e=b[d],f=zn("DIV");jq(f,[aW.UZa,c]);var h=zn("DIV");iq(h,aW.S0a);f.appendChild(h);Sn(h,"123");if(Ac(e,2)){var k=B(B(e,2),1);switch(B(B(k,1),1)){case 9:case 13:var k=Fc(B(k,1),2)[0],l=Fc(e,1)[0];Sn(h,HA(k,Gc(l,1),Gc(l,2),Gc(l,4)))}}jcc(e,f);a.appendChild(f)}};ukc.prototype.Nj=function(){vkc(this.C);return!0};function wkc(a,b,c){xV.call(this,2,b,a,c)}y(wkc,xV);q=wkc.prototype;q.getTitle=n("Formatting");q.iha=function(a){return 2==a||4==a};q.V6=function(a){var b=B(a,1);switch(b){case 2:return new $V(a,this.oa());case 4:return a=new ZV(a,this.O,this.oa()),this.getHandler().V(a,"assistant-sidepane-apply-banding",this.uRb).V(a,"assistant-sidepane-remove-banding",this.dFb),a;default:throw Error("Unsupported recommendation type: "+b);}};
q.uRb=function(a){Kic(this.Oa,"Alternating colors applied",this.oa(),v(this.Vkb,this,a.C))};q.dFb=function(){this.Oa.clear()};q.Vkb=function(a){this.dispatchEvent(new tV("assistant-undo-pressed",a,2796))};q.nf=function(a){wkc.$.nf.call(this,a);this.setVisible(!a)};q.Gua=function(a){return this.Pd()?(this.setVisible(!1),a):wkc.$.Gua.call(this,a)};q.Fua=n(3);function bW(a,b,c,d){gv.call(this,a,b,c,d,void 0,void 0,!0)}y(bW,gv);bW.prototype.va=function(){bW.$.va.call(this);iq(this.Da,"waffle-assistant-toast");iq(this.$a("docs-ui-toast-content"),"waffle-assistant-toast-content")};bW.prototype.pK=function(a,b,c){c=c?c:"waffle-assistant-toast-action";b=hr(this,b);bW.$.pK.call(this,a,b,c)};bW.prototype.ej=function(a,b,c,d){this.pK(a,b,d);a=jr(this,b);Qf(this.getHandler(),a,qd,v(function(){this.setVisible(!1);c()},this))};function xkc(){this.C=null}y(xkc,E);xkc.prototype.clear=function(){this.C&&(this.C.setVisible(!1),this.C.dispose(),this.C=null)};function Kic(a,b,c,d){a.clear();a.C=new bW(b,c,!1,5E3);a.C.render();d&&a.C.ej("Undo","w-a-u-tm-u",d,void 0);a.C.setVisible(!0);a.C.getElement().focus()}xkc.prototype.xa=function(){xkc.$.xa.call(this);this.clear()};function ykc(a){a=""+('<div class="waffle-assistant-quicksum-entry" tabindex="0"><span class="waffle-assistant-quicksum-entry-name" title="'+W(a.title)+'">'+U(a.name)+'</span><span class="waffle-assistant-quicksum-entry-value"></span><span aria-label="'+Is("Press enter to insert formula")+'"></span></div>');return V(a)};function cW(a,b){T.call(this);this.C=a;this.D=b}y(cW,T);q=cW.prototype;q.va=function(){this.Da=ms(ykc,{name:this.C,title:this.D})};q.Ja=function(){cW.$.Ja.call(this);var a=this.$a("waffle-assistant-quicksum-entry-name");uV(a);this.getHandler().V(this.Da,"keypress",this.JYb);R(this.Da,!1)};q.getFunctionName=g("C");q.Wa=function(a){Sn(this.$a("waffle-assistant-quicksum-entry-value"),a||"");R(this.Da,!!a)};q.Va=function(){return Lq(this.Da)};
q.JYb=function(a){13==a.keyCode&&(a.stopPropagation(),a.preventDefault(),this.dispatchEvent(new I("insert",this)))};function dW(a,b,c,d,e){T.call(this,e);this.Fa=a;this.qa=b;this.R=c;this.L=d;this.D=a.C;this.Aa=new cj;this.ea=Mp(new Lp,17).Ha();this.Z=Mp(new Lp,2).Ha();this.O=!1;this.F=[];this.C=null;this.J=[]}y(dW,T);
dW.prototype.Ja=function(){dW.$.Ja.call(this);this.Ni(new cW(ritz_api.RitzModelApi.getLocalizedFunctionName("SUM"),"Sum"),0,!0);this.Ni(new cW(ritz_api.RitzModelApi.getLocalizedFunctionName("AVERAGE"),"Average"),1,!0);this.Ni(new cW(ritz_api.RitzModelApi.getLocalizedFunctionName("MIN"),"Minimum"),2,!0);this.Ni(new cW(ritz_api.RitzModelApi.getLocalizedFunctionName("MAX"),"Maximum"),3,!0);this.Ni(new cW(ritz_api.RitzModelApi.getLocalizedFunctionName("COUNTA"),"Count all"),4,!0);this.C=new HV(this.Da,
this.qa,this.D,this.R);this.C.nf(this.O);F(this,this.C);this.getHandler().V(this,"insert",this.ma).V(this.C,"formula_inserted",this.Ia)};
function zkc(a){function b(a){return l?ritz_api.RitzModelApi.renderNumberAsFormattedString(a,m):null}if(sw(a.D)){var c=tw(a.D),d=c.Ik(),e=uJ(a.D);if(Bb(d,c.Lt,c)){var f=[];a.F=[];for(c=0;c<d.length;c++){var h=d[c],k=hha(e+"",h.rc(),h.mc(),h.Zc(),h.jd());f.push(a.Aa.serialize(k));a.F.push(h)}if(d=ritz_api.RitzModelApi.quickSum(f)){R(a.Da,!0);var e=d.count,c=d.countNumberFormat,l=1<d.numericCount,m=l?d.valueNumberFormat:null;a.Ed(0).Wa(b(d.sum));a.Ed(1).Wa(b(d.average));a.Ed(2).Wa(b(d.min));a.Ed(3).Wa(b(d.max));
1<e?a.Ed(4).Wa(ritz_api.RitzModelApi.renderNumberAsFormattedString(e,c)):R(a.Da,!1);if(a.C){a.C.L=[];a.J=[];for(c=0;c<a.Dd();++c)d=a.Ed(c),a.J.push(Akc(a,d.getFunctionName()));a.C.L=a.J}}else R(a.Da,!1)}else R(a.Da,!1)}else R(a.Da,!1)}dW.prototype.nf=function(a){this.O=a;this.C&&this.C.nf(a);mq(this.Da,"waffle-assistant-quicksum-panel-readonly",a)};
dW.prototype.ma=function(a){var b=a.target;a=this.F[0];a=new L(a.left,a.Zc());b=b.getFunctionName();b=Akc(this,b);a=new lG(tw(this.D),a,b);this.R.C(a);this.L.Tb(2624,this.Z)};dW.prototype.Ia=function(){this.L.Tb(2624,this.ea)};function Akc(a,b){var c=Tw(a.Fa.L);a=yb(a.F,function(a){return Mw(a)});return"="+b+"("+a.join(c)+")"};function Bkc(a){a=""+('<div class="waffle-autovis-lightbox"><div class="waffle-autovis-lightbox-header"><div class="waffle-autovis-lightbox-buttons-wrapper">'+U(Kt({content:Es("INSERT CHART"),style:4,Ke:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-insert waffle-autovis-lightbox-readonly-hidden"}))+U(Kt({Ke:"waffle-autovis-lightbox-close",content:Fs(""+U(cv({icon:"docs-icon-img docs-icon-close-white"}))),style:4,title:Es("Close")}))+'</div></div><div class="waffle-autovis-lightbox-content"><div class="waffle-autovis-lightbox-content-inner">\x3c!-- TODO(cuiffo): Replace with real icons --\x3e'+
U(Kt({content:Fs("&#10094;"),style:4,Ke:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-previous",attributes:Gs('aria-label="'+Is("Previous chart")+'"')}))+'<div class="goog-inline-block waffle-autovis-lightbox-container"></div>'+U(Kt({content:Fs("&#10095;"),style:4,Ke:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-next",attributes:Gs('aria-label="'+Is("Next chart")+'"')}))+'</div><div class="waffle-autovis-lightbox-page-count"><span class="waffle-autovis-lightbox-page-number"></span>/'+
U(a.QIb)+"</div></div></div>");return V(a)}function Ckc(){return V('<div class="waffle-autovis-lightbox-chart"></div>')};function eW(a,b,c){T.call(this,c);this.F=a;this.D=b;this.J=[];this.C=new Mt("",this.oa());this.Na(this.C);this.R=new Mt("",this.oa());this.Na(this.R);this.O=new Mt("",this.oa());this.Na(this.O);this.L=new Mt("",this.oa());this.Na(this.L)}y(eW,T);q=eW.prototype;q.va=function(){eW.$.va.call(this);this.Da=ms(Bkc,{QIb:this.F.length})};
q.Ja=function(){eW.$.Ja.call(this);var a=X.gJ.isEnabled();this.nf(!a);a=this.$a("waffle-autovis-lightbox-close");this.C.Xa(a);a=this.$a("waffle-autovis-lightbox-insert");this.R.Xa(a);var b=this.$a("waffle-autovis-lightbox-previous");this.O.Xa(b);b=this.$a("waffle-autovis-lightbox-next");this.L.Xa(b);Dkc(this);Ekc(this,this.D,!1);this.getHandler().V(document.body,dd,this.tUb).V(this.Da,"keydown",this.uUb).V(yn(),"resize",this.xUb).V(this.C,"action",this.close).V(this.R,"action",this.Rsb).V(this.O,
"action",this.wUb).V(this.L,"action",this.vUb);b=new Hv(this.Da,this.oa());Iv(b);F(this,b);a.focus()};function Dkc(a){var b=a.$a("waffle-autovis-lightbox-content"),c=a.$a("waffle-autovis-lightbox-content-inner");a=a.$a("waffle-autovis-lightbox-page-count");var d=wn();a=Hq(a);var e=d.height-a.height-195,f=d.width-200;.75<e/f?(d=f,e=.75*f):d=e/.75;Eq(c,d,e);Eq(b,d,e+a.height+35)}q.nf=function(a){mq(this.Da,"waffle-autovis-lightbox-readonly",a)};
function Ekc(a,b,c){c&&Go("Page "+(b+1+(" of "+(a.F.length+"."))));a.J[b]?Fkc(a,b):a.F[b]&&aic(a.F[b],v(a.emb,a,b),!0)}q.emb=function(a,b){if(!this.isDisposed()&&b){var c=this.$a("waffle-autovis-lightbox-container"),d=ms(Ckc);c.appendChild(d);this.J[a]=d;NU(b,d,Lm);Fkc(this,a)}};function Fkc(a,b){R(a.J[a.D],!1);R(a.J[b],!0);a.O.Ra(0!=b);a.L.Ra(b!=a.F.length-1);var c=a.$a("waffle-autovis-lightbox-page-number");Sn(c,b+1);a.D=b}q.tUb=function(a){!Pn(this.Da,a.target)&&a.relatedTarget&&a.relatedTarget.focus()};
q.uUb=function(a){27==a.keyCode?this.close():37==a.keyCode||38==a.keyCode?0!=this.D&&Ekc(this,this.D-1,!0):39!=a.keyCode&&40!=a.keyCode||Gkc(this);a.stopPropagation()};q.xUb=function(){var a=this.$a("waffle-autovis-lightbox-container");Fn(a);this.J=[];Dkc(this);Ekc(this,this.D,!0)};q.Rsb=function(){this.close();dic(this.F[this.D],2256)};q.wUb=function(){0!=this.D&&Ekc(this,this.D-1,!0);0==this.D&&this.L.Da.focus()};q.vUb=function(){Gkc(this);this.D==this.F.length-1&&this.O.Da.focus()};
function Gkc(a){a.D!=a.F.length-1&&Ekc(a,a.D+1,!0)}q.close=function(){this.dispose()};q.Hd=function(){eW.$.Hd.call(this);var a=this.F[this.D];a&&a.Da&&a.Da.focus()};function Hkc(a,b){J.call(this);this.Qb=a;this.eb=b;this.J=a.C;this.Ae=new cj;this.Ia=nk();this.L=nk();this.ib=this.C=this.F=this.O=this.R=this.qa=this.ma=null;this.Ua=!1;this.D=null;this.Gb=!0;this.Ka=this.Oa=!1;this.Qa=this.bb=null;this.ea=wJ.getInstance();this.Fa=this.Aa="";b=this.Qb.L.Er();this.Z=new VU;D(this.Z,2,Zna);a=Aoa&&!a.Pd();D(this.Z,3,a);D(this.Z,4,uoa);a=Jm&&(Sm||"en"==iE(b));D(this.Z,5,a);D(this.Z,6,voa);D(this.Z,7,Boa);D(this.Z,10,!1);D(this.Z,11,Rm);D(this.Z,12,Tm);a=new K(this);
F(this,a);a.V(this.eb,"Da",this.hZb)}y(Hkc,J);var Ikc={K3b:"cu",SXa:"cs",RXa:"ce",R_a:"ls",P_a:"le"};q=Hkc.prototype;q.update=function(a,b,c){c&&this.C&&!Cb(c,function(a){return bha(a,this.C.rect)},this)||!a&&this.C&&c&&1==c.length&&1==c[0].ai()&&this.C.rect.contains(c[0])||(this.Ia.cancel(!0),a&&(this.Ka=!0,this.L.cancel(!0),this.F=this.O=this.R=this.qa=null,this.ma&&(this.ma.cancel(!0),this.ma=null)),this.Ia=Jkc(),this.Ia.addCallback(this.A4a,this),this.Ia.addCallback(Ga(this.B4a,b),this))};
q.Wh=da("bb");q.hZb=function(){this.ma&&3==this.eb.getState()&&(this.ma.Vb(),this.ma=null)};function Jkc(){var a=null,b=new dk(function(){null===a||nl(a)}),a=ml(function(){b.Vb()});return b}q.rlb=function(){this.Oa=!0};
q.A4a=function(){var a=this.J.getActiveGrid();if(a){var b=tw(this.J),c=b.Ik(),d=Kkc(this,c||[]),e=Kkc(this,this.ib||[]);d&&!e||!d&&!Lkc(c,this.ib)?(this.F=null,this.Ua=!0):this.Ua=!1;this.ib=c;var f=iC(b).clone();z(b.Ik(),function(a){f.Nn(a)});this.D=new Mh(a.mb(),"",f)}else this.D=null};
q.B4a=function(a){this.Aa=xJ(this.ea,Fj.uwa);var b=this.J.getActiveGrid(),c=this.D&&this.D.zd;this.C&&this.C.zd!=c&&(this.C=null);if(!b||b.mb()!=c||null===c)return this.D=null;var d=this.J.getActiveGrid().D,b=CA(d,this.D.rect);b.addCallback(function(){if(!this.J.getActiveGrid()||nw(this.J)!=c)return null;var b=tw(this.J),f=Mkc(this,a),h=xA(b.F,"r"),k=b.Sn("r");return!b.Lt(f)||h>=f.rc()&&BNa(b)||k<=f.Zc()&&ANa(b)?(this.dispatchEvent(new I("ls")),DA(d,f,ic(dh),a?void 0:500).addCallback(this.$6a,this)):
f},this);b.addCallback(function(a){var b=this.J.getActiveGrid();return a&&b&&b.mb()==c&&null!==c?Nkc(this,a,tw(this.J)):null},this);b.addCallback(function(b){var d=this.C;b&&3<b.ai()&&(d=b&&new Mh(c,"",b));if(null===d&&null!==this.C||null!==d&&!d.equals(this.C))this.F=this.O=this.R=this.qa=null;b=null!==d&&d.equals(this.C);if(b=this.Ka||this.Ua||!b&&(null===this.R||null!==this.O&&null===this.F))this.Gb=this.Oa&&this.Gb||!this.C||!d||!d.rect.intersects(this.C.rect);var e=null!==d&&d.contains(this.C);
this.C=d;""!=this.Aa&&(yJ(this.ea,this.Aa),this.Aa="");b&&(a&&(this.Fa=xJ(this.ea,Fj.vwa)),this.L.cancel(!0),this.L=nk(),this.L.addCallback(this.I4a,this),this.L.addCallback(this.X6a,this),a&&(this.L.addCallback(Ga(this.T6a,e),this),this.bb&&!YHa(this.Qb)&&woa?this.L.addCallback(this.Igb,this):(this.L.addCallback(this.F4a,this),this.L.addCallback(this.G4a,this)),this.L.addCallback(this.S6a,this)),gk(this.L,this.rlb,this))},this);return b};
function Mkc(a,b){return null!=a.D?ritz_api.RitzModelApi.getExploreTableRectForSelection(""+a.D.zd,a.D.rect.top,a.D.rect.height+a.D.rect.top,a.D.rect.left,a.D.rect.width+a.D.rect.left,b,Koa,xh):null}
q.I4a=function(){if(null!==this.C&&null!==this.C.rect&&null===this.qa){var a=xJ(this.ea,Fj.kva);this.qa=ritz_api.RitzModelApi.getAssistantConfidence(""+this.C.zd,this.C.rect.top,this.C.rect.height+this.C.rect.top,this.C.rect.left,this.C.rect.width+this.C.rect.left,this.Ae.serialize(this.Z));yJ(this.ea,a)}};q.$6a=function(){this.dispatchEvent(new I("le"))};q.X6a=function(){this.dispatchEvent(new Okc(this.C,this.qa))};q.T6a=function(a){a=new Pkc(a,this.Ka);this.Ka=!1;this.dispatchEvent(a)};
q.Igb=function(){if(null===this.C||null===this.C.rect||null!==this.O&&null!==this.F)return null;H(this.Qa);return 3!=this.eb.getState()?(this.ma=new dk,this.ma.addCallback(this.VSa,this),this.ma):this.VSa()};
q.VSa=function(){var a=xJ(this.ea,Fj.xwa),b=Qkc(this),c=b&&!b.oOa,b=ritz_api.RitzModelApi.getAssistantRequestProto(this.C.zd.toString(),this.C.rect.top,this.C.rect.height+this.C.rect.top,this.C.rect.left,this.C.rect.width+this.C.rect.left,c?b.rows:[],c?b.Ne:[]),b=this.Ae.yd(TU.Ea(),b),c=new cj;c.Qw=!0;var b=pj(c.serialize(b)),d=new dk;this.Qa=Lj(Mj(Jj(hl(il(this.bb.eg("/explore/getrecommendations").vg("rp",b),"GET")).setTimeout(6E4),1),function(b){var c=xJ(this.ea,Fj.wwa);b=Rkc(this,b.xg());yJ(this.ea,
c);this.O=Fc(b,1);this.F=Fc(b,2);this.Qa=null;yJ(this.ea,a);d.Vb()},this),function(){this.O=[];this.F=[];d.Vb()},this).rf();return d};
q.F4a=function(){function a(){b=null;ritz_api.RitzModelApi.continueAssistantRecommendation(this.R)?(this.O=Fc(Rkc(this,ritz_api.RitzModelApi.getAssistantRecommendations(this.R)),1),d.Vb()):b=ml(a,5,this)}if(null===this.C||null===this.C.rect||null!==this.R&&null!==this.O)return null;this.R=ritz_api.RitzModelApi.newAssistantRecommender(this.Ae.serialize(this.Z));this.F=this.O=null;ritz_api.RitzModelApi.startAssistantRecommendation(this.R,""+this.C.zd,this.C.rect.top,this.C.rect.height+this.C.rect.top,
this.C.rect.left,this.C.rect.width+this.C.rect.left);var b=null,c=v(function(){null!==b&&(nl(b),this.F=this.O=this.R=b=null)},this),d=new dk(c),b=ml(a,5,this);return d};q.G4a=function(){var a=Qkc(this);a&&this.R&&null===this.F&&(this.F=a.oOa?[]:Fc(Rkc(this,ritz_api.RitzModelApi.getAssistantRecommendationsOnlySelection(this.R,a.rows,a.Ne)),2))};
q.S6a=function(){this.Oa=!1;var a=this.F&&0<this.F.length?this.F:this.O;""!=this.Fa&&(yJ(this.ea,this.Fa),this.Fa="");this.dispatchEvent(new Skc(this.C,a||[],this.Gb))};function Rkc(a,b){return a.Ae.yd(SU.Ea(),b)}function Nkc(a,b,c){b=b.clone();gc(dh,function(a){for(var d=!0;d&&b;){for(var f=hh(a),h=0;h<(f?b.width:b.height);h++){var k=Jh(b,a),l=f?b.mc():b.rc(),k=f?c.Pf(k,l+h):c.Pf(l+h,k);if(!CPb(k)&&k.Or()){d=!1;break}}d&&(fha(b,-1,a),0==b.width||0==b.height)&&(b=null)}return!!b},a);return b}
function Lkc(a,b){return Xb(a,b,function(a,b){return Ch(a,b)})}function Qkc(a){var b=a.J.getActiveGrid();if(!b||!a.C||b.mb()!=a.C.zd)return null;for(var c=tw(a.J).Ik(),c=yb(c,Ga(Bh,a.C.rect)),c=xb(c,ta),d=yb(c,function(a){return new th(a.left-this.C.rect.left,a.top-this.C.rect.top,a.width,a.height)},a),b=new Ag,e=new Ag,f=0;f<d.length;f++){for(var h=0;h<d[f].width;h++)e.add(d[f].left+h);for(h=0;h<d[f].height;h++)b.add(d[f].top+h)}a=Kkc(a,c);return{rows:b.Id(),Ne:e.Id(),oOa:a}}
function Kkc(a,b){a.J.getActiveGrid();if(0==b.length)return!0;if(1!=b.length)return!1;b=b[0];if(Yga(b)||0==b.ai())return!0;a=SRa(tw(a.J).ea,b.top,b.left);return b.equals(a)}function Okc(a,b){I.call(this,"cu");this.C=a;this.D=b}y(Okc,I);function Skc(a,b,c){I.call(this,"ce");this.C=a;this.D=b;this.F=c}y(Skc,I);function Pkc(a,b){I.call(this,"cs");this.C=a;this.D=b}y(Pkc,I);function fW(a,b,c,d,e,f){CT.call(this,f);this.ea=a;this.ib=b.C;this.Ka=c;this.hc=d;this.L=e;this.qa=new dW(b,c,d,e,this.oa());this.Na(this.qa);this.R=new dV(!1,"#4285f4");this.Na(this.R);this.O=null;this.eb=this.bb=!1;this.Qa=!0;this.Oa=wJ.getInstance();this.Fa=this.Aa="";this.Z=Mp(new Lp,10).Ha()}y(fW,CT);q=fW.prototype;q.va=function(){fW.$.va.call(this);this.Da=ms(this.CWa(),{pRb:Jm})};
q.Ja=function(){fW.$.Ja.call(this);var a=this.$a("waffle-assistant-quicksum-panel");this.qa.Xa(a);a=this.$a("waffle-assistant-spinner-container");this.R.render(a);this.getHandler().V(this,"close-sidebar",this.sna).V(this.ea,Ikc.R_a,this.gna).V(this.ea,Ikc.P_a,this.fna).V(this.ea,Ikc.SXa,this.Gma).V(this.ea,Ikc.RXa,this.Fma).V(this.$a("waffle-assistant-scroll-pane"),"scroll",fhc(this.Oda,10,this));a=X.gJ.isEnabled();this.nf(!a)};
q.resize=function(){var a=this.$a("waffle-assistant-sidepane-content"),a=Hq(a).height,b=this.$a("waffle-assistant-spinner-container");pq(b,"margin-top",a/2-16+"px")};q.Wh=pa;function Tkc(a,b){var c=a.$O();0!=c.length&&(H(a.O),c=c.filter(function(a){return a instanceof DV}),b=c.indexOf(b),0<c.length&&-1!=b&&(a.O=new eW(c,b,a.oa()),a.O.render(),F(a,a.O),a.O.nf(a.eb)))}q.nf=function(a){this.eb=a;mq(this.Da,"waffle-assistant-readonly",a);this.qa.nf(a);this.O&&!this.O.isDisposed()&&this.O.nf(a)};
q.setVisible=function(a){var b=this.Va();fW.$.setVisible.call(this,a);if(a&&!b){var c=Mkc(this.ea,a);c?(b=new Vgc,P(b,1,Ih(c,"r")),P(b,2,Ih(c,"c")),c=c.ai(),P(b,3,c),c=new Wgc,zj(c,4,b),b=wua(this.Z),b.Hia=c,b=b.Ha()):b=this.Z;this.Fa=xJ(this.Oa,Fj.Cwa,!1,b);this.R.setActive(!0);gW(this)}a||this.j4(!0)};q.gna=function(){this.Va()&&(this.j4(!0),this.R.setActive(!0),gW(this))};q.fna=function(){this.Va()&&(this.R.setActive(!1),gW(this))};
q.Gma=function(a){this.Va()&&(this.L.Tb(2775,this.Z),this.j4(void 0,a.C,a.D),this.Hoa()||this.R.setActive(!0),gW(this),this.Qa=!1)};q.Fma=function(a){if(this.Va()){this.L.Tb(2776,this.Z);var b=a.D;0<b.length&&(this.Aa=xJ(this.Oa,Fj.Awa));this.j4(!1);this.R.setActive(!1);this.BWa(b,a.C);a=a.F;b=this.$O();0<b.length&&this.bb&&(b[b.length-1].Gb=!0);this.bb=!1;gW(this);this.DWa(a);this.Oda()}};
function gW(a){var b=a.Hoa(),c=Lq(a.$a("waffle-assistant-quicksum-panel")),d=a.R.Wb(),b=b||c||d;a=a.$a(a.RGa());R(a,!b)}q.IHa=Uf;function Ukc(a){return a.$a("waffle-assistant-scroll-pane").scrollTop+Hq(a.$a("waffle-assistant-sidepane-content")).height}q.Oc=pa;q.sra=pa;q.Pd=g("eb");q.sna=function(){this.L.Tb(2226,this.Z)};q.QHb=function(){""!=this.Aa&&(yJ(this.Oa,this.Aa),this.Aa="");""!=this.Fa&&(yJ(this.Oa,this.Fa),this.Fa="");this.Qa||(this.L.Tb(2777,this.Z),this.Qa=!0)};function Vkc(a){a=a||{};return V(U(MT(Ds({title:Fs(""+Wkc()),Ek:Fs('<div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content">'+V('<div class="waffle-assistant-empty-list-old" style="display: none"><img src="//ssl.gstatic.com/docs/spreadsheets/bulbman.svg" /><div aria-live="polite"><div class="waffle-assistant-empty-list-title-old">Nothing interesting here right now</div><div class="waffle-assistant-empty-list-body-old">Try selecting different data. Information with numbers works best.</div></div><a href="https://support.google.com/docs/?p=explore_sheets" target="_blank">Learn more</a><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try an example</a></div>')+
'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="display: none"></div><div class="waffle-assistant-card-holder"></div></div></div>'),id:Es("autovis"),mW:Es("waffle-assistant-sidepanel"),D3:Es("waffle-assistant-title"),xR:Es("waffle-assistant-sidepane-content")},a))))}
function Xkc(a){a=a||{};var b=V,c=Fs('<div class="waffle-assistant-replaceable-title">'+Wkc()+"</div>"),d,e;e=a||{};d=V;e=e||{};var f;f=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content" aria-live="polite">'+U(shc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div class="waffle-assistant-empty-list-title">Get insights instantly</div><div class="waffle-assistant-empty-list-body">');f=e.pRb?f+"To see answers, formatting, and charts in a single click, try adding more data or selecting different cells in your spreadsheet.":
f+"To see formatting and charts in a single click, try adding more data or selecting different cells in your spreadsheet.";e=V(f+'</div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try it out</a></div></div></div>');d=d('<div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content"><div class="waffle-assistant-scroll-pane-feature-content">'+
e+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="display: none"></div><div class="waffle-assistant-features"></div></div><div class="waffle-assistant-expanded-panel" style="display: none"></div></div></div>');return b(U(MT(Ds({title:c,Ek:Fs(""+d),id:Es("autovis"),mW:Es("waffle-assistant-sidepanel"),D3:Es("waffle-assistant-title"),xR:Es("waffle-assistant-sidepane-content")},a))))}
function Wkc(){return V('<div class="waffle-assistant-title-bar"><div class="waffle-assistant-title-icon">'+U(shc({color:"#ffffff",iconSize:"21"}))+'</div><div class="waffle-assistant-title-text">'+U("Explore")+"</div></div>")};function hW(a,b,c,d,e,f,h){fW.call(this,a,b,c,d,e,h);this.Ub=f;this.Ua=b;this.ma=new T(this.oa());this.Na(this.ma);this.J=new xkc;F(this,this.J);this.D=[];this.F=null;this.Ia=new Mt("",h,4);Tr(this.Ia,2);this.Na(this.Ia)}y(hW,fW);
var iW={lB:"waffle-assistant-scroll-pane-feature-content",qZa:"waffle-assistant-empty-list",HZa:"waffle-assistant-features",G_a:"waffle-assistant-empty-list-learn-more",gfa:"waffle-assistant-expanded-panel",oya:"waffle-assistant-replaceable-title",oqc:"waffle-assistant-scroll-pane",gK:"waffle-assistant-title"},Ykc={defaultHelpArticleId:"6280499"};q=hW.prototype;q.CWa=function(){return Xkc};q.RGa=n("waffle-assistant-empty-list");
q.Ja=function(){hW.$.Ja.call(this);this.ma.Xa(this.$a(iW.gfa));uV(this.C.Da,"Close");var a=this.Ua.L.Er();Jm&&(Sm||"en"==iE(a))&&(a=new YV(this.Ub,this.Ka,this.ib,this.hc,this.L,this.J,this.Ua,this.oa()),this.Na(a),this.D.push(a));if(Aoa||Boa)a=new wkc(this.L,this.J,this.oa()),this.Na(a),this.D.push(a);a=new GV(this.ib,this.Ka,this.L,this.J,this.oa());this.Na(a);this.D.push(a);var b=this.$a(iW.HZa);z(this.D,function(a){a.render(b);this.ma.Na(a.D,!0)},this);this.Ia.Xa(this.$a(iW.G_a));this.getHandler().V(this.Ia,
"action",this.gZb);Zkc(this)};q.gZb=function(){Q.Fo.Hb(Ykc)};q.BWa=function(a,b){for(var c=0;c<this.D.length;c++){for(var d=[],e=0;e<a.length;e++){var f=Gc(a[e],1);this.D[c].iha(f)&&d.push(a[e])}0<d.length?this.D[c].Eua(d,b):this.D[c].NW(!0)}};q.DWa=function(){z(this.D,function(a){Ahc(a)})};q.j4=function(a,b,c){z(this.D,function(d){d.NW(a,b,c)})};q.Hoa=function(){return!!Cb(this.D,function(a){return a.Ena()})};
q.Oda=function(){var a=Ukc(this);z(this.D,function(b){this.F&&this.F!=b||(b instanceof GV&&this.getHandler().Hc(b,"assistant-done-rendering",this.QHb),a=b.Gua(a))},this)};q.$O=function(){if(this.F)return this.F.D.C;var a=[];z(this.D,function(b){Qb(a,zhc(b))});return a};q.nf=function(a){hW.$.nf.call(this,a);Zkc(this)};q.Wh=function(a){z(this.D,function(b){b.Wh(a)})};q.sra=function(){var a=this.$a(iW.oya),b=this.$a(iW.gK);Gq(b,Hq(a).height)};
q.Oc=function(){this.oa();var a=this.$a(iW.lB),b=this.$a(iW.oya);this.$a(iW.gK);var c=this.ma.Da;if(this.F)this.F.D.setVisible(!1),this.F.setActive(!1),this.F=null,R(a,!0),R(c,!1),ks(b,Wkc),dq(b,"label"),this.resize();else if(this.F=Cb(this.D,function(a){return a.Wb()}))R(a,!1),R(c,!0),this.F.D.setVisible(!0),Bhc(this.F,b),fq(b,this.F.getTitle());this.sra();ml(function(){var a=Zv;a&&a.dispatchEvent("resize");this.Oda()},300,this)};
q.setVisible=function(a){var b=this.Va();hW.$.setVisible.call(this,a);a&&!b&&$kc(this,!0);a||this.J.clear()};q.sna=function(){hW.$.sna.call(this);this.F&&this.Oc()};q.gna=function(){hW.$.gna.call(this);$kc(this,!0)};q.fna=function(){hW.$.fna.call(this);$kc(this,!1)};q.Gma=function(a){hW.$.Gma.call(this,a);$kc(this,!0,a.C)};q.Fma=function(a){hW.$.Fma.call(this,a);$kc(this,!1)};function Zkc(a){z(a.D,function(a){a.nf(this.Pd())},a)}q.IHa=g("D");function $kc(a,b,c){z(a.D,function(a){c||whc(a.D,b)})};function alc(a){var b;a=a||{};return V('<div class="docs-explore-promo-base docs-ui-unprintable '+W(a.hg)+'"><div class="docs-explore-promo-content">'+(a.aH?'<div class="docs-explore-promo-header">'+U(null==(b=a.aH)?"":b)+"</div>":"")+'<div class="docs-explore-promo-description">'+U(null==(b=a.QZ)?"":b)+'<div class="docs-explore-promo-buttons">'+(a.ZK?U(Kt({Ke:"docs-explore-promo-button docs-explore-promo-continue-button",content:Fs(""+U(a.ZK)),style:4})):"")+(a.iL?U(Kt({Ke:"docs-explore-promo-button docs-explore-promo-close-button",
content:Fs(""+U(a.iL)),style:4})):"")+"</div></div></div>"+(a.tNa?V('<div class="docs-explore-promo-icon-wrapper"><div class="docs-explore-promo-icon">'+U(shc({color:a.tNa,iconSize:"32"}))+"</div></div>"):"")+"</div>")};function blc(a,b){T.call(this,b);this.F=new Mt("",b);this.Na(this.F);this.C=new Mt("",b);this.Na(this.C);this.D=new Mt("",b);Tr(this.D,2);this.Na(this.D);this.J=a;Ysa([Q.yea,Q.zea,Q.zwa],!0)}y(blc,T);q=blc.prototype;q.va=function(){this.Da=ms(alc,this.J)};
q.Ja=function(){blc.$.Ja.call(this);var a=this.gb("docs-explore-promo-continue-button");a&&this.F.Xa(a);(a=this.gb("docs-explore-promo-close-button"))&&this.C.Xa(a);(a=this.gb("docs-explore-promo-icon"))&&this.D.Xa(a);this.getHandler().V(this.F,"action",this.eKa).V(this.C,"action",this.f8a).V(this.D,"action",this.gsb)};q.show=function(a){Q.zwa.Hb();this.render(a)};q.eKa=function(a){Q.yea.Hb();a.stopPropagation()};q.f8a=function(a){Q.zea.Hb();a.stopPropagation()};q.gsb=function(a){this.eKa(a)};function clc(a){return V('<div class="waffle-assistant-walkthrough-promo-content"><h1 class="waffle-assistant-walkthrough-promo-header">'+U(a.aH)+'</h1><p class="waffle-assistant-walkthrough-promo-description">'+U(a.QZ)+"</p>"+(a.ZK?U(Kt({Ke:"waffle-assistant-walkthrough-promo-button waffle-assistant-walkthrough-promo-continue-button",content:Fs(""+U(a.ZK)),style:4})):"")+(a.iL?U(Kt({Ke:"waffle-assistant-walkthrough-promo-button waffle-assistant-walkthrough-promo-close-button",content:Fs(""+U(a.iL)),
style:4})):"")+"</div>")};function jW(a,b,c){wG.call(this,a,c);this.O=new Mt("",c);this.C=new Mt("",c);a=ms(clc,b);this.setContent(a);this.Sg("docs-promo-bubble");this.setPosition(0,0);uu(this);mr(this.D,!1);this.ov=!1}y(jW,wG);jW.prototype.Ja=function(){jW.$.Ja.call(this);var a=this.gb("waffle-assistant-walkthrough-promo-continue-button");a&&this.O.Xa(a);(a=this.gb("waffle-assistant-walkthrough-promo-close-button"))&&this.C.Xa(a);this.getHandler().V(this.O,"action",this.J).V(this.C,"action",this.R)};
jW.prototype.J=function(a){this.dispatchEvent("promo-continue");a.stopPropagation()};jW.prototype.R=function(a){this.dispatchEvent("promo-dismiss");a.stopPropagation()};function dlc(a){var b=un("waffle-assistant-chart-preview",void 0);jW.call(this,b,{aH:"See the big picture",QZ:"Data visualizations and text summaries make it easier to spot trends and outliers",ZK:"Learn more",iL:"Got it"},a)}y(dlc,jW);var elc={defaultHelpArticleId:"6280499"};dlc.prototype.J=function(a){Q.Fo.Hb(elc);dlc.$.J.call(this,a)};function flc(a,b){var c=un("waffle-assistant-answers-input",void 0),d;d=new $v;a="Interested in the "+(d.kf("b")+(a+(d.mf("b")+"? Ask a question about your data to learn more, no formulas needed.")));d={aH:"Find answers in a snap",QZ:d.format(a),ZK:"Next",iL:"Dismiss"};jW.call(this,c,d,b)}y(flc,jW);function glc(a,b){a={hg:"waffle-assistant-entry-promo",aH:"Get insights instantly",QZ:Jm&&"en"==iE(a)?"Find answers to questions about your data, apply formatting, and create charts in a single click using Sheets Explore":"Apply formatting and create charts over your data in a single click using Sheets Explore",ZK:"Check it out",iL:"Dismiss",tNa:"#0F9D58"};blc.call(this,a,b)}y(glc,blc);function hlc(a){var b=un("waffle-assistant-banding-color-picker-container",void 0);jW.call(this,b,{aH:"Make it pop",QZ:"Quickly apply alternating row color formatting to add style, polish, and visual appeal",ZK:"Next",iL:"Dismiss"},a)}y(hlc,jW);function ilc(a,b,c,d,e,f,h,k,l){IT.call(this,b,h);this.Ia=a;this.C=b;this.ea=c;this.Fa=d;this.ib=e;this.ma=f;this.Ka=k;this.Z=c.C;this.Oa=this.qa=!1;this.J=l;this.D=null;this.Ae=new cj;this.R=null;a=rw(this.ib);this.Af().V(this.Fa,"selectionChange",this.jZb).V(this.Z,"Sa",this.iZb).V(a,"kb",this.Yub).V(this.C,"assistant-sidepane-apply-conditional-format-rules",this.skb).V(this.C,"assistant-sidepane-apply-banding",this.rkb).V(this.C,"assistant-sidepane-remove-banding",this.czb).V(this.C,"assistant-sidepane-change-selection",
this.Jlb).V(this.C,"assistant-sidepane-insert-chart",this.Ssb).V(this.C,"assistant-sidepane-thumbs",this.WBb).V(this.C,"assistant-sidepane-set-active-panel",this.OAb).V(this.C,"assistant-sidepane-back-button-clicked",this.Qkb).V(this.C,"assistant-undo-pressed",this.kZb).V(this.Ia,"cu",this.anb);Wo(this.O,X.gJ,$o,this.Vsb).subscribe(X.hE,"action",this.Nkb).subscribe(X.w4,"action",this.JBb).subscribe(X.cea,"action",this.BBb);X.v4.Ra(!0);a=new Xgc;P(a,6,jlc());b=new ip;zj(b,58,a);this.L=Mp(Np(new Lp,
b),10).Ha();this.Qa=wJ.getInstance();this.Aa=xJ(this.Qa,Fj.ywa);ml(Ga(this.qZ,!1),100,this)}y(ilc,IT);q=ilc.prototype;q.wi=function(){return X.eea};q.cw=function(){return X.mva};q.Gt=function(a){ilc.$.Gt.call(this,a);X.w4.Ra(a);this.qZ(!1);!this.qa&&a&&(this.qa=!0,Goa&&CE(this.Ka,"ritz-DisplayExploreV2Promo",!1))};q.T0=function(a){this.C.sra();ml(function(){ilc.$.T0.call(this,a)},300,this)};q.Wh=function(a){this.C.Wh(a);this.Ia.Wh(a)};
q.Nkb=function(){var a=this.C.Va();this.wi().setVisible(!a);a?this.J.Tb(2226,this.L):(this.C.focus(),this.J.Tb(2253,this.L))};q.BBb=function(){this.C.Va()||this.Gt(!0)};q.JBb=function(a){Tkc(this.C,a)};q.jZb=function(){this.qZ(!0)};q.qZ=function(a,b){if(b){if(!b.length)return;if(1==b.length&&this.R&&b[0].equals(this.R)){this.R=null;return}}var c=this.C;c.Va()&&(zkc(c.qa),gW(c));this.Ia.update(!a,this.C.Va(),b)};
q.anb=function(a){""!=this.Aa&&(yJ(this.Qa,this.Aa),this.Aa="");var b=a.D||0;a=a.C;var c=!!a&&a.rect,d=(c=!!c&&c.ai()>=Loa&&Ih(c,"r")>=Noa&&Ih(c,"c")>=Ooa&&c.ai()<=Moa)&&.6<=b;d!==this.Oa&&(this.Oa=d,X.v4.Hb(d),!d&&this.D&&(H(this.D),this.D=null));if(c){if(a&&a.rect){var d=.9<=b,e=1E3>=a.rect.ai(),c=ritz_api.RitzModelApi.isFormsRegion(""+a.zd,a.rect.top,a.rect.left,a.rect.height+a.rect.top,a.rect.width+a.rect.left),d=woa&&!this.C.Va()&&!this.qa&&d&&e&&!YHa(this.ea),c=xoa&&c,e=yoa&&this.ea.Pd();d&&
(c||e)?(d=new Xgc,P(d,1,b),P(d,2,c),P(d,3,e),P(d,5,Tm),P(d,6,jlc()),c=new ip,zj(c,58,d),c=Np(Mp(new Lp,10),c).Ha(),this.WAa(c),c=!0):c=!1}else c=!1;if(c=!c)if(c=Goa){if(b=.6<=b&&!this.C.Va()&&!this.qa&&!this.D&&this.Ka.C["ritz-DisplayExploreV2Promo"].La()&&a)b=a.rect,b=ritz_api.RitzModelApi.hasBandingSuggestions(a.zd+"",b.rc(),b.Zc(),b.mc(),b.jd());c=b}c&&(a=this.ea.L.Er(),this.D=new glc(a),F(this,this.D),this.D.show(),this.O.subscribe(Q.yea,"action",this.Qpb).subscribe(Q.zea,"action",this.nna),CE(this.Ka,
"ritz-DisplayExploreV2Promo",!1),this.J.Tb(2788,this.L))}};q.WAa=function(a){this.C.bb=!0;var b=ETa(tw(this.Z));NQb.C||b||(a=a||this.L,this.wi().setVisible(!0),this.J.Tb(2225,a),this.J.Tb(2253,this.L),ml(Ga(this.X4a,a),5E3,this))};q.X4a=function(a){this.C.Va()||this.J.Tb(2752,a)};function jlc(){switch(Poa){case "NO_DELAY":return 1;case "DELAY_500MS":return 2;case "DELAY_1S":return 3;case "DELAY_2S":return 4;default:return 0}}q.nna=function(){H(this.D);this.D=null};
q.Qpb=function(){H(this.D);this.wi().setVisible(!0);this.C.focus();this.Af().Hc(this.C,"assistant-done-rendering",v(function(){var a;a:{this.C.Va();a=this.ea.L.Er();a=Jm&&(Sm||"en"==iE(a));for(var b=!1,c=!1,d=!1,e=this.C.$O(),f=0;f<e.length;f++)if(e[f]instanceof KV?b=!0:e[f]instanceof ZV?c=!0:e[f]instanceof DV&&(d=!0),c&&d&&(b||!a)){a=!0;break a}a=!1}a?this.ILa():this.nna()},this));this.J.Tb(2253,this.L)};
q.ILa=function(){this.C.Va();H(this.D);var a=null;this.D instanceof glc?(a=this.ea.L.Er(),Jm&&(Sm||"en"==iE(a))?(a=this.C.IHa(),a=Yjc(Cb(a,function(a){return a instanceof YV}).L).toLowerCase(),a=new flc(a)):a=new hlc):this.D instanceof flc?a=new hlc:this.D instanceof hlc&&(a=new dlc);if(this.D=a)F(this,this.D),this.D.render(),this.Af().Hc(this.D,"promo-dismiss",this.nna).Hc(this.D,"promo-continue",this.ILa)};q.Qkb=function(){this.C.Oc()};
q.kZb=function(a){var b=a.C,c=B(b.D,4,0),d=parseInt(c.mb(),10);this.R=Rh(c);this.ma.C(new GRb(d));tkc(b,c);this.J.Tb(a.qk(),this.L)};q.iZb=function(){sw(this.Z)?(this.C.Ra(!0),this.qZ(!1)):(this.wi().setVisible(!1),this.C.Ra(!1))};q.Vsb=function(){this.C.nf(!X.gJ.isEnabled())};q.Yub=function(a){this.qZ(!1,a.C?a.C:a.rect?[a.rect]:[])};
q.skb=function(a){var b=tw(this.Z),c=""+b.Fc(),d=[],e=kcc(b);if(e){var b=new bf,f=Gc(e,2);D(b,3,f);f=Gc(e,2);D(b,2,f);e=Gc(e,1);D(b,1,e);d.push(b)}b=a.C.eb;for(e=0;e<b.length;e++)f=new bf,D(f,2,b[e]),d.push(f);this.ma.C(new WU(d,c));a=a.qk();this.J.Tb(a,this.L)};
q.rkb=function(a){var b=a.C,c=Ycc(b.C),d=B(b.D,4,0),e=c.pv?c.Rx:null,f=c.C?c.zx:null,h=parseInt(d.mb(),10),k=klc(d);this.R=Rh(d);k?this.ma.C(new HT(k,h,this.R,e,c.Qs,c.Dt,f)):this.ma.C(new FT(h,this.R,e,c.Qs,c.Dt,f));d=new zcc;P(d,1,1);c=new XS;b=B(b.D,2);P(c,2,b);zj(c,5,d);b=new ip;zj(b,46,c);b=Np(Mp(new Lp,10),b).Ha();a=a.qk();this.J.Tb(a,b)};q.czb=function(a){a=a.C;var b=B(a.D,4,0),c=parseInt(b.mb(),10),d=klc(b);this.R=Rh(b);this.ma.C(new GT(d,c));tkc(a,b)};
function klc(a){var b=a.mb();a=Rh(a);b=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(b,a.rc(),a.mc(),a.Zc(),a.jd(),7,!1);return 0<b.length?b[0]:null}q.Jlb=function(a){oC(tw(this.Z),a.D);a=a.qk();this.J.Tb(a,this.L)};
q.WBb=function(a){var b=a.C;a=a.qk();if(b instanceof IV||b instanceof KV)this.J.Tb(a,this.L);else{var c=this.C.$O(),d=new XS,e=B(b.D,2),c=c.indexOf(b);P(d,1,c);P(d,2,e);e=new ip;zj(e,46,d);if(b instanceof DV){(d=b.J)?(b=llc(this,b,d),b=zfc(b,d,d.Vf)):b=null;if(!b)return;zj(e,39,b)}else if(b instanceof FV){var f=b.D,c=new ehc;if(b instanceof FV)b=1;else throw Error("Unknown text analysis card type.");f=Fc(B(f,8),20).slice(0,10);P(c,2,f||[]);P(c,1,b);zj(d,3,c)}b=Np(Mp(new Lp,10),e).Ha();this.J.Tb(a,
b)}};q.OAb=function(){this.C.Oc()};
q.Ssb=function(a){var b=a.F;if(b){var c=tw(this.Z),d=a.hf();d||(d=AC(this.Fa).Gd().C.hf());var e=16,f=16,h=a.Qa;h&&(e=h.x,f=h.y);h=pbc(this.ea.J);c={oid:null,ar:vC(c,d.y),ac:wC(c,d.x),x:e,y:f,h:Jz.height,w:Jz.width,p:{context:{chartName:"Chart "+(h+1)}}};d=new ZD(nw(this.Z)||0,c,!1,!1);c=b.Vf;e=new Ul(c);f=hm(e,"headers");f=null!=f&&za(f)&&Wa(f)?parseInt(f,10):-1;d.Fa=f;d.L=0;f="1"==hm(e,"transpose");d.ma=f;d.F=f?"ROWS":"COLS";f=hm(e,"range");f=pcc(lT(f,","),this.Z);d.iI(f);US(d,b);(e=hm(e,"dt"))&&
dXa(d,this.Ae.yd(of.Ea(),JSON.parse(decodeURIComponent(e))));this.Fa.dispatchEvent(new KE("objectRequest"));this.ma.C(new jG(this.ea,d));d=mlc(this,b,a.ea,a.He());yfc(this.J,a.qk(),d,10,b,c)}};function llc(a,b,c){var d=a.C.$O().filter(function(a){return a instanceof DV});return mlc(a,c,d.indexOf(b),b.J&&b.J.He())}
function mlc(a,b,c,d){var e=new bgc;a=a.C.$O().filter(function(a){return a instanceof DV}).map(function(a){return a.getChartType()});e.R=a;e.J=c;cgc(e,b.getChartType());e.D=d?d.clone():null;return e};function nlc(a,b){BV.call(this,a,b)}y(nlc,BV);q=nlc.prototype;q.bE=function(a){a()};q.ZD=pa;q.mC=n("assistantPivotTableFeedback");q.kG=n(2632);q.jG=n(2631);function olc(a,b,c,d,e,f,h){fW.call(this,a,b,c,d,e,h);this.J=new T(this.oa());this.Na(this.J);this.F=null;this.Ia=new K;F(this,this.Ia);this.D=[];this.Ua=null;this.ma=!0}y(olc,fW);var plc={UXa:"waffle-assistant-card-holder",lB:"waffle-assistant-sidepane-content",jZa:"waffle-assistant-dragger-card",iZa:"waffle-assistant-dragged-card",qZa:"waffle-assistant-empty-list-old",bAa:"waffle-assistant-visible"};q=olc.prototype;q.CWa=function(){return Vkc};q.RGa=n("waffle-assistant-empty-list-old");
q.Ja=function(){olc.$.Ja.call(this);var a=this.$a(plc.UXa);this.J.Xa(a)};q.setVisible=function(a){var b=this.Va();olc.$.setVisible.call(this,a);a&&!b&&(this.ma=!0)};
q.BWa=function(a){for(var b=0;b<a.length;b++){var c=a[b],d=B(c,1),e=null;switch(d){case 0:"WordCloud"==B(c,8).getChartType()?e=new FV(c,this.oa()):e=new DV(c,this.ib,this.Ka,this.L,null,this.oa());break;case 1:e=new nlc(c,this.oa());break;case 2:e=new $V(c,this.oa());break;case 4:e=new ZV(c,this.L,this.oa());break;default:throw Error("Unsupported recommendation type: "+d);}c=this.J.Dd();e.Z=c;this.J.Na(e,!0);if(X.gJ.isEnabled()){if(!this.F||this.F.isDisposed())this.F=new qlc,Nfc(this.F,this.J.Da),
this.F.Z=10,this.F.R=Ya(plc.jZa).split(" "),this.F.Aa=!0,this.F.Yra(plc.bAa),this.F.L=!1,this.F.jf(),this.Ia.V(this.F,"beforedragstart",v(this.lZb,this)).V(this.F,"dragstart",v(this.ym,this)).V(this.F,"beforedragend",v(this.$kb,this));var c=this.F,d=this.J.Da,f=e.Da;t(void 0)?Gpa(d,f,void 0):d.appendChild(f);Ofc(c,f)}0!=this.D.length&&e.getHandler().V(this.D[this.D.length-1],"content-rendered",e.rF);this.D.push(e)}};q.DWa=function(a){0<this.D.length&&this.D[0].rF();if(a||this.ma)this.ma=!1,rlc(this)};
function rlc(a){if(0!=a.D.length){for(var b=0,c=0;c<a.D.length;c++){var d=a.D[c].Da;vq(d,0,1E3);b+=Hq(d).height}b=Math.max(Hq(a.$a("waffle-assistant-sidepane-content")).height,b);Gq(a.J.Da,b);for(c=0;c<a.D.length;c++)ml(Ga(a.x3a,a.D[c]),100*c,a);ml(function(){Gq(this.J.Da,"auto")},100*a.D.length,a)}}q.x3a=function(a){!a.isDisposed()&&this.isEnabled()&&(new oT(a.Da,[0,1E3],[0,0],100)).play()};
q.j4=function(){this.Ia.Sc();H(this.F);for(var a=0;a<this.D.length;a++){var b=this.D[a];b.Gc()&&this.J.removeChild(b,!0);H(b)}this.D=[]};q.Hoa=function(){return 0<this.D.length};q.Oda=function(){for(var a=Ukc(this),b=0,c=0;c<this.D.length;c++)b<a?(wV(this.D[c],!0),b+=Hq(this.D[c].Da).height):wV(this.D[c],!1)};q.lZb=function(a){var b=vb(this.J.Da.childNodes,a.C),b=this.J.Ed(b);b.$Na()?this.Ua=b:a.preventDefault()};q.ym=function(a){iq(a.D,plc.iZa)};
q.$kb=function(a){var b=wq(a.D),c=AC(this.Ka).ye();if(uh(UF(c,"page",!1,!1)).contains(b)){var d=SF(c,b.x,b.y,"page"),c=WF(c,zh(d),"page");this.Ua.p$(d,new L(b.x-c.left,b.y-c.top))}a.F.Ox(null,!0);a.preventDefault();this.Ua=null};q.$O=g("D");function qlc(){XU.call(this)}y(qlc,XU);qlc.prototype.rla=function(a){a=qlc.$.rla.call(this,a);var b=yb(a.querySelectorAll("clippath"),function(a){return a.id});slc(a,b);return a};
function slc(a,b){for(var c=a.getAttribute&&a.getAttribute("clip-path"),d=0;d<b.length;d++){var e=b[d];za(c)&&eb(c,e)&&a.setAttribute("clip-path",c.replace(e,e+"-clone"));e==a.id&&(a.id=e+"-clone")}a=Kn(a);for(d=0;d<a.length;d++)slc(a[d],b)};function tlc(){E.call(this)}y(tlc,oo);tlc.prototype.C=function(){return Hkc};tlc.prototype.F=function(){return Aoa||Boa||Jm?hW:olc};tlc.prototype.D=function(){return ilc};wo("assistant",tlc);
