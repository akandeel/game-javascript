YT.prototype.Lra=ga(210,function(a){this.O=Pb(arguments,0)});ff.prototype.nG=ga(31,function(){return zc(this,3)});function ofc(a,b,c,d,e){return Onb(a,y(function(){return this.C.calculateArrayFormulaResultPreview(b,c,d,e,!1,this.L,!0)},a))}function nV(a){jj(this,a,0,-1,null)}z(nV,ij);function oV(a){jj(this,a,0,-1,null)}z(oV,ij);
function pfc(a,b){var c=b.width;b=b.height;for(var d=a.width<=c?1:Math.floor(a.width/c),e=a.height<=b?1:Math.floor(a.height/b),f=[],h=0;h<d;h++)for(var k=a.left+h*c,l=0;l<e;l++){var m=a.top+l*b;f.push(new rh(m,k,m+b,k+c))}return f}var qfc=["BarChart","ColumnChart"],rfc=[1],sfc=[1],tfc=[1],ufc=[1],vfc=[2];function wfc(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c}function xfc(a){return mc(zec,function(b){return b.match(a)}).getName()}function yfc(a){jj(this,a,0,-1,null)}z(yfc,ij);
yfc.prototype.wg=function(){return O(this,2)};function zfc(a){jj(this,a,0,-1,null)}z(zfc,ij);function Afc(a){jj(this,a,0,-1,null)}z(Afc,ij);function Bfc(a){jj(this,a,0,-1,rfc)}z(Bfc,ij);function Cfc(a){jj(this,a,0,-1,sfc)}z(Cfc,ij);function Dfc(a){jj(this,a,0,-1,tfc)}z(Dfc,ij);function Efc(a){jj(this,a,0,-1,ufc)}z(Efc,ij);var Ffc={Isc:0,mza:1,Oza:2};function Gfc(a){jj(this,a,0,-1,vfc)}z(Gfc,ij);var Hfc={Aqc:0,bkc:1,r7b:2,b4b:3,rmc:4,B3b:5,H1b:6,Nvc:7};function pV(a,b,c,d,e,f){J.call(this,a,b);this.C=b;this.Oa=c;this.Ia=d||null;this.bb=e||null;this.F=f||null}z(pV,J);pV.prototype.qk=g("Oa");pV.prototype.hf=g("Ia");function Ifc(a,b,c,d,e,f){pV.call(this,"assistant-sidepane-insert-chart",null,d,e,f);this.Z=a;this.ea=b;this.vc=c}z(Ifc,pV);Ifc.prototype.Ge=g("vc");function Jfc(a){a=""+('<div class="waffle-assistant-feature-section"><div class="waffle-assistant-section-header"><div class="waffle-assistant-section-title">'+U(a.title)+"</div>"+U(It({Je:"waffle-assistant-section-more-button",content:ns("More"),style:4}))+'</div><div class="waffle-assistant-section-content"></div><div class="waffle-assistant-section-card-holder"></div></div>');return V(a)};function qV(a,b,c){a&&(t(b)||(b=a.hasAttribute("title")?a.getAttribute("title"):""),b=Va(b),Ht(a,b,void 0),mbc(a),a.setAttribute("data-tooltip-delay",500),nbc(a,t(c)?c:1))};function Kfc(a){return V('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0" y="0" height="'+W(a.iconSize)+'px" width="'+W(a.iconSize)+'px" viewBox="0 0 24 24" preserveAspectRatio="none"><path fill="'+W(a.color)+'" d="M19,2 L5,2 C3.9,2 3,2.9 3,4 L3,18 C3,19.1 3.9,20 5,20 L9,20 L12,23 L15,20 L19,20 C20.1,20 21,19.1 21,18 L21,4 C21,2.9 20.1,2 19,2 L19,2 Z M13.88,12.88 L12,17 L10.12,12.88 L6,11 L10.12,9.12 L12,5 L13.88,9.12 L18,11 L13.88,12.88 L13.88,12.88 Z"/></svg>')}
;function Lfc(){var a=V,b;b=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content">'+U(Kfc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div aria-live="polite"><div class="waffle-assistant-empty-list-title">Nothing interesting here right now</div><div class="waffle-assistant-empty-list-body">Try selecting different data. Information with numbers works best.</div></div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try an example</a></div></div></div>');
b=V(b);return a('<div class="waffle-assistant-scroll-pane" style="display: none;"><div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-panel-pane">'+b+'<div class="waffle-assistant-panel-content-container"><div class="waffle-assistant-panel-card-holder"></div></div></div></div>')}
function Mfc(a){return V('<div class="waffle-assistant-panel-title-bar">'+U(It({Je:"waffle-assistant-panel-back-button",content:ns(""+U(Wu({icon:"docs-icon-img-container docs-explore-img docs-explore-back-white"}))),style:4}))+'<div class="waffle-assistant-title-text" role="heading">'+U(a.title)+"</div></div>")};function rV(a){T.call(this,a);this.jd=new eV(!1,"#4285f4");this.Ma(this.jd);this.R=new T(this.oa());this.Ma(this.R);this.C=[];this.Jf=this.vf=!1;this.Md=this.Gd=this.Qa=this.ma=null;this.Gb=new Jt("",a,4);Ar(this.Gb,2);this.Ma(this.Gb)}z(rV,T);var Nfc={defaultHelpArticleId:"6280499"};q=rV.prototype;q.va=function(){rV.$.va.call(this);this.Da=Xr(Lfc);this.Gd=this.$a("waffle-assistant-panel-content-container");this.Md=this.$a("waffle-assistant-empty-list")};
q.Ja=function(){rV.$.Ja.call(this);var a=this.$a("waffle-assistant-spinner-container");this.jd.render(a);this.R.Ya(this.$a("waffle-assistant-panel-card-holder"));this.Gb.Ya(this.$a("waffle-assistant-empty-list-learn-more"));this.getHandler().V(this.Gb,"action",this.GYb).V(this.Da,"scroll",xbc(this.mWa,10,this))};q.setVisible=function(a){S(this.Da,a);A(this.C,function(a){if(!a.Jc()){var b=this.R.Dd();a.Z=b;this.R.Ma(a,!0);a.CB()}},this);this.vf=a};
q.Uqa=function(a,b){var c=this.oa();this.ma&&this.T6();this.ma=new T;this.Ma(this.ma);a=Vr(a,Mfc,{title:b});this.Qa=new Jt("",this.oa());this.ma.Ma(this.Qa);this.Qa.Ya(c.$a("waffle-assistant-panel-back-button",a));qV(this.Qa.Da,"Back");this.ma.getHandler().V(this.Qa,"action",this.tkb)};q.T6=function(){this.ma.dispose();this.ma=null};function Ofc(a,b){a.jd.setActive(b);S(a.$a("waffle-assistant-panel-pane"),!b)}q.VH=function(a){S(this.Md,a);S(this.Gd,!a)};
function Pfc(a,b){Jb(a.C,b);a.R.removeChild(b);a.R.Mi(b,0);a.C.push(b)}q.FN=function(a){Jb(this.C,a);-1!=Pq(this.R,a)&&this.R.removeChild(a,!0)};q.k6=function(){this.R.Vd(!0);Ic(this.C);this.C=[]};q.mWa=function(){for(var a=this.Da,a=a.scrollTop+qq(a).height,b=0,c=0;c<this.C.length;c++){var d=this.C[c];b<a?(sV(d,!0),b+=qq(d.Da).height):sV(d,!1)}};q.mf=function(a){this.Jf=a;A(this.C,function(b){b.mf(a)})};q.Pd=g("Jf");q.GYb=function(){Q.Eo.Nb(Nfc)};q.tkb=function(){this.dispatchEvent("assistant-sidepane-back-button-clicked")};function tV(a,b,c,d){T.call(this,d);this.R=a;this.Oa=b;this.Z=new Jt("",this.oa());this.Ma(this.Z);this.J=new T(this.oa());this.Ma(this.J);this.D=null;this.Ka=[];this.Ia=this.Fa=!1;this.O=c}z(tV,T);q=tV.prototype;q.vMa=Nf;q.jsa=Of;q.va=function(){tV.$.va.call(this);this.Da=Xr(Jfc,{title:this.getTitle()})};
q.Ja=function(){tV.$.Ja.call(this);this.J.Ya(this.$a("waffle-assistant-section-card-holder"));this.Z.Ya(this.$a("waffle-assistant-section-more-button"));this.getHandler().V(this.Z,"action",this.Sub);this.D=this.nCa();H(this,this.D);S(Qfc(this),this.vMa());this.setVisible(!1)};q.setVisible=function(a){if(this.Jc()&&this.Va()!=a&&(S(this.Da,a),a)){S(this.Z.Da,this.JTa());a=new Afc;P(a,4,this.rua());var b=new Ko;pj(b,58,a);a=pp(op(new np,10),b).Ha();this.O.Tb(2774,a)}};
q.Va=function(){return this.Jc()&&uq(this.Da)};q.JTa=function(){return this.Ka.length>this.R};q.nCa=function(){return new rV(this.oa())};q.mf=function(a){this.Ia=a;A(Rfc(this),function(b){b.mf(a)});this.D.mf(a)};q.Pd=g("Ia");q.Wh=v;
q.qua=function(a){this.Ka=a;for(var b=0;b<a.length;b++){Fc(a[b],1);if(this.J.Dd()<this.R){var c=this.B6(a[b]);c.mf(this.Ia);var d=this.J.Dd();c.Z=d;this.J.Ma(c,!0)}if(this.jsa()&&(this.D.VH(!1),c=this.D,d=this.B6(a[b]),c.C.push(d),c.vf)){Ofc(c,!1);var e=c.R.Dd();d.Z=e;c.R.Ma(d,!0);d.CB()}}};function Rfc(a){var b=[];a.J.Dg(function(a){b.push(a)});return b}function Qfc(a){return a.$a("waffle-assistant-section-content")}q.pna=function(){return this.J.v$()};
q.rW=function(){this.Ka=[];Ic(this.J.Vd(!0));this.setVisible(!1);this.jsa()&&(this.D.k6(),this.D.VH(!0))};function Sfc(a){a.J.Dg(function(a,c){c<this.R&&a.CB()},a)}q.sua=function(a){var b=0;if(this.Fa)this.D.mWa();else if(this.pna()){this.setVisible(!0);for(var b=qq(this.$a("waffle-assistant-section-header")).height+qq(Qfc(this)).height,c=Rfc(this),d=0;d<c.length;d++)b<a&&d<this.R?(this.BJa(c[d]),sV(c[d],!0),b+=qq(c[d].Da).height):sV(c[d],!1)}else this.setVisible(!1);return a-b};q.BJa=v;
q.setActive=function(a){(this.Fa=a)||this.D.T6()};q.Xb=g("Fa");function Tfc(a,b){a.D.Uqa(b,a.getTitle())}q.Sub=function(){this.setActive(!0);this.dispatchEvent("assistant-sidepane-set-active-panel")};var Ufc={UNKNOWN_ERROR:0,btc:1,ykc:2,l8b:3},Vfc={Tsc:0,A8b:1,Yda:2,jk:3,Nsc:4,J0b:5,N9b:6},Wfc={Rsc:0,WD:1,Ekc:2,kkc:3,Lmc:4},Xfc={Osc:0,Akc:1,MJ:2,Thc:3},Yfc={Gsc:0,ssc:1,pbc:2,xrc:3,wrc:4,u3b:5};var Zfc={zqc:0,DQ:1,ZXa:2,osc:3,kpc:4,w0a:5};function uV(){B.call(this)}z(uV,B);var $fc=null;uV.prototype.Sm=function(){return D(this,1)};function vV(){B.call(this)}z(vV,B);var agc=null;vV.prototype.getText=function(){return D(this,1)};vV.prototype.Mr=function(){return zc(this,1)};function wV(){B.call(this)}z(wV,B);var bgc=null;wV.prototype.getStatus=function(){return D(this,1)};wV.prototype.hasFormula=function(){return zc(this,2)};wV.prototype.getError=function(){return D(this,9)};
function xV(){B.call(this)}z(xV,B);var cgc=null;q=xV.prototype;q.B$=function(){return zc(this,1)};q.hasFormula=function(){return zc(this,2)};q.getType=function(){return D(this,3)};q.setType=function(a){E(this,3,a)};q.Hf=function(){return zc(this,3)};uV.prototype.Ea=function(){var a=$fc;a||($fc=a=Gc(uV,{0:{name:"Error",xb:"ritz.assistant.Error"},1:{name:"message",Ca:9,type:String},2:{name:"code",Ca:14,defaultValue:0,type:Ufc},3:{name:"unsupported_op_reason",Ca:14,defaultValue:0,type:Vfc}}));return a};
uV.Ea=uV.prototype.Ea;vV.prototype.Ea=function(){var a=agc;a||(agc=a=Gc(vV,{0:{name:"AnswerQueryPhrase",xb:"ritz.assistant.AnswerQueryPhrase"},1:{name:"text",Ca:9,type:String},2:{name:"start_byte",Ca:5,type:Number},3:{name:"num_bytes",Ca:5,type:Number}}));return a};vV.Ea=vV.prototype.Ea;
wV.prototype.Ea=function(){var a=bgc;a||(bgc=a=Gc(wV,{0:{name:"AnswerResponse",xb:"ritz.assistant.AnswerResponse"},1:{name:"status",Ca:5,type:Number},10:{name:"parse_status",Ca:14,defaultValue:0,type:Wfc},11:{name:"answer_status",Ca:14,defaultValue:0,type:Xfc},2:{name:"formula",Ca:9,type:String},3:{name:"debug_parse_response",Ca:9,type:String},4:{name:"interpretation",Ca:9,type:String},5:{name:"debug_interpretation_response",Ca:9,type:String},6:{name:"unused_phrase",od:!0,Ca:11,type:vV},7:{name:"used_entity_phrase",
od:!0,Ca:11,type:vV},8:{name:"unused_entity_phrase",od:!0,Ca:11,type:vV},9:{name:"error",Ca:11,type:uV},12:{name:"alternate_suggestion",od:!0,Ca:11,type:xV},13:{name:"answer_visualization_type",od:!0,Ca:14,defaultValue:0,type:Zfc},14:{name:"formula_builder_used",Ca:9,type:String}}));return a};wV.Ea=wV.prototype.Ea;
xV.prototype.Ea=function(){var a=cgc;a||(cgc=a=Gc(xV,{0:{name:"QuerySuggestion",xb:"ritz.assistant.QuerySuggestion"},1:{name:"query",Ca:9,type:String},2:{name:"formula",Ca:9,type:String},3:{name:"type",Ca:14,defaultValue:0,type:Yfc},4:{name:"formula_builder_used",Ca:9,type:String}}));return a};xV.Ea=xV.prototype.Ea;function yV(){B.call(this)}z(yV,B);var dgc=null;yV.prototype.getChartType=function(){return D(this,1)};function egc(a,b){E(a,1,b)}function fgc(a,b){E(a,3,b)}function ggc(a,b){E(a,6,b)}
yV.prototype.Ea=function(){var a=dgc;a||(dgc=a=Gc(yV,{0:{name:"AutovisRecommendationProto",xb:"ritz.assistant.AutovisRecommendationProto"},1:{name:"chart_type",Ca:9,type:String},2:{name:"chart_title",Ca:9,type:String},3:{name:"horizontal_axis_title",Ca:9,type:String},4:{name:"horizontal_axis_min",Ca:1,type:Number},5:{name:"horizontal_axis_max",Ca:1,type:Number},6:{name:"left_vertical_axis_title",Ca:9,type:String},7:{name:"left_vertical_axis_min",Ca:1,type:Number},8:{name:"left_vertical_axis_max",
Ca:1,type:Number},9:{name:"right_vertical_axis_title",Ca:9,type:String},10:{name:"right_vertical_axis_min",Ca:1,type:Number},11:{name:"right_vertical_axis_max",Ca:1,type:Number},12:{name:"columns_to_group_by",od:!0,Ca:5,type:Number},13:{name:"column_aggregation_types",od:!0,Ca:9,type:String},14:{name:"is_transposed",Ca:8,type:Boolean},15:{name:"use_first_column_as_domain",Ca:8,type:Boolean},16:{name:"first_data_row_index",Ca:5,type:Number},17:{name:"is_stacked",Ca:8,type:Boolean},19:{name:"text_analysis_words",
od:!0,Ca:9,type:String},20:{name:"text_analysis_word_counts",od:!0,Ca:5,type:Number},22:{name:"best_facet_column_from_range",Ca:5,type:Number},23:{name:"best_facet_labels",od:!0,Ca:9,type:String},24:{name:"needs_data_transformation",Ca:8,type:Boolean},25:{name:"data_transformation",Ca:11,type:jf},26:{name:"best_facet_column_label",Ca:9,type:String},27:{name:"best_facet_range",od:!0,Ca:11,type:Ud}}));return a};yV.Ea=yV.prototype.Ea;var hgc={jfa:0,eea:1,zW:2,T4:3};function zV(){B.call(this)}z(zV,B);var igc=null;q=zV.prototype;q.getName=function(){return D(this,1)};q.Bh=function(a){E(this,1,a)};function AV(a,b){return D(a,2,b)}q.getType=function(){return D(this,4)};q.setType=function(a){E(this,4,a)};q.Hf=function(){return zc(this,4)};q.getProperties=function(a){return D(this,9,a)};function BV(){B.call(this)}z(BV,B);var jgc=null;BV.prototype.getName=function(){return D(this,1)};BV.prototype.Bh=function(a){E(this,1,a)};
BV.prototype.getProperties=function(a){return D(this,3,a)};function CV(){B.call(this)}z(CV,B);var kgc=null;CV.prototype.Od=function(a){return D(this,2,a)};CV.prototype.Xp=function(){return zc(this,2)};
zV.prototype.Ea=function(){var a=igc;a||(igc=a=Gc(zV,{0:{name:"Dimension",xb:"ritz.assistant.Dimension"},1:{name:"name",Ca:9,type:String},2:{name:"filter",od:!0,Ca:9,type:String},3:{name:"non_unique_filter",od:!0,Ca:13,type:Number},4:{name:"type",Ca:14,defaultValue:0,type:hgc},5:{name:"year_only_dates",Ca:8,type:Boolean},6:{name:"density",Ca:1,type:Number},7:{name:"alt_name",od:!0,Ca:9,type:String},8:{name:"non_empty_cell_count",Ca:13,type:Number},9:{name:"properties",od:!0,Ca:14,defaultValue:0,type:Hfc}}));
return a};zV.Ea=zV.prototype.Ea;BV.prototype.Ea=function(){var a=jgc;a||(jgc=a=Gc(BV,{0:{name:"Metric",xb:"ritz.assistant.Metric"},1:{name:"name",Ca:9,type:String},2:{name:"alt_name",od:!0,Ca:9,type:String},3:{name:"properties",od:!0,Ca:14,defaultValue:0,type:Hfc}}));return a};BV.Ea=BV.prototype.Ea;
CV.prototype.Ea=function(){var a=kgc;a||(kgc=a=Gc(CV,{0:{name:"EntityListTable",xb:"ritz.assistant.EntityListTable"},1:{name:"metric",od:!0,Ca:11,type:BV},2:{name:"dimension",od:!0,Ca:11,type:zV},3:{name:"non_unique_dimension",od:!0,Ca:13,type:Number},4:{name:"is_flipped_table",Ca:8,type:Boolean}}));return a};CV.Ea=CV.prototype.Ea;var lgc={o1b:0,vJ:1,h3b:2,M0b:3,rXa:4};function DV(){B.call(this)}z(DV,B);var mgc=null;function EV(){B.call(this)}z(EV,B);var ngc=null;EV.prototype.getColor=function(a){return D(this,4,a)};function FV(){B.call(this)}z(FV,B);var ogc=null;q=FV.prototype;q.xV=function(){return D(this,2)};q.Eh=function(){return D(this,3)};q.EL=function(){return D(this,4,0)};q.getPivotTableDef=function(){return D(this,5)};q.Dga=function(){return Ec(this,7)};q.getAutovisRecommendation=function(){return D(this,8)};
function GV(){B.call(this)}z(GV,B);var pgc=null;DV.prototype.Ea=function(){var a=mgc;a||(mgc=a=Gc(DV,{0:{name:"AssistantResponseProto",xb:"ritz.assistant.AssistantResponseProto"},1:{name:"recommendation",od:!0,Ca:11,type:FV},2:{name:"selection_recommendation",od:!0,Ca:11,type:FV}}));return a};DV.Ea=DV.prototype.Ea;
EV.prototype.Ea=function(){var a=ngc;a||(ngc=a=Gc(EV,{0:{name:"AssistantRequestProto",xb:"ritz.assistant.AssistantRequestProto"},1:{name:"table_range",Ca:11,type:Ud},2:{name:"selected_row",od:!0,Ca:5,type:Number},3:{name:"selected_column",od:!0,Ca:5,type:Number},4:{name:"color",od:!0,Ca:11,type:sd},5:{name:"color_frequency",od:!0,Ca:5,type:Number}}));return a};EV.Ea=EV.prototype.Ea;
FV.prototype.Ea=function(){var a=ogc;a||(ogc=a=Gc(FV,{0:{name:"RecommendationProto",xb:"ritz.assistant.RecommendationProto"},1:{name:"recommendation_type",Ca:14,defaultValue:0,type:lgc},2:{name:"confidence",Ca:1,type:Number},3:{name:"description",Ca:9,type:String},4:{name:"grid_ranges",od:!0,Ca:11,type:Ud},5:{name:"pivot_table_def",Ca:11,type:Qe},6:{name:"conditional_format_rules",od:!0,Ca:11,type:Xe},7:{name:"banding_protos",od:!0,Ca:11,type:Hd},8:{name:"autovis_recommendation",Ca:11,type:yV},9:{name:"entity_list_table",
Ca:11,type:CV}}));return a};FV.Ea=FV.prototype.Ea;
GV.prototype.Ea=function(){var a=pgc;a||(pgc=a=Gc(GV,{0:{name:"AssistantFlagsProto",xb:"ritz.assistant.AssistantFlagsProto"},2:{name:"include_word_clouds",Ca:8,type:Boolean},3:{name:"include_conditional_formats",Ca:8,type:Boolean},4:{name:"include_forms_integration",Ca:8,type:Boolean},5:{name:"include_answers",Ca:8,type:Boolean},6:{name:"include_autovis_faceting",Ca:8,type:Boolean},7:{name:"include_banding",Ca:8,type:Boolean},9:{name:"include_autovis_sum",Ca:8,type:Boolean},10:{name:"include_already_applied_formatting_recommendations",
Ca:8,type:Boolean},11:{name:"enable_simple_table_detector_for_answers",Ca:8,type:Boolean},12:{name:"simple_table_detector_config_version",Ca:9,type:String}}));return a};GV.Ea=GV.prototype.Ea;function qgc(){return V('<div class="waffle-assistant-card" tabindex="0" role="region">'+(im?'<div class="waffle-assistant-card-feedback-container waffle-assistant-feedback-card-hidden"></div>':"")+'<div class="waffle-assistant-card-spinner-container"></div><div class="waffle-assistant-card-inner"><div class="waffle-assistant-button-holder waffle-assistant-card-options"></div><div class="waffle-assistant-card-content-container"></div>'+(im?'<div class="waffle-assistant-thumbs-container"></div>':"")+
"</div></div>")};function HV(){}z(HV,qI);pa(HV);HV.prototype.Sc=n("waffle-assistant-link-button");function rgc(){return V('<div class="waffle-assistant-feedback-card waffle-assistant-feedback-card-hidden"><div class="waffle-assistant-feedback-card-content"><div class="waffle-assistant-feedback-card-text">Tell us what could be improved.</div><div class="waffle-assistant-feedback-card-link">Send feedback</div></div></div>')};function sgc(a,b){T.call(this,b);this.D=a;this.C=new tt("",new HV,this.oa());this.Ma(this.C)}z(sgc,T);q=sgc.prototype;q.va=function(){this.Da=Xr(rgc)};q.Ja=function(){sgc.$.Ja.call(this);var a=this.$a("waffle-assistant-feedback-card-link");this.C.Ya(a);this.getHandler().V(this.Da,"mousedown",this.Ug).V(this.C,"action",this.Lpb);this.show(!1)};q.Ug=function(a){a.stopPropagation()};
q.show=function(a){var b=this.Da,c=this.$a("waffle-assistant-feedback-card-link");Up(b,"waffle-assistant-feedback-card-hidden",!a);xn(c,a)};q.Lpb=function(){Q.Fy.Nb({source:this.D});this.show(!1);this.dispatchEvent(new J("feedback-dialog-opened"))};function IV(){}z(IV,rt);pa(IV);IV.prototype.Sc=n("waffle-assistant-button");function tgc(){var a;a=""+('<div class="waffle-assistant-thumbs"><div class="waffle-assistant-thumbs-text">Was this useful?</div><div class="waffle-assistant-thumbs-button-holder"><div class="waffle-assistant-thumbs-up-button">'+U(Wu({icon:"docs-icon-img docs-icon-thumb-up"}))+'</div><div class="waffle-assistant-thumbs-down-button">'+U(Wu({icon:"docs-icon-img docs-icon-thumb-down"}))+"</div></div></div>");return V(a)};function JV(a){T.call(this,a);this.C=new tt("",new IV,this.oa());this.Ma(this.C);this.D=new tt("",new IV,this.oa());this.Ma(this.D)}z(JV,T);JV.prototype.va=function(){this.Da=Xr(tgc)};JV.prototype.Ja=function(){JV.$.Ja.call(this);var a=this.$a("waffle-assistant-thumbs-down-button");this.C.Ya(a);qV(a,"Not useful");a=this.$a("waffle-assistant-thumbs-up-button");this.D.Ya(a);qV(a,"Useful");this.getHandler().V(this.C,"action",this.F).V(this.D,"action",this.J)};
function ugc(a,b){a.oa().Xf(a.$a("waffle-assistant-thumbs-text"),b)}JV.prototype.F=function(){this.dispatchEvent(new J("thumbs-down"));S(this.Da,!1)};JV.prototype.J=function(){this.dispatchEvent(new J("thumbs-up"));S(this.Da,!1)};function KV(a,b){T.call(this,b);this.D=a;this.R=this.L=this.Z=null;this.Ua=new eV(!0,"#4285f4");this.Ma(this.Ua);this.bb=this.qc=this.Md=!1;this.ea=null;this.Gd=this.Gb=!1}z(KV,T);q=KV.prototype;q.NNa=Nf;q.qW=Nf;q.D$=Of;q.OF=Pf;q.MF=Pf;q.S8=Pf;q.Mka=Pf;q.Lka=Pf;q.mf=da("Gd");q.Pd=g("Gd");q.d$=v;q.va=function(){this.Da=Xr(qgc)};
q.Ja=function(){KV.$.Ja.call(this);var a=this.$a("waffle-assistant-card-spinner-container");this.Ua.render(a);Xp(this.$a("waffle-assistant-card-inner"),"visibility","hidden");if(this.qW()){var a=this.Da,b=new Kq(a);H(this,b);this.getHandler().V(b,"focusin",this.Ykb).V(b,"focusout",this.Xkb).V(a,"mouseenter",this.Uma).V(a,"mouseleave",this.j$)}vgc(this,!1);im&&(this.R=new sgc(this.YB(),this.oa()),this.R.render(this.$a("waffle-assistant-card-feedback-container")),this.getHandler().V(this.R,"feedback-dialog-opened",
this.Mpb).V(this,"trigger_feedback",this.aTb),this.D$()?(this.L=new JV(this.oa()),this.L.render(this.$a("waffle-assistant-thumbs-container")),wgc(this,!0),a=Ra(this.S8()),Pa(a)||ugc(this.L,a),a=Ra(this.Mka()),Pa(a)||qV(this.L.$a("waffle-assistant-thumbs-up-button"),a),a=Ra(this.Lka()),Pa(a)||qV(this.L.$a("waffle-assistant-thumbs-down-button"),a),this.getHandler().V(this.L,"thumbs-down",this.EYb).V(this.L,"thumbs-up",this.FYb)):wgc(this,!1));this.xD()};
function LV(a){return a.$a("waffle-assistant-card-content-container")}function xgc(a){a.qW();return a.$a("waffle-assistant-card-options")}function wgc(a,b){im&&S(a.$a("waffle-assistant-thumbs-container"),a.D$()&&b)}q.CB=function(){this.isDisposed()||(this.Md=!0,ygc(this))};function sV(a,b){!a.qc&&b&&(a.qc=!0,ygc(a))}function ygc(a){if(a.Md&&a.qc){var b=y(a.DYb,a);a.ED(b)}}q.Uma=function(){this.bb||(vgc(this,!0),this.bb=!0,cl(this.ea),this.ea=bl(this.zBa,100,this))};
q.zBa=function(){this.isDisposed()||(cl(this.ea),this.ea=null,this.Da.parentNode.querySelector(":hover")==this.Da?this.ea=bl(this.zBa,100,this):this.j$())};q.j$=function(){vgc(this,!1);this.bb=!1};q.Ykb=function(){vgc(this,!0)};q.Xkb=function(){bl(function(){this.isDisposed()||sn(this.Da,document.activeElement)||this.Da.parentNode.querySelector(":hover")==this.Da||vgc(this,!1)},0,this)};
q.EYb=function(){zgc(this,!0);wgc(this,!1);var a=this.MF();this.dispatchEvent(new pV("assistant-sidepane-thumbs",this,a))};q.FYb=function(){wgc(this,!1);var a=this.OF();this.dispatchEvent(new pV("assistant-sidepane-thumbs",this,a))};q.Mpb=function(){zgc(this,!1)};q.aTb=function(){zgc(this,!0)};function vgc(a,b){var c=a.$a("waffle-assistant-card-options");a=a.qW();S(c,a&&b)}q.DYb=function(){this.Ua.setActive(!1);S(this.Ua.Da,!1);Xp(this.$a("waffle-assistant-card-inner"),"visibility","visible");this.dispatchEvent(new J("content-rendered"))};
function zgc(a,b){Up(a.$a("waffle-assistant-card-feedback-container"),"waffle-assistant-feedback-card-hidden",!b);a.R.show(b)};var Agc={options:{hAxis:{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},vAxes:[{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0}],fontName:"Roboto",legacyContinuousAxisRemoved:!0,booleanRole:"certainty",theme:"material",width:null,height:null}};
function Bgc(a){var b=new FD(tc(Agc)),c=a.getChartType(),d=D(a,16);"PieChart"==c?(b.setOption("pieSliceText","none"),b.setOption("legend.position","labeled")):null!=d&&0>=d&&b.setOption("legend.position","none");b.setOption("title",D(a,2));b.setOption("hAxis.title",D(a,3));zc(a,4)&&b.setOption("hAxis.viewWindow.min",D(a,4));zc(a,5)&&b.setOption("hAxis.viewWindow.max",D(a,5));b.setOption("vAxes.0.title",D(a,6));zc(a,7)&&b.setOption("vAxes.0.viewWindow.min",D(a,7));zc(a,8)&&b.setOption("vAxes.0.viewWindow.max",
D(a,8));b.setOption("vAxes.1.title",D(a,9));zc(a,10)&&b.setOption("vAxes.1.viewWindow.min",D(a,10));zc(a,11)&&b.setOption("vAxes.1.viewWindow.max",D(a,11));b.setOption("useFirstColumnAsDomain",D(a,15));b.setOption("isStacked",D(a,17));b.setOption("treatLabelsAsText",Cb(qfc,c));b.Sh(c);d=Ec(a,12);if(!D(a,24)&&d&&d.length)if(b.setOption("applyAggregateData",0),a=Ec(a,13),"PieChart"===c)b.setOption("aggregateFunction",a[0]);else for(c=0;c<a.length;c++)b.setOption("series."+c+".aggregateFunction",a[c]);
return b}
function Cgc(a,b){a.setOption("legend.position","none");a.setOption("hAxis.slantedText",!1);a.setOption("hAxis.textStyle.fontSize",11);a.setOption("vAxes.0.textStyle.fontSize",11);a.setOption("vAxes.1.textStyle.fontSize",11);a.setOption("fontStyle.size",10);a.setOption("fontStyle.italic",!1);a.setOption("titleTextStyle.bold",!1);a.setOption("titleTextStyle.fontSize",12);a.setOption("async",40);!1!==a.dc("useFirstColumnAsDomain")&&a.Ge()&&"number"===a.Ge().qd(0)&&a.setOption("hAxis.gridlines.count",-1);
var c=15;if(!1!==a.dc("useFirstColumnAsDomain")&&a.Ge()&&"string"===a.Ge().qd(0)){var c=0,d=dn("span");d.style.fontSize="11px";d.style.fontFamily="Roboto,Arial";b.appendChild(d);for(b=0;b<a.Ge().getNumberOfRows();b++)vn(d,a.Ge().Yf(b,0)),c=Math.max(c,yq(d).width);ln(d);c=Math.min(27,Math.max(15,10+100*c/271))}a.setOption("chartArea.top","15%");b=a.dc("hAxis.title");a.setOption("chartArea.height",Pa(Ra(b))?"80%":"65%");a.setOption("chartArea.left",c+"%");a.setOption("chartArea.width",95-c+"%");"PieChart"==
a.getChartType()&&(a.setOption("chartArea.top",Pa(Ra(a.dc("title")))?"12%":"15%"),a.setOption("chartArea.height","70%"),a.setOption("chartArea.left","0%"),a.setOption("chartArea.width","100%"),a.setOption("pieSliceText","none"),a.setOption("legend.position","labeled"),a.setOption("legend.textStyle.fontSize",10));return a};function Dgc(){return V('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-before-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-preview"></div><div class="waffle-assistant-after-chart-preview"  tabindex="0"></div><div class="waffle-assistant-chart-highlights"></div></div>')}
function Egc(){return V(U(It({Je:"waffle-assistant-insert-chart-button waffle-assistant-readonly-hidden",content:ns(""+U(Wu({icon:"docs-icon-img docs-icon-insert-autovis-chart"}))),style:4}))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+U(It({Je:"waffle-assistant-zoom-button",content:ns(""+U(Wu({icon:"docs-icon-img docs-icon-zoom-in"}))),style:4})))};function Fgc(a){var b="",c='By <span class="waffle-assistant-facet-title">'+(U(a.i5a)+"</span>"),d=0==a.CFa.length,b=b+('<div class="waffle-assistant-facet-section"><div class="waffle-assistant-facet-header"><div class="waffle-assistant-pie-icon"></div><div class="waffle-assistant-facet-top-text">'+c+'</div><div class="waffle-assistant-facet-toggle" tabindex="0"></div></div>');if(d)c=V('<div class="waffle-assistant-facet-by-color-container"><div class="waffle-assistant-faceted-chart waffle-assistant-facet-by-color"></div></div>');
else{c='<div class="waffle-assistant-facet-charts-container">\x3c!-- Create chart containers with two in each row. --\x3e';a=a.CFa;for(var e=a.length,f=0;f<e;f++)var h=a[f],c=c+((0==f%2?'<div class="waffle-assistant-facet-chart-row">':"")+'<div class="waffle-assistant-single-facet"><div class="waffle-assistant-single-facet-title">'),c=h?c+U(h):c+"(empty)",c=c+('</div><div class="waffle-assistant-faceted-chart"></div></div>'+(1==f%2||f==e-1?"</div>":""));c=V(c+"</div>")}b+='<div class="waffle-assistant-facet-content-wrapper'+
(d?" waffle-assistant-facet-white-section":"")+'">'+c+(im?'<div class="waffle-assistant-facet-feedback-container"></div><div class="waffle-assistant-facet-thumbs-container"></div>':"")+"</div></div>";return V(b)};function Ggc(a,b,c,d,e,f,h){T.call(this,h);this.F=a;this.D=b;this.O=e;this.L=f;this.C=this.vc=null;this.J=op(new np,10).Ha()}z(Ggc,T);q=Ggc.prototype;q.Ja=function(){Ggc.$.Ja.call(this);(new HU(VD,this.D.Zf)).send(y(this.hnb,this,this.D))};q.d$=function(a,b){a=new Ifc(this.F.clone(),this.O,this.vc,2746,a,b);this.dispatchEvent(a)};q.hnb=function(a,b){b&&(b.Oi()?tD.nB(this.Da,b):(b=b.Ge(),a.If(b),WU(a,b),uD(a,"ready",y(this.wYb,this,a)),dV(a,this.Da,um),this.vc=b))};
q.wYb=function(a){a.Um()&&(uD(a.Um(),"onmouseover",y(this.uYb,this)),uD(a.Um(),"onmouseout",y(this.vYb,this)))};q.uYb=function(){this.C=Ga()};q.vYb=function(){Ba(this.C)&&500<Ga()-this.C&&this.L.Tb(2750,this.J);this.C=null};function Hgc(a,b,c,d,e){T.call(this,e);this.L=a;this.Ia=b;this.Aa=c;this.R=d;this.O=Ec(this.L,23);this.Fa=D(this.L,22);this.D=D(this.L,26);this.qa=[];this.He=new Ui;this.Z=this.F=this.C=null;this.ea=!1;this.ma=new Jt("",this.oa());this.Ma(this.ma);this.J=null}z(Hgc,T);q=Hgc.prototype;q.va=function(){Hgc.$.va.call(this);this.Da=Xr(Fgc,{i5a:this.D,CFa:this.O});this.Da.style.visibility="hidden"};
q.Ja=function(){Hgc.$.Ja.call(this);var a=this.$a("waffle-assistant-facet-toggle");this.ma.Ya(a);this.getHandler().V(this.Da,"mousedown",this.Ug).V(this.ma,"action",this.ECb);im&&(this.Z=new sgc("assistantAutovisFacetFeedback",this.oa()),this.Z.render(this.$a("waffle-assistant-facet-feedback-container")),this.C=new JV(this.oa()),this.Ma(this.C),this.C.render(this.$a("waffle-assistant-facet-thumbs-container")),ugc(this.C,this.O.length?"Were these charts useful?":"Was this chart useful?"),this.getHandler().V(this.C,
"thumbs-up",this.tYb).V(this.C,"thumbs-down",this.sYb));Igc(this,uoa)};q.Pd=g("ea");q.mf=function(a){this.ea=a;Jgc(this)};q.Ug=function(a){a.stopPropagation()};q.ECb=function(){var a=Pp(this.$a("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden");Igc(this,a);Kgc(this,a?2647:2646)};
function Igc(a,b){var c=a.$a("waffle-assistant-facet-toggle");vn(c,b?"HIDE":"SHOW");Up(a.$a("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden",!b);A(a.Bj("waffle-assistant-faceted-chart"),function(a){xn(a,b)});a.C&&S(a.C.Da,b);var d='Show chart broken down by "'+(a.D+'"');a='Hide chart broken down by "'+(a.D+'"');qV(c,b?a:d)}
function Lgc(a){a.setOption("legend","top");a.setOption("titleTextStyle.fontSize",10);a.setOption("allowAsync",!0);a.setOption("applyAggregateData",void 0);a.setOption("pieSliceTextStyle.fontSize",11);a.setOption("tooltip.textStyle.fontSize",11);"BarChart"==a.getChartType()&&a.setOption("isStacked",!0)}function Mgc(a){"BarChart"==a.getChartType()&&a.setOption("isStacked",!0);a.setOption("applyAggregateData",void 0)}
function Jgc(a){a.R&&!a.ea&&A(a.qa,y(function(a){var b=a.Da;if(!this.R.contains(b)){var d=this.R;a=new Ngc(b,a);Lbb(d,a)}},a))}q.tYb=function(){Kgc(this,2649)};q.sYb=function(){Kgc(this,2648);this.Z.show(!0)};function Kgc(a,b){var c=a.Aa,d=new Hec,e=a.J.getChartType();d.F=e;e=a.J.Ge();d.D=e?e.clone():null;Eec(c,b,d,10,a.J,a.J.Zf)};function MV(a,b,c,d,e,f){KV.call(this,a,f);this.C=a.getAutovisRecommendation();this.jd=b;this.Tc=c;this.O=d;this.Qa=e;this.ma=new Jt("",this.oa());this.Ma(this.ma);this.Aa=new Jt("",this.oa());this.Ma(this.Aa);this.He=new Ui;this.Gc=null;this.Ka=!1;this.Ub=[];this.Qb=[];this.ib=[];this.Oa=this.Ia=this.F=this.J=this.Fa=null;this.qa=op(new np,10).Ha()}z(MV,KV);
var NV={YWa:"waffle-assistant-after-chart-preview",uXa:"waffle-assistant-before-chart-preview",GXa:"waffle-assistant-card-draggable",x4:"waffle-assistant-chart-highlights",h_a:"waffle-assistant-insert-chart-button",Wea:"waffle-assistant-chart-preview",i1a:"waffle-assistant-button-separator",E1a:"waffle-assistant-styled-border",F1a:"waffle-assistant-styled-rect",D2a:"waffle-assistant-zoom-button"};q=MV.prototype;q.ED=function(a){this.Gc=a;Ogc(this)};
q.xD=function(){Pgc(this,y(function(a){a=Dec(this.jd,a);Np(this.Da,a)},this),!1)};q.NNa=Of;q.qW=Of;q.YB=n("autovisFeedback");q.OF=n(2208);q.MF=n(2207);q.S8=n("Was this chart useful?");q.va=function(){MV.$.va.call(this);LV(this).appendChild(Xr(Dgc));xgc(this).appendChild(Xr(Egc));zc(this.C,22)&&(this.F=new Hgc(this.C,this.Z,this.O,this.Qa,this.oa()),this.Ma(this.F,!0),this.F.mf(this.Pd()))};
q.Ja=function(){MV.$.Ja.call(this);Qp(this.Da,NV.GXa);var a=this.$a(NV.h_a);this.ma.Ya(a);qV(a,"Insert chart");a=this.$a(NV.D2a);this.Aa.Ya(a);qV(a,"View full size");var a=this.$a(NV.uXa),b=this.$a(NV.Wea),c=this.$a(NV.YWa);this.getHandler().V(this.Da,"keydown",this.pYb).V(b,"click",this.Clb).V(a,"focus",this.Bkb).V(c,"focus",this.vjb).V(this.ma,"action",this.tsb).V(this.ma.Da,"mousedown",this.Ug).V(this.Aa,"action",this.rEb).V(this.Aa.Da,"mousedown",this.Ug).V(this.$a(NV.x4),"mousedown",this.Ug).V(qw(this.jd),
"Ib",this.qYb);Qgc(this);this.O.Tb(2790,this.qa);this.F&&this.O.Tb(2791,this.qa)};q.mf=function(a){MV.$.mf.call(this,a);Qgc(this);this.Jc()&&Rgc(this)};function Qgc(a){if(a.Jc()){var b=a.Pd();a.ma.setVisible(!b);a=a.oa().$a(NV.i1a,xgc(a));S(a,!b)}}q.pYb=function(a){13==a.keyCode&&a.target==this.Da&&(a.preventDefault(),a.stopPropagation(),Sgc(this,2255))};
function Tgc(a){for(var b=a.getChartType(),c=!!D(a.C,14),d=D(a.C,16),e=!!D(a.C,15),f="Histogram"==b,h="PieChart"==b,k=Ugc(a),l=1<k.length,m=[],b=0;b<k.length;b++){var p=Vgc(k[b].rect,c!=h);Ob(m,p)}var b=jA(a.Tc).Fd(),r=wb(hc(Zg),b.K3,b),c=wb(m,function(a){return wb(r,Ea(vh,a))});f&&e&&(c=Pb(c,1));a.ib=Wgc(c.length,h&&0<d||!f&&!h&&e,h&&l);d=jA(a.Tc);for(b=0;b<c.length;b++)for(e=a.ib[b],f=0;f<c[b].length;f++)c[b][f]&&Dh(c[b][f])&&(h=bT(d,c[b][f],NV.F1a),H(a,h),WG(mI(d),h,!0),Xp(h.Da,"background-color",
e),h.setVisible(!0),a.Ub.push(h),h=TH(d,c[b][f],NV.E1a,1,0),H(a,h),p6a(h,e),h.setVisible(!0),a.Qb.push(h))}function Xgc(a){Ic(a.Ub);Ic(a.Qb);a.Ub=[];a.Qb=[];a.ib=[]}q.qYb=function(){this.Ka&&(Xgc(this),Tgc(this))};q.Uma=function(){MV.$.Uma.call(this);this.Ia=Ga();this.Ka||(Tgc(this),this.Ka=!0)};q.j$=function(){MV.$.j$.call(this);Ba(this.Ia)&&500<Ga()-this.Ia&&this.O.Tb(2789,this.qa);this.Ia=null;Xgc(this);this.Ka=!1};q.Clb=function(){this.Da.focus()};
q.Bkb=function(){var a=this.$a(NV.x4);uq(a)?a.focus():this.Da.nextSibling&&this.Da.nextSibling.focus()};q.vjb=function(){var a;if(a=this.R)a=this.R,a.gb("waffle-assistant-feedback-card-hidden")?a=!1:(a.$a("waffle-assistant-feedback-card-link").focus(),a=!0);a||this.Aa.Da.focus()};q.tsb=function(){this.O.Tb(2255,this.qa);Sgc(this,2255)};q.Ug=function(a){a.stopPropagation()};q.rEb=function(){X.Y3.Nb(this)};q.d$=function(a,b){Sgc(this,2257,a,b)};
function Sgc(a,b,c,d){Pgc(a,y(function(a){a=new Ifc(a,this.Z,this.J&&this.J.Ge(),b,c,d);this.dispatchEvent(a)},a),!1)}
q.rYb=function(a,b){if(b){var c=this.$a(NV.Wea);if(b.Oi())tD.nB(c,b);else{a.If(b.Ge());WU(a,a.Ge());sT(a,"ready",y(this.oYb,this,a));b=[];try{var d=new hf;d.setContext(a.toJSON());var e=!!D(this.C,14);E(d,3,e);var f=D(this.C,16);E(d,4,f);E(d,5,"ROWS"==(e?"ROWS":"COLS"));E(d,8,0);if(D(this.C,24)){var h=D(this.C,25);E(d,9,h)}for(var k=Ugc(this),e=0;e<k.length;e++)d.addRange(Ih(k[e].rect,k[e].xd));var l=this.He.serialize(d);b=wb(Mec(Ea(ritz.getVerbalHighlightsForProto,l),a).call(),Jec)}catch(m){b=[]}d=
this.$a(NV.x4);S(d,0<b.length);0<b.length&&(d.appendChild(b[0]),xn(d,!0));this.J=a;dV(a,c,um)}}};q.oYb=function(a){null!==this.Fa&&(AJ(yJ.getInstance(),this.Fa),this.Fa=null);this.isDisposed()||(a.Um()&&(uD(a.Um(),"onmouseover",y(this.mYb,this)),uD(a.Um(),"onmouseout",y(this.nYb,this))),this.Gc(),Rgc(this))};q.mYb=function(){this.Oa=Ga()};q.nYb=function(){Ba(this.Oa)&&500<Ga()-this.Oa&&this.O.Tb(2795,this.qa);this.Oa=null};
function Rgc(a){if(a.Qa&&!a.Pd()){var b=a.$a(NV.Wea);if(!a.Qa.contains(b)){var c=a.Qa;a=new Ngc(b,a);Lbb(c,a)}}}
function Ygc(a){a.Gb&&(a.Fa=zJ(yJ.getInstance(),vj.Yua),a.Gb=!1);D(a.C,16);var b=Bgc(a.C);b.lca(VD);var c=Ugc(a),d=!!D(a.C,14),e=D(a.C,16)||0,d=Hl(yWa("/gviz/tq"),"").zb("transpose",d?"1":"0").zb("headers",e.toString()).zb("hds",0).zb("merge",d?"ROWS":"COLS").zb("authkey",Dm("authKey"));D(a.C,24)&&d.zb("dt",encodeURIComponent(JSON.stringify(a.He.serialize(D(a.C,25)))));CWa(d,c);b.Ci(d.toString());a.F&&(c=d.clone(),a.F.F=c);return b}
function Ogc(a){var b=Ygc(a),b=Cgc(b,a.$a("waffle-assistant-card-inner"));(new HU(VD,b.Zf)).send(y(a.rYb,a,b));a.F&&Pgc(a,y(function(a){var c=this.F,e=b;a=new FD(a.toJSON());var e=new FD(e.toJSON()),f=c.Bj("waffle-assistant-faceted-chart");if(1<f.length){Mgc(a);var h=e;Lgc(h);h.setOption("pieSliceText","percentage");h.setOption("axisFontSize",0);h.setOption("hAxis.title",null);h.setOption("hAxis.textPosition","none");h.setOption("vAxes.0.title",null);h.setOption("vAxes.0.textPosition","none");h.setOption("vAxes.1.title",
null);h.setOption("vAxes.1.textPosition","none");h.setOption("chartArea",{left:"5%",top:"5%",width:"90%",height:"90%"});h.setOption("legend","none");h.setOption("titleTextStyle.fontSize",0)}else h=a,Mgc(h),h.setOption("applyAggregateData",void 0),h.setOption("legend","right"),Lgc(e);for(var h=CWa,k=c.F,l=Ec(c.L,27),m=[],p=0;p<l.length;p++)m.push(ZS(l[p]));h(k,m);h=D(c.L,25);for(k=0;k<f.length;k++){var l=za(c.O[k])?c.O[k]:null,p=m=h.clone(),r=c.Fa,u=l,w=new nf;E(w,1,r);za(u)&&w.Xa(u);E(p,7,w);c.F.zb("dt",
encodeURIComponent(JSON.stringify(c.He.serialize(m))));p=new FD(a.toJSON());p.Ci(c.F.toString());m=e.clone();m.Ci(c.F.toString());var u=c,x=p,r=l;(w=x.dc("title"))||(w=xfc(x));x=w+(' when "'+(u.D+('" is "'+(r+'"'))));u=w+(' by "'+(u.D+'"'));r=r?x:u;p.setOption("title",r);m.setOption("title",r);r=new Ggc(p,m,0,0,c.Ia,c.Aa,c.oa());c.Ma(r);u=f[k];r.Ya(u);c.qa.push(r);r=c;w=xfc(p);p=w+(' broken down by "'+(r.D+('" for "'+(l+'"'))));r=w+(' broken down by "'+(r.D+'"'));Np(u,l?p:r);c.J=m}Jgc(c);c.Da.style.visibility=
"visible"},a),!1)}function Pgc(a,b,c){var d=Ygc(a);(new HU(VD,d.Zf)).send(function(a){a?(a=a.Ge(),c&&d.If(a),WU(d,a),b(d)):b(null)})}function Ugc(a){a=Ec(a.D,4);for(var b=[],c=0;c<a.length;c++)b.push(ZS(a[c]));return b}q.getChartType=function(){return this.C.getChartType()};function Wgc(a,b,c){var d=b?["#666"]:[];c&&(a/=2);b&&--a;b=Qcc("material").colors;for(var e=0;e<a;e++)d.push(b[e%b.length].color);c&&Ob(d,d);return d}
function Vgc(a,b){return b?pfc(a,new kh(a.width,1)):pfc(a,new kh(1,a.height))};function Zgc(){HI.call(this);this.Ia.push(this);this.qa=this.Aa=!0;this.Ua="waffle-assistant-dragged-card"}z(Zgc,Kbb);Zgc.prototype.contains=function(a){return!!A(this.O,function(b){if(b.element==a)return!0})};Zgc.prototype.Yka=function(a){var b=Zgc.$.Yka.call(this,a);if(DT()||um){a=a.querySelectorAll("CANVAS");for(var c=b.querySelectorAll("CANVAS"),d=0;d<a.length;d++)c[d].getContext("2d").drawImage(a[d],0,0)}else a=wb(b.querySelectorAll("clippath"),function(a){return a.id}),$gc(b,a);return b};
function $gc(a,b){for(var c=a.getAttribute&&a.getAttribute("clip-path"),d=0;d<b.length;d++){var e=b[d];za(c)&&bb(c,e)&&a.setAttribute("clip-path",c.replace(e,e+"-clone"));e==a.id&&(a.id=e+"-clone")}a=nn(a);for(d=0;d<a.length;d++)$gc(a[d],b)}function Ngc(a,b){JI.call(this,a,b)}z(Ngc,JI);Ngc.prototype.$ka=g("element");function ahc(){return V('<div class="waffle-assistant-word-cloud-card"><div class="waffle-assistant-word-cloud-title"></div><div class="waffle-assistant-word-cloud-words-container"></div></div>')};function OV(a,b){KV.call(this,a,b);this.C=a.getAutovisRecommendation()}z(OV,KV);q=OV.prototype;q.xD=v;q.YB=n("assistantWordCloudFeedback");q.OF=n(2634);q.MF=n(2633);q.va=function(){OV.$.va.call(this);LV(this).appendChild(Xr(ahc));Qp(LV(this),"waffle-assistant-word-cloud-content-container")};
q.ED=function(a){for(var b=Ec(this.C,19),c=Ec(this.C,20),d=this.$a("waffle-assistant-word-cloud-words-container"),e=0;e<b.length;e++)if(this.Hl(b,c,e),120<d.clientHeight){this.Hl(b,c,e-1);break}b=this.oa();c=D(this.C,2);c=Hn(b,c);d=this.$a("waffle-assistant-word-cloud-title");b.appendChild(d,c);a()};
q.Hl=function(a,b,c){for(var d=this.$a("waffle-assistant-word-cloud-words-container"),e=this.oa();d.firstChild;)d.removeChild(d.firstChild);for(var f=b[c],h=b[0],k=0;k<=c;k++){0!=k&&d.appendChild(Hn(e," "));var l=e.createElement("SPAN");e.appendChild(l,Hn(e,a[k]));e.appendChild(d,l);Qp(l,"waffle-assistant-word-cloud-word");var m=b[k];l.style.color=0==k%2?"#00695C":"#61443C";l.style.fontSize=(m-f)/(h-f)*15+9+"px"}};function PV(a,b,c,d,e){tV.call(this,20,d,c,e);this.qa=a;this.ma=b;this.C=new Zgc;H(this,this.C);this.F=null;this.ea=0}z(PV,tV);q=PV.prototype;q.Ja=function(){PV.$.Ja.call(this);this.C.gf();this.getHandler().V(this.C,"drag",this.lYb).V(this.C,"dragend",this.Vm)};q.getTitle=n("Analysis");q.Vga=function(a){return 0==a};q.B6=function(a){return"WordCloud"==a.getAutovisRecommendation().getChartType()?new OV(a,this.oa()):new MV(a,this.qa,this.ma,this.O,this.C,this.oa())};
q.mf=function(a){PV.$.mf.call(this,a);a&&sbb(this.C)};q.BJa=function(a){this.getHandler().Oc(a,"content-rendered",this.kYb);this.ea++};q.kYb=function(){0==--this.ea&&this.dispatchEvent("assistant-done-rendering")};q.lYb=function(){this.F=mq(this.C.kd.target)};q.Vm=function(a){var b=this.F,c=jA(this.ma).ye();if(oh(UF(c,"page",!1,!1)).contains(b)){var d=SF(c,b.x,b.y,"page"),c=WF(c,th(d),"page"),b=new N(b.x-c.left,b.y-c.top);a.C.getData().d$(d,b)}this.F=null};q.rua=n(2);function bhc(a){var b=a.type;if(!t(b))return null;switch(b.toLowerCase()){case "checkbox":case "radio":return a.checked?a.value:null;case "select-one":return b=a.selectedIndex,0<=b?a.options[b].value:null;case "select-multiple":for(var b=[],c,d=0;c=a.options[d];d++)c.selected&&b.push(c.value);return b.length?b:null;default:return t(a.value)?a.value:null}}
function chc(a,b){var c=a.type;if(t(c))switch(c.toLowerCase()){case "checkbox":case "radio":a.checked=b;break;case "select-one":a.selectedIndex=-1;if(za(b))for(var d=0;c=a.options[d];d++)if(c.value==b){c.selected=!0;break}break;case "select-multiple":za(b)&&(b=[b]);for(d=0;c=a.options[d];d++)if(c.selected=!1,b)for(var e,f=0;e=b[f];f++)c.value==e&&(c.selected=!0);break;default:a.value=null!=b?b:""}};var dhc="help;how can;how do i;how do you;how do u;how to;what can;what does;what is this".split(";"),ehc=[{$j:["Thank you"],Vg:"No problem"},{$j:["you are amazing","This is great","omg"],Vg:"Happy to help"},{$j:["I love you"],Vg:"Must be in the air"},{$j:["How do you know"],Vg:"It's all in the data"},{$j:["Are you sure"],Vg:"Send feedback if this doesn't seem correct to help improve accuracy"},{$j:["How are you"],Vg:"Pretty good, thanks"},{$j:["Hi","Hello","Hey"],Vg:"Hi, there. Try asking a question about your data."},
{$j:["You are stupid","This is dumb","You are wrong"],Vg:"Help improve this experience by sending feedback"},{$j:["How smart are you"],Vg:"Pretty smart"}];function fhc(a){for(var b=0;b<ehc.length;++b)if(-1!=Bb(ehc[b].$j,function(b){return La(a,b)}))return b;return-1};function ghc(a,b,c,d,e){this.C=a;this.Xy=b;this.D=d;this.Oo=c;this.L=d?Ec(d,6):[];this.O=d?Ec(d,7):[];this.J=d?Ec(d,8):[];this.error=e||1;this.interpretation=d&&zc(d,4)?D(d,4):null;this.F=d?Ec(d,12):[]}function hhc(a){return{zN:ihc(a),interpretation:a.interpretation,Xy:a.Xy,Oo:a.Oo,Y0:1<a.Xy.length&&1<a.Xy[0].length,nG:a.nG()}}
ghc.prototype.nG=function(){var a=Ec(this.D,13);if(0==a.length)return!1;switch(a[0]){case 2:case 3:case 4:case 5:a=!0;break;default:a=!1}return moa&&1<this.Xy.length&&1<this.Xy[0].length&&a};ghc.prototype.getChartType=function(){switch(Ec(this.D,13)[0]){case 2:return"ColumnChart";case 3:return"Timeline";case 4:return"ScatterChart";case 5:return"PieChart";default:throw Error("Unknown chart type.");}};function jhc(a){a.nG();return a.Xy[0][0]}function khc(a){a.nG();return a.Xy[0][1]}
function lhc(a){return{zN:ihc(a),error:mhc(a)}}
function nhc(a){if(!zc(a.D,9))return"";if(zc(a.D.getError(),3))switch(D(a.D.getError(),3)){case 1:return"Sorry, questions related to formatting are not supported at this time.";case 2:return"Answers provides formulas based on your data. Charts are currently not supported. Please use the menus to create a chart.";case 3:return"Sorry, this action is not supported at this time.";case 4:return"Sorry, this function is not supported at this time.";case 5:return"Sorry, your question is too generic. Please ask a more specific question.";default:return"Sorry, this function is not supported at this time."}return a.D.getError().Sm()||
""}function mhc(a){switch(a.error){case 2:return"Looks like you are offline. Try again when you reconnect.";case 3:return"There was a problem getting your answer at this time. Please try again later.";case 4:return"Sorry, couldn't understand your question.";case 5:return"Answers lets you ask question and learn more about your data.";case 6:return nhc(a)||"Sorry, couldn't understand your question.";case 7:return a=fhc(a.C),-1!=a?ehc[a].Vg:""}return""}
function ihc(a){var b=[];if(1==a.error&&null!=a.Oo){var c=[];A(Lb(a.L,a.J),function(a){c.push(ohc(a,"waffle-assistant-answercard-question-unused-phrase"))},a);A(a.O,function(a){c.push(ohc(a,"waffle-assistant-answercard-question-used-entity"))},a);Tb(c,function(a,b){return a.$V>b.$V?1:-1});var d=0;A(c,function(a){var c=a.length,e=a.$V;e>d?b.push({text:this.C.substring(d,e),className:null}):(c-=d-e,e=d);0<c&&(d=e+c,b.push({text:this.C.substring(e,d),className:a.jl}))},a);d<a.C.length&&b.push({text:a.C.substring(d),
className:null})}else b.push({text:a.C,className:null});return b}function ohc(a,b){return{$V:D(a,2),length:D(a,3),jl:b}}function phc(a,b,c){return new ghc(a,null,null,c||null,b)};function QV(a,b,c,d){K.call(this);this.R=a;this.Z=b;this.ma=c;this.Ia=d;this.Ba=new L(this);H(this,this.Ba);this.C=new YT;H(this,this.C);this.O="";this.L=[];this.F=this.D=this.J=null;this.ea=!1;Vbc(this.C,this.R);this.C.Z=10;this.C.Aa=!0;this.C.L=!1;this.C.Lra("waffle-assistant-visible");this.C.R=Va("waffle-assistant-dragged-formula").split(" ");this.C.gf();this.Ba.V(this.C,"beforedragstart",this.Aa).V(this.C,"dragmove",this.Fa).V(this.C,"beforedragend",this.qa)}z(QV,K);QV.prototype.mf=da("ea");
QV.prototype.Aa=function(a){a=tb(this.R.childNodes,a.C);this.O=this.L[a]};
QV.prototype.Fa=function(a){var b=a.event instanceof Jq?a.event.F:a.event;this.ea?(a.Z.Bx(b,!0),a.preventDefault()):(cq(a.F,a.event.clientX,a.event.clientY),a=dq(a.F),b=jA(this.Z).ye(),oh(UF(b,"page",!1,!1)).contains(a)?(a=SF(b,a.x,a.y,"page"),(b=Cx(sw(this.ma),a.y,a.x))?a=new N(b.kc(),b.rc()):b=th(a),this.J=a,this.D&&this.D.Pc().equals(b)||(a=jA(this.Z),I(this.D),this.D=bT(a,b,"waffle-assistant-formula-insertion-rect"),H(this,this.D),WG(mI(a),this.D),I(this.F),this.F=TH(a,b,"waffle-assistant-formula-insertion-border",
2,0),H(this,this.F),p6a(this.F,"#000"),this.F.setVisible(!0))):qhc(this))};QV.prototype.qa=function(a){if(this.J){var b=this.J,c=sw(this.ma),b=new lG(c,b,this.O);this.Ia.C(b);this.dispatchEvent(new J("formula_inserted"))}a.Z.Bx(null,!0);a.preventDefault();this.O="";qhc(this)};function qhc(a){a.J=null;I(a.D);a.D=null;I(a.F);a.F=null};function rhc(a){var b=V,c='<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+shc({zN:a.RQ.zN}),d;d=a.RQ.Xy;var e=a.RQ.Oo,f=a.RQ.interpretation,h=a.RQ.Y0;a=a.RQ.nG;null==d||sa(d);var k;k=""+('<div class="waffle-assistant-answercard-answer-container"><div class="waffle-assistant-answercard-answer-header" role="heading" aria-label="'+rs("Answer")+'"><span aria-hidden="true">Answer</span></div>'+(f?'<div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret">'+
U(f)+"</div></div>":"")+'<div class="waffle-assistant-answercard-answer-content">');if(d){a&&(k+='<div class="waffle-assistant-answercard-tabs"><div class="waffle-assistant-answercard-formula-tab">FORMULA</div><div class="waffle-assistant-answercard-chart-tab">CHART</div></div>');k+='<div class="waffle-assistant-answercard-answer">';if(h){k+='<div class="waffle-assistant-answercard-answer-rowheader">';for(var f=d[0],l=f.length,m=0;m<l;m++)k+='<span class="waffle-assistant-answercard-answer-col">'+
U(f[m])+"</span>";k+="</div>"}k+='<div class="waffle-assistant-answercard-answer-rows">';f=ms("waffle-assistant-answercard-answer-row"+(h?" waffle-assistant-answercard-answer-list-row":""));l=d.length;for(m=0;m<l;m++){var p=d[m];if(h&&0==m)p="";else{var r=f;sa(p);for(var r='<div class="'+W(r)+'">',u=p.length,w=0;w<u;w++)var x=p[w],r=x?r+('<span class="waffle-assistant-answercard-answer-col">'+U(x)+"</span>"):r+('<span class="'+W("waffle-assistant-answercard-answer-col waffle-assistant-answercard-answer-empty")+
'">N/A</span>');p=V(r+"</div>")}k+=p}k+="</div></div>"+(a?'<div class="waffle-assistant-answercard-chart-container"><div class="waffle-assistant-answercard-chart"></div></div>':"")}k+='<div class="waffle-assistant-answercard-formula-holder"><div class="waffle-assistant-answercard-see-formula-link">See formula</div><div class="waffle-assistant-answercard-hide-formula-link">Hide formula</div><div class="waffle-assistant-answercard-formula"><div class="waffle-assistant-answercard-formula-icon">'+U(Wu({icon:"docs-icon-img docs-icon-insert-formula"}))+
'</div><div class="waffle-assistant-answercard-formula-text-container"><div class="waffle-assistant-answercard-formula-text" tabindex="0">'+U(e)+"</div></div></div></div></div></div>";d=V(k);return b(c+d+"</div></div>")}
function shc(a){sa(a.zN);a=a.zN;var b;b=""+('<div class="waffle-assistant-answercard-question-container"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+rs("Question")+'"><span aria-hidden="true">Question</span></div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">');for(var c=a.length,d=0;d<c;d++){var e=a[d];b+=e.className?'<span class="'+W(e.className)+'">'+U(e.text)+"</span>":U(e.text)}return V(b+
"</div></div></div>")}function thc(){return V(U(V('<div class="waffle-assistant-answers-card-remove">'+U(Wu({icon:"docs-icon-img docs-icon-trash"}))+"</div>")))};function uhc(a,b,c,d,e,f){J.call(this,"sqc");this.Ia=a;this.Z=f||"";this.ea=b;this.F=d;this.Oa=e;this.C=c}z(uhc,J);function RV(a,b,c,d,e,f,h,k){KV.call(this,new FV,k);this.C=a;this.Ia=a.nG();this.Fa=!1;this.Ka=b;this.Qb=c;this.ib=d;this.Ub=f;this.qa=e;this.Oa=h;this.Qa=op(new np,10).Ha();this.Aa=new tt("",new IV,this.oa());this.Ma(this.Aa);this.J=null;this.O=new tt("",new HV,this.oa());this.Ma(this.O);this.ma=new tt("",new HV,this.oa());this.Ma(this.ma);this.F=new fU;this.Ma(this.F)}z(RV,KV);q=RV.prototype;q.Zja=g("Oa");q.va=function(){RV.$.va.call(this);xgc(this).appendChild(Xr(thc))};
q.Ja=function(){RV.$.Ja.call(this);var a=this.$a("waffle-assistant-answers-card-remove");this.Aa.Ya(a);qV(a,"Remove card",0);this.getHandler().Oc(this.Aa,"action",this.yYb).V(this.O,"action",this.Zzb).V(this.ma,"action",this.srb)};
q.ED=function(a){LV(this).appendChild(Xr(rhc,{RQ:hhc(this.C)}));this.O.Ya(this.$a("waffle-assistant-answercard-see-formula-link"));this.ma.Ya(this.$a("waffle-assistant-answercard-hide-formula-link"));this.J=new QV(this.$a("waffle-assistant-answercard-formula-text-container"),this.Ka,this.Qb,this.ib);this.J.mf(this.Pd());this.J.L=[this.C.Oo];H(this,this.J);var b=this.$a("waffle-assistant-answercard-formula-text");Np(b,"Formula: "+(this.C.Oo+". Click/Press ENTER to copy or drag to insert on to sheet."));
Lf(this.getHandler().V(this.J,"formula_inserted",this.xYb),this.$a("waffle-assistant-answercard-formula-text"),nd,this.Dqb);vhc(this,!1);this.Ia&&(this.F.Ya(this.$a("waffle-assistant-answercard-tabs")),b=new dU(""),b.Ya(this.$a("waffle-assistant-answercard-formula-tab")),this.F.Ma(b),this.F.rA(b),b=new dU(""),b.Ya(this.$a("waffle-assistant-answercard-chart-tab")),this.F.Ma(b),this.getHandler().V(this.F,"select",this.hCb),whc(this,!1));a()};
function xhc(a){var b=new yV;egc(b,a.C.getChartType());fgc(b,jhc(a.C));ggc(b,khc(a.C));var c=Pb(a.C.Xy,1),d=wb(c,function(a){return pb(a[1])}),e=Math.min.apply(Math,[].concat(d instanceof Array?d:wfc(iaa(d)))),d=Math.max.apply(Math,[].concat(d instanceof Array?d:wfc(iaa(d)))),d=Math.floor(1.1*d),e=Math.min(e,0);E(b,7,e);E(b,8,d);b=Bgc(b);e=new lD;e.Hr("string",jhc(a.C));e.Hr("number",khc(a.C));for(d=0;d<c.length;++d)e.Vw([c[d][0],pb(c[d][1])]);b.If(e);c=a.$a("waffle-assistant-answercard-chart");b=
Cgc(b,c);WU(b,b.Ge());dV(b,c,um);a.Fa=!0}q.xD=function(){Np(this.Da,"Answer Card for question: "+this.C.C)};q.qW=Of;q.YB=n("assistantAnswersFeedback");q.OF=n(2628);q.MF=n(2627);q.S8=n("Was this answer correct?");q.Mka=n("Correct");q.Lka=n("Incorrect");q.a8=g("C");q.mf=function(a){RV.$.mf.call(this,a);this.J&&this.J.mf(a)};q.hCb=function(){switch(lcc(this.F)){case 0:whc(this,!1);break;case 1:whc(this,!0);break;default:lcc(this.F)}};
function whc(a,b){S(a.$a("waffle-assistant-answercard-chart-container"),b);S(a.$a("waffle-assistant-answercard-answer"),!b);!a.Fa&&b&&xhc(a)}function vhc(a,b){a.O.setVisible(!b);a.ma.setVisible(b);S(a.$a("waffle-assistant-answercard-formula"),b);b?a.$a("waffle-assistant-answercard-formula-text").focus():(a.O.Da.focus(),a.O.Yr(!0))}q.yYb=function(){var a=new oV;P(a,8,Am);P(a,3,!0);var b=new eT;pj(b,4,a);a=new Ko;pj(a,46,b);b=pp(op(new np,10),a).Ha();this.qa.Tb(2753,b);this.dispatchEvent(new J("rc"))};
q.Zzb=function(){vhc(this,!0);yhc(this,!0)};q.srb=function(){vhc(this,!1);yhc(this,!1)};function yhc(a,b){var c=new oV;P(c,9,b);b=new eT;pj(b,4,c);c=new Ko;pj(c,46,b);c=pp(op(new np,10),c).Ha();a.qa.Tb(2849,c)}q.xYb=function(){this.qa.Tb(2709,this.Qa)};
q.Dqb=function(){var a=this.oa().Pb(),b=a.createElement("textarea");b.textContent=this.C.Oo;b.style.position="fixed";a.body.appendChild(b);b.select();var c=!1;try{c=a.execCommand("copy")}catch(d){}finally{a.body.removeChild(b)}c&&zhc(this.Ub,"Formula copied to clipboard",this.oa())};function Ahc(){var a;a=ms("Ask a question about your data");a='<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container">'+('<input type="text" class="waffle-assistant-answers-input-box" placeholder="'+W(a)+'" aria-label="'+W(a)+'"/></div><div class="waffle-assistant-answers-input-controls"><div class="waffle-assistant-answers-button-container">');a+='<div class="'+W("waffle-assistant-answers-query-box-button waffle-assistant-answers-clear-query-button")+
'">'+U(Wu({icon:"docs-icon-img docs-icon-cancel"}))+'</div></div><div class="waffle-assistant-answers-spinner-container" style="display:none"></div></div></form></div>';return V(a)};function Bhc(a){var b=V,c='<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+U(shc({zN:a.pFa.zN})),d;d=a.pFa.error;var e=a.showHelp;a='<div class="waffle-assistant-answercard-error-container"><div class="waffle-assistant-answercard-error-image">'+U(Wu({icon:"docs-icon-img docs-icon-unsupported-black"}))+'</div><div class="waffle-assistant-errorcard-content">';e?(d=U(d)+' Look in <div class="waffle-assistant-answers-helpcenter-link">Sheets help</div> instead?',
a+='<div class="waffle-assistant-errorcard-text">'+d+"</div>"):a+='<div class="waffle-assistant-errorcard-text">'+U(d)+"</div>";d=V(a+"</div></div>");return b(c+d+"</div></div>")}function Chc(){return V('<div class="waffle-assistant-answercard-feedback-container"><div class="waffle-assistant-answercard-feedback-link">Send feedback</div></div>')};function SV(a,b,c,d,e){KV.call(this,new FV,e);this.O=a;this.qa=b;this.J=d;this.Aa=c;this.ma=new tt("",new IV,this.oa());this.Ma(this.ma);this.F=new tt("",new HV,this.oa());this.Ma(this.F);this.C=new tt("",new HV,this.oa());this.Ma(this.C)}z(SV,KV);q=SV.prototype;q.xD=function(){Np(this.Da,"Error Card for question: "+this.O.C)};q.YB=n("assistantAnswersFeedback");q.qW=Of;q.D$=Nf;q.va=function(){SV.$.va.call(this);xgc(this).appendChild(Xr(thc))};
q.Ja=function(){SV.$.Ja.call(this);var a=this.$a("waffle-assistant-answers-card-remove");this.ma.Ya(a);this.C.setVisible(this.J);qV(a,"Remove card",0);this.getHandler().Oc(this.ma,"action",this.CYb).Oc(this.F,"action",this.mAb).V(this.C,"action",this.nrb)};
q.ED=function(a){LV(this).appendChild(Xr(Bhc,{pFa:lhc(this.O),showHelp:this.J}));if(im){var b=Xr(Chc);this.oa().appendChild(this.Da,b);this.F.Ya(this.$a("waffle-assistant-answercard-feedback-link"))}this.J&&this.C.Ya(this.$a("waffle-assistant-answers-helpcenter-link"));a()};q.Zja=g("qa");q.a8=g("O");q.mAb=function(){this.F.setVisible(!1);S(this.$a("waffle-assistant-answercard-feedback-container"),!1);this.dispatchEvent(new J("trigger_feedback"))};
q.CYb=function(){var a=new oV;P(a,3,!1);P(a,8,Am);var b=new eT;pj(b,4,a);a=new Ko;pj(a,46,b);b=pp(op(new np,10),a).Ha();this.Aa.Tb(2753,b);this.dispatchEvent(new J("rc"))};q.nrb=function(){Q.Eo.Nb()};function Dhc(a,b,c,d){var e=new Bfc;P(e,2,c);A(b,function(a){O(e,1).push(a)});P(e,3,d);d=new nV;P(d,1,a);P(d,3,b[c]);pj(d,11,e);return d}function Ehc(a,b,c,d){var e=new Dfc;P(e,2,c);A(b,function(a){O(e,1).push(a)});P(e,3,d);d=new nV;P(d,1,a);P(d,2,b[c]);pj(d,10,e);return d}function Fhc(a){var b=new Efc;A(a,function(a){a=a.type;O(b,1).push(a)});return b}function Ghc(a){var b=new Cfc;A(a,function(a){a=a.type;O(b,1).push(a)});return b};function Hhc(a){KV.call(this,new FV,a);this.C=this.oa().createElement("div");vn(this.C,"Previous")}z(Hhc,KV);q=Hhc.prototype;q.xD=function(){Np(this.Da,"Previous questions below")};q.va=function(){Hhc.$.va.call(this);Sp(this.Da,"waffle-assistant-card");Qp(this.Da,"waffle-assistant-answers-previousheadercard")};q.ED=function(a){0<this.oa().ri(LV(this)).length||LV(this).appendChild(this.C);a()};q.D$=Nf;q.YB=n("assistantAnswersFeedback");function Ihc(a){var b;b=""+(a.title?'<div class="waffle-assistant-suggestionscard-header">'+U(a.title)+"</div>":"");var c;c=ms("Suggested question");b+='<div class="waffle-assistant-suggested-questions">';a=a.hSb;for(var d=a.length,e=0;e<d;e++){var f=a[e];b+='<div class="waffle-assistant-answercard-question-container" tabindex="0"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+W(c)+'">'+U(Wu({icon:"docs-icon-img docs-icon-help"}))+'</div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">'+
U(f)+"</div></div></div>"}return V(b+"</div>")};function TV(a,b,c,d,e){KV.call(this,a,e);this.F=c;this.C=d;this.J=b}z(TV,KV);q=TV.prototype;q.OF=function(){return Cb([Jhc,UV],this.C)?2799:Cb([Khc,VV],this.C)?2801:null};q.MF=function(){return Cb([Jhc,UV],this.C)?2798:Cb([Khc,VV],this.C)?2800:null};q.S8=n("Were these interesting?");q.Mka=n("Interesting");q.Lka=n("Not interesting");q.YB=n("assistantAnswersFeedback");q.xD=function(){var a=this.C.title;a&&this.F?Np(this.Da,a+(" for question : "+this.F)):Np(this.Da,"Suggested questions")};
q.ED=function(a){this.J.then(function(b){if(0==b.length)S(this.Da,!1);else{var c=this.oa(),d=LV(this);if(0==c.ri(d).length){var e=Xr(Ihc,{title:this.C.title,hSb:wb(b,function(a){return a.query})});d.appendChild(e);var f=wb(b,function(a){return a.type}),d=this.Bj("waffle-assistant-answercard-question-container");A(d,function(a,d){var e=new tt("",new IV,c);this.Ma(e);e.Ya(a);this.getHandler().V(e,"action",y(this.TBb,this,b[d],f,d))},this)}}a()},null,this)};
q.TBb=function(a,b,c){this.dispatchEvent(new uhc(this.C.U2,a.Oo||null,b,c,this.C.RY,a.query))};var Lhc={title:"",RY:0,U2:null},Jhc={title:"",RY:5,U2:1},UV={title:"Suggested questions",RY:5,U2:1},VV={title:"Did you mean?",RY:2,U2:4},Khc={title:"Related questions",RY:4,U2:4};function Mhc(a,b){var c=[],d={};if(a>b*b)for(var e=0;e<b;e++){var f;do f=Math.floor(Math.random()*a);while(d[f]);d[f]=1;c.push(f)}else{for(e=0;e<a;e++)c.push(e);for(e=0;e<b;e++)d=Math.floor(Math.random()*(a-e)+e),f=c[e],c[e]=c[d],c[d]=f}return c.slice(0,b)}function WV(a){return Mhc(a,1)[0]}function Nhc(a){var b=0;A(a,function(c,d){c.length>a[b].length&&(b=d)});return wb(a[b],function(b,d){return wb(a,function(a){return a[d]})})};function Ohc(a){this.F=[];this.D={};this.L=a;this.C=new uO}function Phc(a,b,c,d){function e(a){return a.toLowerCase()}Qb(b,void 0,e);Qb(c,void 0,e);Qb(d,void 0,e);A(b,a.J,a);A(c,a.J,a);A(d,a.J,a)}Ohc.prototype.J=function(a){var b=a.toLocaleLowerCase(),c=0;if(100>b.length)for(var d=0;d<b.length&&3>c;++d)if(0==d||/[^a-zA-Z0-9]/.test(b[d-1])&&!/[^a-zA-Z0-9]/.test(b[d])){++c;var e=a,f=b.substr(d),h=this.C.get(f);h||(h=[],this.C.add(f,h));h.push(e)}};
function Qhc(a,b){a.D[b.toLowerCase()]||(a.D[b.toLowerCase()]=b)}Ohc.prototype.zH=function(a,b,c){var d;if(Va(a||"")){d=this.L.Qm();d=Rhc(this,a.substring(0,d));var e=Shc(this,b-d.length,a);d=Lb(d,e)}else d=Shc(this,b);d.length>b&&(d=Pb(d,0,b));c(a,d)};
function Shc(a,b,c){var d=c||"";c=cc(a.D,function(a){return La(a,d)});var e=Thc(hc(c),d?1:2,1);a=vb(a.F,function(a){return La(a.query,d)&&!e[a.query.toLowerCase()]});b=Thc(a,b-gc(e),2);b=hc(b);var f=wb(b,function(a,b){a.cta=b;return a.zUa});A(b,function(a){a.ata=f});return Lb(b,hc(e))}
function Rhc(a,b){for(var c=[],d=3,e={},f=b.toLowerCase(),h=0;h<f.length&&0<d;++h)if(0==h||" "==f[h-1]&&" "!=f[h]){var k={},l=0,m=f.substr(h),p=a.C.Ke(m);A(p,function(a){var b=a.length-m.length;l=Math.max(b,l);a=this.C.get(a);k[b]||(k[b]=[]);Ob(k[b],a)},a);for(p=0;p<=l&&0<d;++p){var r=k[p];if(r)for(var u=0;u<r.length&&0<d;++u){var w=r[u];bb(b.toLowerCase(),w.toLowerCase())||e[w]||(--d,c.push({text:w,Oo:"",tA:0,vBa:f.length-h,zUa:void 0,ata:[],cta:-1}),e[w]=!0)}}}return c}
function Thc(a,b,c){b=Mhc(a.length,Math.min(a.length,b));var d={};A(b,function(b){b=a[b];var e=za(b)?b:b.query;d[e.toLowerCase()]={text:e,Oo:za(b)?"":b.Oo,tA:c,vBa:0,zUa:za(b)?void 0:b.type,ata:[],cta:-1}});return d};function XV(){MG.call(this,"",null,!1)}z(XV,MG);XV.prototype.eD=function(a,b){if(2==a.tA||1==a.tA)return XV.$.eD.call(this,a.text,b);var c=this.La(),d=this.Qm(),e=" "==c[d];void 0==c[d]&&(c=c.trim(),d>c.length&&(d=c.length));var f=c.substring(0,d-a.vBa)+a.text;e||(f+=" ");a=XV.$.eD.call(this,{toString:function(){return f+c.substring(d)}},b);this.w2(f.length);b=this.lk;b.blur();b.focus();return a};
XV.prototype.gh=function(a){var b=XV.$.gh.call(this,a);b||39!=a.keyCode||a.ctrlKey||a.shiftKey||(b=this.C,X4a(b)&&b.cG()&&a.preventDefault(),b=!0);return b};function Uhc(){return V('<div class="waffle-assistant-answers-ac-suggestion"><div class="waffle-assistant-answers-ac-suggestion-icon-container"><div class="waffle-assistant-answers-ac-suggested-query-icon">'+U(Wu({icon:"docs-icon-img docs-icon-help"}))+'</div><div class="waffle-assistant-answers-ac-session-query-icon">'+U(Wu({icon:"docs-icon-img docs-icon-clock"}))+'</div><div class="waffle-assistant-answers-ac-entity-icon">'+U(Wu({icon:"docs-icon-img docs-icon-arrow-tilted"}))+'</div></div><span class="waffle-assistant-answers-ac-suggestion-text"></span></div>')}
;function Vhc(a){this.Za=a||Rm()}
Vhc.prototype.JN=function(a,b,c){b=Xr(Uhc);var d=this.Za.$a("waffle-assistant-answers-ac-suggestion-text",b);a=a.data;this.Za.Xf(d,a.text);var d=this.Za.$a("waffle-assistant-answers-ac-entity-icon",b),e=this.Za.$a("waffle-assistant-answers-ac-suggested-query-icon",b),f=this.Za.$a("waffle-assistant-answers-ac-session-query-icon",b);S(d,0==a.tA);S(e,2==a.tA);S(f,1==a.tA);d="";switch(a.tA){case 0:d="waffle-assistant-answers-ac-row-entity";break;case 1:d="waffle-assistant-answers-ac-row-session-query";break;
case 2:d="waffle-assistant-answers-ac-row-suggested-query"}d&&Qp(c,d);this.Za.appendChild(c,b)};function YV(a,b,c,d,e,f,h,k,l,m){rV.call(this,m);this.ue=c;this.Gg=d;this.ag=e;this.bf=a;this.ib=h;this.Qg=l;this.Aa=this.Z=this.L=this.eb=null;this.qa=new XV;this.qa.eGa=!0;this.qa.Aa=!0;this.Fa=new Ohc(this.qa);a=new KG(null,new Vhc(m));this.J=new GG(this.Fa,a,this.qa);H(this,this.J);this.F=f;this.Oa=this.O=null;this.Ub=k;this.Ua=!1;this.Ka=op(new np,10).Ha();this.He=new Ui;this.Ia={};this.ea=this.qc=this.D=this.Qb=null;this.Tc=[];this.Gc=[];this.Se=yJ.getInstance();this.bb=""}z(YV,rV);q=YV.prototype;
q.va=function(){YV.$.va.call(this);var a=this.J.Ne();a.className="waffle-assistant-answers-ac-renderer";a.zV="waffle-assistant-answers-ac-row";a.z5="waffle-assistant-answers-ac-active";a.Ana="waffle-assistant-answers-ac-highlighted"};q.Ja=function(){YV.$.Ja.call(this);this.qa.C=this.J;this.J.X5=!1;this.J.Gaa=6;this.getHandler().V(this.J,"update",this.fkb);this.VH(null==this.O)};
q.Uqa=function(a,b){YV.$.Uqa.call(this,a,b);b=this.oa();var c=this.ma;b.appendChild(a,Xr(Ahc));this.qc=b.$a("waffle-assistant-answers-input",a);this.ea=b.$a("waffle-assistant-answers-query-box",a);this.L=new tt("",new IV,this.oa());c.Ma(this.L);this.L.Ya(b.$a("waffle-assistant-answers-clear-query-button",this.ea));this.Aa=new eV(!1,"#4285f4");c.Ma(this.Aa);this.Qb=b.$a("waffle-assistant-answers-spinner-container",this.ea);this.Aa.render(this.Qb);this.D=b.$a("waffle-assistant-answers-input-box",this.ea);
l5a(this.qa,this.D);qV(this.L.getElement(),"Clear query");c.getHandler().V(this.ea,"submit",y(this.BDb,this)).V(this.ea,"focus",y(this.jFa,this,!0),!0).V(this.ea,"blur",y(this.jFa,this,!1),!0).V(this.L,"action",y(this.$4a,this)).V(this.D,"input",y(this.uTb,this)).V(this.D,"focus",y(this.MOb,this));this.L.setVisible(!1)};q.T6=function(){n5a(this.qa,this.D);this.L.setVisible(!1);this.Aa.dispose();this.Aa=null;YV.$.T6.call(this)};
q.VH=function(a){if(this.qc){S(this.qc,!a);var b=Tv;b&&b.dispatchEvent("resize")}a?bl(function(){YV.$.VH.call(this,a)},300,this):YV.$.VH.call(this,a)};q.Wh=da("eb");function Whc(a,b,c){var d=wb(Ec(c,1),function(a){return a.getName()}),e=[],f=[];A(Ec(c,2),function(a){e.push(a.getName());f=f.concat(Ec(a,2))});Phc(a.Fa,d,e,f);Xhc(a.bf).then(function(a){this.Fa.F=a},null,a);a.O=b;a.Oa=c;a.VH(null==b)}q.reset=function(){GT(this.Ia);GT(this.Fa.D);var a=this.Fa;a.F=[];a.C.clear();this.Z=null};
function Yhc(a){if(a.Jc()&&(Zhc(a),null!=a.O))for(var b=jA(a.ue),c=b.Fd(),c=wb(hc(Zg),c.K3,c),c=wb(c,Ea(vh,a.O.rect)),d=0;d<c.length;d++)if(c[d]&&Dh(c[d])){var e=bT(b,c[d],"waffle-assistant-answers-styled-rect");H(a,e);WG(mI(b),e,!0);e.setVisible(!0);a.Tc.push(e);e=TH(b,c[d],"waffle-assistant-answers-styled-border",1,0);H(a,e);e.setVisible(!0);a.Gc.push(e)}}function Zhc(a){Ic(a.Tc);Ic(a.Gc);a.Tc=[];a.Gc=[]}
q.fkb=function(a){if(a.row)if(a=a.row,2==a.tA){var b=Dhc(1,a.ata,a.cta,2);$hc(this,b,a.Oo);this.F.Tb(2652,this.Ka)}else 0==a.tA?(this.Ua=!0,this.F.Tb(2651,this.Ka)):1==a.tA&&(b=new nV,P(b,1,3),$hc(this,b))};q.jFa=function(a){Up(this.ea,"waffle-assistant-answers-query-box-focused",a);this.J.jg()&&!a&&this.J.Tj()};q.uTb=function(){this.L.setVisible(!!bhc(this.D))};q.MOb=function(){this.J.pw(this.D);var a=Ra(bhc(this.D));this.qa.w2(a.length);U4a(this.J,a||"  ");this.J.update(!0)};
function $hc(a,b,c){var d=a.Qg.L.Ar();P(b,13,d);var e=new oV;pj(e,5,b);d=Va(bhc(a.D));if(!a.eb||3<=a.eb.getStatus().getState().C)c=phc(d,2),aic(a,c,!1,e);else{if(d&&a.O)if(a.Ia[d])a.F.Tb(2681,a.Ka),c=a.Ia[d],c!=sb(a.C)&&(1<a.C.length&&bic(a),cic(a,c.a8()),Pfc(a,c));else{var f=dic(),h=nj(nj(f,eT,46),oV,4);P(h,2,a.Ua);f=pp(op(new np,10),f).Ha();a.F.Tb(2635,f);a.Ua=!1;f=Jw(a.O.rect);b=Xk(zj(Yk(Bj(Cj(a.eb.eg("/answers/parse").vg("q",d,"qt",O(b,1),"gid",a.O.xd,"range",f),y(a.Lk,a,d,e)),y(a.zYb,a,d,e)),
"POST"),2));c&&b.vg("sgfml",c);b.qf();a.bb=zJ(a.Se,vj.Uua);eic(a,!0)}else chc(a.D,"");a.D.blur();a.L.setVisible(!!d);a.J.jg()&&a.J.Tj()}}q.BDb=function(a){a.stopPropagation();a.preventDefault();a=new nV;P(a,1,2);$hc(this,a)};q.$4a=function(){chc(this.D,"");this.L.setVisible(!1)};q.zYb=function(a,b){if(this.O){var c=O(nj(b,nV,5),1),c=1==c||4==c?Ffc.mza:Ffc.Oza,d=dic(),e=nj(nj(d,eT,46),oV,4);P(e,1,c);P(b,1,c);c=pp(op(new np,10),d).Ha();this.F.Tb(2640,c);fic(this,a,b)}};
function fic(a,b,c){eic(a,!1);b=phc(b,3);aic(a,b,!1,c);gic(a)}
q.Lk=function(a,b,c){this.O&&this.Ub.C.D.Ce.then(function(){var d=null,e=null,f=!1,h=nj(b,nV,5),k=O(h,1),l=dic(),k=1==k||4==k?Ffc.mza:Ffc.Oza,m=nj(nj(l,eT,46),oV,4);P(m,1,k);P(b,1,k);l=pp(op(new np,10),l).Ha();if(c.El()){e=this.He.Ad(wV.Ea(),c.xg());if(f=e.getStatus()){var p;switch(f){case 1:p=2639;break;case 2:p=2643;break;case 3:p=2644;break;case 4:p=2638;break;case 5:p=2707;break;case 6:p=2706}p&&this.F.Tb(p,l)}p=D(e,10);P(h,4,p);p=D(e,11);P(h,5,p);if(1==f){fic(this,a,b);return}if(2==f){e=-1!=
hic(a);h=-1!=fhc(a);d=4;f=nj(b,nV,5);e?(d=5,P(f,8,2)):h&&(d=7,P(f,8,1));h=phc(a,d);e?(e=new SV(h,!0,this.F,!0,this.oa()),iic(this,h,e,b)):aic(this,h,!0,b);eic(this,!1);gic(this);return}p=e.hasFormula()?D(e,2):null;f=!0;if(p){d=jic(this.Ub,p,this.O,!!this.Oa&&!!D(this.Oa,4));P(h,14,!!d);if(!d){if(h=p.match(/([A-Z]*)\(/))k=nj(nj(mua(l),eT,46),oV,4),P(k,7,h[1]),P(b,7,h[1]);this.F.Tb(2645,l)}d=new ghc(a,d,"="!=p[0]?"="+p:p,e,null)}else zc(e,9)&&(l=e.getError(),d=phc(a,6,e),p=D(l,2),P(h,6,p),zc(l,3)&&
(l=D(l,3),P(h,12,l)))}else this.F.Tb(2640,l);d||(d=phc(a,4,e));eic(this,!1);1==d.error&&null!=d.Oo?kic(this,d,f,b):aic(this,d,f,b);gic(this)},function(){fic(this,a,b)},this)};function gic(a){""!=a.bb&&(AJ(a.Se,a.bb),a.bb="")}function lic(a){if(null!=a.Oo)return Khc;switch(a.error){case 4:return 0<a.F.length?VV:UV;case 5:return UV;case 6:return VV}return Lhc}function dic(){var a=new oV;P(a,8,Am);var b=new eT;pj(b,4,a);a=new Ko;pj(a,46,b);return a}
function hic(a){return Bb(dhc,function(b){return La(a,b)})}function mic(a,b){var c=[];b=b.F;for(var d=0;d<b.length&&3>c.length;++d)if(nic(a.Ub,D(b[d],2),a.O,!!a.Oa&&!!D(a.Oa,4))){var e={query:D(b[d],1),Oo:D(b[d],2),type:b[d].getType()};c.push(e)}return Kj(c)}function kic(a,b,c,d){c=new RV(b,a.ue,a.Gg,a.ag,a.F,a.ib,c,a.oa());iic(a,b,c,d)}function aic(a,b,c,d){c=new SV(b,c,a.F,!1,a.oa());iic(a,b,c,d)}
function iic(a,b,c,d){bic(a);cic(a,b,d).then(function(){if(d){var a=dic(),b=nj(a,eT,46);pj(b,4,d);a=pp(op(new np,10),a).Ha();this.F.Tb(2781,a)}},null,a);oic(a,c);pic(a);1==b.error&&null!=b.Oo&&Qhc(a.Fa,b.C);c.Zja()&&(a.Ia[b.C]=c);a.getHandler().V(c,"rc",a.Jyb)}function bic(a){qic(a);0!=a.C.length&&(a.Z?Pfc(a,a.Z):(a.Z=new Hhc(a.oa()),oic(a,a.Z)))}function qic(a){A(a.C,function(a){a instanceof RV||a instanceof SV||a==this.Z||this.FN(a)},a)}
function cic(a,b,c){var d=lic(b),e=null;d==Khc||d==VV?0<b.F.length&&(e=mic(a,b)):d==UV&&(e=ric(a.bf));if(e){var f=new TV(new FV,e,b.C,d,a.oa());oic(a,f);a.F.Tb(2769,a.Ka);a.getHandler().V(f,"sqc",y(a.SBb,a));return e.then(function(a){if(c){var b=nj(c,nV,5);Cb([Khc,VV],f.C)?(a=Fhc(a),pj(b,7,a)):Cb([Jhc,UV],f.C)&&(a=Ghc(a),pj(b,9,a))}},null,a)}return Kj()}q.SBb=function(a){chc(this.D,a.Z);this.D.focus();var b=a.Ia,b=1==b?Dhc(b,a.C,a.F,3):Ehc(b,a.C,a.F,a.Oa);$hc(this,b,a.ea);this.F.Tb(2762,this.Ka)};
function eic(a,b){S(a.Qb,b);S(a.oa().$a("waffle-assistant-answers-button-container",a.ea),!b);a.Aa&&a.Aa.setActive(b)}function oic(a,b){b.mf(a.Pd());a.C.push(b);a.vf&&(a.R.Mi(b,0,!0),b.CB());sV(b,!0)}function pic(a){for(var b=a.C;5<b.length;)a.FN(b[0])}q.k6=function(){YV.$.k6.call(this);this.reset()};
q.Jyb=function(a){var b=this.oa();a=a.target;a instanceof RV?(this.FN(a),zhc(this.ib,"Answer removed",b,y(this.Kyb,this,a))):a instanceof SV&&(this.FN(a),zhc(this.ib,"Card removed",b));b=this.C;!this.Z||b[0]!=this.Z&&b[b.length-1]!=this.Z||(this.FN(this.Z),this.Z=null)};q.Kyb=function(a){kic(this,a.a8(),a.Zja());zhc(this.ib,"Remove answer undone",this.oa())};q.FN=function(a){if(a.Jc()){if(a instanceof RV||a instanceof SV)delete this.Ia[a.a8().C],a==sb(this.C)&&qic(this);YV.$.FN.call(this,a)}I(a)};function sic(){var a;a=""+(V('<div class="waffle-assistant-answers-logging-message-container"><div class="waffle-assistant-answers-logging-message"><span class="waffle-assistant-answers-logging-text">We\'re logging your queries and data to improve the feature.</span><div class="waffle-assistant-answers-learn-more">Learn More</div><div class="waffle-assistant-answers-logging-opt-out">Opt-out for this file</div></div></div>')+'<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container"><div class="waffle-assistant-answers-search-icon">'+
U(Wu({icon:"docs-icon-img docs-icon-search-this-document"}))+'</div><input class="waffle-assistant-answers-input-box" placeholder="'+rs("Ask a question about your data")+'" /></div></form></div>');return V(a)};function tic(a,b){this.C=a;this.D=b}function jic(a,b,c,d){b="="!=b[0]?"="+b:b;var e=hw(a.D),e=null!=e?e.toString():"0",f=0,h=0;ritz.getActiveFilterId(e)&&c&&(c=c.rect,ritz.getNumberOfRows(e)>c.$c()+1?f=c.$c()+1:ritz.getNumberOfColumns(e)>c.fd()+1&&(h=c.fd()+1));(a=ofc(a.C,b,e,f,h))&&d&&(a=Nhc(a));return a}function nic(a,b,c,d){if(a=jic(a,b,c,d))for(b=1<a.length?1:0;b<a.length;b++){c=!1;d=a[b];for(var e=0;e<d.length;e++)if(!d[e]){c=!0;break}if(!c)return!0}return!1};function uic(a){var b=[];if(zc(a,25)&&(a=D(a,25)))for(var c=0;c<Ac(a,1);c++){var d=D(a,1,c);if(zc(d,2)){var e=D(d,2);e&&b.push(vic(e,wic(d)))}}return b}function xic(a){var b=uic(a);zc(a,6)&&(a=D(a,6))&&b.push(vic(a,0));return b}function wic(a){return(a=zc(a,4)?D(a,4):0)?a:0}function vic(a,b){return{name:a,jAa:b}};function yic(a,b,c){this.qa=a;this.Aa=b;this.D=[];this.F=[];this.O=[];this.R=[];this.Z=[];this.ea=[];this.C=new ng;this.L=new ng;this.ma=new ng;this.J=new ng;zic(this,c)}function Aic(a,b){return pg(a,b)?a.get(b).values.Id():[]}
function zic(a,b){for(var c=new ug,d=new ug,e=0;e<b.length;e++){for(var f=xic(b[e]),h=[],k=[],l=0;l<f.length;l++){var m=f[l].name.toLowerCase();if(pg(a.qa,m)){var p=a.qa.get(m);c.add(p);h.push(p)}pg(a.Aa,m)&&(m=a.Aa.get(m),d.add(m),k.push(m))}Bic(a,h,k)}a.D=c.Id();a.F=d.Id();Tb(a.D);Tb(a.F);a.O=wb(a.C.Id(),function(a){return a.key});Tb(a.O);a.R=wb(a.L.Id(),function(a){return a.key});Tb(a.R);a.Z=wb(a.ma.Id(),function(a){return a.key});Tb(a.Z);a.ea=wb(a.J.Id(),function(a){return a.key});Tb(a.ea)}
function Bic(a,b,c){for(var d=0;d<b.length;d++)for(var e=d+1;e<b.length;e++)ZV(a.C,b[d],b[e]),ZV(a.C,b[e],b[d]);for(d=0;d<b.length;d++)for(e=0;e<c.length;e++)ZV(a.L,b[d],c[e]),ZV(a.ma,c[e],b[d]);for(d=0;d<c.length;d++)for(e=d+1;e<c.length;e++)ZV(a.J,c[d],c[e]),ZV(a.J,c[e],c[d])}function ZV(a,b,c){var d;pg(a,b)?d=a.get(b).values:d=new ug;d.add(c);a.set(b,{key:b,values:d})};function Cic(a,b){this.C=a;for(var c=new ng,d=0;d<Ac(a,2);d++)c.set(a.Od(d).getName().toLowerCase(),d);this.R=c;c=new ng;for(d=0;d<Ac(a,1);d++)c.set(D(a,1,d).getName().toLowerCase(),d);this.qa=c;c=[];for(d=0;d<Ac(a,2);d++)$V(a.Od(d).getName())&&c.push(d);this.L=c;c=[];for(d=0;d<Ac(a,1);d++)$V(D(a,1,d).getName())&&c.push(d);this.O=c;c=[];for(d=0;d<Ac(a,1);d++){for(var e=D(a,1,d).getName(),f=!0,h=0;h<Dic.length;h++)if(-1!=e.search(new RegExp("(\\b|_)"+Dic[h]+"(\\b|_)","i"))){f=!1;break}f&&c.push(d)}this.Aa=
c;this.ma=Eic(a,0);this.Z=Eic(a,1);c=[];for(d=0;d<Ac(a,2);d++).8<=D(a.Od(d),6)&&c.push(d);this.ea=c;c=[];for(d=0;d<Ac(a,2);d++)e=a.Od(d),.95<=Ec(e,2).length/D(e,8)&&c.push(d);this.Ia=c;c=[];for(d=0;d<Ac(a,3);d++)f=a.Od(D(a,3,d)),e=Ec(f,2).length/D(f,8),f=Ac(f,3)/Ac(f,2),.5<e||.3>f||c.push(D(a,3,d));this.Fa=c;this.F=Fic(Ac(a,2));this.J=Fic(Ac(a,1));this.D=new yic(this.R,this.qa,b)}function Fic(a){for(var b=[],c=0;c<a;c++)b.push(c);return b}
function Eic(a,b){for(var c=[],d=0;d<Ac(a,2);d++)a.Od(d).getType()==b&&c.push(d);return c}function Gic(a,b){if(0==a.length&&0==b.length)return-1;for(var c=0<a.length?a[0]:b[0],d=1;d<a.length;d++)c=Hic(c,a[d]);for(d=0;d<b.length;d++)a=c,c=Hic(a,b[d]),c=0<c.length?c:a;return 0<c.length?c[WV(c.length)]:-1}function aW(a,b,c,d,e,f){var h=[a.L,a.D.D],k=[a.F];b&&(k.push(a.ma),k.push(a.ea));c&&k.push(a.Fa);d&&k.push(a.Ia);null!=f&&-1!=f?h.push(Aic(a.D.L,f)):e&&h.push(a.D.R);return Gic(k,h)}
function bW(a,b,c){var d=[a.O,a.D.F],e=[a.J];b&&e.push(a.Aa);c&&d.push(a.D.Z);return Gic(e,d)}function Iic(a,b){for(var c=5;;){var d=a.C.Od(b),e=WV(Ac(d,2));c--;if($V(AV(d,e))||0==c)return e}}function cW(a,b){b=a.C.Od(b);a=b.getName();$V(a)||(b=Jic(Ec(b,7)),a=null==b?a:b);return a}function dW(a,b){b=D(a.C,1,b);a=b.getName();$V(a)||(b=Jic(Ec(b,2)),a=null==b?a:b);return a}function Jic(a){for(var b=0;b<a.length;b++)if($V(a[b]))return a[b];return null}function $V(a){return null==a?!1:50>=a.length}
function Kic(a){for(var b=Mhc(a.length,2),c=[],d=0;d<b.length;d++)c.push(a[b[d]]);return c}function Hic(a,b){for(var c=[],d=0,e=0;d<a.length&&e<b.length;)a[d]==b[e]?(c.push(a[d]),d++,e++):a[d]<b[e]?d++:e++;return c}var Dic=["average","total","sum","mean","median"];function Lic(a,b){this.C=[];this.F=[];this.J=this.Z=this.L=this.D=null;this.R=new ug;this.O=new ug;this.ea=a;this.qa=b;this.ma=op(new np,10).Ha()}Lic.prototype.reset=function(){this.C=[];this.F=[];this.D&&(this.D.cancel(),this.D=null);this.O=new ug;this.R=new ug};Lic.prototype.Wh=da("J");function Xhc(a){return koa&&a.D?a.D.then(function(){return this.F.slice()},null,a):Kj(a.C.slice())}
function Mic(a){if(!a.C)throw Error("Suggestions not generated. Must call generate() at the top level");return 0<a.C.length?a.C[0].query:""}function Nic(a){Tb(a,function(a,c){return c.weight-a.weight});return wb(a,function(a){return a.bta})}
function Oic(a){switch(a){case 13:return.3;case 3:return.38;case 12:return.31;case 5:return.33;case 2:return.49;case 8:return.69;case 9:return.37;case 14:return.57;case 11:return.45;case 7:return.42;case 10:return.36;case 1:return.44;case 15:return.3;case 16:return.3;default:return.3}}function eW(a,b,c,d,e){e=Math.pow(Math.random(),1/(Oic(d)*(void 0===e?1:e)));a.O.contains(c)||(b.push({bta:{query:c,Oo:void 0,type:d},weight:e}),a.R.add(d),a.O.add(c))}function fW(a,b){return!a.R.contains(b)}
function ric(a){return Xhc(a).then(function(a){return 3>=a.length?a:Pb(a,0,3)},null,a)}function Pic(a,b){var c=[];b=uic(b);for(var d=0;d<b.length&&-1!=a.qa.get(b[d].name.toLowerCase(),-1);d++)c.push(b[d]);return c}function Qic(a){switch(a){case 6:return"Sum";case 1:return"Average";case 4:return"Count"}return null}function Ric(a){a:{if(0<a.length)for(var b=0;b<a.length;b++)switch(a[b]){case 5:a=Sic;break a;case 4:a=Tic;break a}a=Uic}return a[WV(a.length)]}
function Vic(a){var b=null;a.D=new Ij(function(a){if(!this.J||3<=this.J.getStatus().getState().C)this.F=this.C,a();var c=Jw(this.L.rect),e=wb(this.C,function(a){return a.query});b=Yk(Xk(zj(Bj(Cj(this.J.eg("/answers/parsesuggestions").vg("gid",this.L.xd,"range",c),y(function(b){Wic(this,b).then(a)},this)),y(function(b){8==b.errorCode&&this.qa.Tb(2833,this.ma);this.F=this.C;a()},this)).setContent(["queries",fj(e)]).setTimeout(2E3),1)),"POST").qf()},a);Pj(a.D,function(){b&&b.dispose()})}
function Wic(a,b){return a.ea.C.D.Ce.then(function(){var a=[];if(b.El())for(var d=b.xg(),e=0;e<d.length;e++)d[e]&&nic(this.ea,d[e],this.L,!!this.Z&&!!D(this.Z,4))&&(this.C[e].Oo=d[e],a.push(this.C[e]));this.F=a},function(){this.F.length=0},a)}var Xic="Minimum Maximum Most Least Highest Lowest".split(" "),Uic=["Average","Median"],Sic=["Total","Average","Median"],Tic=["Median"],Yic=["before","after"];function gW(a,b,c,d,e,f,h,k){tV.call(this,1,f,e,k);this.Ua=c;this.qa=null;this.ea=new tt("",new HV,this.oa());this.Ma(this.ea);this.ma=new tt("",new HV,this.oa());this.Ma(this.ma);a=new Mnb(a,!0,!0);a=new tic(a,c);this.L=new Lic(a,e);this.C=new YV(this.L,0,b,c,d,e,this.Oa,a,h,k);this.F=this.Aa=null;this.Qa=op(new np,10).Ha()}z(gW,tV);
var Zic={f_a:"waffle-assistant-answers-input-box",J0a:"waffle-assistant-answers-query-box",tnc:"waffle-assistant-answers-query-box-focused",t_a:"waffle-assistant-answers-learn-more",Fic:"waffle-assistant-answers-logging-message-container",m0a:"waffle-assistant-answers-logging-opt-out"};q=gW.prototype;q.va=function(){gW.$.va.call(this);var a=Xr(sic);this.oa().appendChild(Qfc(this),a)};
q.Ja=function(){gW.$.Ja.call(this);var a=this.$a(Zic.J0a),b=this.$a(Zic.f_a);this.ma.Ya(this.$a(Zic.m0a));this.ea.Ya(this.$a(Zic.t_a));this.getHandler().V(a,"focus",this.Zxb,!0).V(a,"blur",this.Xxb,!0).V(a,"mouseover",this.ayb).V(a,"mouseout",this.$xb).V(a,"click",this.Yxb).V(b,"input",this.AYb).V(this.ma,"action",this.vwb).V(this.ea,"action",this.etb).V(qw(this.Ua),"Ib",xbc(this.BYb,25,this));this.setVisible(null!=this.Aa);$ic(this,joa&&noa&&Dm("showAnswersLoggingOptOut"))};q.JTa=Nf;q.vMa=Of;
q.jsa=Nf;q.getTitle=n("Answers");q.rua=n(1);q.Vga=function(a){return 3==a||0==a};q.qua=function(a,b){Tb(a,function(a,b){return b.xV()-a.xV()});for(var c=[],d=null,e=0;e<a.length;e++){var f=Fc(a[e],1);3==f?d=a[e]:0==f&&c.push(a[e].getAutovisRecommendation())}d&&d.xV()?(e=b||null,0<Ac(d,4)?ajc(this,ZS(d.EL()),D(d,9),c):ajc(this,e,D(d,9),c),this.F||(gW.$.qua.call(this,a,b),this.getHandler().V(this.F,"sqc",this.RBb))):this.rW(!0)};
q.B6=function(a){if(!this.F){var b=ric(this.L);this.F=new TV(a,b,"",Jhc,this.oa())}return this.F};q.nCa=g("C");q.pna=function(){return this.Va()};
q.rW=function(a,b,c){this.L.reset();(a||b)&&this.F&&(gW.$.rW.call(this,a,b,c),this.F.dispose(),this.F=null);if(a||t(b)&&!b)this.F&&(gW.$.rW.call(this,a,b,c),this.F.dispose(),this.F=null),this.Jc()&&(this.L.reset(),this.Aa=null,a=this.C,a.Jc()&&(b=a.Fa,b.F=[],b.C.clear(),a.D&&chc(a.D),a.k6(),a.O=null,a.VH(!0),a.L&&!a.L.isDisposed()&&a.L.setVisible(!1),a.Ua=!1),this.setVisible(!1),this.Xb()&&Zhc(this.C));c&&this.C.reset()};q.Wh=function(a){this.qa=a;this.C.Wh(a);this.L.Wh(a)};
q.setActive=function(a){gW.$.setActive.call(this,a);a?Yhc(this.C):Zhc(this.C)};function $ic(a,b){S(a.$a("waffle-assistant-answers-logging-message-container"),b)}function bjc(a,b){a=a.$a("waffle-assistant-answers-query-box");Up(a,"waffle-assistant-answers-query-box-focused",b)}q.BYb=function(){this.Xb()&&Yhc(this.C)};q.Zxb=function(){bjc(this,!0);Yhc(this.C)};q.Xxb=function(){bjc(this,!1);this.Xb()||Zhc(this.C)};q.ayb=function(){Yhc(this.C)};q.$xb=function(){this.Xb()||Zhc(this.C)};
q.Yxb=function(){cjc(this,"")};q.AYb=function(){var a=this.$a("waffle-assistant-answers-input-box");cjc(this,a.value);a.value=""};q.RBb=function(a){cjc(this,a.Z);var b=Dhc(1,a.C,a.F,1);bl(y(function(a){$hc(this.C,b,a)},this,a.ea),300,this);this.O.Tb(2652,this.Qa)};function cjc(a,b){a.setActive(!0);a.dispatchEvent("assistant-sidepane-set-active-panel");bl(function(){var a=this.C;chc(a.D,b);a.D.focus()},300,a)}
function ajc(a,b,c,d){var e=c||new CV;a.Aa=b;var f=a.L,h=d;f.reset();var h=loa?h:[],k=[],l=new Cic(e,h);if(loa)for(var m=h,p=0;p<m.length;p++){var r=m[p];switch(r.getChartType()){case "BarChart":var u=f,w=l,x=r,C=k;if(fW(u,13)||fW(u,2)){var G=D(x,6);if(G&&-1!=w.R.get(G.toLowerCase(),-1)){var M=Pic(w,x);if(0<M.length){var R=M[WV(M.length)],Y=Qic(R.jAa);Y&&fW(u,13)&&eW(u,C,Y+" of "+R.name+" by "+G,13,1.5)}1<M.length&&fW(u,2)&&eW(u,C,"Correlation between "+M[0].name+" and "+M[1].name,2,1.5)}}break;case "ScatterChart":var fa=
f,ka=l,ca=r,wa=k;if(fW(fa,2)){var xa=Pic(ka,ca);1<xa.length&&eW(fa,wa,"Correlation between "+xa[0].name+" and "+xa[1].name,2,1.5)}break;case "PieChart":var ya=f,Ta=l,Xa=r,nb=k;if(fW(ya,14)){for(var eb,rb=Ta,Rc=[],ed=uic(Xa),xd=0;xd<ed.length&&-1!=rb.R.get(ed[xd].name.toLowerCase(),-1);xd++)Rc.push(ed[xd]);eb=Rc;1==eb.length&&4==eb[0].jAa&&eW(ya,nb,"Distribution of "+eb[0].name,14,1.5)}}}if(fW(f,1)){var de=l.C,Nb=bW(l,!1,!0),Jf=aW(l,!0,!1,!0,!0,Nb);if(-1!=Jf&&-1!=Nb){var db=10<=Ac(de.Od(Jf),2)?"5 ":
"",Ld=cW(l,Jf),Ed=dW(l,Nb);Ld!=Ed&&eW(f,k,"Top "+db+Ld+" by "+Ed,1)}}if(fW(f,2)&&1<Ac(l.C,1)){var Ng;a:if(2>l.J.length)Ng=[-1,-1];else{var wk=Gic([l.J],[l.O,l.D.F,l.D.ea]);if(-1!=wk){var ii=Aic(l.D.J,wk);if(0<ii.length){var xk=[wk],yk=WV(ii.length);xk.push(ii[yk]);Ng=xk;break a}}Ng=Kic(2<=l.O.length?l.O:l.J)}var zk=dW(l,Ng[0]),el=dW(l,Ng[1]);zk!=el&&eW(f,k,"Correlation between "+zk+" and "+el,2)}if(fW(f,3)){var Gm=l.C,Jn=bW(l,!0);-1!=Jn&&eW(f,k,Ric(Ec(D(Gm,1,Jn),3))+" of "+dW(l,Jn),3)}if(fW(f,5)){var jq=
l.C,kq=bW(l,!0,!0),Iv=aW(l,!0,!0,!1,!0,kq);if(-1!=kq&&-1!=Iv){var bt=dW(l,kq),Yb=jq.Od(Iv),Uj=cW(l,Iv);if(0<Ac(Yb,3)&&Uj!=bt){var Zn;a:for(var sq=5;;){var gp=l.C.Od(Iv),WD=WV(Ac(gp,3)),EQ=D(gp,3,WD);sq--;if($V(AV(gp,EQ))||0==sq){Zn=EQ;break a}}eW(f,k,Ric(Ec(D(jq,1,kq),3))+" of "+bt+" when "+Uj+" is "+AV(Yb,Zn),5)}}}if(fW(f,9)){var xt=bW(l,!1,!0),FQ=aW(l,!0,!1,!1,!0,xt);if(-1!=FQ&&-1!=xt){var yt=dW(l,xt),GQ=cW(l,FQ);GQ!=yt&&eW(f,k,GQ+" with "+Xic[WV(Xic.length)]+" "+yt,9)}}if(fW(f,10)&&0<Ac(l.C,1)){var Oz=
dW(l,bW(l));eW(f,k,Xic[WV(Xic.length)]+" "+Oz,10)}if(fW(f,11)){var Pz=l.C,Qz=aW(l,!0,!0,!1,!1,-1);if(-1!=Qz){var jw=cW(l,Qz);0<Ac(Pz.Od(Qz),3)&&eW(f,k,"Most frequent "+jw,11)}}if(fW(f,12)){var HQ=l.C,XD=bW(l,!0),zt;a:{if(1==l.Z.length){var IQ=l.Z[0];if(!D(l.C.Od(IQ),5)){zt=IQ;break a}}zt=-1}if(-1!=zt&&-1!=XD){var JQ=dW(l,XD),vJ=HQ.Od(zt);if(0<Ac(vJ,2)){var KQ=Iic(l,zt);eW(f,k,Ric(Ec(D(HQ,1,XD),3))+" of "+JQ+" "+Yic[WV(Yic.length)]+" "+AV(vJ,KQ),12)}}}if(fW(f,15)){var wJ=l.C,YD=bW(l,!0),$n=aW(l,!1,
!0,!1,!0,YD);if(-1!=YD&&-1!=$n){var Rz=dW(l,YD),ZD=cW(l,$n);if(ZD!=Rz){var Pr=wJ.Od($n);if(2<=Ac(Pr,3)){var $D=Mhc(Ac(Pr,3),2);eW(f,k,"Compare "+Ric(Ec(D(wJ,1,YD),3))+" "+Rz+" for "+ZD+" "+AV(Pr,D(Pr,3,$D[0]))+" and "+AV(Pr,D(Pr,3,$D[1])),15)}}}}if(fW(f,16)){var Sz=l.C,At=aW(l,!0,!0,!1,!1);if(-1!=At){var Tz=cW(l,At);Sz.Od(At);eW(f,k,"List unique values in "+Tz,16)}}var kw=3>k.length;if((kw||0==WV(5))&&fW(f,7)){var aE=l.C,lw=bW(l,!1,!0),mw=aW(l,!1,!1,!1,!0,lw);if(-1!=mw&&-1!=lw){var nw=aE.Od(mw),Bt=
cW(l,mw),bE=dW(l,lw);if(0<Ac(nw,2)&&Bt!=bE){var cE=Iic(l,mw);eW(f,k,"Show "+bE+" for "+Bt+" "+AV(nw,cE),7)}}}if((kw||0==WV(5))&&fW(f,8)){var Ct=l.C,Dt;a:if(2>l.F.length)Dt=[-1,-1];else{var dE=[l.L,l.D.D,l.D.O],eE=[l.F];eE.push(l.ma);eE.push(l.ea);var Et=Gic(eE,dE);if(-1!=Et){var fE=Aic(l.D.C,Et);if(0<fE.length){var ao=[Et],J0=WV(fE.length);ao.push(fE[J0]);Dt=ao;break a}}ao=Kic(2<=l.L.length?l.L:l.F);ao[0]!=Et&&(ao[1]=ao[0],ao[0]=Et);Dt=ao}var UAa=Dt[0];if(1<Ac(Ct,2)&&-1!=UAa){var Y0=Dt[1],qfa=Ct.Od(Y0),
Z0=cW(l,Y0),BJ=cW(l,UAa);if(0<Ac(qfa,2)&&Z0!=BJ){var rfa=Iic(l,Y0);eW(f,k,"What is "+BJ+" where "+Z0+" is "+AV(qfa,rfa),8)}}}f.C=Nic(k);f.L=b;f.Z=e;koa&&Vic(f);a.setVisible(null!=b);Whc(a.C,b,e);a.Xb()&&Yhc(a.C)}q.vwb=function(a){a.stopPropagation();a.preventDefault();this.qa&&(Yk(Bj(Cj(this.qa.eg("/answers/logoptout"),y(this.Otb,this)),y(this.Ntb,this)),"POST").qf(),this.O.Tb(2663,this.Qa))};
q.etb=function(a){a.stopPropagation();a.preventDefault();sp("https://docs.google.com/document/d/1VxpmAx5RTnwmeXyj3IuPPYIXg9DYzTS8nz8pi1E_ZJk/preview",{target:"_blank"})};q.Otb=function(a){a.El()&&$ic(this,!1)};q.Ntb=ba();function djc(){var a;a=""+('<div class="waffle-assistant-banding-recommendation"><div class="waffle-assistant-banding-color-picker-container"></div><div class="waffle-assistant-banding-range-wrapper">Alternating colors for <span class="waffle-assistant-banding-range"></span></div>'+ejc()+"</div>");return V(a)}
function fjc(){return V('<div class="waffle-assistant-conditionalformat-rule-group"><div class="waffle-assistant-conditionalformat-rule-holder" tabindex="0"></div><div class="waffle-assistant-conditionalformat-description"></div>'+ejc()+"</div>")}function ejc(){var a;a=""+U(It({Je:"waffle-assistant-formatting-edit-button",content:ms("Edit"),style:4}));return V(a)};function hW(a,b,c){KV.call(this,a,c);a=wb(this.D.Dga(),Kbc);this.C=new TT(!1,a,7);this.Ma(this.C);this.O=new Jt("",this.oa());this.Ma(this.O);this.ma=b;this.J=!1;this.F=-1}z(hW,KV);var gjc={$da:"waffle-assistant-banding-color-picker-container",kea:"waffle-assistant-formatting-edit-button",wJ:"waffle-assistant-banding-range"};q=hW.prototype;q.va=function(){hW.$.va.call(this);LV(this).appendChild(Xr(djc))};
q.Ja=function(){hW.$.Ja.call(this);this.getHandler().V(this.O,"action",this.bpb).V(this.C,"banding-scheme-changed",this.wkb);this.ma.Tb(2768,void 0)};q.ED=function(a){var b=this.$a(gjc.$da);this.C.render(b);Qbc(this.C);var b=this.$a(gjc.wJ),c=this.D.EL(),d=Kh(c);vn(b,Jw(d));hjc(this,c);b=this.$a(gjc.kea);this.O.Ya(b);a()};q.xD=function(){Np(this.Da,"Suggested alternating background colors");wr(this.C,"Choose a color scheme")};q.YB=n("assistantBandingFeedback");q.OF=n(2672);q.MF=n(2671);
q.bpb=function(a){eo.dispatchEvent({type:"show-banding-pane-recommendation",IRa:this.D,X5a:Rbc(this.C)});a.stopPropagation()};q.wkb=function(a){if(!this.J&&UT(this.C)){var b=this.F;this.F=this.C.Zi();this.F==b?this.dispatchEvent(new pV("assistant-sidepane-remove-banding",this,2797)):this.dispatchEvent(new pV("assistant-sidepane-apply-banding",this,2673));a.stopPropagation()}};
function hjc(a,b){a.J=!0;var c;c=b.wb();b=Kh(b);c=ritz.getWorkbookRangeIntersectingIds(c,b.rc(),b.kc(),b.$c(),b.fd(),7,!1);c.length?(c=ritz.getBandedRangeByWorkbookRangeId(c[0]),c=(new Ui).Ad(Hd.Ea(),c),c=Kbc(c)):c=null;c?(c=Sbc(a.C,c),wI(a.C,c?c.getElement():null)):wI(a.C,null);a.F=a.C.Zi();a.J=!1};function iW(a,b){KV.call(this,a,b);this.C=new Jt("",this.oa());this.Ma(this.C);this.eb=Ec(a,6)}z(iW,KV);var jW={kea:"waffle-assistant-formatting-edit-button",HZa:"waffle-assistant-conditionalformat-format-preview",d1a:"waffle-assistant-conditionalformat-rule-holder",e4:"waffle-assistant-conditionalformat-description",j0a:"one-rule",a2a:"two-rules",O1a:"three-rules",C0a:"waffle-assistant-conditionalformat-format-preview-label"};q=iW.prototype;q.va=function(){iW.$.va.call(this);LV(this).appendChild(Xr(fjc))};
q.Ja=function(){iW.$.Ja.call(this);var a=this.$a(jW.kea);this.C.Ya(a);qV(a,"Apply and edit conditional format rules");this.getHandler().V(this.C,"action",this.Ujb)};q.ED=function(a){vn(this.$a(jW.e4),Fc(this.D,3));var b=this.$a(jW.d1a),c=new ijc(this,this.oa());this.Ma(c);c.Ya(b);qV(b,"Apply conditional format rules");a()};q.xD=v;q.YB=n("assistantConditionalFormatFeedback");q.OF=n(2630);q.MF=n(2629);
q.Ujb=function(){jjc(this);this.dispatchEvent(new pV("assistant-sidepane-change-selection",this,2670,void 0,void 0,Kh(D(this.eb[0],1,0))));jo()};function jjc(a){a.dispatchEvent(new pV("assistant-sidepane-apply-conditional-format-rules",a,2563))}function ijc(a,b){tr.call(this,void 0,void 0,b);this.C=a}z(ijc,tr);
ijc.prototype.Te=function(a){ijc.$.Te.call(this,a);var b=this.C.eb,c;switch(b.length){case 0:break;case 1:c=jW.j0a;break;case 2:case 4:c=jW.a2a;break;default:c=jW.O1a}for(var d=0;d<b.length;d++){var e=b[d],f=bn("DIV");Rp(f,[jW.HZa,c]);var h=bn("DIV");Qp(h,jW.C0a);f.appendChild(h);vn(h,"123");if(zc(e,2)){var k=D(D(e,2),1);switch(D(D(k,1),1)){case 9:case 13:var k=Ec(D(k,1),2)[0],l=Ec(e,1)[0];vn(h,FA(k,Fc(l,1),Fc(l,2),Fc(l,4)))}}bbc(e,f);a.appendChild(f)}};ijc.prototype.Oj=function(){jjc(this.C);return!0};function kjc(a,b,c){tV.call(this,2,b,a,c)}z(kjc,tV);q=kjc.prototype;q.getTitle=n("Formatting");q.Vga=function(a){return 2==a||4==a};q.B6=function(a){var b=D(a,1);switch(b){case 2:return new iW(a,this.oa());case 4:return a=new hW(a,this.O,this.oa()),this.getHandler().V(a,"assistant-sidepane-apply-banding",this.WQb).V(a,"assistant-sidepane-remove-banding",this.GEb),a;default:throw Error("Unsupported recommendation type: "+b);}};
q.WQb=function(a){zhc(this.Oa,"Alternating colors applied",this.oa(),y(this.xkb,this,a.C))};q.GEb=function(){this.Oa.clear()};q.xkb=function(a){this.dispatchEvent(new pV("assistant-undo-pressed",a,2796))};q.mf=function(a){kjc.$.mf.call(this,a);this.setVisible(!a)};q.sua=function(a){return this.Pd()?(this.setVisible(!1),a):kjc.$.sua.call(this,a)};q.rua=n(3);function kW(a,b,c,d){$u.call(this,a,b,c,d,void 0,void 0,!0)}z(kW,$u);kW.prototype.va=function(){kW.$.va.call(this);Qp(this.Da,"waffle-assistant-toast");Qp(this.$a("docs-ui-toast-content"),"waffle-assistant-toast-content")};kW.prototype.$J=function(a,b,c){c=c?c:"waffle-assistant-toast-action";b=Mq(this,b);kW.$.$J.call(this,a,b,c)};kW.prototype.Vi=function(a,b,c,d){this.$J(a,b,d);a=Oq(this,b);Lf(this.getHandler(),a,nd,y(function(){this.setVisible(!1);c()},this))};function ljc(){this.C=null}z(ljc,F);ljc.prototype.clear=function(){this.C&&(this.C.setVisible(!1),this.C.dispose(),this.C=null)};function zhc(a,b,c,d){a.clear();a.C=new kW(b,c,!1,5E3);a.C.render();d&&a.C.Vi("Undo","w-a-u-tm-u",d,void 0);a.C.setVisible(!0);a.C.getElement().focus()}ljc.prototype.xa=function(){ljc.$.xa.call(this);this.clear()};function mjc(a){a=""+('<div class="waffle-assistant-quicksum-entry" tabindex="0"><span class="waffle-assistant-quicksum-entry-name" title="'+W(a.title)+'">'+U(a.name)+'</span><span class="waffle-assistant-quicksum-entry-value"></span><span aria-label="'+rs("Press enter to insert formula")+'"></span></div>');return V(a)};function lW(a,b){T.call(this);this.C=a;this.D=b}z(lW,T);q=lW.prototype;q.va=function(){this.Da=Xr(mjc,{name:this.C,title:this.D})};q.Ja=function(){lW.$.Ja.call(this);var a=this.$a("waffle-assistant-quicksum-entry-name");qV(a);this.getHandler().V(this.Da,"keypress",this.jYb);S(this.Da,!1)};q.getFunctionName=g("C");q.Xa=function(a){vn(this.$a("waffle-assistant-quicksum-entry-value"),a||"");S(this.Da,!!a)};q.Va=function(){return uq(this.Da)};
q.jYb=function(a){13==a.keyCode&&(a.stopPropagation(),a.preventDefault(),this.dispatchEvent(new J("insert",this)))};function mW(a,b,c,d,e){T.call(this,e);this.Fa=a;this.qa=b;this.R=c;this.L=d;this.D=a.C;this.Aa=new Ui;this.ea=op(new np,17).Ha();this.Z=op(new np,2).Ha();this.O=!1;this.F=[];this.C=null;this.J=[]}z(mW,T);
mW.prototype.Ja=function(){mW.$.Ja.call(this);this.Mi(new lW(ritz.getLocalizedFunctionName("SUM"),"Sum"),0,!0);this.Mi(new lW(ritz.getLocalizedFunctionName("AVERAGE"),"Average"),1,!0);this.Mi(new lW(ritz.getLocalizedFunctionName("MIN"),"Minimum"),2,!0);this.Mi(new lW(ritz.getLocalizedFunctionName("MAX"),"Maximum"),3,!0);this.Mi(new lW(ritz.getLocalizedFunctionName("COUNTA"),"Count all"),4,!0);this.C=new QV(this.Da,this.qa,this.D,this.R);this.C.mf(this.O);H(this,this.C);this.getHandler().V(this,"insert",
this.ma).V(this.C,"formula_inserted",this.Ia)};
function njc(a){function b(a){return l?ritz.renderNumberAsFormattedString(a,m):null}if(rw(a.D)){var c=sw(a.D),d=c.Jk(),e=uJ(a.D);if(zb(d,c.Gt,c)){var f=[];a.F=[];for(c=0;c<d.length;c++){var h=d[c],k=cha(e+"",h.rc(),h.kc(),h.$c(),h.fd());f.push(a.Aa.serialize(k));a.F.push(h)}if(d=ritz.quickSum(f)){S(a.Da,!0);var e=d.count,c=d.countNumberFormat,l=1<d.numericCount,m=l?d.valueNumberFormat:null;a.Ed(0).Xa(b(d.sum));a.Ed(1).Xa(b(d.average));a.Ed(2).Xa(b(d.min));a.Ed(3).Xa(b(d.max));1<e?a.Ed(4).Xa(ritz.renderNumberAsFormattedString(e,
c)):S(a.Da,!1);if(a.C){a.C.L=[];a.J=[];for(c=0;c<a.Dd();++c)d=a.Ed(c),a.J.push(ojc(a,d.getFunctionName()));a.C.L=a.J}}else S(a.Da,!1)}else S(a.Da,!1)}else S(a.Da,!1)}mW.prototype.mf=function(a){this.O=a;this.C&&this.C.mf(a);Up(this.Da,"waffle-assistant-quicksum-panel-readonly",a)};mW.prototype.ma=function(a){var b=a.target;a=this.F[0];a=new N(a.left,a.$c());b=b.getFunctionName();b=ojc(this,b);a=new lG(sw(this.D),a,b);this.R.C(a);this.L.Tb(2624,this.Z)};mW.prototype.Ia=function(){this.L.Tb(2624,this.ea)};
function ojc(a,b){var c=Qw(a.Fa.L);a=wb(a.F,function(a){return Jw(a)});return"="+b+"("+a.join(c)+")"};function pjc(a){a=""+('<div class="waffle-autovis-lightbox"><div class="waffle-autovis-lightbox-header"><div class="waffle-autovis-lightbox-buttons-wrapper">'+U(It({content:ms("INSERT CHART"),style:4,Je:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-insert waffle-autovis-lightbox-readonly-hidden"}))+U(It({Je:"waffle-autovis-lightbox-close",content:ns(""+U(Wu({icon:"docs-icon-img docs-icon-close-white"}))),style:4,title:ms("Close")}))+'</div></div><div class="waffle-autovis-lightbox-content"><div class="waffle-autovis-lightbox-content-inner">\x3c!-- TODO(cuiffo): Replace with real icons --\x3e'+
U(It({content:ns("&#10094;"),style:4,Je:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-previous",attributes:os('aria-label="'+rs("Previous chart")+'"')}))+'<div class="goog-inline-block waffle-autovis-lightbox-container"></div>'+U(It({content:ns("&#10095;"),style:4,Je:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-next",attributes:os('aria-label="'+rs("Next chart")+'"')}))+'</div><div class="waffle-autovis-lightbox-page-count"><span class="waffle-autovis-lightbox-page-number"></span>/'+
U(a.rIb)+"</div></div></div>");return V(a)}function qjc(){return V('<div class="waffle-autovis-lightbox-chart"></div>')};function nW(a,b,c){T.call(this,c);this.F=a;this.D=b;this.J=[];this.C=new Jt("",this.oa());this.Ma(this.C);this.R=new Jt("",this.oa());this.Ma(this.R);this.O=new Jt("",this.oa());this.Ma(this.O);this.L=new Jt("",this.oa());this.Ma(this.L)}z(nW,T);q=nW.prototype;q.va=function(){nW.$.va.call(this);this.Da=Xr(pjc,{rIb:this.F.length})};
q.Ja=function(){nW.$.Ja.call(this);var a=X.EI.isEnabled();this.mf(!a);a=this.$a("waffle-autovis-lightbox-close");this.C.Ya(a);a=this.$a("waffle-autovis-lightbox-insert");this.R.Ya(a);var b=this.$a("waffle-autovis-lightbox-previous");this.O.Ya(b);b=this.$a("waffle-autovis-lightbox-next");this.L.Ya(b);rjc(this);sjc(this,this.D,!1);this.getHandler().V(document.body,bd,this.UTb).V(this.Da,"keydown",this.VTb).V(an(),"resize",this.YTb).V(this.C,"action",this.close).V(this.R,"action",this.usb).V(this.O,
"action",this.XTb).V(this.L,"action",this.WTb);b=new Av(this.Da,this.oa());Bv(b);H(this,b);a.focus()};function rjc(a){var b=a.$a("waffle-autovis-lightbox-content"),c=a.$a("waffle-autovis-lightbox-content-inner");a=a.$a("waffle-autovis-lightbox-page-count");var d=Zm();a=qq(a);var e=d.height-a.height-195,f=d.width-200;.75<e/f?(d=f,e=.75*f):d=e/.75;nq(c,d,e);nq(b,d,e+a.height+35)}q.mf=function(a){Up(this.Da,"waffle-autovis-lightbox-readonly",a)};
function sjc(a,b,c){c&&ho("Page "+(b+1+(" of "+(a.F.length+"."))));a.J[b]?tjc(a,b):a.F[b]&&Pgc(a.F[b],y(a.Hlb,a,b),!0)}q.Hlb=function(a,b){if(!this.isDisposed()&&b){var c=this.$a("waffle-autovis-lightbox-container"),d=Xr(qjc);c.appendChild(d);this.J[a]=d;dV(b,d,um);tjc(this,a)}};function tjc(a,b){S(a.J[a.D],!1);S(a.J[b],!0);a.O.Ra(0!=b);a.L.Ra(b!=a.F.length-1);var c=a.$a("waffle-autovis-lightbox-page-number");vn(c,b+1);a.D=b}q.UTb=function(a){!sn(this.Da,a.target)&&a.relatedTarget&&a.relatedTarget.focus()};
q.VTb=function(a){27==a.keyCode?this.close():37==a.keyCode||38==a.keyCode?0!=this.D&&sjc(this,this.D-1,!0):39!=a.keyCode&&40!=a.keyCode||ujc(this);a.stopPropagation()};q.YTb=function(){var a=this.$a("waffle-autovis-lightbox-container");hn(a);this.J=[];rjc(this);sjc(this,this.D,!0)};q.usb=function(){this.close();Sgc(this.F[this.D],2256)};q.XTb=function(){0!=this.D&&sjc(this,this.D-1,!0);0==this.D&&this.L.Da.focus()};q.WTb=function(){ujc(this);this.D==this.F.length-1&&this.O.Da.focus()};
function ujc(a){a.D!=a.F.length-1&&sjc(a,a.D+1,!0)}q.close=function(){this.dispose()};q.Hd=function(){nW.$.Hd.call(this);var a=this.F[this.D];a&&a.Da&&a.Da.focus()};function vjc(a,b){K.call(this);this.Qb=a;this.eb=b;this.J=a.C;this.He=new Ui;this.Ia=Zj();this.L=Zj();this.ib=this.C=this.F=this.O=this.R=this.qa=this.ma=null;this.Ua=!1;this.D=null;this.Gb=!0;this.Ka=this.Oa=!1;this.Qa=this.bb=null;this.ea=yJ.getInstance();this.Fa=this.Aa="";b=this.Qb.L.Ar();this.Z=new GV;E(this.Z,2,Tna);a=voa&&!a.Pd();E(this.Z,3,a);E(this.Z,4,ooa);a=tm&&(Bm||"en"==mE(b));E(this.Z,5,a);E(this.Z,6,qoa);E(this.Z,7,woa);E(this.Z,10,!1);E(this.Z,11,Am);E(this.Z,12,Loa);a=new L(this);
H(this,a);a.V(this.eb,"Da",this.IYb)}z(vjc,K);var wjc={i3b:"cu",FXa:"cs",EXa:"ce",B_a:"ls",A_a:"le"};q=vjc.prototype;q.update=function(a,b,c){c&&this.C&&!Ab(c,function(a){return Xga(a,this.C.rect)},this)||!a&&this.C&&c&&1==c.length&&1==c[0].oi()&&this.C.rect.contains(c[0])||(this.Ia.cancel(!0),a&&(this.Ka=!0,this.L.cancel(!0),this.F=this.O=this.R=this.qa=null,this.ma&&(this.ma.cancel(!0),this.ma=null)),this.Ia=xjc(),this.Ia.addCallback(this.i4a,this),this.Ia.addCallback(Ea(this.j4a,b),this))};
q.Wh=da("bb");q.IYb=function(){this.ma&&3==this.eb.getState()&&(this.ma.Vb(),this.ma=null)};function xjc(){var a=null,b=new Rj(function(){null===a||cl(a)}),a=bl(function(){b.Vb()});return b}q.Ukb=function(){this.Oa=!0};
q.i4a=function(){var a=this.J.getActiveGrid();if(a){var b=sw(this.J),c=b.Jk(),d=yjc(this,c||[]),e=yjc(this,this.ib||[]);d&&!e||!d&&!zjc(c,this.ib)?(this.F=null,this.Ua=!0):this.Ua=!1;this.ib=c;var f=dC(b).clone();A(b.Jk(),function(a){f.Nn(a)});this.D=new Fh(a.wb(),"",f)}else this.D=null};
q.j4a=function(a){this.Aa=zJ(this.ea,vj.gwa);var b=this.J.getActiveGrid(),c=this.D&&this.D.xd;this.C&&this.C.xd!=c&&(this.C=null);if(!b||b.wb()!=c||null===c)return this.D=null;var d=this.J.getActiveGrid().D,b=AA(d,this.D.rect);b.addCallback(function(){if(!this.J.getActiveGrid()||hw(this.J)!=c)return null;var b=sw(this.J),f=Ajc(this,a),h=xA(b.F,"r"),k=b.Sn("r");return!b.Gt(f)||h>=f.rc()&&XMa(b)||k<=f.$c()&&WMa(b)?(this.dispatchEvent(new J("ls")),BA(d,f,hc(Yg),a?void 0:500).addCallback(this.I6a,this)):
f},this);b.addCallback(function(a){var b=this.J.getActiveGrid();return a&&b&&b.wb()==c&&null!==c?Bjc(this,a,sw(this.J)):null},this);b.addCallback(function(b){var d=this.C;b&&3<b.oi()&&(d=b&&new Fh(c,"",b));if(null===d&&null!==this.C||null!==d&&!d.equals(this.C))this.F=this.O=this.R=this.qa=null;b=null!==d&&d.equals(this.C);if(b=this.Ka||this.Ua||!b&&(null===this.R||null!==this.O&&null===this.F))this.Gb=this.Oa&&this.Gb||!this.C||!d||!d.rect.intersects(this.C.rect);var e=null!==d&&d.contains(this.C);
this.C=d;""!=this.Aa&&(AJ(this.ea,this.Aa),this.Aa="");b&&(a&&(this.Fa=zJ(this.ea,vj.hwa)),this.L.cancel(!0),this.L=Zj(),this.L.addCallback(this.q4a,this),this.L.addCallback(this.F6a,this),a&&(this.L.addCallback(Ea(this.B6a,e),this),this.bb&&!sHa(this.Qb)&&roa?this.L.addCallback(this.lgb,this):(this.L.addCallback(this.n4a,this),this.L.addCallback(this.o4a,this)),this.L.addCallback(this.A6a,this)),Vj(this.L,this.Ukb,this))},this);return b};
function Ajc(a,b){return null!=a.D?ritz.getExploreTableRectForSelection(""+a.D.xd,a.D.rect.top,a.D.rect.height+a.D.rect.top,a.D.rect.left,a.D.rect.width+a.D.rect.left,b,Foa,rh):null}q.q4a=function(){if(null!==this.C&&null!==this.C.rect&&null===this.qa){var a=zJ(this.ea,vj.Xua);this.qa=ritz.getAssistantConfidence(""+this.C.xd,this.C.rect.top,this.C.rect.height+this.C.rect.top,this.C.rect.left,this.C.rect.width+this.C.rect.left,this.He.serialize(this.Z));AJ(this.ea,a)}};q.I6a=function(){this.dispatchEvent(new J("le"))};
q.F6a=function(){this.dispatchEvent(new Cjc(this.C,this.qa))};q.B6a=function(a){a=new Djc(a,this.Ka);this.Ka=!1;this.dispatchEvent(a)};q.lgb=function(){if(null===this.C||null===this.C.rect||null!==this.O&&null!==this.F)return null;I(this.Qa);return 3!=this.eb.getState()?(this.ma=new Rj,this.ma.addCallback(this.HSa,this),this.ma):this.HSa()};
q.HSa=function(){var a=zJ(this.ea,vj.jwa),b=Ejc(this),c=b&&!b.aOa,b=ritz.getAssistantRequestProto(this.C.xd.toString(),this.C.rect.top,this.C.rect.height+this.C.rect.top,this.C.rect.left,this.C.rect.width+this.C.rect.left,c?b.rows:[],c?b.Me:[]),b=this.He.Ad(EV.Ea(),b),c=new Ui;c.Dw=!0;var b=fj(c.serialize(b)),d=new Rj;this.Qa=Bj(Cj(zj(Xk(Yk(this.bb.eg("/explore/getrecommendations").vg("rp",b),"GET")).setTimeout(6E4),1),function(b){var c=zJ(this.ea,vj.iwa);b=Fjc(this,b.xg());AJ(this.ea,c);this.O=Ec(b,
1);this.F=Ec(b,2);this.Qa=null;AJ(this.ea,a);d.Vb()},this),function(){this.O=[];this.F=[];d.Vb()},this).qf();return d};
q.n4a=function(){function a(){b=null;ritz.continueAssistantRecommendation(this.R)?(this.O=Ec(Fjc(this,ritz.getAssistantRecommendations(this.R)),1),d.Vb()):b=bl(a,5,this)}if(null===this.C||null===this.C.rect||null!==this.R&&null!==this.O)return null;this.R=ritz.newAssistantRecommender(this.He.serialize(this.Z));this.F=this.O=null;ritz.startAssistantRecommendation(this.R,""+this.C.xd,this.C.rect.top,this.C.rect.height+this.C.rect.top,this.C.rect.left,this.C.rect.width+this.C.rect.left);var b=null,c=
y(function(){null!==b&&(cl(b),this.F=this.O=this.R=b=null)},this),d=new Rj(c),b=bl(a,5,this);return d};q.o4a=function(){var a=Ejc(this);a&&this.R&&null===this.F&&(this.F=a.aOa?[]:Ec(Fjc(this,ritz.getAssistantRecommendationsOnlySelection(this.R,a.rows,a.Me)),2))};q.A6a=function(){this.Oa=!1;var a=this.F&&0<this.F.length?this.F:this.O;""!=this.Fa&&(AJ(this.ea,this.Fa),this.Fa="");this.dispatchEvent(new Gjc(this.C,a||[],this.Gb))};function Fjc(a,b){return a.He.Ad(DV.Ea(),b)}
function Bjc(a,b,c){b=b.clone();fc(Yg,function(a){for(var d=!0;d&&b;){for(var f=bh(a),h=0;h<(f?b.width:b.height);h++){var k=Ch(b,a),l=f?b.kc():b.rc(),k=f?c.Pf(k,l+h):c.Pf(l+h,k);if(!AOb(k)&&k.Kr()){d=!1;break}}d&&(aha(b,-1,a),0==b.width||0==b.height)&&(b=null)}return!!b},a);return b}function zjc(a,b){return Vb(a,b,function(a,b){return wh(a,b)})}
function Ejc(a){var b=a.J.getActiveGrid();if(!b||!a.C||b.wb()!=a.C.xd)return null;for(var c=sw(a.J).Jk(),c=wb(c,Ea(vh,a.C.rect)),c=vb(c,ra),d=wb(c,function(a){return new nh(a.left-this.C.rect.left,a.top-this.C.rect.top,a.width,a.height)},a),b=new ug,e=new ug,f=0;f<d.length;f++){for(var h=0;h<d[f].width;h++)e.add(d[f].left+h);for(h=0;h<d[f].height;h++)b.add(d[f].top+h)}a=yjc(a,c);return{rows:b.Id(),Me:e.Id(),aOa:a}}
function yjc(a,b){a.J.getActiveGrid();if(0==b.length)return!0;if(1!=b.length)return!1;b=b[0];if(Tga(b)||0==b.oi())return!0;a=jRa(sw(a.J).ea,b.top,b.left);return b.equals(a)}function Cjc(a,b){J.call(this,"cu");this.C=a;this.F=b}z(Cjc,J);function Gjc(a,b,c){J.call(this,"ce");this.C=a;this.F=b;this.Z=c}z(Gjc,J);function Djc(a,b){J.call(this,"cs");this.C=a;this.F=b}z(Djc,J);function oW(a,b,c,d,e,f){LT.call(this,f);this.ea=a;this.ib=b.C;this.Ka=c;this.qc=d;this.L=e;this.qa=new mW(b,c,d,e,this.oa());this.Ma(this.qa);this.R=new eV(!1,"#4285f4");this.Ma(this.R);this.O=null;this.eb=this.bb=!1;this.Qa=!0;this.Oa=yJ.getInstance();this.Fa=this.Aa="";this.Z=op(new np,10).Ha()}z(oW,LT);q=oW.prototype;q.va=function(){oW.$.va.call(this);this.Da=Xr(this.oWa(),{RQb:tm})};
q.Ja=function(){oW.$.Ja.call(this);var a=this.$a("waffle-assistant-quicksum-panel");this.qa.Ya(a);a=this.$a("waffle-assistant-spinner-container");this.R.render(a);this.getHandler().V(this,"close-sidebar",this.dna).V(this.ea,wjc.B_a,this.Tma).V(this.ea,wjc.A_a,this.Sma).V(this.ea,wjc.FXa,this.qma).V(this.ea,wjc.EXa,this.pma).V(this.$a("waffle-assistant-scroll-pane"),"scroll",xbc(this.Bda,10,this));a=X.EI.isEnabled();this.mf(!a)};
q.resize=function(){var a=this.$a("waffle-assistant-sidepane-content"),a=qq(a).height,b=this.$a("waffle-assistant-spinner-container");Xp(b,"margin-top",a/2-16+"px")};q.Wh=v;function Hjc(a,b){var c=a.zO();0!=c.length&&(I(a.O),c=c.filter(function(a){return a instanceof MV}),b=c.indexOf(b),0<c.length&&-1!=b&&(a.O=new nW(c,b,a.oa()),a.O.render(),H(a,a.O),a.O.mf(a.eb)))}q.mf=function(a){this.eb=a;Up(this.Da,"waffle-assistant-readonly",a);this.qa.mf(a);this.O&&!this.O.isDisposed()&&this.O.mf(a)};
q.setVisible=function(a){var b=this.Va();oW.$.setVisible.call(this,a);if(a&&!b){var c=Ajc(this.ea,a);c?(b=new yfc,P(b,1,Bh(c,"r")),P(b,2,Bh(c,"c")),c=c.oi(),P(b,3,c),c=new zfc,pj(c,4,b),b=sua(this.Z),b.tia=c,b=b.Ha()):b=this.Z;this.Fa=zJ(this.Oa,vj.owa,!1,b);this.R.setActive(!0);pW(this)}a||this.L3(!0)};q.Tma=function(){this.Va()&&(this.L3(!0),this.R.setActive(!0),pW(this))};q.Sma=function(){this.Va()&&(this.R.setActive(!1),pW(this))};
q.qma=function(a){this.Va()&&(this.L.Tb(2775,this.Z),this.L3(void 0,a.C,a.F),this.toa()||this.R.setActive(!0),pW(this),this.Qa=!1)};q.pma=function(a){if(this.Va()){this.L.Tb(2776,this.Z);var b=a.F;0<b.length&&(this.Aa=zJ(this.Oa,vj.mwa));this.L3(!1);this.R.setActive(!1);this.nWa(b,a.C);a=a.Z;b=this.zO();0<b.length&&this.bb&&(b[b.length-1].Gb=!0);this.bb=!1;pW(this);this.pWa(a);this.Bda()}};
function pW(a){var b=a.toa(),c=uq(a.$a("waffle-assistant-quicksum-panel")),d=a.R.Xb(),b=b||c||d;a=a.$a(a.IGa());S(a,!b)}q.zHa=Pf;function Ijc(a){return a.$a("waffle-assistant-scroll-pane").scrollTop+qq(a.$a("waffle-assistant-sidepane-content")).height}q.Nc=v;q.$qa=v;q.Pd=g("eb");q.dna=function(){this.L.Tb(2226,this.Z)};q.sHb=function(){""!=this.Aa&&(AJ(this.Oa,this.Aa),this.Aa="");""!=this.Fa&&(AJ(this.Oa,this.Fa),this.Fa="");this.Qa||(this.L.Tb(2777,this.Z),this.Qa=!0)};function Jjc(a){a=a||{};return V(U(VT(ks({title:ns(""+Kjc()),Ek:ns('<div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content">'+V('<div class="waffle-assistant-empty-list-old" style="display: none"><img src="//ssl.gstatic.com/docs/spreadsheets/bulbman.svg" /><div aria-live="polite"><div class="waffle-assistant-empty-list-title-old">Nothing interesting here right now</div><div class="waffle-assistant-empty-list-body-old">Try selecting different data. Information with numbers works best.</div></div><a href="https://support.google.com/docs/?p=explore_sheets" target="_blank">Learn more</a><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try an example</a></div>')+
'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="display: none"></div><div class="waffle-assistant-card-holder"></div></div></div>'),id:ms("autovis"),XV:ms("waffle-assistant-sidepanel"),e3:ms("waffle-assistant-title"),jR:ms("waffle-assistant-sidepane-content")},a))))}
function Ljc(a){a=a||{};var b=V,c=ns('<div class="waffle-assistant-replaceable-title">'+Kjc()+"</div>"),d,e;e=a||{};d=V;e=e||{};var f;f=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content" aria-live="polite">'+U(Kfc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div class="waffle-assistant-empty-list-title">Get insights instantly</div><div class="waffle-assistant-empty-list-body">');f=e.RQb?f+"To see answers, formatting, and charts in a single click, try adding more data or selecting different cells in your spreadsheet.":
f+"To see formatting and charts in a single click, try adding more data or selecting different cells in your spreadsheet.";e=V(f+'</div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try it out</a></div></div></div>');d=d('<div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content"><div class="waffle-assistant-scroll-pane-feature-content">'+
e+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="display: none"></div><div class="waffle-assistant-features"></div></div><div class="waffle-assistant-expanded-panel" style="display: none"></div></div></div>');return b(U(VT(ks({title:c,Ek:ns(""+d),id:ms("autovis"),XV:ms("waffle-assistant-sidepanel"),e3:ms("waffle-assistant-title"),jR:ms("waffle-assistant-sidepane-content")},a))))}
function Kjc(){return V('<div class="waffle-assistant-title-bar"><div class="waffle-assistant-title-icon">'+U(Kfc({color:"#ffffff",iconSize:"21"}))+'</div><div class="waffle-assistant-title-text">'+U("Explore")+"</div></div>")};function qW(a,b,c,d,e,f,h){oW.call(this,a,b,c,d,e,h);this.Ub=f;this.Ua=b;this.ma=new T(this.oa());this.Ma(this.ma);this.J=new ljc;H(this,this.J);this.D=[];this.F=null;this.Ia=new Jt("",h,4);Ar(this.Ia,2);this.Ma(this.Ia)}z(qW,oW);
var rW={WA:"waffle-assistant-scroll-pane-feature-content",dZa:"waffle-assistant-empty-list",uZa:"waffle-assistant-features",s_a:"waffle-assistant-empty-list-learn-more",Tea:"waffle-assistant-expanded-panel",dya:"waffle-assistant-replaceable-title",Kpc:"waffle-assistant-scroll-pane",OJ:"waffle-assistant-title"},Mjc={defaultHelpArticleId:"6280499"};q=qW.prototype;q.oWa=function(){return Ljc};q.IGa=n("waffle-assistant-empty-list");
q.Ja=function(){qW.$.Ja.call(this);this.ma.Ya(this.$a(rW.Tea));qV(this.C.Da,"Close");var a=this.Ua.L.Ar();tm&&(Bm||"en"==mE(a))&&(a=new gW(this.Ub,this.Ka,this.ib,this.qc,this.L,this.J,this.Ua,this.oa()),this.Ma(a),this.D.push(a));if(voa||woa)a=new kjc(this.L,this.J,this.oa()),this.Ma(a),this.D.push(a);a=new PV(this.ib,this.Ka,this.L,this.J,this.oa());this.Ma(a);this.D.push(a);var b=this.$a(rW.uZa);A(this.D,function(a){a.render(b);this.ma.Ma(a.D,!0)},this);this.Ia.Ya(this.$a(rW.s_a));this.getHandler().V(this.Ia,
"action",this.HYb);Njc(this)};q.HYb=function(){Q.Eo.Nb(Mjc)};q.nWa=function(a,b){for(var c=0;c<this.D.length;c++){for(var d=[],e=0;e<a.length;e++){var f=Fc(a[e],1);this.D[c].Vga(f)&&d.push(a[e])}0<d.length?this.D[c].qua(d,b):this.D[c].rW(!0)}};q.pWa=function(){A(this.D,function(a){Sfc(a)})};q.L3=function(a,b,c){A(this.D,function(d){d.rW(a,b,c)})};q.toa=function(){return!!Ab(this.D,function(a){return a.pna()})};
q.Bda=function(){var a=Ijc(this);A(this.D,function(b){this.F&&this.F!=b||(b instanceof PV&&this.getHandler().Oc(b,"assistant-done-rendering",this.sHb),a=b.sua(a))},this)};q.zO=function(){if(this.F)return this.F.D.C;var a=[];A(this.D,function(b){Ob(a,Rfc(b))});return a};q.mf=function(a){qW.$.mf.call(this,a);Njc(this)};q.Wh=function(a){A(this.D,function(b){b.Wh(a)})};q.$qa=function(){var a=this.$a(rW.dya),b=this.$a(rW.OJ);pq(b,qq(a).height)};
q.Nc=function(){this.oa();var a=this.$a(rW.WA),b=this.$a(rW.dya);this.$a(rW.OJ);var c=this.ma.Da;if(this.F)this.F.D.setVisible(!1),this.F.setActive(!1),this.F=null,S(a,!0),S(c,!1),Vr(b,Kjc),Jp(b,"label"),this.resize();else if(this.F=Ab(this.D,function(a){return a.Xb()}))S(a,!1),S(c,!0),this.F.D.setVisible(!0),Tfc(this.F,b),Np(b,this.F.getTitle());this.$qa();bl(function(){var a=Tv;a&&a.dispatchEvent("resize");this.Bda()},300,this)};
q.setVisible=function(a){var b=this.Va();qW.$.setVisible.call(this,a);a&&!b&&Ojc(this,!0);a||this.J.clear()};q.dna=function(){qW.$.dna.call(this);this.F&&this.Nc()};q.Tma=function(){qW.$.Tma.call(this);Ojc(this,!0)};q.Sma=function(){qW.$.Sma.call(this);Ojc(this,!1)};q.qma=function(a){qW.$.qma.call(this,a);Ojc(this,!0,a.C)};q.pma=function(a){qW.$.pma.call(this,a);Ojc(this,!1)};function Njc(a){A(a.D,function(a){a.mf(this.Pd())},a)}q.zHa=g("D");function Ojc(a,b,c){A(a.D,function(a){c||Ofc(a.D,b)})};function Pjc(a){var b;a=a||{};return V('<div class="docs-explore-promo-base docs-ui-unprintable '+W(a.hg)+'"><div class="docs-explore-promo-content">'+(a.uG?'<div class="docs-explore-promo-header">'+U(null==(b=a.uG)?"":b)+"</div>":"")+'<div class="docs-explore-promo-description">'+U(null==(b=a.oZ)?"":b)+'<div class="docs-explore-promo-buttons">'+(a.yK?U(It({Je:"docs-explore-promo-button docs-explore-promo-continue-button",content:ns(""+U(a.yK)),style:4})):"")+(a.QK?U(It({Je:"docs-explore-promo-button docs-explore-promo-close-button",
content:ns(""+U(a.QK)),style:4})):"")+"</div></div></div>"+(a.gNa?V('<div class="docs-explore-promo-icon-wrapper"><div class="docs-explore-promo-icon">'+U(Kfc({color:a.gNa,iconSize:"32"}))+"</div></div>"):"")+"</div>")};function Qjc(a,b){T.call(this,b);this.F=new Jt("",b);this.Ma(this.F);this.C=new Jt("",b);this.Ma(this.C);this.D=new Jt("",b);Ar(this.D,2);this.Ma(this.D);this.J=a;Usa([Q.lea,Q.mea,Q.lwa],!0)}z(Qjc,T);q=Qjc.prototype;q.va=function(){this.Da=Xr(Pjc,this.J)};
q.Ja=function(){Qjc.$.Ja.call(this);var a=this.gb("docs-explore-promo-continue-button");a&&this.F.Ya(a);(a=this.gb("docs-explore-promo-close-button"))&&this.C.Ya(a);(a=this.gb("docs-explore-promo-icon"))&&this.D.Ya(a);this.getHandler().V(this.F,"action",this.VJa).V(this.C,"action",this.O7a).V(this.D,"action",this.Hrb)};q.show=function(a){Q.lwa.Nb();this.render(a)};q.VJa=function(a){Q.lea.Nb();a.stopPropagation()};q.O7a=function(a){Q.mea.Nb();a.stopPropagation()};q.Hrb=function(a){this.VJa(a)};function Rjc(a){return V('<div class="waffle-assistant-walkthrough-promo-content"><h1 class="waffle-assistant-walkthrough-promo-header">'+U(a.uG)+'</h1><p class="waffle-assistant-walkthrough-promo-description">'+U(a.oZ)+"</p>"+(a.yK?U(It({Je:"waffle-assistant-walkthrough-promo-button waffle-assistant-walkthrough-promo-continue-button",content:ns(""+U(a.yK)),style:4})):"")+(a.QK?U(It({Je:"waffle-assistant-walkthrough-promo-button waffle-assistant-walkthrough-promo-close-button",content:ns(""+U(a.QK)),
style:4})):"")+"</div>")};function sW(a,b,c){wG.call(this,a,c);this.O=new Jt("",c);this.C=new Jt("",c);a=Xr(Rjc,b);this.setContent(a);this.Rg("docs-promo-bubble");this.setPosition(0,0);nu(this);Sq(this.D,!1);this.Vu=!1}z(sW,wG);sW.prototype.Ja=function(){sW.$.Ja.call(this);var a=this.gb("waffle-assistant-walkthrough-promo-continue-button");a&&this.O.Ya(a);(a=this.gb("waffle-assistant-walkthrough-promo-close-button"))&&this.C.Ya(a);this.getHandler().V(this.O,"action",this.J).V(this.C,"action",this.R)};
sW.prototype.J=function(a){this.dispatchEvent("promo-continue");a.stopPropagation()};sW.prototype.R=function(a){this.dispatchEvent("promo-dismiss");a.stopPropagation()};function Sjc(a){var b=Xm("waffle-assistant-chart-preview",void 0);sW.call(this,b,{uG:"See the big picture",oZ:"Data visualizations and text summaries make it easier to spot trends and outliers",yK:"Learn more",QK:"Got it"},a)}z(Sjc,sW);var Tjc={defaultHelpArticleId:"6280499"};Sjc.prototype.J=function(a){Q.Eo.Nb(Tjc);Sjc.$.J.call(this,a)};function Ujc(a,b){var c=Xm("waffle-assistant-answers-input",void 0),d;d=new Uv;a="Interested in the "+(d.jf("b")+(a+(d.kf("b")+"? Ask a question about your data to learn more, no formulas needed.")));d={uG:"Find answers in a snap",oZ:d.format(a),yK:"Next",QK:"Dismiss"};sW.call(this,c,d,b)}z(Ujc,sW);function Vjc(a,b){a={hg:"waffle-assistant-entry-promo",uG:"Get insights instantly",oZ:tm&&"en"==mE(a)?"Find answers to questions about your data, apply formatting, and create charts in a single click using Sheets Explore":"Apply formatting and create charts over your data in a single click using Sheets Explore",yK:"Check it out",QK:"Dismiss",gNa:"#0F9D58"};Qjc.call(this,a,b)}z(Vjc,Qjc);function Wjc(a){var b=Xm("waffle-assistant-banding-color-picker-container",void 0);sW.call(this,b,{uG:"Make it pop",oZ:"Quickly apply alternating row color formatting to add style, polish, and visual appeal",yK:"Next",QK:"Dismiss"},a)}z(Wjc,sW);function Xjc(a,b,c,d,e,f,h,k,l){RT.call(this,b,h);this.Ia=a;this.C=b;this.ea=c;this.Fa=d;this.ib=e;this.ma=f;this.Ka=k;this.Z=c.C;this.Oa=this.qa=!1;this.J=l;this.D=null;this.He=new Ui;this.R=null;a=qw(this.ib);this.Ef().V(this.Fa,"selectionChange",this.KYb).V(this.Z,"Sa",this.JYb).V(a,"kb",this.Bub).V(this.C,"assistant-sidepane-apply-conditional-format-rules",this.Wjb).V(this.C,"assistant-sidepane-apply-banding",this.Vjb).V(this.C,"assistant-sidepane-remove-banding",this.Iyb).V(this.C,"assistant-sidepane-change-selection",
this.llb).V(this.C,"assistant-sidepane-insert-chart",this.vsb).V(this.C,"assistant-sidepane-thumbs",this.zBb).V(this.C,"assistant-sidepane-set-active-panel",this.sAb).V(this.C,"assistant-sidepane-back-button-clicked",this.skb).V(this.C,"assistant-undo-pressed",this.LYb).V(this.Ia,"cu",this.Dmb);xo(this.O,X.EI,Bo,this.ysb).subscribe(X.RD,"action",this.pkb).subscribe(X.Y3,"action",this.mBb).subscribe(X.Qda,"action",this.fBb);X.X3.Ra(!0);a=new Afc;P(a,6,Yjc());b=new Ko;pj(b,58,a);this.L=op(pp(new np,
b),10).Ha();this.Qa=yJ.getInstance();this.Aa=zJ(this.Qa,vj.kwa);bl(Ea(this.WY,!1),100,this)}z(Xjc,RT);q=Xjc.prototype;q.wi=function(){return X.Sda};q.Rv=function(){return X.Zua};q.Tu=function(a){Xjc.$.Tu.call(this,a);X.Y3.Ra(a);this.WY(!1);!this.qa&&a&&(this.qa=!0,Boa&&FE(this.Ka,"ritz-DisplayExploreV2Promo",!1))};q.v0=function(a){this.C.$qa();bl(function(){Xjc.$.v0.call(this,a)},300,this)};q.Wh=function(a){this.C.Wh(a);this.Ia.Wh(a)};
q.pkb=function(){var a=this.C.Va();this.wi().setVisible(!a);a?this.J.Tb(2226,this.L):(this.C.focus(),this.J.Tb(2253,this.L))};q.fBb=function(){this.C.Va()||this.Tu(!0)};q.mBb=function(a){Hjc(this.C,a)};q.KYb=function(){this.WY(!0)};q.WY=function(a,b){if(b){if(!b.length)return;if(1==b.length&&this.R&&b[0].equals(this.R)){this.R=null;return}}var c=this.C;c.Va()&&(njc(c.qa),pW(c));this.Ia.update(!a,this.C.Va(),b)};
q.Dmb=function(a){""!=this.Aa&&(AJ(this.Qa,this.Aa),this.Aa="");var b=a.F||0;a=a.C;var c=!!a&&a.rect,d=(c=!!c&&c.oi()>=Goa&&Bh(c,"r")>=Ioa&&Bh(c,"c")>=Joa&&c.oi()<=Hoa)&&.6<=b;d!==this.Oa&&(this.Oa=d,X.X3.Nb(d),!d&&this.D&&(I(this.D),this.D=null));if(c){if(a&&a.rect){var d=.9<=b,e=1E3>=a.rect.oi(),c=ritz.isFormsRegion(""+a.xd,a.rect.top,a.rect.left,a.rect.height+a.rect.top,a.rect.width+a.rect.left),d=roa&&!this.C.Va()&&!this.qa&&d&&e&&!sHa(this.ea),c=soa&&c,e=toa&&this.ea.Pd();d&&(c||e)?(d=new Afc,
P(d,1,b),P(d,2,c),P(d,3,e),P(d,5,Loa),P(d,6,Yjc()),c=new Ko,pj(c,58,d),c=pp(op(new np,10),c).Ha(),this.MAa(c),c=!0):c=!1}else c=!1;if(c=!c)if(c=Boa){if(b=.6<=b&&!this.C.Va()&&!this.qa&&!this.D&&this.Ka.C["ritz-DisplayExploreV2Promo"].La()&&a)b=a.rect,b=ritz.hasBandingSuggestions(a.xd+"",b.rc(),b.$c(),b.kc(),b.fd());c=b}c&&(a=this.ea.L.Ar(),this.D=new Vjc(a),H(this,this.D),this.D.show(),this.O.subscribe(Q.lea,"action",this.rpb).subscribe(Q.mea,"action",this.Zma),FE(this.Ka,"ritz-DisplayExploreV2Promo",
!1),this.J.Tb(2788,this.L))}};q.MAa=function(a){this.C.bb=!0;var b=WSa(sw(this.Z));JPb.C||b||(a=a||this.L,this.wi().setVisible(!0),this.J.Tb(2225,a),this.J.Tb(2253,this.L),bl(Ea(this.F4a,a),5E3,this))};q.F4a=function(a){this.C.Va()||this.J.Tb(2752,a)};function Yjc(){switch(Koa){case "NO_DELAY":return 1;case "DELAY_500MS":return 2;case "DELAY_1S":return 3;case "DELAY_2S":return 4;default:return 0}}q.Zma=function(){I(this.D);this.D=null};
q.rpb=function(){I(this.D);this.wi().setVisible(!0);this.C.focus();this.Ef().Oc(this.C,"assistant-done-rendering",y(function(){var a;a:{this.C.Va();a=this.ea.L.Ar();a=tm&&(Bm||"en"==mE(a));for(var b=!1,c=!1,d=!1,e=this.C.zO(),f=0;f<e.length;f++)if(e[f]instanceof TV?b=!0:e[f]instanceof hW?c=!0:e[f]instanceof MV&&(d=!0),c&&d&&(b||!a)){a=!0;break a}a=!1}a?this.wLa():this.Zma()},this));this.J.Tb(2253,this.L)};
q.wLa=function(){this.C.Va();I(this.D);var a=null;this.D instanceof Vjc?(a=this.ea.L.Ar(),tm&&(Bm||"en"==mE(a))?(a=this.C.zHa(),a=Mic(Ab(a,function(a){return a instanceof gW}).L).toLowerCase(),a=new Ujc(a)):a=new Wjc):this.D instanceof Ujc?a=new Wjc:this.D instanceof Wjc&&(a=new Sjc);if(this.D=a)H(this,this.D),this.D.render(),this.Ef().Oc(this.D,"promo-dismiss",this.Zma).Oc(this.D,"promo-continue",this.wLa)};q.skb=function(){this.C.Nc()};
q.LYb=function(a){var b=a.C,c=b.D.EL(),d=parseInt(c.wb(),10);this.R=Kh(c);this.ma.C(new CQb(d));hjc(b,c);this.J.Tb(a.qk(),this.L)};q.JYb=function(){rw(this.Z)?(this.C.Ra(!0),this.WY(!1)):(this.wi().setVisible(!1),this.C.Ra(!1))};q.ysb=function(){this.C.mf(!X.EI.isEnabled())};q.Bub=function(a){this.WY(!1,a.C?a.C:a.rect?[a.rect]:[])};
q.Wjb=function(a){var b=sw(this.Z),c=""+b.Fc(),d=[],e=cbc(b);if(e){var b=new af,f=Fc(e,2);E(b,3,f);f=Fc(e,2);E(b,2,f);e=Fc(e,1);E(b,1,e);d.push(b)}b=a.C.eb;for(e=0;e<b.length;e++)f=new af,E(f,2,b[e]),d.push(f);this.ma.C(new XT(d,c));a=a.qk();this.J.Tb(a,this.L)};
q.Vjb=function(a){var b=a.C,c=Rbc(b.C),d=b.D.EL(),e=c.Wu?c.Ex:null,f=c.C?c.lx:null,h=parseInt(d.wb(),10),k=Zjc(d);this.R=Kh(d);k?this.ma.C(new QT(k,h,this.R,e,c.Ns,c.At,f)):this.ma.C(new OT(h,this.R,e,c.Ns,c.At,f));d=new rbc;P(d,1,1);c=new eT;b=b.D.xV();P(c,2,b);pj(c,5,d);b=new Ko;pj(b,46,c);b=pp(op(new np,10),b).Ha();a=a.qk();this.J.Tb(a,b)};q.Iyb=function(a){a=a.C;var b=a.D.EL(),c=parseInt(b.wb(),10),d=Zjc(b);this.R=Kh(b);this.ma.C(new PT(d,c));hjc(a,b)};
function Zjc(a){var b=a.wb();a=Kh(a);b=ritz.getWorkbookRangeIntersectingIds(b,a.rc(),a.kc(),a.$c(),a.fd(),7,!1);return 0<b.length?b[0]:null}q.llb=function(a){jC(sw(this.Z),a.F);a=a.qk();this.J.Tb(a,this.L)};
q.zBb=function(a){var b=a.C;a=a.qk();if(b instanceof RV||b instanceof TV)this.J.Tb(a,this.L);else{var c=this.C.zO(),d=new eT,e=b.D.xV(),c=c.indexOf(b);P(d,1,c);P(d,2,e);e=new Ko;pj(e,46,d);if(b instanceof MV){(d=b.J)?(b=$jc(this,b,d),b=Fec(b,d,d.Zf)):b=null;if(!b)return;pj(e,39,b)}else if(b instanceof OV){var f=b.D,c=new Gfc;if(b instanceof OV)b=1;else throw Error("Unknown text analysis card type.");f=Ec(f.getAutovisRecommendation(),20).slice(0,10);P(c,2,f||[]);P(c,1,b);pj(d,3,c)}b=pp(op(new np,10),
e).Ha();this.J.Tb(a,b)}};q.sAb=function(){this.C.Nc()};
q.vsb=function(a){var b=a.Z;if(b){var c=sw(this.Z),d=a.hf();d||(d=jA(this.Fa).Fd().C.hf());var e=16,f=16,h=a.bb;h&&(e=h.x,f=h.y);h=gac(this.ea.J);c={oid:null,ar:qC(c,d.y),ac:rC(c,d.x),x:e,y:f,h:Az.height,w:Az.width,p:{context:{chartName:"Chart "+(h+1)}}};d=new SD(hw(this.Z)||0,c,!1,!1);c=b.Zf;e=new Gl(c);f=Sl(e,"headers");f=null!=f&&za(f)&&Sa(f)?parseInt(f,10):-1;d.Ia=f;d.Z=0;f="1"==Sl(e,"transpose");d.Fa=f;d.J=f?"ROWS":"COLS";f=Sl(e,"range");f=hbc(tT(f,","),this.Z);d.$N(f);hac(d,b);(e=Sl(e,"dt"))&&
vWa(d,this.He.Ad(jf.Ea(),JSON.parse(decodeURIComponent(e))));this.Fa.dispatchEvent(new ME("objectRequest"));this.ma.C(new jG(this.ea,d));d=akc(this,b,a.ea,a.Ge());Eec(this.J,a.qk(),d,10,b,c)}};function $jc(a,b,c){var d=a.C.zO().filter(function(a){return a instanceof MV});return akc(a,c,d.indexOf(b),b.J&&b.J.Ge())}
function akc(a,b,c,d){var e=new Hec;a=a.C.zO().filter(function(a){return a instanceof MV}).map(function(a){return a.getChartType()});e.R=a;e.J=c;Iec(e,b.getChartType());e.D=d?d.clone():null;return e};function bkc(a,b){KV.call(this,a,b)}z(bkc,KV);q=bkc.prototype;q.ED=function(a){a()};q.xD=v;q.YB=n("assistantPivotTableFeedback");q.OF=n(2632);q.MF=n(2631);function ckc(a,b,c,d,e,f,h){oW.call(this,a,b,c,d,e,h);this.J=new T(this.oa());this.Ma(this.J);this.F=null;this.Ia=new L;H(this,this.Ia);this.D=[];this.Ua=null;this.ma=!0}z(ckc,oW);var dkc={HXa:"waffle-assistant-card-holder",WA:"waffle-assistant-sidepane-content",XYa:"waffle-assistant-dragger-card",WYa:"waffle-assistant-dragged-card",dZa:"waffle-assistant-empty-list-old",Sza:"waffle-assistant-visible"};q=ckc.prototype;q.oWa=function(){return Jjc};q.IGa=n("waffle-assistant-empty-list-old");
q.Ja=function(){ckc.$.Ja.call(this);var a=this.$a(dkc.HXa);this.J.Ya(a)};q.setVisible=function(a){var b=this.Va();ckc.$.setVisible.call(this,a);a&&!b&&(this.ma=!0)};
q.nWa=function(a){for(var b=0;b<a.length;b++){var c=a[b],d=D(c,1),e=null;switch(d){case 0:"WordCloud"==c.getAutovisRecommendation().getChartType()?e=new OV(c,this.oa()):e=new MV(c,this.ib,this.Ka,this.L,null,this.oa());break;case 1:e=new bkc(c,this.oa());break;case 2:e=new iW(c,this.oa());break;case 4:e=new hW(c,this.L,this.oa());break;default:throw Error("Unsupported recommendation type: "+d);}c=this.J.Dd();e.Z=c;this.J.Ma(e,!0);if(X.EI.isEnabled()){if(!this.F||this.F.isDisposed())this.F=new ekc,
Vbc(this.F,this.J.Da),this.F.Z=10,this.F.R=Va(dkc.XYa).split(" "),this.F.Aa=!0,this.F.Lra(dkc.Sza),this.F.L=!1,this.F.gf(),this.Ia.V(this.F,"beforedragstart",y(this.MYb,this)).V(this.F,"dragstart",y(this.ym,this)).V(this.F,"beforedragend",y(this.Ckb,this));var c=this.F,d=this.J.Da,f=e.Da;t(void 0)?Cpa(d,f,void 0):d.appendChild(f);Wbc(c,f)}0!=this.D.length&&e.getHandler().V(this.D[this.D.length-1],"content-rendered",e.CB);this.D.push(e)}};
q.pWa=function(a){0<this.D.length&&this.D[0].CB();if(a||this.ma)this.ma=!1,fkc(this)};function fkc(a){if(0!=a.D.length){for(var b=0,c=0;c<a.D.length;c++){var d=a.D[c].Da;cq(d,0,1E3);b+=qq(d).height}b=Math.max(qq(a.$a("waffle-assistant-sidepane-content")).height,b);pq(a.J.Da,b);for(c=0;c<a.D.length;c++)bl(Ea(a.f3a,a.D[c]),100*c,a);bl(function(){pq(this.J.Da,"auto")},100*a.D.length,a)}}q.f3a=function(a){!a.isDisposed()&&this.isEnabled()&&(new wT(a.Da,[0,1E3],[0,0],100)).play()};
q.L3=function(){this.Ia.Rc();I(this.F);for(var a=0;a<this.D.length;a++){var b=this.D[a];b.Jc()&&this.J.removeChild(b,!0);I(b)}this.D=[]};q.toa=function(){return 0<this.D.length};q.Bda=function(){for(var a=Ijc(this),b=0,c=0;c<this.D.length;c++)b<a?(sV(this.D[c],!0),b+=qq(this.D[c].Da).height):sV(this.D[c],!1)};q.MYb=function(a){var b=tb(this.J.Da.childNodes,a.C),b=this.J.Ed(b);b.NNa()?this.Ua=b:a.preventDefault()};q.ym=function(a){Qp(a.F,dkc.WYa)};
q.Ckb=function(a){var b=dq(a.F),c=jA(this.Ka).ye();if(oh(UF(c,"page",!1,!1)).contains(b)){var d=SF(c,b.x,b.y,"page"),c=WF(c,th(d),"page");this.Ua.d$(d,new N(b.x-c.left,b.y-c.top))}a.Z.Bx(null,!0);a.preventDefault();this.Ua=null};q.zO=g("D");function ekc(){YT.call(this)}z(ekc,YT);ekc.prototype.cla=function(a){a=ekc.$.cla.call(this,a);var b=wb(a.querySelectorAll("clippath"),function(a){return a.id});gkc(a,b);return a};
function gkc(a,b){for(var c=a.getAttribute&&a.getAttribute("clip-path"),d=0;d<b.length;d++){var e=b[d];za(c)&&bb(c,e)&&a.setAttribute("clip-path",c.replace(e,e+"-clone"));e==a.id&&(a.id=e+"-clone")}a=nn(a);for(d=0;d<a.length;d++)gkc(a[d],b)};function hkc(){F.call(this)}z(hkc,Qn);hkc.prototype.C=function(){return vjc};hkc.prototype.F=function(){return voa||woa||tm?qW:ckc};hkc.prototype.D=function(){return Xjc};Yn("assistant",hkc);
