pluginFn['/js/plugins/v2/rubik.js'] = function(lucid, window) {
	(function(){function H(a,b,c){return B(B(C(a),D(b)),E(c))}function F(a,b,c,e,d,g,f,h,r,y,l,G){this.e0=a;this.e1=b;this.e2=c;this.e3=e;this.e4=d;this.e5=g;this.e6=f;this.e7=h;this.e8=r;this.e9=y;this.e10=l;this.e11=G}function B(a,b){var c=a.e0,e=a.e1,d=a.e2,g=a.e4,f=a.e5,h=a.e6,r=a.e8,y=a.e9,l=a.e10,G=b.e0,J=b.e1,K=b.e2,L=b.e3,k=b.e4,m=b.e5,p=b.e6,M=b.e7,N=b.e8,O=b.e9,n=b.e10,q=b.e11;return new F(c*G+e*k+d*N,c*J+e*m+d*O,c*K+e*p+d*n,c*L+e*M+d*q+a.e3,g*G+f*k+h*N,g*J+f*m+h*O,g*K+f*p+h*n,g*L+f*M+h*q+a.e7,
r*G+y*k+l*N,r*J+y*m+l*O,r*K+y*p+l*n,r*L+y*M+l*q+a.e11)}function R(){return new F(1,0,0,0,0,1,0,0,0,0,1,0)}function C(a){var b=Math.sin(a);a=Math.cos(a);return new F(1,0,0,0,0,a,-b,0,0,b,a,0)}function D(a){var b=Math.sin(a);a=Math.cos(a);return new F(a,0,b,0,0,1,0,0,-b,0,a,0)}function E(a){var b=Math.sin(a);a=Math.cos(a);return new F(a,-b,0,0,b,a,0,0,0,0,1,0)}function m(a,b){return{x:a.e0*b.x+a.e1*b.y+a.e2*b.z+a.e3,y:a.e4*b.x+a.e5*b.y+a.e6*b.z+a.e7,z:a.e8*b.x+a.e9*b.y+a.e10*b.z+a.e11}}function S(a){for(var b=
{x:0,y:0,z:0},c=0,e=a.length;c<e;++c){var d=a[c];b.x+=d.xo;b.y+=d.yo;b.z+=d.zo}a=1/e;b.x*=a;b.y*=a;b.z*=a;return b}function k(a,b){this.blockId=b;this.flatId=a;this.blocks=[];this.points=[];this.faces=[];this.queue=[];this.moveHistory=[];this.rotating=!1;this.cameraY=1.0471973333333313;this.cameraX=3.9269900000000044;this.cameraZ=0;this.cy=this.cx=.6;this.cz=0;for(var c=-1;2>c;c++)for(var e=-1;2>e;e++)for(var d=-1;2>d;d++)if(0!=d||0!=e||0!=c){var g=T(a,-e,c,d),g=new z(2.15*c*9,2.15*e*9,2.15*d*9,9,
this,g);this.blocks.push(g);for(var f=0;f<g.faces.length;f++)this.faces.push(g.faces[f]);for(f=0;f<g.points.length;f++)this.points.push(g.points[f])}}function U(a){P[a]=!0;lucid.plugin.refreshBlockView(a);lucid.plugin.invalidateViewport()}function p(){this.phase=0;this.goalState=this.currentState=null}var A={global:this,provide:function(a){a=a.split(".");A.global[a[0]]=A.global[a[0]]||{};var b=A.global[a[0]];a.slice(1).reduce(function(a,b){a[b]||(a[b]={});return a[b]},b)},require:function(){},inherits:function(a,
b){function c(){}c.prototype=b.prototype;a.superClass_=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.base=function(a,c,g){var f=Array.prototype.slice.call(arguments,2);return b.prototype[c].apply(a,f)}},base:function(a,b,c){var e=arguments.callee.caller;if(A.STRICT_MODE_COMPATIBLE||A.DEBUG&&!e)throw Error("arguments.caller not defined.  goog.base() cannot be used with strict mode code. See http://www.ecma-international.org/ecma-262/5.1/#sec-C");if(e.superClass_)return e.superClass_.constructor.apply(a,
Array.prototype.slice.call(arguments,1));for(var d=Array.prototype.slice.call(arguments,2),g=!1,f=a.constructor;f;f=f.superClass_&&f.superClass_.constructor)if(f.prototype[b]===e)g=!0;else if(g)return f.prototype[b].apply(a,d);if(a[b]===e)return a.constructor.prototype[b].apply(a,d);throw Error("goog.base called from a method of one name to a method of a different name");}};A.provide("plugin.rubik");var n=0,q=1,t=2,u=3,v=4,w=5,n=4,q=1,t=2,u=0,v=5,w=3,V="#000099 #ffffff #ffff00 #cc0000 #ff8000 #009900".split(" "),
W=[[3,0],[4,0],[5,0],[3,1],[4,1],[5,1],[3,2],[4,2],[5,2],[0,3],[1,3],[2,3],[3,3],[4,3],[5,3],[6,3],[7,3],[8,3],[0,4],[1,4],[2,4],[3,4],[4,4],[5,4],[6,4],[7,4],[8,4],[0,5],[1,5],[2,5],[3,5],[4,5],[5,5],[6,5],[7,5],[8,5],[3,6],[4,6],[5,6],[3,7],[4,7],[5,7],[3,8],[4,8],[5,8],[3,9],[4,9],[5,9],[3,10],[4,10],[5,10],[3,11],[4,11],[5,11]],x={},P={};lucid.plugin.onDocumentLoaded(function(){function a(a,c){function b(c){var d,f;for(f in h)d=e.getElement(h[f]),f==c?(d.setContent({css:{"text-align":"center",
background:f,border:"6px solid black",cursor:"pointer","-webkit-border-radius":10,"-moz-border-radius":10,"border-radius":10,width:"33px",height:"33px","line-height":"45px","font-weight":"bold","font-size":"15px"}}),lucid.plugin.setProperty(a,"CurrentColor",c,!0)):d.setContent({css:{"text-align":"center",background:f,cursor:"pointer","-webkit-border-radius":10,"-moz-border-radius":10,"border-radius":10,width:"45px",height:"45px","line-height":"45px","font-weight":"bold","font-size":"15px"}})}function f(a){e.openGrid({width:3});
var c=e.add({css:{"text-align":"center",background:a,cursor:"pointer","-webkit-border-radius":10,"-moz-border-radius":10,"border-radius":10,width:"45px",height:"45px","line-height":"45px","font-weight":"bold","font-size":"15px"},onClick:function(){b(a)}});e.close();return c}var h={};e=lucid.template.builder();e.addGrid({width:12,content:{text:"Color Palette",css:{"font-weight":"bold","text-align":"center","font-size":"20px"}}});e.openGrid({width:2});e.add({text:"Edit"});d=e.addInput({type:"checkbox",
value:!1,onChange:function(c,b){b||lucid.plugin.setProperty(a,"Editing",c,!0)}});e.close();h["#ffffff"]=f("#ffffff");h["#ffff00"]=f("#ffff00");h["#000099"]=f("#000099");e.spacer();e.openGrid({width:2});e.add({text:"3D"});g=e.addInput({type:"checkbox",value:!1,onChange:function(c,b){b||(lucid.plugin.setProperty(a,"Show3dBlock",c),lucid.plugin.setProperty(lucid.plugin.getProperty(a,"OtherBlock"),"Hidden",!c))}});e.close();h["#009900"]=f("#009900");h["#ff8000"]=f("#ff8000");h["#cc0000"]=f("#cc0000");
setTimeout(function(){b(c)},10)}function b(a){function b(a){var c=g.getFaceColor(a[0]),d=1==a.length?"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABHNCSVQICAgIfAhkiAAABSxJREFUeJztmU1MG0cUx//rDz4CwXym0BAMpgJRBEQQVKmNQg8mZ3qAKz2ZI9zKDXqDE+0xXIzUU8OhPfQGFRxKBEr5cCmRQGAHCjIEkrULttc29vawXne9eO3d9ayh6v6kEezO87x5/5m3M7ML6Ojo6Ojo6Ojo6PwvofLkxwrgy0RpTPyVYgvAWwDLieLSrlvaYgEwCmATAJtD8QCYASeiUpw5RaASC4AJADRyCzxdcUK+EM7Eb/LKKLQJXFxmwAkthVNgmxesAJagfeDi1OhL0xenyE5z+pCfUZcqw4K+iIPXXIBhDQJSU5xIH7ymAtyV4LMVTei7A4HdmgBW3G7O37oAS3cgKGICmBQGP4rM21g5bAH4Gdw21wduq2sFt0V+nGh/IEcfmmBBblPfCfm7OJK7SWJMqOzAJoAulT4tAH5S6ZeoAGpH34nMW1a5qBWfmACjKhw7STmH9CYnbwIoPdJugszIA7kFT0QAqwqnanNeTK7BExFgWKFDUlOfRPBEBFDaEest+NRUgCUFzjYJ+JtR4C8vAihxNkHCYT4xEG5vmXB7mkNaAB/h9jRHzncBJXmUr+8MxCA9A0it/3mDtADlcg0pirIZTWa7wWDsIWlfeK/E0dzRe9D59Dnb0NLxezZ70ikwBuD7TAZGk9ne2Pb4RYmlwsbfizAh+mj3j+ngpX9abG8wGHs+arBN1dQ32fl7AT/tPtrbHo+GmXmhrbmwaLCt99lL4b0IE6J31397wrKsO21/ZAQ1AKBWhh0AMAB+lKosvFfiaOt99rKgqLgipRMmc3Flbb09wgQ/ZgJXv/D3DQZjT0v35wtllTXtQvuCouKKmofWQd/FqTcWja7z96tqH07er6hu33etjR/vv+mPx67by2tqey7pC280El5J1yc5KfBWhg3PACQOQRRF2Zo+7Z7K9ONHLR0Oc2HRIH/d1N59Qywhrd1fvKAoyiZVLwc5AiwrbHMs3c3i0rJBYTBez+78zupS/75rbVxoV133yAFw01mYJr533vWd1aV+z85GSpqUllc5kjYXZ/MA8EnXZ1OdT5+zdU2tgxEmRIeu/k5JFSFaCXBjFliqHqTk8PnJ4VDsOroYvPRP/7W3PcvX8bluLihMGdmjve3+2HV08ZK+GPe98yanfamlIvmQi4aZ+d2NlZGAn3YDnGh7G6/6pfIfkPdS1AUuDRpl2ALcSjAH4Cspg+ClL6VD4VBQsoMCaP6faIShpYzCwcDswfbrWal6MXKXwTm5DSYYgOhccOWnk6NWU99k53OdoihbQ2vnN3ydcHTzgdzX4nMAJhW2PQDgW/7iyvd+NsKEHPxzQLxc8Zwdu2WPHgnkzoBDKJsFWxB9P2BZ1u15szGe3pzj/NizGA4G7qQAgPwZwAfvF1eEg4HZP1/9+sTr2U37VD47cmcUSAuUCHAI4LssNpLB88TjsfXzk8Mh8XK271obj8djmfI/uYSaC4ok9wZKUXoWmIT0xihr8DxGk9ne1N6d8uATb4OjkXDKytDQ0rFgNJnt9yuqp8of1CWXPuHDVQ1qjq9d4IIVIjt4AGju6D0QbnJ2Vpf6Y9fRxWx26dheWWjOtM5nQ81p0AXga8G1ouABQBiUZ2djOl3wibqhCBOSXPN3N1ZGcgkekHcYSocL3IanCAqDB4BL+oKprK23nx97Ft+fHo+BO0TdgGVZ74fTk0WKomwlZf+KFvDT7oPt1yMRJvSDyv4n+c+8waEoymYwmmxsPE5neVjq6Ojo6Ojo6OjoyOAfZZr9TPrgu5cAAAAASUVORK5CYII=)":
"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABHNCSVQICAgIfAhkiAAABQBJREFUeJztmk1MG0cUx/9rY2wwxbghJEgEYhOBKAJHEJSqjQKVTNRjLnClJ3NMbvXNPcKpvcKFSL1UcOi5xZU5hAiU4pS4VDICGyjIIZCuXcCfwPawtrO21rs73jFOlf1JI2D2MfPef96bGX8AGhoaGhoaGhoaGh8lzBXM4QAwkm23AdyVsF0CsJP9uQRgt3JuKWeujP/pAPA9gDAATkV7BeAJAIuqCFTCQbkIHVlbNUGLNRaAB1USIueElAgW8CtOO3AxIZ7QDE4JQgfERBiG+lQnbT7w2XYlFE8uFGGC0HHa2TBckYiLEJt8DpWp9XLaROVC56l2gFUXodrBKW0VK4dqB6a0sajQxljtwEia70MX4Gfw5/gw3q+WI/u3B/zNT+0c1O8JNFLTA+W3uA6oO2FYgrkUoXbFy3XGgfIzwlPmnKKUGzwNJywoLxuoZkG5AszRcgDliUBtL1BTArREsIC8HF5RmluVADRFcJQxdweNidUKQFME0lKYoDEpDQFoidBRhTmpCcCBf9NELSR7gY/CfB8cHpCJLomuYm5WjiWag/0fBYjSHOwqPheoBLKpLUAyRuIMYBjGrq8xOHU6/SBNe2O92dXZN7Td/+AR197V97uEvYPUZ0n/lBrqawzO2z13Z8wWqz3Xl04m2L3g6+n4SWy62F6n0w/eaLdPXW+zOXN9ZzE2tLcZcGdSyQWhrcFoGusZejgv7EsnE2xw7fk9juNCRUMPg2wfUJ8Bxnqzq/fzrxaFwQNAranOesdxf8ra0jpTMKhOP9g18MWiMHgAMFus9p6hh/PGerNL2N/UfGMMALbWV92vn//KRMLBhVpTnbWuoXFMxB2pj9aIkRWAYRi77bOBKSmbW119LoPRlHfW1jswX2uqs5ay7x74coZhGHup5zKMENj+IWcgK0BdQ+OYMJhIOLiwseIb3VpfdQvtmltvuQA+nYWZEn0bWdtY8Y2GN/wFZdLQdC2fBdHjwwUAuOO4P9X/4BHXauseSycTbOL034JSAf+i6LGczwJ25AxkBbBcaymo4aOD3fGL84w3fhKb/nszMJt7lkt3Q62xYGX3NgOjF+cZ7wl77I6+jazl+hss1vwml0klF4L+5cmzGBsCeNE2/S9GRer/qZy/RSzJGdSQjBY/iRY4lErEix0Ug839kkkn2VJGqfjZ7Hbg5Wyp5+BXn7oAshlwGmPzq3a9zebM1TrDMPb27v5vc8+Eq1shngFoIrDfAbAuZySbAafRd7PpZMKV2weKj6sch/shqdVTiwdktQ/wgskimwEcx4XCf/ndUjZH+2FvKn5WSQFIgwdoCQDw9fnni9/uRcLB4l0ZAHC4F5IUiAIjUHCkCXgGhV+vUXwVvry8WDs62B0vPs621lfdl5cXUvWfP0INtaaSdwMZYiAT4TulAxO9FtDXGJy23oGCja/4GpxJpwpOhvauvkV9jcH5ibV5qqmlNX/0CTdXhSgV4QcQfLmK6NVgZ9/QtvCSs7HiG704z3jl7MQILC92ipzzSrCAP97ErsQ72f6Y0sGIMkAYVHjDPy0WfPbZeDqZKHnmB/3Lk2UGD0hnwmMQBA8AehLjE/Y4+enNNufRftj77s3+UwBJMTuO4yL/vDnwMgxjNze+F+0sxoa2Ay8n08nEjyTzipAC8BOArwHczPZ9A+AXlePSh/T9A0JyH5jQeLNVQ0NDQ0NDQ0ND42PiP8rc/5s0qSasAAAAAElFTkSuQmCC)",
e="#ffffff"==c||"#ffff00"==c?"#333333":"white";f.openGrid({width:2});f.add({css:{"text-align":"center","background-color":c,"background-image":d,"background-size":"contain",cursor:"pointer","-webkit-border-radius":10,"-moz-border-radius":10,"border-radius":10,width:"30px",height:"30px","line-height":"30px","font-weight":"bold",color:e,"font-size":"15px"},onClick:function(){g.makeMove(a)}});f.close()}var d,e=function(c){var b=f.getElement(d),e=lucid.plugin.getProperty(a,"Cube",!0),g=function(a){var d=
lucid.template.builder(),f=e.getFaceColor(a[0]),h=1==a.length?"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABHNCSVQICAgIfAhkiAAABSxJREFUeJztmU1MG0cUx//rDz4CwXym0BAMpgJRBEQQVKmNQg8mZ3qAKz2ZI9zKDXqDE+0xXIzUU8OhPfQGFRxKBEr5cCmRQGAHCjIEkrULttc29vawXne9eO3d9ayh6v6kEezO87x5/5m3M7ML6Ojo6Ojo6Ojo6PwvofLkxwrgy0RpTPyVYgvAWwDLieLSrlvaYgEwCmATAJtD8QCYASeiUpw5RaASC4AJADRyCzxdcUK+EM7Eb/LKKLQJXFxmwAkthVNgmxesAJagfeDi1OhL0xenyE5z+pCfUZcqw4K+iIPXXIBhDQJSU5xIH7ymAtyV4LMVTei7A4HdmgBW3G7O37oAS3cgKGICmBQGP4rM21g5bAH4Gdw21wduq2sFt0V+nGh/IEcfmmBBblPfCfm7OJK7SWJMqOzAJoAulT4tAH5S6ZeoAGpH34nMW1a5qBWfmACjKhw7STmH9CYnbwIoPdJugszIA7kFT0QAqwqnanNeTK7BExFgWKFDUlOfRPBEBFDaEest+NRUgCUFzjYJ+JtR4C8vAihxNkHCYT4xEG5vmXB7mkNaAB/h9jRHzncBJXmUr+8MxCA9A0it/3mDtADlcg0pirIZTWa7wWDsIWlfeK/E0dzRe9D59Dnb0NLxezZ70ikwBuD7TAZGk9ne2Pb4RYmlwsbfizAh+mj3j+ngpX9abG8wGHs+arBN1dQ32fl7AT/tPtrbHo+GmXmhrbmwaLCt99lL4b0IE6J31397wrKsO21/ZAQ1AKBWhh0AMAB+lKosvFfiaOt99rKgqLgipRMmc3Flbb09wgQ/ZgJXv/D3DQZjT0v35wtllTXtQvuCouKKmofWQd/FqTcWja7z96tqH07er6hu33etjR/vv+mPx67by2tqey7pC280El5J1yc5KfBWhg3PACQOQRRF2Zo+7Z7K9ONHLR0Oc2HRIH/d1N59Qywhrd1fvKAoyiZVLwc5AiwrbHMs3c3i0rJBYTBez+78zupS/75rbVxoV133yAFw01mYJr533vWd1aV+z85GSpqUllc5kjYXZ/MA8EnXZ1OdT5+zdU2tgxEmRIeu/k5JFSFaCXBjFliqHqTk8PnJ4VDsOroYvPRP/7W3PcvX8bluLihMGdmjve3+2HV08ZK+GPe98yanfamlIvmQi4aZ+d2NlZGAn3YDnGh7G6/6pfIfkPdS1AUuDRpl2ALcSjAH4Cspg+ClL6VD4VBQsoMCaP6faIShpYzCwcDswfbrWal6MXKXwTm5DSYYgOhccOWnk6NWU99k53OdoihbQ2vnN3ydcHTzgdzX4nMAJhW2PQDgW/7iyvd+NsKEHPxzQLxc8Zwdu2WPHgnkzoBDKJsFWxB9P2BZ1u15szGe3pzj/NizGA4G7qQAgPwZwAfvF1eEg4HZP1/9+sTr2U37VD47cmcUSAuUCHAI4LssNpLB88TjsfXzk8Mh8XK271obj8djmfI/uYSaC4ok9wZKUXoWmIT0xihr8DxGk9ne1N6d8uATb4OjkXDKytDQ0rFgNJnt9yuqp8of1CWXPuHDVQ1qjq9d4IIVIjt4AGju6D0QbnJ2Vpf6Y9fRxWx26dheWWjOtM5nQ81p0AXga8G1ouABQBiUZ2djOl3wibqhCBOSXPN3N1ZGcgkekHcYSocL3IanCAqDB4BL+oKprK23nx97Ft+fHo+BO0TdgGVZ74fTk0WKomwlZf+KFvDT7oPt1yMRJvSDyv4n+c+8waEoymYwmmxsPE5neVjq6Ojo6Ojo6OjoyOAfZZr9TPrgu5cAAAAASUVORK5CYII=)":
"2"==a[1]?"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABHNCSVQICAgIfAhkiAAABSxJREFUeJztmUtMG1cUhv/xi3fGU8DITYqLaUFRBYlwUaUUhS6ANV04W7qCJd3BDrojK6ruYGOq7vCi2TZGggVUReEZlwUUbEJauaVJxlOw8aN4urDHDGZs5nHHIHU+6Qozc+499/z3dWYGMDAwMDAwMDAwMPhfQpXJjwvAF7nyYe5vMbYAHAJYypVt/bqlLzSAUQCbAHgNJQxgGlkRleLTFIFKaAATAFhoC1yq+CBfCF+uTlkZhT6BF5ZpZIUuhk9kWxZcABahf+CFS6NXoi++Ajvd6UV5Rr1YGRL1pTB43QUY0iEgNcUH6eB1FeC2BH9d0YXeWxDYjQngws2u+RsXYPEWBEVMAIvC4EdROo2VwxaAZ8imuVFkU10Xsinyw1z7gxp96AINbVPfB/lZHMlskhgTKjuwCeCBSp80gB9V+iUqgNrR96F0yioXteITE2BUhWMfKeconuSUTQClj7SbIDPygLbgiQjgUuFU7ZovRGvwRAQYUuiQ1NQnETwRAZR2xHUDPnUVYFGBs00C/qYV+CuLAEqcTZBwWE5MhNtbItye7pAWIEq4Pd2R811AyToq13cGYpCeAaTO/7JBWgA74fZ0h7QAD7U2QFGU22yx9plMZg8p+4rqmuHWju6Dzp4BvrmtY01sK2fNbkJ+YM8AfJn7zbR2dK/V0IxbuBk9jqwf7QX7kX2yLIRpvOuacba0e4ULMY4NhXc2nmQy5+uFxiaT2dPU7J5qvNfSJ7Y/2guOp5MJv3DNWlHpvd/9eF5cN5U4Y3fXlz/leT4kZwYcyrARGETuIai6jh4WBw8AdofTY7ZYpUaKaW7rCIiDB4AamnG3dT0KFI6uyWT2tHU9CoiDF+zvdz+er6iuGc77bGjyAsD+9ur4y+XnVCS867dVVjFVtXe8gLwlsCTDRszXAJCInS7IrVBdRw/bHU7JKWyrrGLqnffGxNdaPumat1VWMcXaa+/6fIaiKHex+2L0EoDOZM7XgyuB1v3t1fHrKtD1jkvT+OXy8/ci4d38NBbPDGtFpbdwWe38stgf3tl4Km6z1l4/DADRN3/5AeCjB59NdfYM8M6Wdm8qccaenf7jB+QJsA1ly8AOYA4AeJ4PJc/iV9avFqy2iksje7QX7D//N71wwr4Zjx5H8r5qacYDAOlkwr+7sTIS49gQkBVsb+Pnfp7nQ4D8t8JzACYV9HMQ2eeCb+QYc2+PF4T1XEMz7s6egXfi+6/3grMlquc31HQqIbW5IhmPzR4EX0i2IfcYnJNpJ0b2q+34CVcqQJxyrOz9RClyBXgFZSJsQcH3A8bhnCp13+n6eKzUfS0oSYQmZdoJwXNyjCmKcn/Q1pE/tmIcG9rfXh3/+/dwftTtDqdHfLSRRIkArwB8e42NouABQDiPBUK/rvXHT7inkcPf+oWNCwDuMA19V2trR2kqPIniJ4Li4KXgef5iU0tebGoWq63YuZ+/brVVFs0NiqFUAA7Sm5vq4NOpZEj8f+Nd14zZYu2rrqPHxMnRKceuS9k3t3UEzBZrXx3TMCVlfx1KP44C2bzgK1xsippGPp1M+GMcGxKSG2dLu7cwJQaA0+jbWSl7u8PpsTucgWL216H2afB7ZPcDItM+vLPxJJU4kzzDAWB3Y2VESFzU2JfCrKyrl/gJwAyAZCkjPpMJpRLx9+n6Js/rveBs/IT77ooNz0fe/fnHAkVR7po7F2lujGNDB8EXI6nE2Q9a7Etx615hURTlNpktbj6TYaUeg7XaGxgYGBgYGBgY5PgPHc4RtaXi8ysAAAAASUVORK5CYII=)":
"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABHNCSVQICAgIfAhkiAAABQBJREFUeJztmk1MG0cUx/9rY2wwxbghJEgEYhOBKAJHEJSqjQKVTNRjLnClJ3NMbvXNPcKpvcKFSL1UcOi5xZU5hAiU4pS4VDICGyjIIZCuXcCfwPawtrO21rs73jFOlf1JI2D2MfPef96bGX8AGhoaGhoaGhoaGh8lzBXM4QAwkm23AdyVsF0CsJP9uQRgt3JuKWeujP/pAPA9gDAATkV7BeAJAIuqCFTCQbkIHVlbNUGLNRaAB1USIueElAgW8CtOO3AxIZ7QDE4JQgfERBiG+lQnbT7w2XYlFE8uFGGC0HHa2TBckYiLEJt8DpWp9XLaROVC56l2gFUXodrBKW0VK4dqB6a0sajQxljtwEia70MX4Gfw5/gw3q+WI/u3B/zNT+0c1O8JNFLTA+W3uA6oO2FYgrkUoXbFy3XGgfIzwlPmnKKUGzwNJywoLxuoZkG5AszRcgDliUBtL1BTArREsIC8HF5RmluVADRFcJQxdweNidUKQFME0lKYoDEpDQFoidBRhTmpCcCBf9NELSR7gY/CfB8cHpCJLomuYm5WjiWag/0fBYjSHOwqPheoBLKpLUAyRuIMYBjGrq8xOHU6/SBNe2O92dXZN7Td/+AR197V97uEvYPUZ0n/lBrqawzO2z13Z8wWqz3Xl04m2L3g6+n4SWy62F6n0w/eaLdPXW+zOXN9ZzE2tLcZcGdSyQWhrcFoGusZejgv7EsnE2xw7fk9juNCRUMPg2wfUJ8Bxnqzq/fzrxaFwQNAranOesdxf8ra0jpTMKhOP9g18MWiMHgAMFus9p6hh/PGerNL2N/UfGMMALbWV92vn//KRMLBhVpTnbWuoXFMxB2pj9aIkRWAYRi77bOBKSmbW119LoPRlHfW1jswX2uqs5ay7x74coZhGHup5zKMENj+IWcgK0BdQ+OYMJhIOLiwseIb3VpfdQvtmltvuQA+nYWZEn0bWdtY8Y2GN/wFZdLQdC2fBdHjwwUAuOO4P9X/4BHXauseSycTbOL034JSAf+i6LGczwJ25AxkBbBcaymo4aOD3fGL84w3fhKb/nszMJt7lkt3Q62xYGX3NgOjF+cZ7wl77I6+jazl+hss1vwml0klF4L+5cmzGBsCeNE2/S9GRer/qZy/RSzJGdSQjBY/iRY4lErEix0Ug839kkkn2VJGqfjZ7Hbg5Wyp5+BXn7oAshlwGmPzq3a9zebM1TrDMPb27v5vc8+Eq1shngFoIrDfAbAuZySbAafRd7PpZMKV2weKj6sch/shqdVTiwdktQ/wgskimwEcx4XCf/ndUjZH+2FvKn5WSQFIgwdoCQDw9fnni9/uRcLB4l0ZAHC4F5IUiAIjUHCkCXgGhV+vUXwVvry8WDs62B0vPs621lfdl5cXUvWfP0INtaaSdwMZYiAT4TulAxO9FtDXGJy23oGCja/4GpxJpwpOhvauvkV9jcH5ibV5qqmlNX/0CTdXhSgV4QcQfLmK6NVgZ9/QtvCSs7HiG704z3jl7MQILC92ipzzSrCAP97ErsQ72f6Y0sGIMkAYVHjDPy0WfPbZeDqZKHnmB/3Lk2UGD0hnwmMQBA8AehLjE/Y4+enNNufRftj77s3+UwBJMTuO4yL/vDnwMgxjNze+F+0sxoa2Ay8n08nEjyTzipAC8BOArwHczPZ9A+AXlePSh/T9A0JyH5jQeLNVQ0NDQ0NDQ0ND42PiP8rc/5s0qSasAAAAAElFTkSuQmCC)",
l="#ffffff"==f||"#ffff00"==f?"#333333":"white";d.spacer();d.add({css:{"text-align":"center",background:f,"background-image":h,"background-repeat":"no-repeat",cursor:"pointer","-webkit-border-radius":10,"-moz-border-radius":10,"border-radius":10,width:"64px",height:"64px","line-height":"60px","font-weight":"bold",color:l,"font-size":"15px"},onClick:function(){e.makeMove(a);0<c.length?g(c.shift()):b.setContent({})}});b.setContent(d)};0<c.length&&g(c.shift())},g=lucid.plugin.getProperty(a,"Cube",!0);
f=lucid.template.builder();f.addGrid({width:2,content:{text:"x:"}});f.openGrid({width:10});var h=f.addInput({type:"slider",min:-.5,max:360.5,step:.5,value:0,onStart:function(c){x[a]={x:null,y:null,z:null}},onSlide:function(c){x[a].x=c;lucid.plugin.invalidateViewport()},onStop:function(b){c([a]);delete x[a]},onChange:function(b,d){if(!d){var e={};e[a]={x:b};c(e)}}});f.close();f.addGrid({width:2,content:{text:"y:"}});f.openGrid({width:10});var r=f.addInput({type:"slider",min:-.5,max:360.5,step:.5,value:0,
onStart:function(c){x[a]={x:null,y:null,z:null}},onSlide:function(c){x[a].y=c;lucid.plugin.invalidateViewport()},onStop:function(b){c([a]);delete x[a]},onChange:function(b,d){if(!d){var e={};e[a]={y:b};c(e)}}});f.close();f.addGrid({width:2,content:{text:"z:"}});f.openGrid({width:10});var k=f.addInput({type:"slider",min:-.5,max:360.5,step:.5,value:0,onStart:function(c){x[a]={x:null,y:null,z:null}},onSlide:function(c){x[a].z=c;lucid.plugin.invalidateViewport()},onStop:function(b){c([a]);delete x[a]},
onChange:function(b,d){if(!d){var e={};e[a]={z:b};c(e)}}});f.close();f.spacer();b("F");b("B");b("U");b("D");b("R");b("L");f.spacer();b("F'");b("B'");b("U'");b("D'");b("R'");b("L'");f.spacer();f.openGrid({width:6});f.addButton({label:"Solve",onClick:function(){var c=lucid.plugin.getProperty(a,"Cube",!0),b=new p,e=c.getState();b.setState(e)?(b=b.solve(),f.getElement(d).setContent({}),c.makeMoves(b)):lucid.dialog.alert(b.currentState)}});f.close();f.openGrid({width:6});f.addButton({label:"Interactive solve",
onClick:function(){var c=lucid.plugin.getProperty(a,"Cube",!0),b=new p,c=c.getState();b.setState(c)?(b=b.solve(),e(b.split(" "))):lucid.dialog.alert(b.currentState)}});f.close();f.clear();d=f.add();var m=lucid.plugin.getProperty(a,"CubeRotation");setTimeout(function(){h.setValue(180/Math.PI*(m.x-.6));r.setValue(180/Math.PI*(m.y-.6));k.setValue(180/Math.PI*m.z)},20)}var c=function(a){lucid.object.forEach(a||x,function(a,c){var b=lucid.plugin.getProperty(c,"CubeRotation"),d=lucid.plugin.getProperty(c,
"CameraAffine");if(a.x){var e=b.x;b.x=.6+a.x*Math.PI/180;d=B(d,C((e-a.x)*Math.PI/180))}a.y&&(e=b.y,b.y=.6+a.y*Math.PI/180,d=B(d,D((e-a.y)*Math.PI/180)));a.z&&(e=b.z,b.z=a.z*Math.PI/180,d=B(d,E((e-a.z)*Math.PI/180)));lucid.plugin.setProperty(c,"CubeRotation",b);lucid.plugin.setProperty(c,"CameraAffine",d)})};lucid.plugin.provideRenderProperties(function(){c();lucid.object.forEach(P,function(a,c){delete P[c]})});var e=lucid.template.builder(),d,g,f=lucid.template.builder(),h=lucid.template.builder(),
r=h.add();lucid.plugin.addCustomPanel("Context Panel",null,[{content:h}],null,{isContextPanel:!0,checkShow:function(c){if(1!=c.length)return!1;var l;if("RubikCube"==c[0].className){var k=!0;l=lucid.plugin.getProperty(c[0].id,"CurrentColor",!0);a(c[0].id,l);l=e;var m=lucid.plugin.getProperty(c[0].id,"Editing",!0);d.setValue(m);c=lucid.plugin.getProperty(c[0].id,"Show3dBlock");g.setValue(c)}else if("RubikCube3d"==c[0].className)k=!0,b(c[0].id),l=f;else return!1;h.getElement(r).setContent(l);return k}})});
lucid.plugin.initBlockClass({className:"RubikCube",name:"Rubik",searchKeywords:["cube","solve","rubik","secret"],defaultSize:{w:450,h:600},disabledPropertyControls:["FillColor"],allowHiding:!0,onCreate:function(a){var b=lucid.plugin.addBlock(lucid.plugin.getItemPageId(a),{className:"RubikCube3d",RubikCube:a,Hidden:!0});lucid.plugin.setProperty(a,"OtherBlock",b)},onDelete:function(a){lucid.plugin.deleteItem(lucid.plugin.getProperty(a,"OtherBlock"))},onInit:function(a){lucid.plugin.registerProperty(a,
"BlockColors",{"3,0":"#009900","4,0":"#009900","5,0":"#009900","3,1":"#009900","4,1":"#009900","5,1":"#009900","3,2":"#009900","4,2":"#009900","5,2":"#009900","0,3":"#cc0000","1,3":"#cc0000","2,3":"#cc0000","3,3":"#ffffff","4,3":"#ffffff","5,3":"#ffffff","6,3":"#ff8000","7,3":"#ff8000","8,3":"#ff8000","0,4":"#cc0000","1,4":"#cc0000","2,4":"#cc0000","3,4":"#ffffff","4,4":"#ffffff","5,4":"#ffffff","6,4":"#ff8000","7,4":"#ff8000","8,4":"#ff8000","0,5":"#cc0000","1,5":"#cc0000","2,5":"#cc0000","3,5":"#ffffff",
"4,5":"#ffffff","5,5":"#ffffff","6,5":"#ff8000","7,5":"#ff8000","8,5":"#ff8000","3,6":"#000099","4,6":"#000099","5,6":"#000099","3,7":"#000099","4,7":"#000099","5,7":"#000099","3,8":"#000099","4,8":"#000099","5,8":"#000099","3,9":"#ffff00","4,9":"#ffff00","5,9":"#ffff00","3,10":"#ffff00","4,10":"#ffff00","5,10":"#ffff00","3,11":"#ffff00","4,11":"#ffff00","5,11":"#ffff00"});lucid.plugin.hookPropertyPostSave(a,"BlockColors",function(b){b=lucid.plugin.getProperty(a,"OtherBlock");var c=lucid.plugin.getProperty(b,
"Cube",!0);c&&(c.updateColors(),U(b))});lucid.plugin.setProperty(a,"Editing",!1,!0);lucid.plugin.setProperty(a,"CurrentColor",V[0],!0);lucid.plugin.registerProperty(a,"Show3dBlock",!1);lucid.plugin.registerProperty(a,"Rotating",0)},getLinkPoints:function(){return[]},onPaste:function(a,b){var c=lucid.plugin.addBlock(lucid.plugin.getItemPageId(a),{className:"RubikCube3d",RubikCube:a,Hidden:!0});lucid.plugin.setProperty(a,"OtherBlock",c)},hitTest:function(a,b){var c=lucid.plugin.getProperty(a,"BoundingBox");
if(c){var e=lucid.math.Point.rotate(b,lucid.math.Box.center(c),-lucid.plugin.getProperty(a,"Rotation"));if(lucid.plugin.getProperty(a,"Editing",!0)){var d=Math.floor((e.x-c.x)/(c.w/9)),g=Math.floor((e.y-c.y)/(c.h/12)),f=lucid.plugin.getProperty(a,"BlockColors"),h=lucid.plugin.getProperty(a,"CurrentColor",!0);lucid.plugin.getProperty(a,"OtherBlock");if(void 0!==f[[d,g]]&&h!=f[[d,g]])return{onClick:function(){f[[d,g]]=h;lucid.plugin.setProperty(a,"BlockColors",f)},cursor:"pointer"};if(void 0!==f[[d,
g]])return{cursor:"pointer"}}}},getRenderData:function(a,b){function c(c,b){var f=d[[c,b]]||"#dddddd",l=e.w/9,k=e.h/12;c=e.x+e.w/9*c;b=e.y+e.h/12*b;return{FillColor:f,StrokeColor:a.LineColor,LineWidth:g,Actions:[{Action:"move",x:c,y:b},{Action:"line",x:c+l,y:b},{Action:"line",x:c+l,y:b+k},{Action:"line",x:c,y:b+k},{Action:"close"}]}}var e=a.BoundingBox,d=a.BlockColors,g=a.LineWidth;"sample"==b&&(g=0);var f=[];lucid.array.forEach(W,function(a){f.push(c(a[0],a[1]))});return f}});var T=function(a,b,
c,e){a=lucid.plugin.getProperty(a,"BlockColors");var d="#000000 #000000 #000000 #000000 #000000 #000000".split(" "),g=Math.abs(b)+Math.abs(c)+Math.abs(e);3==g?1==b&&1==e&&1==c?(d[q]=a[[5,5]],d[n]=a[[5,6]],d[v]=a[[6,5]]):1==b&&1==e&&-1==c?(d[q]=a[[5,3]],d[v]=a[[6,3]],d[w]=a[[5,2]]):1==b&&-1==e&&1==c?(d[q]=a[[3,5]],d[n]=a[[3,6]],d[u]=a[[2,5]]):1==b&&-1==e&&-1==c?(d[q]=a[[3,3]],d[w]=a[[3,2]],d[u]=a[[2,3]]):-1==b&&1==e&&1==c?(d[n]=a[[5,8]],d[v]=a[[8,5]],d[t]=a[[5,9]]):-1==b&&1==e&&-1==c?(d[v]=a[[8,3]],
d[w]=a[[5,0]],d[t]=a[[5,11]]):-1==b&&-1==e&&1==c?(d[n]=a[[3,8]],d[u]=a[[0,5]],d[t]=a[[3,9]]):-1==b&&-1==e&&-1==c&&(d[w]=a[[3,0]],d[u]=a[[0,3]],d[t]=a[[3,11]]):2==g?1==b?1==c?(d[n]=a[[4,6]],d[q]=a[[4,5]]):-1==c?(d[w]=a[[4,2]],d[q]=a[[4,3]]):1==e?(d[v]=a[[6,4]],d[q]=a[[5,4]]):-1==e&&(d[u]=a[[2,4]],d[q]=a[[3,4]]):-1==b?1==c?(d[n]=a[[4,8]],d[t]=a[[4,9]]):-1==c?(d[w]=a[[4,0]],d[t]=a[[4,11]]):1==e?(d[v]=a[[8,4]],d[t]=a[[5,10]]):-1==e&&(d[u]=a[[0,4]],d[t]=a[[3,10]]):1==c?1==e?(d[n]=a[[5,7]],d[v]=a[[7,5]]):
-1==e&&(d[n]=a[[3,7]],d[u]=a[[1,5]]):-1==c&&(1==e?(d[w]=a[[5,1]],d[v]=a[[7,3]]):-1==e&&(d[w]=a[[3,1]],d[u]=a[[1,3]])):1==g&&(1==b?d[q]=a[[4,4]]:-1==b?d[t]=a[[4,10]]:1==c?d[n]=a[[4,7]]:-1==c?d[w]=a[[4,1]]:1==e?d[v]=a[[7,4]]:-1==e&&(d[u]=a[[1,4]]));return d};lucid.plugin.initBlockClass({className:"RubikCube3d",name:"Rubik 3D",searchKeywords:[],defaultSize:{w:450,h:450},disabledPropertyControls:["FillColor"],allowHiding:!0,noSearch:!0,onInit:function(a){lucid.plugin.registerProperty(a,"RubikCube",null);
lucid.plugin.registerProperty(a,"OtherBlock",null);lucid.plugin.registerProperty(a,"CubeRotation",{x:.6,y:.6,z:0});lucid.plugin.registerProperty(a,"CameraAffine",H(.6,.6,0))},onDelete:function(a){lucid.plugin.deleteItem(lucid.plugin.getProperty(a,"RubikCube"))},onPaste:function(a,b){lucid.object.map(b,function(c,b){if(c==a){var d=lucid.plugin.getProperty(b,"RubikCube"),d=lucid.plugin.getProperty(d,"BlockColors"),d=lucid.plugin.addBlock(lucid.plugin.getItemPageId(a),{className:"RubikCube",OtherBlock:a,
Show3dBlock:!0,BlockColors:d});lucid.plugin.setProperty(a,"RubikCube",d)}})},getLinkPoints:function(){return[]},spatialControls:function(a){lucid.plugin.getProperty(a,"BoundingBox");lucid.plugin.getProperty(a,"Cube",!0).getVisibleFaces();return[]},hitTest:function(a,b){},getRenderData:function(a,b){var c=a.BoundingBox,e=lucid.plugin.getProperty(a.id,"Cube",!0);if(!e&&a.RubikCube)e=new k(a.RubikCube,a.id),lucid.plugin.setProperty(a.id,"Cube",e,!0);else if(!a.RubikCube)return[];e.cameraX=a.CubeRotation.x;
e.cameraY=a.CubeRotation.y;e.cameraZ=a.CubeRotation.z;return e.getRenderData(c)}});lucid.plugin.createToolGroups({Rubiks:["RubikCube"]});var Q=function(a,b,c,e){this.project=c;this.rubiks=e;this.xo=b[0];this.yo=b[1];this.zo=b[2];this.cube=a};Q.prototype.projection=function(a){var b=m(this.cube.rotationAffine,{x:this.xo,y:this.yo,z:this.zo}),b=m(this.rubiks.cameraAffine,b);this.x=b.x;this.y=b.y;this.z=b.z;var c=b.x,e=b.y,b=b.z;this.project&&(this.visible=0<350+b,this.X=a.x+a.w/75*(37.5+250/(b+350)*
c),this.Y=a.y+a.h/75*(37.5+250/(b+350)*e))};var I=function(a,b,c,e,d){this.rubiks=d;this.cube=a;this.p0=a.points[b[0]];this.p1=a.points[b[1]];this.p2=a.points[b[2]];this.p3=a.points[b[3]];this.normal=new Q(this.cube,c,!1,d);this.color=e};I.prototype.distanceToCamera=function(){var a=.25*(this.p0.x+this.p1.x+this.p2.x+this.p3.x),b=.25*(this.p0.y+this.p1.y+this.p2.y+this.p3.y),c=600+.25*(this.p0.z+this.p1.z+this.p2.z+this.p3.z);this.distance=Math.sqrt(a*a+b*b+c*c)};I.prototype.getRenderData=function(){this.normal.projection();
var a=this.normal.z,a=a+.8*(1-a);return{FillColor:lucid.color.rgb((this.color||"#000000").substr(1).match(/../g).map(function(b){return parseInt(b,16)*a})).ahex(),StrokeColor:"#000000",LineWidth:2,Actions:[{Action:"move",x:this.p0.X,y:this.p0.Y},{Action:"line",x:this.p1.X,y:this.p1.Y},{Action:"line",x:this.p2.X,y:this.p2.Y},{Action:"line",x:this.p3.X,y:this.p3.Y},{Action:"close"}]}};I.prototype.hitTest=function(a){function b(a){return{x:a.X,y:a.Y}}var c;c=0+(lucid.math.linesIntersect(b(this.p0),b(this.p1),
{x:-1E4,y:-1E4},a)?1:0);c+=lucid.math.linesIntersect(b(this.p1),b(this.p2),{x:-1E4,y:-1E4},a)?1:0;c+=lucid.math.linesIntersect(b(this.p2),b(this.p3),{x:-1E4,y:-1E4},a)?1:0;c+=lucid.math.linesIntersect(b(this.p3),b(this.p0),{x:-1E4,y:-1E4},a)?1:0;return 1==c%2};var z=function(a,b,c,e,d,g){this.rubiks=d;this.w=e;this.points=[];a=[[a-e,b-e,c-e],[a+e,b-e,c-e],[a+e,b+e,c-e],[a-e,b+e,c-e],[a-e,b-e,c+e],[a+e,b-e,c+e],[a+e,b+e,c+e],[a-e,b+e,c+e]];for(var f in a)this.points.push(new Q(this,a[f],!0,d));a=[[0,
1,2,3],[0,4,5,1],[3,2,6,7],[0,3,7,4],[1,5,6,2],[5,4,7,6]];b=[[0,0,1],[0,1,0],[0,-1,0],[1,0,0],[-1,0,0],[0,0,-1]];this.alpha=1;this.faces=[];for(f in a)this.faces.push(new I(this,a[f],b[f],g[f],d));this.rotationAffine=R();this.rotateZ=this.rotateY=this.rotateX=0};z.prototype.updateColors=function(a){lucid.array.forEach(this.faces,function(b){1==b.normal.zo?b.color=a[0]:1==b.normal.yo?b.color=a[1]:-1==b.normal.yo?b.color=a[2]:1==b.normal.xo?b.color=a[3]:-1==b.normal.xo?b.color=a[4]:-1==b.normal.zo&&
(b.color=a[5])})};z.prototype.getPosition=function(){for(var a=[],b=0;b<this.points.length;b++){var c=m(C(this.rotateX),{x:this.points[b].xo,y:this.points[b].yo,z:this.points[b].zo}),c=m(D(this.rotateY),c),c=m(E(this.rotateZ),c);a.push(c)}for(var b={x:0,y:0,z:0},c=0,e=a.length;c<e;++c){var d=a[c];b.x+=d.x;b.y+=d.y;b.z+=d.z}a=1/e;b.x*=a;b.y*=a;b.z*=a;b.x=Math.round(b.x);b.y=Math.round(b.y);b.z=Math.round(b.z);return b};z.prototype.setRotationAffine=function(){if(0!=this.rotateX||0!=this.rotateY||0!=
this.rotateZ)this.rotationAffine=H(this.rotateX,this.rotateY,this.rotateZ)};z.prototype.resetRotation=function(){for(var a=0;a<this.points.length;a++){var b=m(C(this.rotateX),{x:this.points[a].xo,y:this.points[a].yo,z:this.points[a].zo}),b=m(D(this.rotateY),b),b=m(E(this.rotateZ),b);this.points[a].xo=b.x;this.points[a].yo=b.y;this.points[a].zo=b.z}for(a=0;a<this.faces.length;a++){var c=this.faces[a].normal,b=m(C(this.rotateX),{x:c.xo,y:c.yo,z:c.zo}),b=m(D(this.rotateY),b),b=m(E(this.rotateZ),b);c.xo=
b.x;c.yo=b.y;c.zo=b.z}this.rotateZ=this.rotateY=this.rotateX=0;this.rotationAffine=R()};z.prototype.getRenderData=function(){for(var a=[],b=[],c=0,e;e=this.points[c++];)e.projection();for(c=0;c<this.faces.length;c++)this.faces[c].distanceToCamera(),b.push(this.faces[c]);b.sort(function(a,c){return c.distance-a.distance});for(c=0;e=b[c++];)if(e.visible)a.push(e.getRenderData());else break;return a};k.prototype.updateFlatBlock=function(){var a=lucid.plugin.getProperty(this.flatId,"BlockColors"),b,c=
this.getBlocks("U");lucid.array.forEach(c,function(c){var d=c.getPosition(),g=0==d.x?0:Math.abs(d.x)/d.x,d=0==d.z?0:Math.abs(d.z)/d.z;lucid.array.forEach(c.faces,function(a){1==a.normal.yo&&(b=a.color)});a[[4+d,4+g]]=b});c=this.getBlocks("D");lucid.array.forEach(c,function(c){var d=c.getPosition(),g=0==d.x?0:Math.abs(d.x)/d.x,d=0==d.z?0:Math.abs(d.z)/d.z;lucid.array.forEach(c.faces,function(a){-1==a.normal.yo&&(b=a.color)});a[[4+d,10-g]]=b});c=this.getBlocks("F");lucid.array.forEach(c,function(c){var d=
c.getPosition(),g=0==d.y?0:Math.abs(d.y)/d.y,d=0==d.z?0:Math.abs(d.z)/d.z;lucid.array.forEach(c.faces,function(a){-1==a.normal.xo&&(b=a.color)});a[[4+d,7+g]]=b});c=this.getBlocks("B");lucid.array.forEach(c,function(c){var d=c.getPosition(),g=0==d.y?0:Math.abs(d.y)/d.y,d=0==d.z?0:Math.abs(d.z)/d.z;lucid.array.forEach(c.faces,function(a){1==a.normal.xo&&(b=a.color)});a[[4+d,1-g]]=b});c=this.getBlocks("R");lucid.array.forEach(c,function(c){var d=c.getPosition(),g=0==d.x?0:Math.abs(d.x)/d.x,d=0==d.y?
0:Math.abs(d.y)/d.y;lucid.array.forEach(c.faces,function(a){-1==a.normal.zo&&(b=a.color)});a[[7+d,4+g]]=b});c=this.getBlocks("L");lucid.array.forEach(c,function(c){var d=c.getPosition(),g=0==d.x?0:Math.abs(d.x)/d.x,d=0==d.y?0:Math.abs(d.y)/d.y;lucid.array.forEach(c.faces,function(a){1==a.normal.zo&&(b=a.color)});a[[1-d,4+g]]=b});lucid.plugin.setProperty(this.flatId,"BlockColors",a)};k.prototype.updateColors=function(){var a=this;lucid.array.forEach(this.blocks,function(b){var c=b.getPosition(),c=
T(a.flatId,0>c.y?1:0<c.y?-1:0,0>c.x?-1:0<c.x?1:0,0>c.z?-1:0<c.z?1:0);b.updateColors(c)})};k.prototype.getRenderData=function(a){this.cameraAffine=H(this.cameraX,this.cameraY,this.cameraZ);lucid.array.forEach(this.blocks,function(a){a.setRotationAffine()});lucid.array.forEach(this.points,function(c){c.projection(a)});lucid.array.forEach(this.faces,function(a){a.distanceToCamera()});this.faces.sort(function(a,b){return b.distance-a.distance});var b=[];lucid.array.forEach(this.faces,function(a){b.push(a.getRenderData())});
return b};k.prototype.render=function(){this.cameraAffine=H(this.cameraX,this.cameraY,this.cameraZ);lucid.array.forEach(this.blocks,function(a){a.setRotationAffine()});lucid.array.forEach(this.points,function(a){a.projection()});lucid.array.forEach(this.faces,function(a){a.distanceToCamera()});this.faces.sort(function(a,c){return c.distance-a.distance});this.ctx.fillStyle="rgba(0,0,0,1)";this.ctx.fillRect(0,0,this.width,this.width);for(var a=0;a<this.faces.length;a++)this.faces[a].draw()};k.prototype.opposites=
{F:"B",B:"F",T:"D",D:"T",R:"L",L:"R"};k.prototype.rotateFace=function(a,b){if(!this.rotating){this.rotating=a;var c=this.getBlocks(a),e=[];lucid.array.forEach(c,function(a){e.push({rotateY:a.rotateY,rotateX:a.rotateX,rotateZ:a.rotateZ})});var d=Math.floor(8*Math.abs(b)),g=0,f=this,h=function(){lucid.array.forEach(c,function(c,f){if("F"==a||"B"==a||"Z"==a)c.rotateX=e[f].rotateX+Math.PI/2*b*(g/d);if("U"==a||"D"==a||"Y"==a)c.rotateY=e[f].rotateY+Math.PI/2*b*(g/d);if("L"==a||"R"==a||"X"==a)c.rotateZ=
e[f].rotateZ+Math.PI/2*b*(g/d)});g++;if(g<=d)U(f.blockId),setTimeout(function(){h()},20);else{f.rotating=!1;for(var k=0;k<c.length;k++)c[k].resetRotation();f.updateFlatBlock();f.makeNextMove()}};h()}};k.prototype.getBlocks=function(a){var b=[];if("B"==a)lucid.array.forEach(this.blocks,function(a){0>a.getPosition().x&&b.push(a)});else if("F"==a)lucid.array.forEach(this.blocks,function(a){0<a.getPosition().x&&b.push(a)});else if("U"==a)lucid.array.forEach(this.blocks,function(a){0>a.getPosition().y&&
b.push(a)});else if("D"==a)lucid.array.forEach(this.blocks,function(a){0<a.getPosition().y&&b.push(a)});else if("L"==a)lucid.array.forEach(this.blocks,function(a){0>a.getPosition().z&&b.push(a)});else if("R"==a)lucid.array.forEach(this.blocks,function(a){0<a.getPosition().z&&b.push(a)});else if("X"==a||"Y"==a||"Z"==a)b=this.blocks;return b};k.prototype.makeMoves=function(a){a=a.split(/\s/);for(var b=0;b<a.length;b++)this.makeMove(a[b])};k.prototype.makeMove=function(a){if(this.rotating)this.queue.push(a);
else{this.moveHistory.push(a);var b=1;"2"==a[a.length-1]&&(b++,a=a.substr(0,a.length-1));switch(a.toLowerCase()){case "f":this.rotateFace("F",-b);break;case "f'":this.rotateFace("F",b);break;case "r":this.rotateFace("R",-b);break;case "r'":this.rotateFace("R",b);break;case "u":this.rotateFace("U",b);break;case "u'":this.rotateFace("U",-b);break;case "d":this.rotateFace("D",-b);break;case "d'":this.rotateFace("D",b);break;case "b":this.rotateFace("B",b);break;case "b'":this.rotateFace("B",-b);break;
case "l":this.rotateFace("L",b);break;case "l'":this.rotateFace("L",-b);break;case "x":this.rotateFace("X",b);break;case "x'":this.rotateFace("X",-b);break;case "y":this.rotateFace("Y",b);break;case "y'":this.rotateFace("Y",-b);break;case "z":this.rotateFace("Z",-b);break;case "z'":this.rotateFace("Z",b)}}};k.prototype.makeNextMove=function(){0<this.queue.length&&this.makeMove(this.queue.shift())};k.prototype.getFaceColor=function(a){function b(a){for(var b=-1,d=0,g=0;g<a.faces.length;g++){var f=
S([a.faces[g].p0,a.faces[g].p1,a.faces[g].p2,a.faces[g].p3]);Math.abs(f.x)>d&&(b=g,d=Math.abs(f.x));Math.abs(f.y)>d&&(b=g,d=Math.abs(f.y));Math.abs(f.z)>d&&(b=g,d=Math.abs(f.z))}return a.faces[b].color}switch(a){case "D":return b(lucid.array.find(this.blocks,function(a){a=a.getPosition();return 0==a.x&&0<a.y&&0==a.z}));case "U":return b(lucid.array.find(this.blocks,function(a){a=a.getPosition();return 0==a.x&&0>a.y&&0==a.z}));case "L":return b(lucid.array.find(this.blocks,function(a){a=a.getPosition();
return 0==a.x&&0==a.y&&0>a.z}));case "R":return b(lucid.array.find(this.blocks,function(a){a=a.getPosition();return 0==a.x&&0==a.y&&0<a.z}));case "F":return b(lucid.array.find(this.blocks,function(a){a=a.getPosition();return 0<a.x&&0==a.y&&0==a.z}));case "B":return b(lucid.array.find(this.blocks,function(a){a=a.getPosition();return 0>a.x&&0==a.y&&0==a.z}))}};k.prototype.getVisibleFaces=function(){};k.prototype.getCubie=function(a){var b=this.getBlocks(a[0]);switch(a){case "UF":case "DF":return lucid.array.find(b,
function(a){a=a.getPosition();return 0==a.z&&0<a.x});case "UB":case "DB":return lucid.array.find(b,function(a){a=a.getPosition();return 0==a.z&&0>a.x});case "UR":case "DR":return lucid.array.find(b,function(a){a=a.getPosition();return 0<a.z&&0==a.x});case "UL":case "DL":return lucid.array.find(b,function(a){a=a.getPosition();return 0>a.z&&0==a.x});case "FR":case "BR":return lucid.array.find(b,function(a){a=a.getPosition();return 0<a.z&&0==a.y});case "FL":case "BL":return lucid.array.find(b,function(a){a=
a.getPosition();return 0>a.z&&0==a.y});case "UFR":case "DRF":return lucid.array.find(b,function(a){a=a.getPosition();return 0<a.z&&0<a.x});case "URB":case "DBR":return lucid.array.find(b,function(a){a=a.getPosition();return 0<a.z&&0>a.x});case "UBL":case "DLB":return lucid.array.find(b,function(a){a=a.getPosition();return 0>a.z&&0>a.x});case "ULF":case "DFL":return lucid.array.find(b,function(a){a=a.getPosition();return 0>a.z&&0<a.x})}};k.prototype.faceNames="LUDBFR".split("");k.prototype.getState=
function(){var a=this,b="",c={},e={F:"x",B:"x",U:"y",D:"y",R:"z",L:"z"},d=function(a,b){var c=null,d=0;lucid.array.forEach(a.faces,function(a){var e=S([a.p0,a.p1,a.p2,a.p3]);Math.abs(e[b])>d&&(d=Math.abs(e[b]),c=a.color)});return c};lucid.array.forEach(this.faceNames,function(b){c[a.getFaceColor(b)]=b});lucid.array.forEach("UF UR UB UL DF DR DB DL FR FL BR BL UFR URB UBL ULF DRF DFL DLB DBR".split(" "),function(g){var f=a.getCubie(g),h="";lucid.array.forEach(g.split(""),function(a){a=d(f,e[a]);h+=
c[a]});b+=h+" "});return b.trim()};p.prototype.applyMove=function(a,b){for(var c=[[0,1,2,3,0,1,2,3],[4,7,6,5,4,5,6,7],[0,9,4,8,0,3,5,4],[2,10,6,11,2,1,7,6],[3,11,7,9,3,2,6,5],[1,8,5,10,1,0,4,7]],e=a%3+1,d=Math.floor(a/3),g=b.slice();0<e--;)for(var f=g.slice(),h=0;8>h;h++){var k=3<h,m=c[d][h]+12*k,l=c[d][3==(h&3)?h-3:h+1]+12*k,p=4>h?1<d&&4>d:2>d?0:2-(h&1);g[m]=f[l];g[m+20]=f[l+20]+p;0==e&&(g[m+20]%=2+k)}return g};p.prototype.inverse=function(a){return a+2-a%3*2};p.prototype.getId=function(a){if(2>
this.phase)return JSON.stringify(a.slice(20,32));if(3>this.phase){for(var b=a.slice(31,40),c=0;12>c;c++)b[0]|=Math.floor(a[c]/8)<<c;return JSON.stringify(b)}if(4>this.phase){b=[0,0,0];for(c=0;12>c;c++)b[0]|=(7<a[c]?2:a[c]&1)<<2*c;for(c=0;8>c;c++)b[1]|=(a[c+12]-12&5)<<3*c;for(c=12;20>c;c++)for(var e=c+1;20>e;e++)b[2]^=a[c]>a[e];return JSON.stringify(b)}return JSON.stringify(a)};p.prototype.setState=function(a){a=a.split(" ");if(20!=a.length)return this.currentState="Not enough cubies provided",!1;
var b="UF UR UB UL DF DR DB DL FR FL BR BL UFR URB UBL ULF DRF DFL DLB DBR".split(" ");this.currentState=Array(40);this.goalState=Array(40);for(var c=0;40>c;c++)this.currentState[c]=0,this.goalState[c]=0;for(c=0;20>c;c++){this.goalState[c]=c;for(var e=a[c];-1==(this.currentState[c]=b.indexOf(e));)if(e=e.substr(1)+e[0],this.currentState[c+20]++,2<this.currentState[c+20])return this.currentState="Cannot solve: Invalid painting of cube.",!1;b[b.indexOf(e)]=""}return this.verifyState()};p.prototype.verifyState=
function(){if(!Array.isArray(this.currentState))return!1;var a=0;lucid.array.forEach(this.currentState.slice(20,32),function(b){a+=b});if(0!=a%2)return this.currentState="Cannot solve: Edges not oriented correctly.",!1;a=0;lucid.array.forEach(this.currentState.slice(32,40),function(b){a+=b});if(0!=a%3)return this.currentState="Cannot solve: Corners not oriented correctly",!1;var b=function(a){for(var b=0,d=0;d<a.length;d++)for(var g=0;g<d;g++)if(a[g]>a[d]){b++;var f=a[d];a[d]=a[g];a[g]=f}return b},
a=0,a=a+b(this.currentState.slice(0,12)),a=a+b(this.currentState.slice(12,20));return 0!=a%2?(this.currentState="Cannot solve: Parity error only one set of corners or edges swapped.",!1):!0};p.prototype.solve=function(a){this.solution="";this.phase=0;if(a){if(!this.setState(a))return!1}else if(!this.verifyState())return!1;for(;5>++this.phase;)this.startPhase();this.prepareSolution();return this.solution};p.prototype.startPhase=function(){var a=this.getId(this.currentState),b=this.getId(this.goalState);
if(a!=b){var c=[];c.push(this.currentState);c.push(this.goalState);var e={},d={},g={};d[a]=1;for(d[b]=2;;)for(var f=c.shift(),h=this.getId(f),k=d[h],m=[0,262143,259263,74943,74898],l=0;18>l;l++)if(m[this.phase]&1<<l){var p=this.applyMove(l,f),n=this.getId(p),q=d[n];if(q&&q!=k){1<k&&(c=n,n=h,h=c,l=this.inverse(l));for(l=[l];h!=a;)l.unshift(g[h]),h=e[h];for(;n!=b;)l.push(this.inverse(g[n])),n=e[n];for(a=0;a<l.length;a++){for(b=0;b<l[a]%3+1;b++)this.solution+="UDFBLR"[Math.floor(l[a]/3)];this.currentState=
this.applyMove(l[a],this.currentState)}return}q||(c.push(p),d[n]=d[h],g[n]=l,e[n]=h)}}};p.prototype.prepareSolution=function(){var a=this.solution.match(/(\w)\1*/g);if(a){for(var b={F:"B",B:"F",T:"D",D:"T",R:"L",L:"R"},c="",e=0;e<a.length-2;e++)if(a[e][0]==a[e+2][0]&&b[a[e+1][0]]==a[e][0]){var d=a[e+2];a[e+2]=a[e+1];a[e+1]=d;e=0}a=a.join("").match(/(\w)\1*/g);lucid.array.forEach(a,function(a){if(1==a.length%4)c+=a[0];else if(2==a.length%4)c+=a[0]+"2";else if(3==a.length%4)c+=a[0]+"'";else if(0==a.length%
4)return;c+=" "});this.solution=c.trim()}else this.solution=""}})();
//# sourceMappingURL=/js/plugins/v2/source-maps/rubik.js.map
};
