pluginFn['/js/plugins/v2/uml.js'] = function(lucid, window) {
	(function(){function v(b,c,a){return{Action:"line",x:b.x+b.w*c,y:b.y+b.h*a}}function y(b,c){return{Action:"line",x:b,y:c}}function r(b,c,a){return{Action:"move",x:b.x+b.w*c,y:b.y+b.h*a}}function G(b,c){return{Action:"move",x:b,y:c}}function U(b,c,a,d,h,e,m){return{Action:"curve",Control:lucid.math.ellipseArcControlPoints(b.x+b.w*c,b.y+b.h*a,d*b.w,h*b.h,e*Math.PI,m*Math.PI)}}function E(){return{Action:"close"}}function B(){return lucid.plugin.getProperty(null,"Version")||0}function F(b,c,a){return 1<
B()?a(b):c(b)}function qb(b,c){for(var a=lucid.plugin.getProperty(b,"Rows"),d=lucid.plugin.getProperty(b,"BoundingBox");c!=a.length;)c<a.length?(d.h-=a[a.length-1].height,a=a.slice(0,a.length-1)):c>a.length&&(d.h+=a[a.length-1].height,a.push({id:a.length,height:a[a.length-1].height}));lucid.plugin.setProperty(b,"Rows",a);lucid.plugin.setProperty(b,"BoundingBox",d)}function Na(b,c){for(var a=lucid.plugin.getProperty(b,"Columns"),d=lucid.plugin.getProperty(b,"BoundingBox");c!=a.length;)c<a.length?(d.w-=
a[a.length-1].width,a=a.slice(0,a.length-1)):c>a.length&&(d.w+=a[a.length-1].width,a.push({id:a.length,width:a[a.length-1].width}));lucid.plugin.setProperty(b,"Columns",a);lucid.plugin.setProperty(b,"BoundingBox",d)}function rb(b){lucid.plugin.registerStepperControl(b?"UMLMultiLanePoolRotatedBlock":"UMLMultiLanePoolBlock","LaneCount",function(){return 1},function(){return 1},function(){return 50});lucid.plugin.registerStringSelectControl(b?"UMLMultiLanePoolRotatedBlock":"UMLMultiLanePoolBlock","Orientation",
plugin.common.Swimlane.getOrientationOptions);return{className:b?"UMLMultiLanePoolRotatedBlock":"UMLMultiLanePoolBlock",name:"Multi Swim Lane",defaultSize:{w:640,h:700},container:!0,disabledPropertyControls:["FlipX","FlipY"],rLock:!0,hLock:!0,vLock:!0,searchKeywords:["bpmn","container","pool","lane"],beforeCreate:function(b,a){return plugin.common.Swimlane.beforeCreate.bind(this)(b,a,["UMLMultiLanePoolBlock","UMLMultiLanePoolRotatedBlock"])},getLinkPoints:function(b){return plugin.common.Swimlane.getLinkPoints.bind(this)(b)},
spatialControls:function(b){return plugin.common.Swimlane.spatialControls.bind(this)(b,!0)},onCreate:function(b){Oa||(lucid.plugin.openPanel("plugin"),Oa=!0);lucid.plugin.editBlockTextArea(b,"MainText")},onInit:function(c){var a=40,d=null,h=function(a,b){return plugin.common.Swimlane.setOrientation.bind(this)(c,a,b)},e=function(b){lucid.plugin.getProperty(c,"Vertical");var e=lucid.plugin.getProperty(c,"BoundingBox"),h=lucid.plugin.getProperty(c,"titleHeight",!0),m=lucid.plugin.getProperty(c,"mainTitleHeight",
!0),g,A=e.h/3,w=!1;a=40;g={x:0,y:0,w:e.w,h:1E4};g=lucid.text.getSize(c,"MainText",g);g=Math.min(A,Math.round(Math.max(a,g.h+15)));g!=m&&(lucid.plugin.setProperty(c,"mainTitleHeight",g,!0),w=!0);for(m=0;m<b.length;m++)g={x:0,y:0,w:e.w*b[m].p,h:1E4},g=lucid.text.getSize(c,"Lane_"+b[m].tid,g),a=Math.min(A,Math.round(Math.max(a,g.h+15)));d=lucid.text.getStyle(c,"Lane_"+b[b.length-1].tid);a!=h&&(lucid.plugin.setProperty(c,"titleHeight",a,!0),w=!0);w&&lucid.plugin.refreshBlockView(c)};lucid.plugin.addBlockTextArea(c,
{id:"MainText",value:lucid.text.restyle("Pool",d),getBoundingBox:function(a,b){var d=lucid.plugin.getProperty(c,"Lanes");e(d);lucid.plugin.getProperty(c,"Vertical");return{x:a.x,y:a.y,w:a.w,h:lucid.plugin.getProperty(c,"mainTitleHeight",!0)}}});var m=function(a){lucid.plugin.getBlockTextAreas(c);lucid.plugin.addBlockTextArea(c,{id:"Lane_"+a,value:lucid.text.restyle("Lane",d),getBoundingBox:function(a){return function(b){var d=lucid.plugin.getProperty(c,"Lanes");e(d);var h;for(h=0;h<d.length&&d[h].tid!==
a;h++);if(h>=d.length)return null;var l=0;if(lucid.plugin.getProperty(c,"Vertical"))for(var m=0;m<h;m++)l+=b.w*d[m].p;else for(m=d.length-1;m>h;m--)l+=b.w*d[m].p;return{x:b.x+l,y:b.y+lucid.plugin.getProperty(c,"mainTitleHeight",!0),w:b.w*d[h].p,h:lucid.plugin.getProperty(c,"titleHeight",!0)}}}(a)})};lucid.plugin.registerProperty(c,"Lanes",[{p:.5,tid:0},{p:.5,tid:1}],null,function(a,b){if(a!=b){var d=lucid.plugin.getBlockTextAreas(c),h=d.indexOf("MainText");0<=h&&d.splice(h,1);for(var g=["MainText"],
A=0;A<b.length;A++){var w="Lane_"+b[A].tid,h=d.indexOf(w);0>h?m(b[A].tid):d.splice(h,1);g.push(w)}for(A=0;A<d.length;A++)lucid.plugin.deleteBlockTextArea(c,d[A]);lucid.plugin.setBlockTextAreasOrder(c,g);e(b)}});lucid.plugin.registerProperty(c,"Vertical",b?0:1,null,function(a,b){a!=b&&h(a,b)});lucid.plugin.registerProxyProperty(c,"LaneCount",plugin.common.Swimlane.getLaneCountOfSwimLaneBlock.bind(null,c),plugin.common.Swimlane.setLaneCountOfSwimLaneBlock.bind(null,c,!0));lucid.plugin.registerProxyProperty(c,
"Orientation",plugin.common.Swimlane.getOrientationOfSwimLaneBlock.bind(null,c),plugin.common.Swimlane.setOrientationOfSwimLaneBlock.bind(null,c,!1));lucid.plugin.hookPropertyPostSave(c,"Lanes",function(){lucid.plugin.proxyPropertyChanged(c,"LaneCount")});lucid.plugin.hookPropertyPostSave(c,"Vertical",function(){lucid.plugin.proxyPropertyChanged(c,"Orientation")})},getRenderData:function(b,a){var d=b.Lanes,h=b.Vertical||!1,e=b.BoundingBox,m=b.mainTitleHeight||40,l=b.titleHeight||40;if(40>e.h||"sample"==
a)m=e.h/5,l=e.h/5;var n=[{FillColor:b.FillColor,Actions:[r(e,0,0),v(e,1,0),y(e.x+e.w,e.y+m+l),y(e.x,e.y+m+l),E()]},{FillColor:b.FillColor,NoRounding:!0,Actions:[G(e.x,e.y+m),y(e.x+e.w,e.y+m),y(e.x+e.w,e.y+m+l),y(e.x,e.y+m+l),E()]},{StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[G(e.x,e.y+m),y(e.x+e.w,e.y+m),G(e.x,e.y+m+l),y(e.x+e.w,e.y+m+l)]},{StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[r(e,1,0),v(e,1,1),v(e,0,1),v(e,0,0),E()]}],l=function(a){n[2].Actions.push({Action:"move",x:a.x,
y:a.y+m});n[2].Actions.push({Action:"line",x:a.x,y:a.y+a.h})},p=e.w;if(h)for(h=0;h<d.length;h++)e.w=p*d[h].p,0<h&&l(e),e.x+=p*d[h].p;else for(h=d.length-1;0<=h;h--)e.w=p*d[h].p,h<d.length-1&&l(e),e.x+=p*d[h].p;return n}}}function bc(b){var c,a=b?lucid.plugin.getProperty(b,"Markup").UML_Sequence:"Alice->Bob";lucid.dialog.textAreaPrompt({children:[lucid.i18n("uml.sequence.markup.dialog.paragraph"),{classes:"spacer"},{css:{color:"red"},create:function(a){c=a}}]},a,function(a){if(a=ja(b,a))return $(c).text(a.message),
!1;$(c).text("");return!0},void 0,void 0,lucid.i18n("uml.sequence.markup.dialog.title"));lucid.kissMetrics.record(lucid.kissMetrics.Events.openedUMLSequenceMarkupDialog)}function Y(b){return lucid.plugin.getProperty(b,"Markup")}function ja(b,c){lucid.hubspot.recordEvent("uml-markup-used");lucid.kissMetrics.record(lucid.kissMetrics.Events.umlMarkupUsed);var a;a=c?c:b?Y(b).UML_Sequence:"Alice->Bob";for(lucid.kissMetrics.record(lucid.kissMetrics.Events.generatedUMLSequenceMarkupDiagram);-1!==a.indexOf("/'");){var d=
a.indexOf("/'"),h=a.indexOf("'/",d+2);a=Da(a,d,h,"'/")}for(;-1!==a.indexOf("\n'");)d=a.indexOf("\n'"),h=a.indexOf("\n",d+2),a=Da(a,d,h,"\n");"'"==a.charAt(0)&&(h=a.indexOf("\n"),a=Da(a,0,h,"\n"));c=a;a=plugin.uml.sequence.Parser.parse(c);if(a instanceof plugin.uml.sequence.Parser.ParseSuccess){a=ya(a.diagram);lucid.plugin.setProperty(a,"Markup",{UML_Sequence:c});lucid.plugin.deselectAllItems();lucid.plugin.selectItem(a);h={x:100,y:100,w:0,h:0};void 0!==b&&(h=lucid.plugin.getGroupBoundingBox(b),lucid.plugin.deleteItem(b));
d=lucid.plugin.getGroupBoundingBox(a);h=lucid.math.Box.subtract(h,d);h.w=0;h.h=0;a=lucid.plugin.getOffsetProperties(a,d,h,{top:!1,left:!1,bottom:!1,right:!1},null);for(var e in a){var d=a[e],m;for(m in d)lucid.plugin.setProperty(e,m,d[m])}lucid.config.showsequencemarkup&&lucid.qualaroo.showSurvey("sequence_markup",!1);return null}e=a.getErrorMessage();m=a.getErrorLine();return{message:e,lineNum:m}}function sb(b,c){if(lucid.user.getRestrictions("UMLMarkup")){if(b&&1==b.length&&Y(b[0].getId()))return ja(b[0].getId(),
c);if(!b||1!=b.length)return ja(void 0,c)}else Pa()}function tb(b,c,a){if(b&&!Y(b))return!0;lucid.user.getRestrictions("UMLMarkup")?bc(b,c):Pa();return!1}function Pa(){lucid.hubspot.recordEvent("uml-markup-editor-paywall");lucid.kissMetrics.record(lucid.kissMetrics.Events.umlMarkupEditorPaywall);lucid.paywall.displayPremiumFeaturePaywall("UMLMarkup")}function Da(b,c,a,d){if(-1<a){var h=b.substring(0,c);c=b.substring(c,a+d.length);b=b.substring(a+d.length);return h+c.replace(/[^\r\n]/g," ")+b}h=b.substring(0,
c);c=b.substring(c);return h+c.replace(/[^\r\n]/g," ")}function ya(b){var c=lucid.plugin.getPageSelection()[0],a=b.getParticipantWidths(function(a){var b=new plugin.uml.sequence.view.Message(a);return a.isSelfMessage()?b.rightPadding:b.textWidth}),a=cc(c,b.participants,a,b.totalDepth);b=dc(c,b,a);var d=[],h;for(h in a){var e=a[h];d.push(e.topBlockId);d.push(e.bottomBlockId);d.push(e.line.id)}h=d.concat(b);return lucid.plugin.addGroup(c,h)}function cc(b,c,a,d){var h=plugin.uml.sequence.model.size,
e=h.participantSize,m=h.padding,l={};d=m.y+e.h+m.segmentHeight*(h.verticalSegments+d);for(var n=m.x,p=0;p<c.length;p++){var g=c[p],t=g.name,A=g.displayName,g=Math.max(e.w+m.w,a[t]),w=lucid.plugin.addBlock(b,{className:"UMLObjectBlock",BoundingBox:{x:n,y:m.y,w:e.w,h:e.h},Text:A}),A=lucid.plugin.addBlock(b,{className:"UMLObjectBlock",BoundingBox:{x:n,y:d,w:e.w,h:e.h},Text:A}),w=lucid.plugin.addLine(b,{Endpoint1:{Block:w,LinkX:.5,LinkY:1,Style:"None"},Endpoint2:{Block:A,LinkX:.5,LinkY:0,Style:"None"},
StrokeStyle:"dashed",Shape:"elbow"});l[t]=new plugin.uml.sequence.view.ParticipantLifeline(t,w,p,p<c.length-1?g:a[t]+h.participantLinePadding);n+=g}return l}function dc(b,c,a){var d=c.totalDepth+plugin.uml.sequence.model.size.verticalSegments,h;plugin.uml.sequence.view.ParticipantLifeline.addActivationEventsToLifelines(c,a,0,d);h=[];for(var e in a)h=h.concat(a[e].renderLifelineBlocks(b));Qa(c,a);b=Z(b,c,a,0,d,c.participantSet);return h.concat(b)}function Qa(b,c){for(var a=plugin.uml.sequence.model.size.participantLinePadding,
d=[],h=0;h<b.getActionCount();h++){var e=b.get(h);e instanceof plugin.uml.sequence.model.SubDiagram&&(Qa(e,c),d.push(e))}if(b instanceof plugin.uml.sequence.model.SubDiagram){var h=lucid.object.getKeys(b.participantSet),e=plugin.uml.sequence.view.ParticipantLifeline.getParticipantsInOrder(h,c),h=e[0],e=e[e.length-1],m=function(){return function(){return null}};if(void 0!==h){var l;h==e?(l=c[h].line,e=lucid.object.copy(l),e.x+=c[h].width):(l=c[h].line,e=c[e].line);var n=l.x-a,p=e.x+a,m=function(){var a=
null;return function(e,h){var m=0,g=0;if(void 0!==e&&void 0!==h)var g=b.getTopDepth(e),V=b.getBottomDepth(e),m=l.yTop+(l.yBot-l.yTop)*g/h,g=(l.yBot-l.yTop)*(V-g)/h;if(!a){for(var x=d.map(function(a){return a.getBoundingBox(e,h)}).filter(function(a){return null!==a}),V=x.map(function(a){return a.x-10}),x=x.map(function(a){return a.x+a.w+10}),D=b.getActionCount(),v=0;v<D;v++){var r=b.get(v);if(r instanceof plugin.uml.sequence.model.Message){var I=(new plugin.uml.sequence.view.Message(r)).getBoundingBox(c,
e,h),r=plugin.uml.sequence.view.Note.horizontalPadding/2;V.push(I.x-r);x.push(I.x+I.w+r)}else if(r instanceof plugin.uml.sequence.model.Note){var I=r,y;I instanceof plugin.uml.sequence.model.LeftBlockNote?y=new plugin.uml.sequence.view.LeftBlockNote(I,c):I instanceof plugin.uml.sequence.model.RightBlockNote?y=new plugin.uml.sequence.view.RightBlockNote(I,c):r instanceof plugin.uml.sequence.model.OverNote&&(y=new plugin.uml.sequence.view.OverBlockNote(I,c));r=plugin.uml.sequence.view.Note.horizontalPadding/
2;I=y.getBoundingBox(e,h);V.push(I.x-r);x.push(I.x+I.w+r)}}V.unshift(n);x.unshift(p);y=Math.min.apply(null,V);V=Math.max.apply(null,x);a={x:y,w:V-y}}return{x:a.x,y:m,w:a.w,h:g}}}}b.getBoundingBox=m()}}function Z(b,c,a,d,h,e){for(var m=[],l=0;l<c.getActionCount();l++){var n=c.get(l);if(n instanceof plugin.uml.sequence.model.Message){var p=(new plugin.uml.sequence.view.Message(n)).render(b,a,d,h);d+=n.height;m=m.concat(p)}else if(n instanceof plugin.uml.sequence.model.MessageGroup){if(p=n,n=p.getBoundingBox(d,
h),null!==n){var g=lucid.plugin.addBlock(b,{className:"UMLOptionLoopBlock",BoundingBox:n,Title:p.type,Text:p.label?p.label:""}),n=Z(b,p,a,p.getDepthBelowLabel(d),h,e);m.push(g);Array.prototype.push.apply(m,n);d+=p.height}}else if(n instanceof plugin.uml.sequence.model.AltGroup)p=n,n=p.getBoundingBox(d,h),null!==n&&(g=lucid.plugin.addBlock(b,{className:"UMLAlternativeBlock2",BoundingBox:n,Boundaries:p.boundaries,Condition:p.condition||""}),n=Z(b,p,a,p.getDepthBelowLabel(d),h,e),m.push(g),Array.prototype.push.apply(m,
n),d+=p.height);else if(n instanceof plugin.uml.sequence.model.ElseGroup)p=n,n=Z(b,p,a,p.getDepthBelowLabel(d),h,e),Array.prototype.push.apply(m,n),d+=p.height;else if(n instanceof plugin.uml.sequence.model.ActivationGroup)d+=n.height;else if(n instanceof plugin.uml.sequence.model.Note&&!(n instanceof plugin.uml.sequence.model.InlineNote)){var p=n,t;p instanceof plugin.uml.sequence.model.LeftBlockNote?t=new plugin.uml.sequence.view.LeftBlockNote(p,a):p instanceof plugin.uml.sequence.model.RightBlockNote?
t=new plugin.uml.sequence.view.RightBlockNote(p,a):n instanceof plugin.uml.sequence.model.OverNote&&(t=new plugin.uml.sequence.view.OverBlockNote(p,a));m.push(t.render(b,d,h));d+=p.height}d+=c.depthBetweenActions}return m}var g={global:this,provide:function(b){b=b.split(".");g.global[b[0]]=g.global[b[0]]||{};var c=g.global[b[0]];b.slice(1).reduce(function(a,b){a[b]||(a[b]={});return a[b]},c)},require:function(){},inherits:function(b,c){function a(){}a.prototype=c.prototype;b.superClass_=c.prototype;
b.prototype=new a;b.prototype.constructor=b;b.base=function(a,b,e){var m=Array.prototype.slice.call(arguments,2);return c.prototype[b].apply(a,m)}},base:function(b,c,a){var d=arguments.callee.caller;if(g.STRICT_MODE_COMPATIBLE||g.DEBUG&&!d)throw Error("arguments.caller not defined.  goog.base() cannot be used with strict mode code. See http://www.ecma-international.org/ecma-262/5.1/#sec-C");if(d.superClass_)return d.superClass_.constructor.apply(b,Array.prototype.slice.call(arguments,1));for(var h=
Array.prototype.slice.call(arguments,2),e=!1,m=b.constructor;m;m=m.superClass_&&m.superClass_.constructor)if(m.prototype[c]===d)e=!0;else if(e)return m.prototype[c].apply(b,h);if(b[c]===d)return b.constructor.prototype[c].apply(b,h);throw Error("goog.base called from a method of one name to a method of a different name");}};g.provide("plugin.uml.Label");plugin.uml.Label.processMessageGroupLabel=function(b){return null!==b&&(b=plugin.uml.Label.parseNewlines(b).trim(),0<b.length)?b:null};plugin.uml.Label.parseNewlines=
function(b){return b.replace(/\\n/g,"\n")};g.provide("plugin.uml.sequence.model.size");plugin.uml.sequence.model.size=function(){var b={w:120,h:100};return{participantSize:b,verticalSegments:4,padding:{x:40,y:40,w:b.w,h:40,segmentHeight:10},participantLinePadding:30}}();g.provide("plugin.uml.sequence.model.Action");plugin.uml.sequence.model.Action=function(){};g.provide("plugin.uml.sequence.model.BlockNote");g.provide("plugin.uml.sequence.model.InlineNote");g.provide("plugin.uml.sequence.model.LeftBlockNote");
g.provide("plugin.uml.sequence.model.LeftInlineNote");g.provide("plugin.uml.sequence.model.Note");g.provide("plugin.uml.sequence.model.NoteArrangement");g.provide("plugin.uml.sequence.model.NotePosition");g.provide("plugin.uml.sequence.model.OverNote");g.provide("plugin.uml.sequence.model.RightBlockNote");g.provide("plugin.uml.sequence.model.RightInlineNote");g.provide("plugin.uml.sequence.model.SideNote");g.require("plugin.uml.Label");g.require("plugin.uml.sequence.model.Action");g.require("plugin.uml.sequence.model.size");
plugin.uml.sequence.model.NoteArrangement={Inline:0,Block:1};plugin.uml.sequence.model.NotePosition={Left:0,Right:1,Over:2};plugin.uml.sequence.model.Note=function(b,c,a){this.label=plugin.uml.Label.parseNewlines(b).trim();this.arrangement=a;this.height=plugin.uml.sequence.model.Note.paddingAbove+this.label.split("\n").length*plugin.uml.sequence.model.Note.lineHeight+plugin.uml.sequence.model.Note.innerPadding};plugin.uml.sequence.model.Note.innerPadding=plugin.uml.sequence.model.size.verticalSegments;
plugin.uml.sequence.model.Note.paddingAbove=.5*plugin.uml.sequence.model.size.verticalSegments;plugin.uml.sequence.model.Note.lineHeight=.5*plugin.uml.sequence.model.size.verticalSegments;plugin.uml.sequence.model.SideNote=function(b,c,a){plugin.uml.sequence.model.Note.call(this,b,c,a)};g.inherits(plugin.uml.sequence.model.SideNote,plugin.uml.sequence.model.Note);plugin.uml.sequence.model.InlineNote=function(b,c){plugin.uml.sequence.model.SideNote.call(this,b,c,plugin.uml.sequence.model.NoteArrangement.Inline)};
g.inherits(plugin.uml.sequence.model.InlineNote,plugin.uml.sequence.model.SideNote);plugin.uml.sequence.model.LeftInlineNote=function(b){plugin.uml.sequence.model.InlineNote.call(this,b,plugin.uml.sequence.model.NotePosition.Left)};g.inherits(plugin.uml.sequence.model.LeftInlineNote,plugin.uml.sequence.model.InlineNote);plugin.uml.sequence.model.RightInlineNote=function(b){plugin.uml.sequence.model.InlineNote.call(this,b,plugin.uml.sequence.model.NotePosition.Right)};g.inherits(plugin.uml.sequence.model.RightInlineNote,
plugin.uml.sequence.model.InlineNote);plugin.uml.sequence.model.BlockNote=function(b,c,a){plugin.uml.sequence.model.SideNote.call(this,b,c,plugin.uml.sequence.model.NoteArrangement.Block);this.participant=a};g.inherits(plugin.uml.sequence.model.BlockNote,plugin.uml.sequence.model.SideNote);plugin.uml.sequence.model.LeftBlockNote=function(b,c){plugin.uml.sequence.model.BlockNote.call(this,b,plugin.uml.sequence.model.NotePosition.Left,c)};g.inherits(plugin.uml.sequence.model.LeftBlockNote,plugin.uml.sequence.model.BlockNote);
plugin.uml.sequence.model.RightBlockNote=function(b,c){plugin.uml.sequence.model.BlockNote.call(this,b,plugin.uml.sequence.model.NotePosition.Right,c)};g.inherits(plugin.uml.sequence.model.RightBlockNote,plugin.uml.sequence.model.BlockNote);plugin.uml.sequence.model.OverNote=function(b,c){plugin.uml.sequence.model.Note.call(this,b,plugin.uml.sequence.model.NotePosition.Over,plugin.uml.sequence.model.NoteArrangement.Block);this.participants=c};g.inherits(plugin.uml.sequence.model.OverNote,plugin.uml.sequence.model.Note);
g.provide("plugin.uml.sequence.model.Deactivate");plugin.uml.sequence.model.Deactivate=function(b){this.participant=b};g.provide("plugin.uml.sequence.model.Autonumber");g.provide("plugin.uml.sequence.model.AutonumberChange");g.provide("plugin.uml.sequence.model.AutonumberResume");g.provide("plugin.uml.sequence.model.AutonumberStart");g.provide("plugin.uml.sequence.model.AutonumberStop");plugin.uml.sequence.model.AutonumberState={Paused:0,Running:1};plugin.uml.sequence.model.Autonumber=function(){this.step=
this.current=1;this.formatString="";this.state=plugin.uml.sequence.model.AutonumberState.Paused};plugin.uml.sequence.model.Autonumber.prototype.setState=function(b){this.state=b};plugin.uml.sequence.model.Autonumber.prototype.setNextValue=function(b){this.current=b};plugin.uml.sequence.model.Autonumber.prototype.setIncrement=function(b){this.step=b};plugin.uml.sequence.model.Autonumber.prototype.setFormatString=function(b){this.formatString=b};plugin.uml.sequence.model.Autonumber.prototype.format=
function(b){this.state==plugin.uml.sequence.model.AutonumberState.Running&&(b=this.current+": "+(b||""),this.current+=this.step);return b};plugin.uml.sequence.model.AutonumberChange=function(){};plugin.uml.sequence.model.AutonumberChange.prototype.updateAutonumber=function(b){};plugin.uml.sequence.model.AutonumberStart=function(b,c,a){this.start=null===b||void 0===b?1:b;this.step=null===c||void 0===b?1:c;this.format=a};g.inherits(plugin.uml.sequence.model.AutonumberStart,plugin.uml.sequence.model.AutonumberChange);
plugin.uml.sequence.model.AutonumberStart.prototype.updateAutonumber=function(b){b.setState(plugin.uml.sequence.model.AutonumberState.Running);b.setNextValue(this.start);b.setIncrement(this.step);this.format&&b.setFormatString(this.format)};plugin.uml.sequence.model.AutonumberStop=function(){};g.inherits(plugin.uml.sequence.model.AutonumberStop,plugin.uml.sequence.model.AutonumberChange);plugin.uml.sequence.model.AutonumberStop.prototype.updateAutonumber=function(b){b.setState(plugin.uml.sequence.model.AutonumberState.Paused)};
plugin.uml.sequence.model.AutonumberResume=function(b,c){this.step=b;this.format=c};g.inherits(plugin.uml.sequence.model.AutonumberResume,plugin.uml.sequence.model.AutonumberChange);plugin.uml.sequence.model.AutonumberResume.prototype.updateAutonumber=function(b){b.setState(plugin.uml.sequence.model.AutonumberState.Running);null!==this.step&&void 0!==this.step&&b.setIncrement(this.step);this.format&&b.setFormatString(this.format)};g.provide("plugin.uml.sequence.model.Activate");plugin.uml.sequence.model.Activate=
function(b){this.participant=b};g.provide("plugin.uml.sequence.model.ActivationTarget");g.require("plugin.uml.sequence.model.Activate");g.require("plugin.uml.sequence.model.Deactivate");plugin.uml.sequence.model.ActivationTarget=function(){};plugin.uml.sequence.model.ActivationTarget.prototype.triggerActivation=function(b){};plugin.uml.sequence.model.ActivationTarget.prototype.getActivations=function(){};plugin.uml.sequence.model.ActivationTarget.prototype.getDeactivations=function(){};g.provide("plugin.uml.sequence.model.ActivationGroup");
g.require("plugin.uml.sequence.model.Action");g.require("plugin.uml.sequence.model.ActivationTarget");g.require("plugin.uml.sequence.model.Activate");g.require("plugin.uml.sequence.model.Deactivate");g.require("plugin.uml.sequence.model.size");plugin.uml.sequence.model.ActivationGroup=function(){this.activations=[];this.deactivations=[];this.height=plugin.uml.sequence.model.size.verticalSegments};plugin.uml.sequence.model.ActivationGroup.prototype.triggerActivation=function(b){b instanceof plugin.uml.sequence.model.Activate?
this.activations.push(b):b instanceof plugin.uml.sequence.model.Deactivate&&this.deactivations.push(b)};plugin.uml.sequence.model.ActivationGroup.prototype.getActivations=function(){return this.activations};plugin.uml.sequence.model.ActivationGroup.prototype.getDeactivations=function(){return this.deactivations};g.provide("plugin.uml.sequence.model.Participant");plugin.uml.sequence.model.Participant=function(b,c){this.name=b;this.displayName=c?c:b};g.provide("plugin.uml.sequence.model.ArrowType");
g.provide("plugin.uml.sequence.model.Connector");g.provide("plugin.uml.sequence.model.LineType");g.provide("plugin.uml.sequence.model.Message");g.require("plugin.uml.Label");g.require("plugin.uml.sequence.model.Activate");g.require("plugin.uml.sequence.model.ActivationTarget");g.require("plugin.uml.sequence.model.Deactivate");g.require("plugin.uml.sequence.model.InlineNote");g.require("plugin.uml.sequence.model.Note");g.require("plugin.uml.sequence.model.size");plugin.uml.sequence.model.ArrowType=
{none:"None",closed:"Arrow",open:"Open Arrow"};plugin.uml.sequence.model.LineType={solid:"solid",dash:"dashed"};plugin.uml.sequence.model.Connector=function(b,c,a){this.lineType=b;this.leftArrow=c;this.rightArrow=a};plugin.uml.sequence.model.Connector.prototype.isLeft=function(){return this.leftArrow!=plugin.uml.sequence.model.ArrowType.none&&this.rightArrow==plugin.uml.sequence.model.ArrowType.none};plugin.uml.sequence.model.Connector.prototype.reverse=function(){return new plugin.uml.sequence.model.Connector(this.lineType,
this.rightArrow,this.leftArrow)};plugin.uml.sequence.model.Message=function(b,c,a,d){this.activations=[];this.deactivations=[];this.note=null;var h=a.isLeft();this.sender=plugin.uml.Label.parseNewlines(h?c:b);this.recipient=plugin.uml.Label.parseNewlines(h?b:c);this.connector=h?a.reverse():a;this.setLabel(d)};plugin.uml.sequence.model.Message.prototype.setLabel=function(b){this.label=plugin.uml.Label.processMessageGroupLabel(b);this.height=this.calculateHeight()};plugin.uml.sequence.model.Message.messageHeight=
1;plugin.uml.sequence.model.Message.selfMessageCenterPadding=1;plugin.uml.sequence.model.Message.textLineHeight=.5;plugin.uml.sequence.model.Message.prototype.calculateHeight=function(){var b;this.paddingAboveRecipient=this.paddingBelow=0;this.note&&(this.paddingBelow=(this.note.height-plugin.uml.sequence.model.Note.paddingAbove)/2);var c=plugin.uml.sequence.model.size.verticalSegments,a=plugin.uml.sequence.model.Message;this.isSelfMessage()?(this.paddingAboveRecipient=a.selfMessageCenterPadding*
c,b=a.messageHeight*c+this.paddingAboveRecipient):(b=a.messageHeight*c,null!==this.label&&(c=a.textLineHeight*c*this.label.split("\n").length,b+=c));this.arrowHeight=Math.max(b,this.paddingBelow+plugin.uml.sequence.model.Note.paddingAbove);return this.arrowHeight+this.paddingBelow};plugin.uml.sequence.model.Message.prototype.isSelfMessage=function(){return this.sender&&this.recipient&&this.sender==this.recipient};plugin.uml.sequence.model.Message.prototype.triggerActivation=function(b){b instanceof
plugin.uml.sequence.model.Activate?this.activations.push(b):b instanceof plugin.uml.sequence.model.Deactivate&&this.deactivations.push(b)};plugin.uml.sequence.model.Message.prototype.getActivations=function(){return this.activations};plugin.uml.sequence.model.Message.prototype.getDeactivations=function(){return this.deactivations};plugin.uml.sequence.model.Message.prototype.setNote=function(b){this.note=b;this.height=this.calculateHeight()};g.provide("plugin.uml.sequence.model.SequenceDiagram");g.require("plugin.uml.sequence.model.Action");
g.require("plugin.uml.sequence.model.Activate");g.require("plugin.uml.sequence.model.ActivationGroup");g.require("plugin.uml.sequence.model.ActivationTarget");g.require("plugin.uml.sequence.model.Autonumber");g.require("plugin.uml.sequence.model.AutonumberChange");g.require("plugin.uml.sequence.model.Deactivate");g.require("plugin.uml.sequence.model.InlineNote");g.require("plugin.uml.sequence.model.Message");g.require("plugin.uml.sequence.model.Note");g.require("plugin.uml.sequence.model.Participant");
plugin.uml.sequence.model.SequenceDiagram=function(b){this.actions=[];this.totalDepth=0;this.participants=[];this.participantSet={};b instanceof plugin.uml.sequence.model.SequenceDiagram?(this.actions=b.actions,this.participants=b.participants,this.participantSet=b.participantSet):this.loadActions(b);this.depthBetweenActions=0};plugin.uml.sequence.model.SequenceDiagram.prototype.loadActions=function(b){this.lastMessage=this.activationTarget=null;for(var c=0;c<b.length;c++){var a=b[c];if(a instanceof
plugin.uml.sequence.model.Activate||a instanceof plugin.uml.sequence.model.Deactivate){this.addParticipant(a.participant);if(!this.activationTarget){var d=new plugin.uml.sequence.model.ActivationGroup;this.actions.push(d);this.activationTarget=d}this.activationTarget.triggerActivation(a)}else if(a instanceof plugin.uml.sequence.model.AutonumberChange)this.actions.push(a);else if(a instanceof plugin.uml.sequence.model.Message)this.loadMessage(a);else if(a instanceof plugin.uml.sequence.model.Note)this.loadNote(a);
else if(a instanceof plugin.uml.sequence.model.Participant)this.addParticipant(a);else if(a instanceof plugin.uml.sequence.model.SequenceDiagram){this.lastMessage=this.activationTarget=null;for(d=0;d<a.participants.length;d++)this.addParticipant(a.participants[d]);this.actions.push(a)}}};plugin.uml.sequence.model.SequenceDiagram.prototype.loadMessage=function(b){this.lastMessage=this.activationTarget=b;this.addParticipant(b.sender);this.addParticipant(b.recipient);this.actions.push(b)};plugin.uml.sequence.model.SequenceDiagram.prototype.loadNote=
function(b){b instanceof plugin.uml.sequence.model.InlineNote?this.lastMessage&&(this.lastMessage.setNote(b),this.lastMessage=null):(b instanceof plugin.uml.sequence.model.OverNote?b.participants.forEach(this.addParticipant.bind(this)):this.addParticipant(b.participant),this.actions.push(b))};plugin.uml.sequence.model.SequenceDiagram.prototype.addParticipant=function(b){b="string"==typeof b?new plugin.uml.sequence.model.Participant(b):b;void 0===this.participantSet[b.name]&&(this.participantSet[b.name]=
this.participants.length,this.participants.push(b))};plugin.uml.sequence.model.SequenceDiagram.prototype.doAutonumbering=function(b){b=b||new plugin.uml.sequence.model.Autonumber;for(var c=0;c<this.actions.length;c++){var a=this.actions[c];a instanceof plugin.uml.sequence.model.Message?a.setLabel(b.format(a.label)):a instanceof plugin.uml.sequence.model.SequenceDiagram?a.doAutonumbering(b):a instanceof plugin.uml.sequence.model.AutonumberChange&&a.updateAutonumber(b)}this.remeasureDepth()};plugin.uml.sequence.model.SequenceDiagram.prototype.remeasureDepth=
function(){for(var b=this.totalDepth=0;b<this.actions.length;b++){var c=this.actions[b];Number.isInteger(c.height)&&(this.totalDepth+=c.height)}};plugin.uml.sequence.model.SequenceDiagram.prototype.get=function(b){return this.actions[b]};plugin.uml.sequence.model.SequenceDiagram.prototype.getActionCount=function(){return this.actions.length};plugin.uml.sequence.model.SequenceDiagram.prototype.getParticipantWidths=function(b,c){for(var a={},d=c||this.participantSet,h=0;h<this.participants.length;h++)a[this.participants[h].name]=
0;for(h=0;h<this.getActionCount();h++){var e=this.get(h);if(e instanceof plugin.uml.sequence.model.Message){var m=b(e),e=d[e.sender]>d[e.recipient]?e.recipient:e.sender;m>a[e]&&(a[e]=m)}else if(e instanceof plugin.uml.sequence.model.SequenceDiagram){var m=e.getParticipantWidths(b,d),l;for(l in m)if(l in a&&m[l]>a[l]||!(l in a))a[l]=m[l]}}return a};g.provide("plugin.uml.sequence.view.Activation");plugin.uml.sequence.view.Activation=function(b,c,a){this.top=b;this.height=c;this.inner=a;this.blockId=
null};plugin.uml.sequence.view.Activation.offsetX=20;plugin.uml.sequence.view.Activation.width=40;plugin.uml.sequence.view.Activation.halfWidth=plugin.uml.sequence.view.Activation.width/2;plugin.uml.sequence.view.Activation.prototype.render=function(b,c,a,d){var h=[];if(0<this.height){var e=a-c;this.blockId=lucid.plugin.addBlock(b,{className:"UMLActivationBlock",BoundingBox:{x:d-plugin.uml.sequence.view.Activation.halfWidth,y:e*this.top+c,w:plugin.uml.sequence.view.Activation.width,h:e*this.height}});
h.push(this.blockId);for(e=0;e<this.inner.length;e++)h=h.concat(this.inner[e].render(b,c,a,d+plugin.uml.sequence.view.Activation.offsetX))}return h};g.provide("plugin.uml.sequence.view.ParticipantLifeline");g.require("plugin.uml.sequence.model.ActivationGroup");g.require("plugin.uml.sequence.model.Message");g.require("plugin.uml.sequence.model.Note");g.require("plugin.uml.sequence.model.SequenceDiagram");g.require("plugin.uml.sequence.model.size");g.require("plugin.uml.sequence.view.Activation");
plugin.uml.sequence.view.ActivationType={Activation:0,Deactivation:1};plugin.uml.sequence.view.ParticipantLifeline=function(b,c,a,d){this.name=b;this.order=a;this.width=d;b=lucid.plugin.getProperty(c,"Endpoint1");a=lucid.plugin.getProperty(c,"Endpoint2");this.line={id:c,x:b.x,yTop:b.y,yBot:a.y};this.topBlockId=b.Block;this.bottomBlockId=a.Block;this.activationStack=[];this.activations=[]};plugin.uml.sequence.view.ParticipantLifeline.prototype.addActivation=function(b){this.activationStack.push({distance:b,
type:plugin.uml.sequence.view.ActivationType.Activation})};plugin.uml.sequence.view.ParticipantLifeline.prototype.addDeactivation=function(b){this.activationStack.push({distance:b,type:plugin.uml.sequence.view.ActivationType.Deactivation})};plugin.uml.sequence.view.ParticipantLifeline.prototype.renderLifelineBlocks=function(b){this.consumeActivationStack();for(var c=[],a=0;a<this.activations.length;a++)c=c.concat(this.activations[a].render(b,this.line.yTop,this.line.yBot,this.line.x));return c};plugin.uml.sequence.view.ParticipantLifeline.prototype.consumeActivationStack=
function(){var b,c=function(){for(var a=[],d=this.activationStack[b++].distance,h;b<this.activationStack.length;b++){var e=this.activationStack[b];if(e.type==plugin.uml.sequence.view.ActivationType.Activation)a.push(c());else if(e.type==plugin.uml.sequence.view.ActivationType.Deactivation){h=e.distance;break}}void 0===h&&(h=1);return new plugin.uml.sequence.view.Activation(d,h-d,a)}.bind(this);for(b=0;b<this.activationStack.length;b++)this.activationStack[b].type==plugin.uml.sequence.view.ActivationType.Activation&&
this.activations.push(c())};plugin.uml.sequence.view.ParticipantLifeline.prototype.setEndpoint1ConnectData=function(b,c,a){this.setEndpointConnectData(b.Endpoint1,c,a)};plugin.uml.sequence.view.ParticipantLifeline.prototype.setEndpoint2ConnectData=function(b,c,a){this.setEndpointConnectData(b.Endpoint2,c,a)};plugin.uml.sequence.view.ParticipantLifeline.prototype.setEndpointConnectData=function(b,c,a){var d=this.getBlockAtHeight(c);if(d){var h=lucid.plugin.getProperty(d,"BoundingBox");b.Block=d;b.LinkY=
((this.line.yBot-this.line.yTop)*c+this.line.yTop-h.y)/h.h;b.LinkX=this.order<=a?1:0}else b.Line=this.line.id,b.LineP=c};plugin.uml.sequence.view.ParticipantLifeline.prototype.getBlockAtHeight=function(b){function c(a){if(a.top<=b&&a.top+a.height>=b){for(var d=0;d<a.inner.length&&!(b<a.inner[d].top);d++){var m=c(a.inner[d]);if(m)return m}return a.blockId}return null}for(var a=0;a<this.activations.length&&!(b<this.activations[a].top);a++){var d=c(this.activations[a]);if(d)return d}return null};plugin.uml.sequence.view.ParticipantLifeline.addActivationEventsToLifelines=
function(b,c,a,d){for(var h=plugin.uml.sequence.model.size.verticalSegments,e=0;e<b.getActionCount();e++){var m=b.get(e);if(m instanceof plugin.uml.sequence.model.Message){var l=m;if(l.getActivations().length||l.getDeactivations().length){var n,p;l.isSelfMessage()?(n=(a+h)/d,p=(a+l.height)/d):p=n=(a+l.height)/d;for(m=0;m<l.getDeactivations().length;m++){var g=l.getDeactivations()[m];c[g.participant].addDeactivation(n)}for(m=0;m<l.getActivations().length;m++)g=l.getActivations()[m],c[g.participant].addActivation(p)}a+=
l.height}else if(m instanceof plugin.uml.sequence.model.SubDiagram)l=m,plugin.uml.sequence.view.ParticipantLifeline.addActivationEventsToLifelines(l,c,l.getDepthBelowLabel(a),d),a+=l.height;else if(m instanceof plugin.uml.sequence.model.ActivationGroup){l=m;p=(a+l.height)/d;for(m=0;m<l.getActivations().length;m++)g=l.getActivations()[m],c[g.participant].addActivation(p);for(m=0;m<l.getDeactivations().length;m++)g=l.getDeactivations()[m],c[g.participant].addDeactivation(p);a+=l.height}else m instanceof
plugin.uml.sequence.model.Note&&(a+=m.height)}};plugin.uml.sequence.view.ParticipantLifeline.getParticipantsInOrder=function(b,c){for(var a=[],d=0;d<b.length;d++)lucid.array.binaryInsert(a,b[d],function(a,b){return c[a].order-c[b].order});return a};g.provide("plugin.uml.sequence.view.Note");g.require("plugin.uml.sequence.model.size");g.require("plugin.uml.sequence.view.ParticipantLifeline");plugin.uml.sequence.view.Note=function(b,c){this.model=b;this.participantLifelines=c;this.calculateTextSize()};
plugin.uml.sequence.view.Note.horizontalPadding=40;plugin.uml.sequence.view.Note.prototype.calculateTextSize=function(){var b=plugin.uml.sequence.model.size.padding,c=plugin.uml.sequence.model.Note.paddingAbove*b.segmentHeight;this.textSize=lucid.text.measure(lucid.text.styled(this.model.label,{}));this.textSize.w+=plugin.uml.sequence.view.Note.horizontalPadding;this.textSize.h=Math.max(this.textSize.h,this.model.height*b.segmentHeight-c)};plugin.uml.sequence.view.Note.prototype.render=function(b,
c,a,d){return lucid.plugin.addBlock(b,{className:"UMLNoteBlock",BoundingBox:this.getBoundingBox(c,a,d),Text:this.model.label,TextAlign:"center"})};plugin.uml.sequence.view.Note.prototype.getBoundingBox=function(b,c,a){return{x:this.calculateX(a),y:this.calculateY(b,c),w:this.textSize.w,h:this.textSize.h}};plugin.uml.sequence.view.Note.prototype.calculateY=function(b,c){for(var a in this.participantLifelines)return a=this.participantLifelines[a].line,a.yTop+(b+this.model.height)/c*(a.yBot-a.yTop)-
this.textSize.h;return 0};plugin.uml.sequence.view.Note.prototype.calculateX=function(b){return 0};g.provide("plugin.uml.sequence.view.SideNote");g.require("plugin.uml.sequence.view.Note");g.require("plugin.uml.sequence.view.ParticipantLifeline");plugin.uml.sequence.view.SideNote=function(b,c,a){plugin.uml.sequence.view.Note.call(this,b,a);this.line=c};g.inherits(plugin.uml.sequence.view.SideNote,plugin.uml.sequence.view.Note);g.provide("plugin.uml.sequence.view.BlockNote");g.provide("plugin.uml.sequence.view.LeftBlockNote");
g.provide("plugin.uml.sequence.view.RightBlockNote");g.require("plugin.uml.sequence.model.BlockNote");g.require("plugin.uml.sequence.model.LeftBlockNote");g.require("plugin.uml.sequence.model.RightBlockNote");g.require("plugin.uml.sequence.view.ParticipantLifeline");g.require("plugin.uml.sequence.view.SideNote");plugin.uml.sequence.view.BlockNote=function(b,c){plugin.uml.sequence.view.SideNote.call(this,b,c[b.participant].line,c)};g.inherits(plugin.uml.sequence.view.BlockNote,plugin.uml.sequence.view.SideNote);
plugin.uml.sequence.view.LeftBlockNote=function(b,c){plugin.uml.sequence.view.BlockNote.call(this,b,c)};g.inherits(plugin.uml.sequence.view.LeftBlockNote,plugin.uml.sequence.view.BlockNote);plugin.uml.sequence.view.LeftBlockNote.prototype.calculateX=function(b){return this.line.x-plugin.uml.sequence.view.Note.horizontalPadding/2-this.textSize.w};plugin.uml.sequence.view.RightBlockNote=function(b,c){plugin.uml.sequence.view.BlockNote.call(this,b,c)};g.inherits(plugin.uml.sequence.view.RightBlockNote,
plugin.uml.sequence.view.BlockNote);plugin.uml.sequence.view.RightBlockNote.prototype.calculateX=function(b){return this.line.x+plugin.uml.sequence.view.Note.horizontalPadding/2};g.provide("plugin.common.Swimlane");plugin.common.Swimlane.ORIENTATIONS={VERTICAL:"vertical",HORIZONTAL:"horizontal"};plugin.common.Swimlane.getOrientationOptions=function(){return lucid.object.getValues(plugin.common.Swimlane.ORIENTATIONS)};plugin.common.Swimlane.updateLanes=function(b,c,a,d,h){var e=lucid.plugin.getProperty(c,
"Lanes"),m=lucid.plugin.getProperty(c,"BoundingBox"),l=lucid.plugin.getProperty(c,"Rotation")||0,g=[];if(e&&m){if("add"===b){void 0===a&&(a=e.length-1);var p=d?a:a+1;h=m.w*e[a].p;a=m.w+h;var z=[],t=0;for(b=0;b<e.length;b++)b>=p&&(t+=e[b].p),d={p:m.w*e[b].p/a,tid:e[b].tid},g.push(d),z.push(d.tid);for(;lucid.array.contains(z,b);)b++;g.splice(p,0,{p:h/a,tid:parseInt(b,10)});e=lucid.plugin.getProperty(c,"Vertical");d=m.x+(1-t)*m.w;if(!e)var A=lucid.math.Box.rotate(m,lucid.plugin.getProperty(c,"Rotation")).y+
(1-t)*m.w;t=lucid.plugin.getContained(c);for(b=0;b<t.length;b++)if(p=lucid.plugin.getProperty(t[b],"BoundingBox"))e?p.x+.01>=d&&(p.x+=h):p.y+.01>=A&&(p.y+=h),lucid.plugin.setProperty(t[b],"BoundingBox",p)}else{A=e.pop();a=m.w*(1-A.p);for(b=0;b<e.length;b++)d={p:m.w*e[b].p/a,tid:e[b].tid},g.push(d);h&&lucid.plugin.setProperty(c,"Lane_"+A.tid,"Lane")}50>=g.length&&0<g.length&&(lucid.plugin.setProperty(c,"Lanes",g),0!==l&&(m.x+=(m.w-a)/2,m.y-=(m.w-a)/2),m.w=a,lucid.plugin.setProperty(c,"BoundingBox",
m))}};plugin.common.Swimlane.setOrientation=function(b,c,a){var d=function(a,c){var d=lucid.plugin.getProperty(b,"Rotation")||0,e=lucid.math.Box.rotate(c,d),d=lucid.plugin.getContained(b),h={x:e.x+e.w/2,y:e.y+e.h/2};lucid.array.forEach(d,function(b){var c=lucid.plugin.getProperty(b,"BoundingBox"),d=lucid.math.Point.rotate({x:c.x,y:c.y},h,"v"===a?Math.PI/2:-Math.PI/2),c={x:"v"===a?d.x-2*(d.x-(e.x+e.w/2)):d.x,y:"h"===a?d.y-2*(d.y-(e.y+e.h/2)):d.y,w:c.w,h:c.h,data:c.data};c.x-=(e.w-e.h)/2;c.y-=(e.h-
e.w)/2;lucid.plugin.setProperty(b,"BoundingBox",c);c=lucid.plugin.getIncomingLines(b);b=lucid.plugin.getOutgoingLines(b);for(d=0;d<c.length;d++){var l=lucid.plugin.getProperty(c[d],"Endpoint2"),g=l.LinkX;l.LinkX=l.LinkY;l.LinkY=g;lucid.plugin.setProperty(c[d],"Endpoint2",l)}for(d=0;d<b.length;d++)l=lucid.plugin.getProperty(b[d],"Endpoint1"),g=l.LinkX,l.LinkX=l.LinkY,l.LinkY=g,lucid.plugin.setProperty(b[d],"Endpoint1",l)})},h=lucid.plugin.getProperty(b,"VerticalText"),e=lucid.plugin.getProperty(b,
"BoundingBox");null!=c&&(d(a?"v":"h",e),(!c&&a||c&&!a)&&lucid.plugin.setProperty(b,"VerticalText",h?0:1));lucid.plugin.setProperty(b,"Rotation",a?0:-Math.PI/2);e.x+=a?(e.w-e.h)/2:-(e.w-e.h)/2;e.y+=a?(e.h-e.w)/2:-(e.h-e.w)/2;lucid.plugin.setProperty(b,"BoundingBox",e)};plugin.common.Swimlane.beforeCreate=function(b,c,a){b=lucid.plugin.getChildren(b,function(b){return(b=lucid.plugin.getBlockClassName(b))&&0<=a.indexOf(b)});var d=c.BoundingBox;c=c.Rotation||0;for(var h in b){var e=b[h],g=lucid.plugin.getProperty(e,
"BoundingBox"),l=lucid.plugin.getProperty(e,"Rotation")||0;if(!(0===l&&0!==c||0!==l&&0===c)){var n=lucid.math.Box.rotate(d,c),p=lucid.math.Box.rotate(g,l);if(lucid.math.Box.overlap(n,p)){var n=lucid.plugin.getProperty(e,"Lanes"),p=g.w*n[n.length-1].p,z=g.w+p,t=[],A=[],w;for(w=0;w<n.length;w++){var ka={p:g.w*n[w].p/z,tid:n[w].tid};t.push(ka);A.push(ka.tid)}for(;lucid.array.contains(A,w);)w++;t.push({p:p/z,tid:parseInt(w)});if(50>=t.length&&0<t.length)return lucid.plugin.setProperty(e,"Lanes",t),0!==
l&&(g.x+=(g.w-z)/2,g.y-=(g.w-z)/2),g.w=z,lucid.plugin.setProperty(e,"BoundingBox",g),!1}}}return!0};plugin.common.Swimlane.getLinkPoints=function(b){var c=lucid.plugin.getProperty(b,"Lanes"),a=0,d=[];if(lucid.plugin.getProperty(b,"Vertical"))for(b=0;b<c.length;b++){var h=a+c[b].p/2;d.push({x:h,y:0});a+=c[b].p}else for(b=c.length-1;0<=b;b--)h=a+c[b].p/2,d.push({x:h,y:0}),a+=c[b].p;return d};plugin.common.Swimlane.spatialControls=function(b,c){function a(){var a=lucid.plugin.getProperty(b,"Lanes"),
c=lucid.plugin.getProperty(b,"Vertical");return a?c?a:a.reverse():null}function d(a,c){var d=lucid.plugin.getProperty(b,"Vertical");c.h&&(d||(a.x-=(a.h-c.h)/2,a.y+=(a.h-c.h)/2),a.h=c.h);c.w&&(d||(a.x+=(a.w-c.w)/2,a.y-=(a.w-c.w)/2),a.w=c.w);lucid.plugin.setProperty(b,"BoundingBox",a)}function h(a){var c=0;lucid.plugin.getProperty(b,"Vertical")||a--;for(var d=0;d<=a;d++)c+=g[d].p;return c}function e(c){return{logAction:"chart.viewport.selection.spatialControls.flowchart.swimlaneWidth",location:function(){g=
a();var d=lucid.plugin.getProperty(b,"BoundingBox"),e=lucid.plugin.getProperty(b,"mainTitleHeight",!0);return{x:d.x+d.w*h(c)-10,y:d.y+(!!e&&e),w:20,h:d.h-(!!e&&e)}},moved:function(e){g=a();var l=lucid.plugin.getProperty(b,"BoundingBox"),n=lucid.plugin.getProperty(b,"Vertical"),w=h(c),ka=l.x+w*l.w;e=n?e.x-ka:ka-e.x;if(!n)var V=lucid.math.Box.rotate(l,lucid.plugin.getProperty(b,"Rotation")).y+(1-w)*l.w;for(var w=l.w+e,x=0;x<g.length;x++)g[x].p=x===c?(g[x].p*l.w+e)/w:g[x].p*l.w/w;for(var D=lucid.plugin.getContained(b),
x=0;x<D.length;x++){var r=lucid.plugin.getProperty(D[x],"BoundingBox");r&&(n?r.x+.01>=ka&&(r.x+=e):r.y+.01>=V&&(r.y+=e),lucid.plugin.setProperty(D[x],"BoundingBox",r))}d(l,{w:w});l=g;n=lucid.plugin.getProperty(b,"Vertical");lucid.plugin.setProperty(b,"Lanes",n?l:l.reverse())},path:function(){g=a();var d=lucid.plugin.getProperty(b,"BoundingBox"),e=lucid.plugin.getProperty(b,"Vertical");return[{x:e?d.x+d.w*h(c-1)+20:d.x+d.w*h(c+1)-20,y:d.y+d.h/2},{x:e?1E8:-1E8,y:d.y+d.h/2}]},cursor:function(){return lucid.plugin.getProperty(b,
"Rotation")?"s-resize":"e-resize"},snap:!0,snapToGuides:!0,color:"none"}}var g=a(),l=[];if(g){for(var n=0;n<g.length;n++)l.push(e(n));l.push({logAction:"chart.viewport.selection.spatialControls."+c?"uml":"flowchart.swimlaneHeight",location:function(){var a=lucid.plugin.getProperty(b,"BoundingBox");return{x:a.x,y:a.y+a.h-10,w:a.w,h:20}},moved:function(a){var c=lucid.plugin.getProperty(b,"BoundingBox");d(c,{h:c.h-(c.y+c.h-a.y)})},path:function(){g=a();var c=lucid.plugin.getProperty(b,"BoundingBox");
return[{x:c.x+c.w/2,y:c.y+20+lucid.plugin.getProperty(b,"titleHeight",!0)||40},{x:c.x+c.w/2,y:1E8}]},cursor:function(){return lucid.plugin.getProperty(b,"Vertical")?"s-resize":"e-resize"},snap:!0,snapToGuides:!0,color:"none"})}return l};plugin.common.Swimlane.getLaneCountOfSwimLaneBlock=function(b){return lucid.plugin.getProperty(b,"Lanes").length};plugin.common.Swimlane.setLaneCountOfSwimLaneBlock=function(b,c,a){for(var d=lucid.plugin.getProperty(b,"Lanes").length,h=Math.abs(a-d),e=0;e<h;e++)plugin.common.Swimlane.updateLanes(d<
a?"add":"remove",b,void 0,void 0,c)};plugin.common.Swimlane.getOrientationOfSwimLaneBlock=function(b){return lucid.plugin.getProperty(b,"Vertical")?plugin.common.Swimlane.ORIENTATIONS.VERTICAL:plugin.common.Swimlane.ORIENTATIONS.HORIZONTAL};plugin.common.Swimlane.setOrientationOfSwimLaneBlock=function(b,c,a){var d=lucid.plugin.getProperty(b,"Vertical");a=a==plugin.common.Swimlane.ORIENTATIONS.VERTICAL?1:0;d!=a&&(lucid.plugin.setProperty(b,"Vertical",a),c&&plugin.common.Swimlane.setOrientation(b,d,
a))};g.provide("plugin.uml.sequence.model.SubDiagram");g.require("plugin.uml.sequence.model.Action");g.require("plugin.uml.sequence.model.SequenceDiagram");plugin.uml.sequence.model.SubDiagram=function(b){plugin.uml.sequence.model.SequenceDiagram.call(this,b);this.height=this.calculateHeight()};g.inherits(plugin.uml.sequence.model.SubDiagram,plugin.uml.sequence.model.SequenceDiagram);plugin.uml.sequence.model.SubDiagram.prototype.remeasureDepth=function(){plugin.uml.sequence.model.SequenceDiagram.prototype.remeasureDepth.call(this);
this.height=this.calculateHeight()};plugin.uml.sequence.model.SubDiagram.prototype.calculateHeight=function(){return this.totalDepth};plugin.uml.sequence.model.SubDiagram.prototype.getBoundingBox=function(b,c){};plugin.uml.sequence.model.SubDiagram.prototype.getTopDepth=function(b){return b};plugin.uml.sequence.model.SubDiagram.prototype.getDepthBelowLabel=function(b){return b};plugin.uml.sequence.model.SubDiagram.prototype.getBottomDepth=function(b){return b+this.height};g.provide("plugin.uml.sequence.view.OverBlockNote");
g.require("plugin.uml.sequence.model.OverNote");g.require("plugin.uml.sequence.view.Note");g.require("plugin.uml.sequence.view.ParticipantLifeline");plugin.uml.sequence.view.OverBlockNote=function(b,c){plugin.uml.sequence.view.Note.call(this,b,c)};g.inherits(plugin.uml.sequence.view.OverBlockNote,plugin.uml.sequence.view.Note);plugin.uml.sequence.view.OverBlockNote.prototype.calculateTextSize=function(){plugin.uml.sequence.view.Note.prototype.calculateTextSize.call(this);var b=this.calculateMinWidthAndCenter(),
c=b[1];this.textSize.w=Math.max(b[0],this.textSize.w);this.precalculatedX=c-this.textSize.w/2};plugin.uml.sequence.view.OverBlockNote.prototype.calculateMinWidthAndCenter=function(){var b=plugin.uml.sequence.view.Note.horizontalPadding,c=this.findOutsideParticipantsX(),a=c[0]-b,b=c[1]+b-a;return[b,a+b/2]};plugin.uml.sequence.view.OverBlockNote.prototype.findOutsideParticipantsX=function(){var b=plugin.uml.sequence.view.ParticipantLifeline.getParticipantsInOrder(this.model.participants,this.participantLifelines);
return[this.participantLifelines[b[0]].line.x,this.participantLifelines[b[b.length-1]].line.x]};plugin.uml.sequence.view.OverBlockNote.prototype.calculateX=function(b){return this.precalculatedX};g.provide("plugin.uml.sequence.model.ElseGroup");g.require("plugin.uml.sequence.model.SequenceDiagram");g.require("plugin.uml.sequence.model.SubDiagram");plugin.uml.sequence.model.ElseGroup=function(b,c){if(this.label=plugin.uml.Label.processMessageGroupLabel(c))this.label="["+this.label+"]";plugin.uml.sequence.model.SubDiagram.call(this,
b)};g.inherits(plugin.uml.sequence.model.ElseGroup,plugin.uml.sequence.model.SubDiagram);plugin.uml.sequence.model.ElseGroup.textLineHeight=.5;plugin.uml.sequence.model.ElseGroup.prototype.calculateHeight=function(){var b=plugin.uml.sequence.model.SubDiagram.prototype.calculateHeight.call(this),c=plugin.uml.sequence.model.size.verticalSegments,a=plugin.uml.sequence.model.ElseGroup.textLineHeight;this.labelHeight=this.label?this.label.split("\n").length*a*c:0;return this.labelHeight+b};plugin.uml.sequence.model.ElseGroup.prototype.getDepthBelowLabel=
function(b){return plugin.uml.sequence.model.SubDiagram.prototype.getTopDepth.call(this,b)+this.labelHeight};g.provide("plugin.uml.sequence.model.AltGroup");g.require("plugin.uml.sequence.model.ElseGroup");g.require("plugin.uml.sequence.model.SubDiagram");g.require("plugin.uml.sequence.model.size");plugin.uml.sequence.model.AltGroup=function(b){plugin.uml.sequence.model.SubDiagram.call(this,b);this.height=this.calculateHeight()};g.inherits(plugin.uml.sequence.model.AltGroup,plugin.uml.sequence.model.SubDiagram);
plugin.uml.sequence.model.AltGroup.aboveBlockHeight=.5;plugin.uml.sequence.model.AltGroup.titleHeight=1;plugin.uml.sequence.model.AltGroup.aboveDividerLineHeight=.5;plugin.uml.sequence.model.AltGroup.belowDividerLineHeight=0;plugin.uml.sequence.model.AltGroup.prototype.calculateHeight=function(){var b=plugin.uml.sequence.model.SubDiagram.prototype.calculateHeight.call(this),c=plugin.uml.sequence.model.size.verticalSegments,a=plugin.uml.sequence.model.AltGroup;this.aboveBlockHeight=a.aboveBlockHeight*
c;var d=a.titleHeight*c;this.topHeight=this.aboveBlockHeight+d;this.depthBetweenActions=a.aboveDividerLineHeight*c+a.belowDividerLineHeight*c;for(var h=0,e=1;e<this.actions.length;e++)h+=this.depthBetweenActions;c*=a.aboveDividerLineHeight;a=this.topHeight+h+b+c;this.calculateBoundaries(d,d+h+b+c);return a};plugin.uml.sequence.model.AltGroup.prototype.calculateBoundaries=function(b,c){var a=plugin.uml.sequence.model.size.verticalSegments,d=plugin.uml.sequence.model.AltGroup,h=d.aboveDividerLineHeight*
a,a=d.belowDividerLineHeight*a;this.boundaries=[];this.condition=null;if(1<=this.actions.length){this.condition=this.actions[0].label;for(var d=b+(this.actions[0].height+h),e=1;e<this.actions.length;e++)this.boundaries.push({height:d/c,text:this.actions[e].label||""}),d+=a+this.actions[e].height+h}};plugin.uml.sequence.model.AltGroup.prototype.getTopDepth=function(b){return plugin.uml.sequence.model.SubDiagram.prototype.getTopDepth.call(this,b)+this.aboveBlockHeight};plugin.uml.sequence.model.AltGroup.prototype.getDepthBelowLabel=
function(b){return plugin.uml.sequence.model.SubDiagram.prototype.getTopDepth.call(this,b)+this.topHeight};g.provide("plugin.uml.sequence.model.MessageGroup");g.require("plugin.uml.sequence.model.SequenceDiagram");g.require("plugin.uml.sequence.model.SubDiagram");g.require("plugin.uml.sequence.model.size");g.require("plugin.uml.Label");plugin.uml.sequence.model.MessageGroup=function(b,c,a){if(this.label=plugin.uml.Label.processMessageGroupLabel(a))this.label="["+this.label+"]";this.type=plugin.uml.Label.processMessageGroupLabel(b);
this.type||(this.type="Group");plugin.uml.sequence.model.SubDiagram.call(this,c)};g.inherits(plugin.uml.sequence.model.MessageGroup,plugin.uml.sequence.model.SubDiagram);plugin.uml.sequence.model.MessageGroup.prototype.calculateHeight=function(){var b=plugin.uml.sequence.model.SubDiagram.prototype.calculateHeight.call(this),c=plugin.uml.sequence.model.size.verticalSegments;this.aboveTopLine=.5*c;this.belowTopLine=.5*c+.5*c*this.type.split("\n").length;null!==this.label&&(belowTopLine=.5*c*Math.max(this.label.split("\n").length,
2));this.aboveBottomLine=.5*c;this.belowBottomLine=0;return this.aboveTopLine+this.belowTopLine+b+this.aboveBottomLine+this.belowBottomLine};plugin.uml.sequence.model.MessageGroup.prototype.getTopDepth=function(b){return plugin.uml.sequence.model.SubDiagram.prototype.getTopDepth.call(this,b)+this.aboveTopLine};plugin.uml.sequence.model.MessageGroup.prototype.getDepthBelowLabel=function(b){return this.getTopDepth(b)+this.belowTopLine};plugin.uml.sequence.model.MessageGroup.prototype.getBottomDepth=
function(b){return plugin.uml.sequence.model.SubDiagram.prototype.getBottomDepth.call(this,b)-this.belowBottomLine};g.provide("plugin.uml.sequence.model.Ignore");plugin.uml.sequence.model.Ignore=function(){};g.provide("plugin.uml.sequence.model.PartialBlockNote");g.provide("plugin.uml.sequence.model.PartialInlineNote");g.provide("plugin.uml.sequence.model.PartialLeftBlockNote");g.provide("plugin.uml.sequence.model.PartialLeftInlineNote");g.provide("plugin.uml.sequence.model.PartialNote");g.provide("plugin.uml.sequence.model.PartialOverNote");
g.provide("plugin.uml.sequence.model.PartialRightBlockNote");g.provide("plugin.uml.sequence.model.PartialRightInlineNote");g.provide("plugin.uml.sequence.model.PartialSideNote");g.require("plugin.uml.sequence.model.LeftBlockNote");g.require("plugin.uml.sequence.model.LeftInlineNote");g.require("plugin.uml.sequence.model.Note");g.require("plugin.uml.sequence.model.NoteArrangement");g.require("plugin.uml.sequence.model.NotePosition");g.require("plugin.uml.sequence.model.OverNote");g.require("plugin.uml.sequence.model.RightBlockNote");
g.require("plugin.uml.sequence.model.RightInlineNote");plugin.uml.sequence.model.PartialNote=function(b,c){this.position=b;this.arrangement=c};plugin.uml.sequence.model.PartialNote.prototype.toNote=function(b){return null};plugin.uml.sequence.model.PartialSideNote=function(b,c){plugin.uml.sequence.model.PartialNote.call(this,b,c)};g.inherits(plugin.uml.sequence.model.PartialSideNote,plugin.uml.sequence.model.PartialNote);plugin.uml.sequence.model.PartialInlineNote=function(b){plugin.uml.sequence.model.PartialSideNote.call(this,
b,plugin.uml.sequence.model.NoteArrangement.Inline)};g.inherits(plugin.uml.sequence.model.PartialInlineNote,plugin.uml.sequence.model.PartialSideNote);plugin.uml.sequence.model.PartialLeftInlineNote=function(){plugin.uml.sequence.model.PartialInlineNote.call(this,plugin.uml.sequence.model.NotePosition.Left)};g.inherits(plugin.uml.sequence.model.PartialLeftInlineNote,plugin.uml.sequence.model.PartialInlineNote);plugin.uml.sequence.model.PartialLeftInlineNote.prototype.toNote=function(b){return new plugin.uml.sequence.model.LeftInlineNote(b)};
plugin.uml.sequence.model.PartialRightInlineNote=function(){plugin.uml.sequence.model.PartialInlineNote.call(this,plugin.uml.sequence.model.NotePosition.Right)};g.inherits(plugin.uml.sequence.model.PartialRightInlineNote,plugin.uml.sequence.model.PartialInlineNote);plugin.uml.sequence.model.PartialRightInlineNote.prototype.toNote=function(b){return new plugin.uml.sequence.model.RightInlineNote(b)};plugin.uml.sequence.model.PartialBlockNote=function(b,c){plugin.uml.sequence.model.PartialSideNote.call(this,
b,plugin.uml.sequence.model.NoteArrangement.Block);this.participant=c};g.inherits(plugin.uml.sequence.model.PartialBlockNote,plugin.uml.sequence.model.PartialSideNote);plugin.uml.sequence.model.PartialLeftBlockNote=function(b){plugin.uml.sequence.model.PartialBlockNote.call(this,plugin.uml.sequence.model.NotePosition.Left,b)};g.inherits(plugin.uml.sequence.model.PartialLeftBlockNote,plugin.uml.sequence.model.PartialBlockNote);plugin.uml.sequence.model.PartialLeftBlockNote.prototype.toNote=function(b){return new plugin.uml.sequence.model.LeftBlockNote(b,
this.participant)};plugin.uml.sequence.model.PartialRightBlockNote=function(b){plugin.uml.sequence.model.PartialBlockNote.call(this,plugin.uml.sequence.model.NotePosition.Right,b)};g.inherits(plugin.uml.sequence.model.PartialRightBlockNote,plugin.uml.sequence.model.PartialBlockNote);plugin.uml.sequence.model.PartialRightBlockNote.prototype.toNote=function(b){return new plugin.uml.sequence.model.RightBlockNote(b,this.participant)};plugin.uml.sequence.model.PartialOverNote=function(b){plugin.uml.sequence.model.PartialNote.call(this,
plugin.uml.sequence.model.NotePosition.Over,plugin.uml.sequence.model.NoteArrangement.Block);this.participants=b};g.inherits(plugin.uml.sequence.model.PartialOverNote,plugin.uml.sequence.model.PartialNote);plugin.uml.sequence.model.PartialOverNote.prototype.toNote=function(b){return new plugin.uml.sequence.model.OverNote(b,this.participants)};plugin.uml.sequence.model.PartialNote.LeftInlineNote=plugin.uml.sequence.model.PartialLeftInlineNote;plugin.uml.sequence.model.PartialNote.RightInlineNote=plugin.uml.sequence.model.PartialRightInlineNote;
plugin.uml.sequence.model.PartialNote.LeftBlockNote=plugin.uml.sequence.model.PartialLeftBlockNote;plugin.uml.sequence.model.PartialNote.RightBlockNote=plugin.uml.sequence.model.PartialRightBlockNote;plugin.uml.sequence.model.PartialNote.OverBlockNote=plugin.uml.sequence.model.PartialOverNote;g.provide("plugin.uml.sequence.model");g.require("plugin.uml.sequence.model.Activate");g.require("plugin.uml.sequence.model.AltGroup");g.require("plugin.uml.sequence.model.ArrowType");g.require("plugin.uml.sequence.model.Autonumber");
g.require("plugin.uml.sequence.model.Connector");g.require("plugin.uml.sequence.model.Deactivate");g.require("plugin.uml.sequence.model.ElseGroup");g.require("plugin.uml.sequence.model.Ignore");g.require("plugin.uml.sequence.model.LineType");g.require("plugin.uml.sequence.model.Message");g.require("plugin.uml.sequence.model.MessageGroup");g.require("plugin.uml.sequence.model.PartialNote");g.require("plugin.uml.sequence.model.SequenceDiagram");g.provide("plugin.uml.sequence.peg");g.require("plugin.uml.sequence.model");
plugin.uml.sequence.peg=function(){function b(c,a,d,h){this.message=c;this.expected=a;this.found=d;this.location=h;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,b)}(function(b,a){function d(){this.constructor=b}d.prototype=a.prototype;b.prototype=new d})(b,Error);return{SyntaxError:b,parse:function(c){function a(a){throw g(a,null,c.substring(u,k),h(u,k));}function d(a){var b=za[a],d,f;if(!b){for(d=a-1;!za[d];)d--;b=za[d];for(b={line:b.line,column:b.column,
seenCR:b.seenCR};d<a;)f=c.charAt(d),"\n"===f?(b.seenCR||b.line++,b.column=1,b.seenCR=!1):"\r"===f||"\u2028"===f||"\u2029"===f?(b.line++,b.column=1,b.seenCR=!0):(b.column++,b.seenCR=!1),d++;za[a]=b}return b}function h(a,b){var c=d(a),f=d(b);return{start:{offset:a,line:c.line,column:c.column},end:{offset:b,line:f.line,column:f.column}}}function e(a){k<M||(k>M&&(M=k,Ea=[]),Ea.push(a))}function g(a,c,d,f){function e(a){var b=1;for(a.sort(function(a,b){return a.description<b.description?-1:a.description>
b.description?1:0});b<a.length;)a[b-1]===a[b]?a.splice(b,1):b++}function k(a,b){function c(a){function b(a){return a.charCodeAt(0).toString(16).toUpperCase()}return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(a){return"\\x0"+b(a)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(a){return"\\x"+b(a)}).replace(/[\u0100-\u0FFF]/g,function(a){return"\\u0"+b(a)}).replace(/[\u1000-\uFFFF]/g,
function(a){return"\\u"+b(a)})}var d=Array(a.length),f;for(f=0;f<a.length;f++)d[f]=a[f].description;d=1<a.length?d.slice(0,-1).join(", ")+" or "+d[a.length-1]:d[0];f=b?'"'+c(b)+'"':"end of input";return"Expected "+d+" but "+f+" found."}null!==c&&e(c);return new b(null!==a?a:k(c,d),c,d,f)}function l(){var a,b,c,d,e,h;a=k;b=[];for(c=n();c!==f;)b.push(c),c=n();if(b!==f)if(c=p(),c!==f){b=[];d=k;e=[];h=n();if(h!==f)for(;h!==f;)e.push(h),h=n();else e=f;e!==f?(h=p(),h!==f?d=e=[e,h]:(k=d,d=f)):(k=d,d=f);
for(;d!==f;){b.push(d);d=k;e=[];h=n();if(h!==f)for(;h!==f;)e.push(h),h=n();else e=f;e!==f?(h=p(),h!==f?d=e=[e,h]:(k=d,d=f)):(k=d,d=f)}if(b!==f){d=[];for(e=n();e!==f;)d.push(e),e=n();d!==f?(e=C(),e===f&&(e=null),e!==f?(u=a,a=b=ja(c,b)):(k=a,a=f)):(k=a,a=f)}else k=a,a=f}else k=a,a=f;else k=a,a=f;return a}function n(){var a,b,c;a=k;b=C();b===f&&(b=null);b!==f?(c=B(),c!==f?a=b=[b,c]:(k=a,a=f)):(k=a,a=f);return a}function p(){var b,d,h,g;b=k;d=C();d===f&&(d=null);if(d!==f){var n,m,p,v,y,I,E,G;m=k;c.substr(k,
3)===Gc?(p=Gc,k+=3):(p=f,0===q&&e(bc));if(p!==f)if(v=D(),v!==f)if(y=B(),y!==f)if(I=l(),I!==f){E=[];for(G=z();G!==f;)E.push(G),G=z();if(E!==f)if(c.substr(k,3)===P?(G=P,k+=3):(G=f,0===q&&e(Aa)),G!==f){u=m;var U=new Hc(I,v);E.unshift(U);m=p=new gd(E)}else k=m,m=f;else k=m,m=f}else k=m,m=f;else k=m,m=f;else k=m,m=f;else k=m,m=f;n=m;if(n===f){var O,M,Y,Z,ja,oa;O=k;c.substr(k,8)===Da?(M=Da,k+=8):(M=f,0===q&&e(qb));M!==f?(Y=D(),Y!==f?(Z=B(),Z!==f?(ja=l(),ja!==f?(c.substr(k,3)===P?(oa=P,k+=3):(oa=f,0===q&&
e(Aa)),oa!==f?(u=O,O=M=new vb("Critical",ja,Y)):(k=O,O=f)):(k=O,O=f)):(k=O,O=f)):(k=O,O=f)):(k=O,O=f);n=O;if(n===f){var Q,ub,za,Ba,Ca,xa;Q=k;c.substr(k,5)===Qa?(ub=Qa,k+=5):(ub=f,0===q&&e(ac));ub!==f?(za=D(),za!==f?(Ba=B(),Ba!==f?(Ca=l(),Ca!==f?(c.substr(k,3)===P?(xa=P,k+=3):(xa=f,0===q&&e(Aa)),xa!==f?(u=Q,lucid.kissMetrics.record(lucid.kissMetrics.Events.umlSequenceMarkupNamedGroups),a("Named groups aren't supported yet."),Q=ub=void 0):(k=Q,Q=f)):(k=Q,Q=f)):(k=Q,Q=f)):(k=Q,Q=f)):(k=Q,Q=f);n=Q;if(n===
f){var R,pa,ya,Ea,ec,fc;R=k;c.substr(k,4)===Na?(pa=Na,k+=4):(pa=f,0===q&&e(rb));pa!==f?(ya=D(),ya!==f?(Ea=B(),Ea!==f?(ec=l(),ec!==f?(c.substr(k,3)===P?(fc=P,k+=3):(fc=f,0===q&&e(Aa)),fc!==f?(u=R,R=pa=new vb("Loop",ec,ya)):(k=R,R=f)):(k=R,R=f)):(k=R,R=f)):(k=R,R=f)):(k=R,R=f);n=R;if(n===f){var S,wb,gc,$a,hc,ic;S=k;c.substr(k,3)===Oa?(wb=Oa,k+=3):(wb=f,0===q&&e(sb));wb!==f?(gc=D(),gc!==f?($a=B(),$a!==f?(hc=l(),hc!==f?(c.substr(k,3)===P?(ic=P,k+=3):(ic=f,0===q&&e(Aa)),ic!==f?(u=S,S=wb=new vb("Opt",hc,
gc)):(k=S,S=f)):(k=S,S=f)):(k=S,S=f)):(k=S,S=f)):(k=S,S=f);n=S;if(n===f){var T,xb,jc,ab,kc,lc;T=k;c.substr(k,3)===Pa?(xb=Pa,k+=3):(xb=f,0===q&&e(tb));xb!==f?(jc=D(),jc!==f?(ab=B(),ab!==f?(kc=l(),kc!==f?(c.substr(k,3)===P?(lc=P,k+=3):(lc=f,0===q&&e(Aa)),lc!==f?(u=T,T=xb=new vb("Par",kc,jc)):(k=T,T=f)):(k=T,T=f)):(k=T,T=f)):(k=T,T=f)):(k=T,T=f);n=T}}}}}h=n;if(h===f){var H,yb,zb,mc,Ab,nc,Bb,Ra;H=k;yb=t();if(yb!==f)if(zb=C(),zb===f&&(zb=null),zb!==f){var aa,Fa,oc,Sa;aa=k;var qa,ba;qa=k;c.substr(k,2)===
Ic?(ba=Ic,k+=2):(ba=f,0===q&&e(hd));ba!==f&&(u=qa,ba=Ga.open);qa=ba;qa===f&&(qa=k,60===c.charCodeAt(k)?(ba=id,k++):(ba=f,0===q&&e(jd)),ba!==f&&(u=qa,ba=Ga.closed),qa=ba);Fa=qa;Fa===f&&(Fa=null);if(Fa!==f){var ra,ca;ra=k;c.substr(k,2)===Jc?(ca=Jc,k+=2):(ca=f,0===q&&e(kd));ca!==f&&(u=ra,ca=Kc.dash);ra=ca;ra===f&&(ra=k,45===c.charCodeAt(k)?(ca=Lc,k++):(ca=f,0===q&&e(Mc)),ca!==f&&(u=ra,ca=Kc.solid),ra=ca);oc=ra;if(oc!==f){var sa,da;sa=k;c.substr(k,2)===Nc?(da=Nc,k+=2):(da=f,0===q&&e(ld));da!==f&&(u=sa,
da=Ga.open);sa=da;sa===f&&(sa=k,62===c.charCodeAt(k)?(da=md,k++):(da=f,0===q&&e(nd)),da!==f&&(u=sa,da=Ga.closed),sa=da);Sa=sa;Sa===f&&(Sa=null);Sa!==f?(u=aa,aa=Fa=new od(oc,Fa||Ga.none,Sa||Ga.none)):(k=aa,aa=f)}else k=aa,aa=f}else k=aa,aa=f;mc=aa;if(mc!==f)if(Ab=C(),Ab===f&&(Ab=null),Ab!==f)if(nc=t(),nc!==f)if(Bb=C(),Bb===f&&(Bb=null),Bb!==f){var ea,Cb,Db,pc;ea=k;58===c.charCodeAt(k)?(Cb=Oc,k++):(Cb=f,0===q&&e(Pc));Cb!==f?(Db=C(),Db===f&&(Db=null),Db!==f?(pc=D(),pc!==f?(u=ea,ea=Cb=pc):(k=ea,ea=f)):
(k=ea,ea=f)):(k=ea,ea=f);Ra=ea;Ra===f&&(Ra=null);Ra!==f?(u=H,H=yb=new pd(yb,nc,mc,Ra)):(k=H,H=f)}else k=H,H=f;else k=H,H=f;else k=H,H=f;else k=H,H=f}else k=H,H=f;else k=H,H=f;h=H;if(h===f){var Eb,W,qc,bb,rc,Ta;W=k;var sc;c.substr(k,11)===Qc?(sc=Qc,k+=11):(sc=f,0===q&&e(qd));qc=sc;qc!==f?(bb=C(),bb!==f?(rc=x(),rc!==f?(Ta=A(),Ta===f&&(Ta=null),Ta!==f?(u=W,W=qc=new rd(rc,Ta)):(k=W,W=f)):(k=W,W=f)):(k=W,W=f)):(k=W,W=f);Eb=W;if(Eb===f){var X,Fb,cb,db,Gb;X=k;var N;c.substr(k,5)===Rc?(N=Rc,k+=5):(N=f,0===
q&&e(sd));N===f&&(c.substr(k,8)===Sc?(N=Sc,k+=8):(N=f,0===q&&e(td)),N===f&&(c.substr(k,7)===Tc?(N=Tc,k+=7):(N=f,0===q&&e(ud)),N===f&&(c.substr(k,6)===Uc?(N=Uc,k+=6):(N=f,0===q&&e(vd)),N===f&&(c.substr(k,8)===Vc?(N=Vc,k+=8):(N=f,0===q&&e(wd))))));Fb=N;Fb!==f?(cb=C(),cb!==f?(db=x(),db!==f?(Gb=A(),Gb===f&&(Gb=null),Gb!==f?(u=X,a("Participant type "+Fb+" isn't supported yet."),X=Fb=void 0):(k=X,X=f)):(k=X,X=f)):(k=X,X=f)):(k=X,X=f);Eb=X}h=Eb;if(h===f){var eb,Hb;eb=k;var Ha;c.substr(k,9)===Wc?(Ha=Wc,k+=
9):(Ha=f,0===q&&e(cc));Ha===f&&(c.substr(k,7)===Xc?(Ha=Xc,k+=7):(Ha=f,0===q&&e(dc)));Hb=Ha;Hb!==f&&(u=eb,Hb=new xd);h=Hb;if(h===f){var Ib,J,Jb,fb,tc,Kb,uc,vc;J=k;c.substr(k,4)===Ia?(Jb=Ia,k+=4):(Jb=f,0===q&&e(wc));Jb!==f?(fb=C(),fb!==f?(tc=ka(),tc!==f?(Kb=C(),Kb===f&&(Kb=null),Kb!==f?(58===c.charCodeAt(k)?(uc=Oc,k++):(uc=f,0===q&&e(Pc)),uc!==f?(vc=D(),vc!==f?(u=J,J=Jb=tc.toNote(vc)):(k=J,J=f)):(k=J,J=f)):(k=J,J=f)):(k=J,J=f)):(k=J,J=f)):(k=J,J=f);Ib=J;if(Ib===f){var K,Lb,gb,xc,hb,yc,ib;K=k;c.substr(k,
4)===Ia?(Lb=Ia,k+=4):(Lb=f,0===q&&e(wc));if(Lb!==f)if(gb=C(),gb!==f)if(xc=ka(),xc!==f)if(hb=B(),hb!==f){var jb,Ja,L,Ka,Mb;jb=k;Ja=[];L=k;Ka=V();Ka!==f?(Mb=B(),Mb!==f?(u=L,L=Ka):(k=L,L=f)):(k=L,L=f);for(;L!==f;)Ja.push(L),L=k,Ka=V(),Ka!==f?(Mb=B(),Mb!==f?(u=L,L=Ka):(k=L,L=f)):(k=L,L=f);Ja!==f&&(u=jb,Ja=Ja.join("\n"));yc=Ja;if(yc!==f){var la,Ua,zc,Nb;la=k;c.substr(k,3)===P?(Ua=P,k+=3):(Ua=f,0===q&&e(Aa));Ua!==f?(zc=C(),zc!==f?(c.substr(k,4)===Ia?(Nb=Ia,k+=4):(Nb=f,0===q&&e(wc)),Nb!==f?la=Ua=[Ua,zc,
Nb]:(k=la,la=f)):(k=la,la=f)):(k=la,la=f);ib=la;ib!==f?(u=K,K=Lb=xc.toNote(yc)):(k=K,K=f)}else k=K,K=f}else k=K,K=f;else k=K,K=f;else k=K,K=f;else k=K,K=f;Ib=K}h=Ib;if(h===f){var ma,Ob,Ac,Pb;q++;ma=k;c.substr(k,5)===Yc?(Ob=Yc,k+=5):(Ob=f,0===q&&e(yd));if(Ob!==f){Ac=[];for(Pb=F();Pb!==f;)Ac.push(Pb),Pb=F();Ac!==f?(u=ma,lucid.kissMetrics.record(lucid.kissMetrics.Events.umlSequenceMarkupTitle),a("Title isn't supported yet."),ma=Ob=void 0):(k=ma,ma=f)}else k=ma,ma=f;q--;ma===f&&0===q&&e(zd);h=ma;if(h===
f){var na,Qb,Bc,Rb;q++;na=k;c.substr(k,7)===Zc?(Qb=Zc,k+=7):(Qb=f,0===q&&e(Ad));if(Qb!==f){Bc=[];for(Rb=F();Rb!==f;)Bc.push(Rb),Rb=F();Bc!==f?(u=na,lucid.kissMetrics.record(lucid.kissMetrics.Events.umlSequenceMarkupCaption),a("Caption isn't supported yet."),na=Qb=void 0):(k=na,na=f)}else k=na,na=f;q--;na===f&&0===q&&e(Bd);h=na;if(h===f){var La,fa,Sb,kb,Cc;fa=k;c.substr(k,8)===$c?(Sb=$c,k+=8):(Sb=f,0===q&&e(Cd));Sb!==f?(kb=C(),kb!==f?(Cc=x(),Cc!==f?(u=fa,fa=Sb=new Dd(Cc)):(k=fa,fa=f)):(k=fa,fa=f)):
(k=fa,fa=f);La=fa;if(La===f){var ga,Tb,lb,Dc;ga=k;c.substr(k,10)===ad?(Tb=ad,k+=10):(Tb=f,0===q&&e(Ed));Tb!==f?(lb=C(),lb!==f?(Dc=x(),Dc!==f?(u=ga,ga=Tb=new Fd(Dc)):(k=ga,ga=f)):(k=ga,ga=f)):(k=ga,ga=f);La=ga;if(La===f){var ha,Ub,mb,nb;ha=k;c.substr(k,7)===bd?(Ub=bd,k+=7):(Ub=f,0===q&&e(Gd));Ub!==f?(mb=C(),mb!==f?(nb=x(),nb!==f?(u=ha,lucid.kissMetrics.record(lucid.kissMetrics.Events.umlSequenceMarkupDestroy),a("Destruction isn't supported yet."),ha=Ub=void 0):(k=ha,ha=f)):(k=ha,ha=f)):(k=ha,ha=f);
La=ha}}h=La;if(h===f){var Ma,ob,Va;ob=k;c.substr(k,15)===cd?(Va=cd,k+=15):(Va=f,0===q&&e(Hd));Va!==f&&(u=ob,Va=new Id);Ma=Va;if(Ma===f){var ta,Vb,Wa;ta=k;c.substr(k,17)===dd?(Vb=dd,k+=17):(Vb=f,0===q&&e(Jd));if(Vb!==f)if(Wa=w(),Wa===f&&(Wa=null),Wa!==f){u=ta;var Wb=Wa,Wb=Wb||[];ta=Vb=new Kd(Wb[0],Wb[1])}else k=ta,ta=f;else k=ta,ta=f;Ma=ta;if(Ma===f){var ua,Xb,Xa;ua=k;c.substr(k,10)===ed?(Xb=ed,k+=10):(Xb=f,0===q&&e(Ld));if(Xb!==f){var ia,Ec,Fc,Ya;ia=k;Ec=C();Ec!==f?(Fc=r(),Fc!==f?(Ya=w(),Ya===f&&
(Ya=null),Ya!==f?(u=ia,ia=Ec=[Fc].concat(Ya)):(k=ia,ia=f)):(k=ia,ia=f)):(k=ia,ia=f);Xa=ia;Xa===f&&(Xa=null);if(Xa!==f){u=ua;var Za=Xa,Za=Za||[];ua=Xb=new Md(Za[0],Za[1],Za[2])}else k=ua,ua=f}else k=ua,ua=f;Ma=ua}}h=Ma;if(h===f){var va,Yb,Zb;va=k;c.substr(k,7)===fd?(Yb=fd,k+=7):(Yb=f,0===q&&e(Nd));Yb!==f?(Zb=D(),Zb===f&&(Zb=null),Zb!==f?(u=va,lucid.kissMetrics.record(lucid.kissMetrics.Events.umlSequenceMarkupPageSplit),a("Page splits aren't supported yet."),va=Yb=void 0):(k=va,va=f)):(k=va,va=f);h=
va;if(h===f){var wa,$b,pb;wa=k;33===c.charCodeAt(k)?($b=Od,k++):($b=f,0===q&&e(Pd));$b!==f?(pb=D(),pb!==f?(u=wa,lucid.kissMetrics.record(lucid.kissMetrics.Events.umlSequenceMarkupPreprocessingDirective),a("Preprocessing directives aren't supported yet."),wa=$b=void 0):(k=wa,wa=f)):(k=wa,wa=f);h=wa}}}}}}}}}}h!==f?(g=C(),g===f&&(g=null),g!==f?(u=b,b=d=h):(k=b,b=f)):(k=b,b=f)}else k=b,b=f;return b}function z(){var a,b,d;a=k;c.substr(k,4)===$a?(b=$a,k+=4):(b=f,0===q&&e(ya));b!==f?(b=D(),b!==f?(d=B(),
d!==f?(d=l(),d!==f?(u=a,a=b=new Hc(d,b)):(k=a,a=f)):(k=a,a=f)):(k=a,a=f)):(k=a,a=f);return a}function t(){var b,d;q++;b=k;91===c.charCodeAt(k)?(d=Qd,k++):(d=f,0===q&&e(Rd));d===f&&(93===c.charCodeAt(k)?(d=Sd,k++):(d=f,0===q&&e(Td)));d!==f&&(u=b,lucid.kissMetrics.record(lucid.kissMetrics.Events.umlSequenceMarkupExternalArrows),a("External arrows aren't supported yet."),d=void 0);b=d;b===f&&(b=k,d=x(),d!==f?(d=A(),d!==f?(u=b,lucid.kissMetrics.record(lucid.kissMetrics.Events.umlSequenceMarkupAliasOutsideParticipantDeclaration),
a("Creating an alias outside a participant declaration isn't supported yet."),b=void 0):(k=b,b=f)):(k=b,b=f),b===f&&(b=k,d=x(),d!==f&&(u=b),b=d));q--;b===f&&0===q&&e(ab);return b}function A(){var a,b;a=k;b=C();b!==f?(c.substr(k,2)===bb?(b=bb,k+=2):(b=f,0===q&&e(Ud)),b!==f?(b=C(),b!==f?(b=x(),b!==f?(u=a,a=b):(k=a,a=f)):(k=a,a=f)):(k=a,a=f)):(k=a,a=f);return a}function w(){var b,c,d;b=k;c=C();if(c!==f)if(c=r(),c!==f){var e;d=k;e=v();e!==f&&(u=d,lucid.kissMetrics.record(lucid.kissMetrics.Events.umlSequenceMarkupFormattedAutonumberStrings),
a("Formatted autonumber strings aren't supported yet."),e=void 0);d=e;d===f&&(d=null);d!==f?(u=b,b=c=[c,d]):(k=b,b=f)}else k=b,b=f;else k=b,b=f;return b}function ka(){var a,b;a=k;c.substr(k,4)===cb?(b=cb,k+=4):(b=f,0===q&&e(Vd));if(b!==f)if(b=C(),b!==f){var d,h,l,g,n,m,p;b=k;d=x();if(d!==f){h=[];l=k;g=C();g===f&&(g=null);g!==f?(44===c.charCodeAt(k)?(n=db,k++):(n=f,0===q&&e(eb)),n!==f?(m=C(),m===f&&(m=null),m!==f?(p=x(),p!==f?l=g=[g,n,m,p]:(k=l,l=f)):(k=l,l=f)):(k=l,l=f)):(k=l,l=f);for(;l!==f;)h.push(l),
l=k,g=C(),g===f&&(g=null),g!==f?(44===c.charCodeAt(k)?(n=db,k++):(n=f,0===q&&e(eb)),n!==f?(m=C(),m===f&&(m=null),m!==f?(p=x(),p!==f?l=g=[g,n,m,p]:(k=l,l=f)):(k=l,l=f)):(k=l,l=f)):(k=l,l=f);h!==f?(u=b,b=d=Wd(d,h)):(k=b,b=f)}else k=b,b=f;b!==f?(u=a,a=b=new oa.OverBlockNote(b)):(k=a,a=f)}else k=a,a=f;else k=a,a=f;a===f&&(a=k,c.substr(k,4)===Ba?(b=Ba,k+=4):(b=f,0===q&&e(fb)),b!==f?(b=C(),b!==f?(c.substr(k,2)===Ca?(b=Ca,k+=2):(b=f,0===q&&e(gb)),b!==f?(b=C(),b!==f?(b=x(),b!==f?(u=a,a=b=new oa.LeftBlockNote(b)):
(k=a,a=f)):(k=a,a=f)):(k=a,a=f)):(k=a,a=f)):(k=a,a=f),a===f&&(a=k,c.substr(k,5)===xa?(b=xa,k+=5):(b=f,0===q&&e(hb)),b!==f?(b=C(),b!==f?(c.substr(k,2)===Ca?(b=Ca,k+=2):(b=f,0===q&&e(gb)),b!==f?(b=C(),b!==f?(b=x(),b!==f?(u=a,a=b=new oa.RightBlockNote(b)):(k=a,a=f)):(k=a,a=f)):(k=a,a=f)):(k=a,a=f)):(k=a,a=f),a===f&&(a=k,c.substr(k,4)===Ba?(b=Ba,k+=4):(b=f,0===q&&e(fb)),b!==f&&(u=a,b=new oa.LeftInlineNote),a=b,a===f&&(a=k,c.substr(k,5)===xa?(b=xa,k+=5):(b=f,0===q&&e(hb)),b!==f&&(u=a,b=new oa.RightInlineNote),
a=b))));return a}function V(){var a,b;a=k;b=D();b!==f&&(u=a,a=b,b=/^\s*end\s+note\s*$/.test(a)?f:a.trim());return b}function x(){var a,b,d,h;q++;a=k;q++;Xd.test(c.charAt(k))?(b=c.charAt(k),k++):(b=f,0===q&&e(Yd));q--;b===f&&0===q&&e(Zd);if(b!==f){d=[];for(h=y();h!==f;)d.push(h),h=y();d!==f?(u=a,a=b=G(b,d)):(k=a,a=f)}else k=a,a=f;a===f&&(a=v());q--;a===f&&0===q&&e(ab);return a}function D(){var a,b,c;q++;a=k;b=[];for(c=F();c!==f;)b.push(c),c=F();b!==f&&(u=a,b=G(b));a=b;q--;a===f&&0===q&&e($d);return a}
function r(){var a,b,d,h;q++;a=k;45===c.charCodeAt(k)?(b=Lc,k++):(b=f,0===q&&e(Mc));b===f&&(b=null);if(b!==f){d=[];h=E();if(h!==f)for(;h!==f;)d.push(h),h=E();else d=f;d!==f?(u=a,a=b=parseInt(G(b,d),10)):(k=a,a=f)}else k=a,a=f;q--;a===f&&0===q&&e(ae);return a}function v(){var a,b,d;q++;a=k;34===c.charCodeAt(k)?(b=ib,k++):(b=f,0===q&&e(jb));if(b!==f){b=[];kb.test(c.charAt(k))?(d=c.charAt(k),k++):(d=f,0===q&&e(lb));if(d!==f)for(;d!==f;)b.push(d),kb.test(c.charAt(k))?(d=c.charAt(k),k++):(d=f,0===q&&e(lb));
else b=f;b!==f?(34===c.charCodeAt(k)?(d=ib,k++):(d=f,0===q&&e(jb)),d!==f?(u=a,a=b=G(b)):(k=a,a=f)):(k=a,a=f)}else k=a,a=f;q--;a===f&&0===q&&e(be);return a}function y(){var a;q++;ce.test(c.charAt(k))?(a=c.charAt(k),k++):(a=f,0===q&&e(de));q--;a===f&&0===q&&e(ee);return a}function E(){var a;q++;fe.test(c.charAt(k))?(a=c.charAt(k),k++):(a=f,0===q&&e(ge));q--;a===f&&0===q&&e(he);return a}function B(){var a,b;q++;a=[];mb.test(c.charAt(k))?(b=c.charAt(k),k++):(b=f,0===q&&e(nb));if(b!==f)for(;b!==f;)a.push(b),
mb.test(c.charAt(k))?(b=c.charAt(k),k++):(b=f,0===q&&e(nb));else a=f;q--;a===f&&0===q&&e(ie);return a}function F(){var a;q++;je.test(c.charAt(k))?(a=c.charAt(k),k++):(a=f,0===q&&e(ke));q--;a===f&&0===q&&e(le);return a}function C(){var a,b;q++;a=[];ob.test(c.charAt(k))?(b=c.charAt(k),k++):(b=f,0===q&&e(pb));if(b!==f)for(;b!==f;)a.push(b),ob.test(c.charAt(k))?(b=c.charAt(k),k++):(b=f,0===q&&e(pb));else a=f;q--;a===f&&0===q&&e(me);return a}function G(){return(1===arguments.length?[arguments[0]]:Array.apply(null,
arguments)).map(function(a){return Array.isArray(a)?a.join(""):"string"==typeof a?a:""}).join("")}var U=1<arguments.length?arguments[1]:{},f={},Y={diagram:l},Z=l,ja=function(a,b){var c=b.map(function(a){return a[1]});c.unshift(a);return new ne(c)},Da="critical",qb={type:"literal",value:"critical",description:'"critical"'},P="end",Aa={type:"literal",value:"end",description:'"end"'},Na="loop",rb={type:"literal",value:"loop",description:'"loop"'},Oa="opt",sb={type:"literal",value:"opt",description:'"opt"'},
Pa="par",tb={type:"literal",value:"par",description:'"par"'},Qa="group",ac={type:"literal",value:"group",description:'"group"'},Gc="alt",bc={type:"literal",value:"alt",description:'"alt"'},$a="else",ya={type:"literal",value:"else",description:'"else"'},Wc="@startuml",cc={type:"literal",value:"@startuml",description:'"@startuml"'},Xc="@enduml",dc={type:"literal",value:"@enduml",description:'"@enduml"'},ab={type:"other",description:"identifier"},Qd="[",Rd={type:"literal",value:"[",description:'"["'},
Sd="]",Td={type:"literal",value:"]",description:'"]"'},Ic="<<",hd={type:"literal",value:"<<",description:'"<<"'},id="<",jd={type:"literal",value:"<",description:'"<"'},Jc="--",kd={type:"literal",value:"--",description:'"--"'},Lc="-",Mc={type:"literal",value:"-",description:'"-"'},Nc=">>",ld={type:"literal",value:">>",description:'">>"'},md=">",nd={type:"literal",value:">",description:'">"'},Oc=":",Pc={type:"literal",value:":",description:'":"'},Qc="participant",qd={type:"literal",value:"participant",
description:'"participant"'},Rc="actor",sd={type:"literal",value:"actor",description:'"actor"'},Sc="boundary",td={type:"literal",value:"boundary",description:'"boundary"'},Tc="control",ud={type:"literal",value:"control",description:'"control"'},Uc="entity",vd={type:"literal",value:"entity",description:'"entity"'},Vc="database",wd={type:"literal",value:"database",description:'"database"'},bb="as",Ud={type:"literal",value:"as",description:'"as"'},ed="autonumber",Ld={type:"literal",value:"autonumber",
description:'"autonumber"'},cd="autonumber stop",Hd={type:"literal",value:"autonumber stop",description:'"autonumber stop"'},dd="autonumber resume",Jd={type:"literal",value:"autonumber resume",description:'"autonumber resume"'},Ia="note",wc={type:"literal",value:"note",description:'"note"'},cb="over",Vd={type:"literal",value:"over",description:'"over"'},Ba="left",fb={type:"literal",value:"left",description:'"left"'},Ca="of",gb={type:"literal",value:"of",description:'"of"'},xa="right",hb={type:"literal",
value:"right",description:'"right"'},db=",",eb={type:"literal",value:",",description:'","'},Wd=function(a,b){var c=b.map(function(a){return a[3]});c.unshift(a);return c},zd={type:"other",description:"title"},Yc="title",yd={type:"literal",value:"title",description:'"title"'},Bd={type:"other",description:"caption"},Zc="caption",Ad={type:"literal",value:"caption",description:'"caption"'},$c="activate",Cd={type:"literal",value:"activate",description:'"activate"'},ad="deactivate",Ed={type:"literal",value:"deactivate",
description:'"deactivate"'},bd="destroy",Gd={type:"literal",value:"destroy",description:'"destroy"'},fd="newpage",Nd={type:"literal",value:"newpage",description:'"newpage"'},Od="!",Pd={type:"literal",value:"!",description:'"!"'},$d={type:"other",description:"text description"},ae={type:"other",description:"an integer"},be={type:"other",description:"a quoted string"},ib='"',jb={type:"literal",value:'"',description:'"\\""'},kb=/^[^"\r\n]/,lb={type:"class",value:'[^"\\r\\n]',description:'[^"\\r\\n]'},
Zd={type:"other",description:"a letter"},Xd=/^[a-zA-Z]/,Yd={type:"class",value:"[a-zA-Z]",description:"[a-zA-Z]"},ee={type:"other",description:"a letter or integer"},ce=/^[a-zA-Z0-9]/,de={type:"class",value:"[a-zA-Z0-9]",description:"[a-zA-Z0-9]"},he={type:"other",description:"a number"},fe=/^[0-9]/,ge={type:"class",value:"[0-9]",description:"[0-9]"},ie={type:"other",description:"a new line"},mb=/^[\r\n]/,nb={type:"class",value:"[\\r\\n]",description:"[\\r\\n]"},le={type:"other",description:"any character except a new line"},
je=/^[^\r\n]/,ke={type:"class",value:"[^\\r\\n]",description:"[^\\r\\n]"},me={type:"other",description:"whitespace"},ob=/^[ \t]/,pb={type:"class",value:"[ \\t]",description:"[ \\t]"},k=0,u=0,za=[{line:1,column:1,seenCR:!1}],M=0,Ea=[],q=0,pa;if("startRule"in U){if(!(U.startRule in Y))throw Error("Can't start parsing from rule \""+U.startRule+'".');Z=Y[U.startRule]}var Dd=plugin.uml.sequence.model.Activate,gd=plugin.uml.sequence.model.AltGroup,Ga=plugin.uml.sequence.model.ArrowType,Kd=plugin.uml.sequence.model.AutonumberResume,
Md=plugin.uml.sequence.model.AutonumberStart,Id=plugin.uml.sequence.model.AutonumberStop,od=plugin.uml.sequence.model.Connector,Fd=plugin.uml.sequence.model.Deactivate,Hc=plugin.uml.sequence.model.ElseGroup,xd=plugin.uml.sequence.model.Ignore,Kc=plugin.uml.sequence.model.LineType,pd=plugin.uml.sequence.model.Message,vb=plugin.uml.sequence.model.MessageGroup,oa=plugin.uml.sequence.model.PartialNote,rd=plugin.uml.sequence.model.Participant,ne=plugin.uml.sequence.model.SequenceDiagram;pa=Z();if(pa!==
f&&k===c.length)return pa;pa!==f&&k<c.length&&e({type:"end",description:"end of input"});throw g(null,Ea,M<c.length?c.charAt(M):null,M<c.length?h(M,M+1):h(M,M));}}}();g.provide("plugin.uml.sequence.Parser");g.require("plugin.uml.sequence.peg");g.require("plugin.uml.sequence.model.Message");g.require("plugin.uml.sequence.model.Participant");g.require("plugin.uml.sequence.model.SequenceDiagram");plugin.uml.sequence.Parser.parse=function(b){try{return plugin.uml.sequence.Parser.parseSuccess(plugin.uml.sequence.peg.parse(b))}catch(c){if(c instanceof
plugin.uml.sequence.peg.SyntaxError)return plugin.uml.sequence.Parser.parseError(c);throw c;}};plugin.uml.sequence.Parser.parseSuccess=function(b){return new plugin.uml.sequence.Parser.ParseSuccess(b)};plugin.uml.sequence.Parser.parseError=function(b){return new plugin.uml.sequence.Parser.ParseFailure(b.message,b.location)};plugin.uml.sequence.Parser.ParseResult=function(){};plugin.uml.sequence.Parser.ParseSuccess=function(b){this.diagram=b;this.diagram.doAutonumbering()};plugin.uml.sequence.Parser.ParseFailure=
function(b,c){this.message=b;this.location=c};plugin.uml.sequence.Parser.ParseFailure.prototype.getErrorMessage=function(){return this.message+" (at line "+this.location.start.line+", column "+this.location.start.column+")"};plugin.uml.sequence.Parser.ParseFailure.prototype.getErrorLine=function(){return this.location.start.line};g.provide("plugin.uml.sequence.view.InlineNote");g.provide("plugin.uml.sequence.view.LeftInlineNote");g.provide("plugin.uml.sequence.view.RightInlineNote");g.require("plugin.uml.sequence.model.InlineNote");
g.require("plugin.uml.sequence.model.Message");g.require("plugin.uml.sequence.model.LeftInlineNote");g.require("plugin.uml.sequence.model.RightInlineNote");g.require("plugin.uml.sequence.view.ParticipantLifeline");g.require("plugin.uml.sequence.view.SideNote");plugin.uml.sequence.view.InlineNote=function(b,c,a){plugin.uml.sequence.view.SideNote.call(this,b,this.getLine(c,a),a)};g.inherits(plugin.uml.sequence.view.InlineNote,plugin.uml.sequence.view.SideNote);plugin.uml.sequence.view.InlineNote.prototype.getLine=
function(b,c){return null};plugin.uml.sequence.view.LeftInlineNote=function(b,c,a){plugin.uml.sequence.view.InlineNote.call(this,b,c,a)};g.inherits(plugin.uml.sequence.view.LeftInlineNote,plugin.uml.sequence.view.InlineNote);plugin.uml.sequence.view.LeftInlineNote.prototype.getLine=function(b,c){var a=plugin.uml.sequence.view.ParticipantLifeline.getParticipantsInOrder([b.sender,b.recipient],c);return c[a[0]].line};plugin.uml.sequence.view.LeftInlineNote.prototype.calculateX=function(b){return this.line.x-
plugin.uml.sequence.view.Note.horizontalPadding/2-this.textSize.w};plugin.uml.sequence.view.RightInlineNote=function(b,c,a){plugin.uml.sequence.view.InlineNote.call(this,b,c,a)};g.inherits(plugin.uml.sequence.view.RightInlineNote,plugin.uml.sequence.view.InlineNote);plugin.uml.sequence.view.RightInlineNote.prototype.getLine=function(b,c){var a=plugin.uml.sequence.view.ParticipantLifeline.getParticipantsInOrder([b.sender,b.recipient],c);return c[a[a.length-1]].line};plugin.uml.sequence.view.RightInlineNote.prototype.calculateX=
function(b){return this.line.x+(b||0)+plugin.uml.sequence.view.Note.horizontalPadding/2};g.provide("plugin.uml.sequence.view.Message");g.require("plugin.uml.sequence.model.LeftInlineNote");g.require("plugin.uml.sequence.model.Message");g.require("plugin.uml.sequence.model.RightInlineNote");g.require("plugin.uml.sequence.view.LeftInlineNote");g.require("plugin.uml.sequence.view.ParticipantLifeline");g.require("plugin.uml.sequence.view.RightInlineNote");g.require("plugin.uml.sequence.model.size");plugin.uml.sequence.view.Message=
function(b){this.model=b;this.rightPadding=this.textWidth=0;this.model.label&&(this.textWidth=lucid.text.measure(lucid.text.styled("M"+b.label+"M",{})).w);this.model.isSelfMessage()&&(this.rightPadding=plugin.uml.sequence.view.Message.selfMessageWidth+this.textWidth)};plugin.uml.sequence.view.Message.selfMessageWidth=120;plugin.uml.sequence.view.Message.prototype.render=function(b,c,a,d){var h=[],e=c[this.model.sender],g=c[this.model.recipient],l=this.renderMessageLine(b,e,g,a,d);this.renderMessageLabel(e,
g,l);h.push(l);this.model.note&&(b=this.renderNote(b,c,a,d),h.push(b));return h};plugin.uml.sequence.view.Message.prototype.renderMessageLine=function(b,c,a,d,h){var e={Endpoint1:{Style:this.model.connector.leftArrow},Endpoint2:{Style:this.model.connector.rightArrow},StrokeStyle:this.model.connector.lineType,Shape:"elbow"};c.setEndpoint1ConnectData(e,this.getPercent1(d,h),a.order);a.setEndpoint2ConnectData(e,this.getPercent2(d,h),c.order);this.model.isSelfMessage()&&(e.XPlanes=[c.line.x+plugin.uml.sequence.view.Message.selfMessageWidth]);
return lucid.plugin.addLine(b,e)};plugin.uml.sequence.view.Message.prototype.getPercent1=function(b,c){return(b+(this.model.arrowHeight-this.model.paddingAboveRecipient))/c};plugin.uml.sequence.view.Message.prototype.getPercent2=function(b,c){return(b+this.model.arrowHeight)/c};plugin.uml.sequence.view.Message.prototype.renderMessageLabel=function(b,c,a){if(this.model.label){var d=-1;b.order>c.order&&(d=1);lucid.plugin.addLineTextArea(a,{id:"label",value:this.model.label,side:d,location:.5})}};plugin.uml.sequence.view.Message.prototype.renderNote=
function(b,c,a,d){var h;this.model.note instanceof plugin.uml.sequence.model.LeftInlineNote?h=new plugin.uml.sequence.view.LeftInlineNote(this.model.note,this.model,c):this.model.note instanceof plugin.uml.sequence.model.RightInlineNote&&(h=new plugin.uml.sequence.view.RightInlineNote(this.model.note,this.model,c));return h.render(b,a+(this.model.height-this.model.note.height),d,this.rightPadding)};plugin.uml.sequence.view.Message.prototype.getBoundingBox=function(b,c,a){var d=[this.getMessageBoundingBox(b[this.model.sender],
b[this.model.recipient],c,a)];this.model.note&&(b=this.getNoteBoundingBox(b,c,a),d.push(b));return lucid.math.Box.combine(d)};plugin.uml.sequence.view.Message.prototype.getMessageBoundingBox=function(b,c,a,d){var h=a/d*(b.line.yBot-b.line.yTop);return{x:Math.min(b.line.x,c.line.x),y:b.line.yTop+h,w:Math.abs(b.line.x-c.line.x)+this.rightPadding,h:(a+this.model.height)/d*(b.line.yBot-b.line.yTop)-h}};plugin.uml.sequence.view.Message.prototype.getNoteBoundingBox=function(b,c,a){var d;this.model.note instanceof
plugin.uml.sequence.model.LeftInlineNote?d=new plugin.uml.sequence.view.LeftInlineNote(this.model.note,this.model,b):this.model.note instanceof plugin.uml.sequence.model.RightInlineNote&&(d=new plugin.uml.sequence.view.RightInlineNote(this.model.note,this.model,b));return d.getBoundingBox(c,a,this.rightPadding)};g.provide("plugin.uml");g.require("plugin.common.Swimlane");g.require("plugin.uml.sequence.Parser");g.require("plugin.uml.sequence.model.Action");g.require("plugin.uml.sequence.model.ActivationGroup");
g.require("plugin.uml.sequence.model.Message");g.require("plugin.uml.sequence.model.Note");g.require("plugin.uml.sequence.model.LeftBlockNote");g.require("plugin.uml.sequence.model.OverNote");g.require("plugin.uml.sequence.model.RightBlockNote");g.require("plugin.uml.sequence.model.Participant");g.require("plugin.uml.sequence.model.SequenceDiagram");g.require("plugin.uml.sequence.model.SubDiagram");g.require("plugin.uml.sequence.model.size");g.require("plugin.uml.sequence.view.Message");g.require("plugin.uml.sequence.view.LeftBlockNote");
g.require("plugin.uml.sequence.view.OverBlockNote");g.require("plugin.uml.sequence.view.ParticipantLifeline");g.require("plugin.uml.sequence.view.RightBlockNote");var Oa=!1;lucid.plugin.onDocumentLoaded(function(){function b(a,b,c){function d(a,e){e||(b.change?lucid.array.forEach(b.ids,function(c){b.change(a,e,c)}):(lucid.array.forEach(b.ids,function(c){lucid.plugin.setPropertyIfChanged(c,b.prop,a)}),c()))}function e(a,b){a=parseInt(a||0,10);d(a,b)}h&&!b.nospace&&a.spacer();h=!0;if("button"==b.type)a.openGrid({prefix:2,
suffix:2,width:8}),a.addButton({onClick:function(){lucid.array.forEach(b.ids,function(a){b.onClick(a)})},label:b.name}),a.close();else if("spinner"==b.type)a.addGrid({width:6,content:{text:b.name+":",classes:"crop ralign"}}),a.openGrid({width:3,suffix:3}),a.addInput({type:"spinner",min:1,max:50,step:1,value:b.value(b.ids[0]),defaultVal:" ",onChange:d}),a.close();else if("select"==b.type){a.addGrid({width:6,content:{text:b.name+":",classes:"crop ralign"}});var l=[];lucid.object.forEach(b.options,function(a,
b){l.push({label:a,value:b})});a.openGrid({width:6});a.addInput({type:"select",options:l,onChange:e}).setValue(b.value(b.ids[0]));a.close()}}function c(n){var p=function(){c(n);l&&l.refresh&&l.refresh()};n=lucid.array.filter(n,function(a){return a.isLine?e(a.id):g(a)||"UMLMultidimensionalSwimlane"==a.className?!0:!1});var z=!1;h=!1;var t=lucid.template.builder();if(1==n.length&&g(n[0]))var A=n[0].id,w={laneCount:{ids:[],name:lucid.i18n("option.lanes"),type:"spinner",prop:"Lanes",value:function(){return lucid.plugin.getProperty(A,
"Lanes").length},change:function(a,b,c){b=lucid.plugin.getProperty(c,"Lanes").length;if(b<a)for(;b<a;b++)plugin.common.Swimlane.updateLanes("add",c,void 0,void 0,!0);else if(b>a)for(;b>a;b--)plugin.common.Swimlane.updateLanes("remove",c,void 0,void 0,!0)}},poolOrientation:{ids:[],name:lucid.i18n("option.orientation"),type:"select",prop:"Vertical",options:{0:"Horizontal",1:"Vertical"},value:function(){return lucid.plugin.getProperty(A,"Vertical")},change:function(a,b,c){""!==a&&(b=lucid.plugin.getProperty(c,
"Vertical"),a=parseInt(a,10),a!=b&&lucid.plugin.setProperty(c,"Vertical",a))}}};else 1==n.length&&"UMLMultidimensionalSwimlane"==n[0].className?(A=n[0].id,w={rows:{ids:[],name:lucid.i18n("option.rows"),type:"spinner",prop:"Rows",value:function(){return lucid.plugin.getProperty(A,"Rows").length},change:qb.bind(null,A)},columns:{ids:[],name:lucid.i18n("option.columns"),type:"spinner",prop:"Columns",value:function(){return lucid.plugin.getProperty(n[0].id,"Columns").length},change:Na.bind(null,A)}}):
w={multiplicity:{ids:[],type:"button",name:lucid.i18n("option.multiplicity"),onClick:function(a){var b=lucid.plugin.getProperty(a,"TextAreas"),c={};if(null===b.m1||void 0===b.m1)c.m1={Location:0,Side:-1,Value:"0..*"};if(null===b.m2||void 0===b.m2)c.m2={Location:1,Side:-1,Value:"0..*"};(c.m1||c.m2)&&lucid.plugin.setPropertyIfChanged(a,"TextAreas",c)}},swapEndPoints:{ids:[],type:"button",name:lucid.i18n("option.line.reverse"),onClick:function(a){var b=lucid.plugin.getProperty(a,"Endpoint1"),c=lucid.plugin.getProperty(a,
"Endpoint2"),d=function(a,b,c){for(var d=0;d<c.length;d++)a[c[d]]=b[c[d]]},e=lucid.object.copy(b),h=lucid.object.copy(c);d(e,c,["Style","Padding"]);d(h,b,["Style","Padding"]);lucid.plugin.setPropertyIfChanged(a,"Endpoint1",e);lucid.plugin.setPropertyIfChanged(a,"Endpoint2",h);var b=lucid.plugin.getProperty(a,"TextAreas"),l;for(l in b)b[l]&&null!==b[l].Location&&(b[l].Location=1-b[l].Location);0<lucid.object.size(b)&&lucid.plugin.setPropertyIfChanged(a,"TextAreas",b)}}};lucid.array.forEach(n,function(a){lucid.object.forEach(w,
function(b){(a.isLine&&null==b.prop||!a.isLine&&null!=b.prop)&&b.ids.push(a.id)})});lucid.object.forEach(w,function(a){0<a.ids.length&&(b(t,a,p),z=!0)});a.getElement(d).setContent(t);return z}var a=lucid.template.builder();lucid.hubspot.recordEvent("uml-shape-library-enabled");lucid.kissMetrics.record(lucid.kissMetrics.Events.umlShapeLibraryEnabled);var d=a.add({classes:"ios_inputs"}),h=!1,e=function(a){function b(a){return a?(a=lucid.plugin.getBlockClassName(a))&&0==a.search("UML"):!1}var c=lucid.plugin.getProperty(a,
"Endpoint1");a=lucid.plugin.getProperty(a,"Endpoint2");return b(c.Block)||b(a.Block)},g=function(a){return a.className&&0==a.className.search("UMLMultiLanePool")},l=lucid.plugin.addCustomPanel("Context Panel",null,[{content:a}],null,{isContextPanel:!0,checkShow:c,refreshProperties:["Vertical","Lanes"]})});lucid.plugin.onDocumentLoaded(function(){lucid.plugin.getAllGroupIds(function(b){return!!lucid.plugin.getProperty(b,"Markup")})});lucid.plugin.initBlockClass({className:"UMLSwimLaneBlock",name:"Swim Lane",
searchKeywords:["uml","container","swimlane","lane"],container:!0,defaultSize:{w:320,h:400},defaultProperties:function(){return{Magnetize:!1}},onInit:function(b){lucid.plugin.addBlockTextArea(b,{id:"Text",value:"Swim Lane",getBoundingBox:function(b){return{x:b.x+20,y:b.y,w:b.w-40,h:40}}})},getLinkPoints:function(){return[{x:.5,y:0}]},getRenderDataKey:function(){return["FillColor","LineColor","LineWidth"]},getRenderData:function(b,c){var a=b.BoundingBox,d=40;40>a.h&&(d=a.h/4);return[{FillColor:b.FillColor||
null,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x,y:a.y+d/2},{Action:"line",x:a.x,y:a.y+a.h},{Action:"line",x:a.x+a.w,y:a.y+a.h},{Action:"line",x:a.x+a.w,y:a.y+d/2}]},{FillColor:b.FillColor||null,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x,y:a.y},{Action:"line",x:a.x+a.w,y:a.y},{Action:"line",x:a.x+a.w,y:a.y+d},{Action:"line",x:a.x,y:a.y+d},{Action:"close"}]}]}});lucid.plugin.initBlockClass({className:"UMLTextBlock",name:"Text",searchKeywords:["uml",
"text"],defaultSize:{w:160,h:40},onInit:function(b){lucid.plugin.addBlockTextArea(b,{id:"Text",value:"Text",wantReturn:!0,getBoundingBox:function(c){return F(c,function(a){return{x:a.x+20,y:a.y,w:a.w-40,h:a.h}},function(a){return{x:a.x,y:a.y,w:a.w,h:a.h,fitShape:lucid.plugin.getProperty(b,"InsetMargin")||0,hideOverflow:!0}})}});1<B()&&(lucid.plugin.registerProperty(b,"TextWrap","fit"),lucid.plugin.registerProperty(b,"InsetMargin",5))},getLinkPoints:function(b){return[{x:.5,y:0},{x:.5,y:1},{x:0,y:.5},
{x:1,y:.5}]},getRenderDataKey:function(){return["FillColor","LineColor","LineWidth"]},getRenderData:function(b,c){var a=b.BoundingBox;return[{FillColor:b.FillColor,Actions:[{Action:"move",x:a.x,y:a.y},{Action:"line",x:a.x+a.w,y:a.y},{Action:"line",x:a.x+a.w,y:a.y+a.h},{Action:"line",x:a.x,y:a.y+a.h},{Action:"close"}]}]}});lucid.plugin.initBlockClass({className:"UMLCircleContainerBlock",name:"Oval Container",searchKeywords:["uml","container","circle","oval"],defaultSize:{w:320,h:480},partialContainer:{getContainerArea:function(b){return lucid.plugin.getProperty(b,
"BoundingBox")}},defaultProperties:function(){return{Magnetize:!1}},getLinkPoints:function(b){return[{x:.5,y:0},{x:.5,y:1},{x:0,y:.5},{x:1,y:.5}]},getRenderDataKey:function(){return["FillColor","LineColor","LineWidth"]},getRenderData:function(b,c){var a=b.BoundingBox;return[{FillColor:b.FillColor||null,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x+a.w,y:a.y+a.h/2},{Action:"curve",Control:lucid.math.ellipseArcControlPoints(a.x,a.y,a.w,a.h,0,2*Math.PI)},{Action:"close"}]}]},
onInit:function(b){lucid.plugin.setProperty(b,"DisableAutoLink",!0)}});lucid.plugin.initBlockClass({className:"UMLRectangleContainerBlock",name:"Rectangle Container",searchKeywords:["uml","container","rectangle","square"],defaultSize:{w:320,h:240},partialContainer:{getContainerArea:function(b){return lucid.plugin.getProperty(b,"BoundingBox")}},defaultProperties:function(){return{Magnetize:!1}},onInit:function(b){lucid.plugin.setProperty(b,"DisableAutoLink",!0);lucid.plugin.addBlockTextArea(b,{id:"Text",
value:"Container",getBoundingBox:function(b){return{x:b.x+8,y:b.y+8,w:b.w-16,h:24}}})},getLinkPoints:function(b){return[{x:.5,y:0},{x:.5,y:1},{x:0,y:.5},{x:1,y:.5}]},getRenderDataKey:function(){return["FillColor","LineColor","LineWidth"]},getRenderData:function(b,c){var a=b.BoundingBox;return[{FillColor:b.FillColor||null,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x,y:a.y},{Action:"line",x:a.x+a.w,y:a.y},{Action:"line",x:a.x+a.w,y:a.y+a.h},{Action:"line",x:a.x,y:a.y+
a.h},{Action:"close"}]}]}});lucid.plugin.initBlockClass({className:"UMLSendSignalBlock",name:"Send Signal",searchKeywords:["uml","container","send","signal"],defaultSize:{w:180,h:60},onInit:function(b){lucid.plugin.setProperty(b,"DisableAutoLink",!0);lucid.plugin.addBlockTextArea(b,{id:"Text",value:"Send Signal",getBoundingBox:function(b){return{x:b.x+8,y:b.y+8,w:.75*b.w,h:b.h-16}}})},getLinkPoints:function(b){return[{x:.5,y:0},{x:.5,y:1},{x:0,y:.5},{x:1,y:.5}]},getRenderDataKey:function(){return["FillColor",
"LineColor","LineWidth"]},getRenderData:function(b,c){var a=b.BoundingBox;return[{FillColor:b.FillColor||null,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x,y:a.y},{Action:"line",x:a.x+.8*a.w,y:a.y},{Action:"line",x:a.x+a.w,y:a.y+a.h/2},{Action:"line",x:a.x+.8*a.w,y:a.y+a.h},{Action:"line",x:a.x,y:a.y+a.h},{Action:"close"}]}]}});lucid.plugin.initBlockClass({className:"UMLReceiveSignalBlock",name:"Receive Signal",searchKeywords:["uml","container","send","signal"],defaultSize:{w:180,
h:60},onInit:function(b){lucid.plugin.setProperty(b,"DisableAutoLink",!0);lucid.plugin.addBlockTextArea(b,{id:"Text",value:"Receive Signal",getBoundingBox:function(b){return{x:b.x+8,y:b.y+8,w:.75*b.w,h:b.h-16}}})},getLinkPoints:function(b){return[{x:.5,y:0},{x:.5,y:1},{x:0,y:.5}]},getRenderDataKey:function(){return["FillColor","LineColor","LineWidth"]},getRenderData:function(b,c){var a=b.BoundingBox;return[{FillColor:b.FillColor||null,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",
x:a.x,y:a.y},{Action:"line",x:a.x+a.w,y:a.y},{Action:"line",x:a.x+.8*a.w,y:a.y+a.h/2},{Action:"line",x:a.x+a.w,y:a.y+a.h},{Action:"line",x:a.x,y:a.y+a.h},{Action:"close"}]}]}});lucid.plugin.initBlockClass({className:"UMLNoteBlock",name:"Note",searchKeywords:["uml","note"],defaultSize:{w:160,h:120},onInit:function(b){lucid.plugin.setProperty(b,"TextAlign","left",!1);lucid.plugin.setProperty(b,"DisableAutoLink",!0);lucid.plugin.addBlockTextArea(b,{id:"Text",value:"",wantReturn:!0,getBoundingBox:function(c){return F(c,
function(a){var b=.2*(a.h>a.w?a.w:a.h);return{x:a.x+.5*b,y:a.y+.5*b,w:a.w-b,h:a.h-.5*b}},function(a){return{x:a.x,y:a.y,w:a.w,h:a.h,fitShape:lucid.plugin.getProperty(b,"InsetMargin")||0,hideOverflow:!0}})}});1<B()&&(lucid.plugin.registerProperty(b,"TextWrap","fit"),lucid.plugin.registerProperty(b,"InsetMargin",5))},getLinkPoints:function(){return[{x:.5,y:0},{x:1,y:.5},{x:.5,y:1},{x:0,y:.5}]},getRenderDataKey:function(){return["FillColor","LineColor","LineWidth"]},getRenderData:function(b,c){var a=
b.BoundingBox,d=.2*(a.h>a.w?a.w:a.h),h=lucid.color.darken(b.FillColor,.3);"sample"==c&&(d*=2);return[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x,y:a.y},{Action:"line",x:a.x+a.w-d,y:a.y},{Action:"line",x:a.x+a.w,y:a.y+d},{Action:"line",x:a.x+a.w,y:a.y+a.h},{Action:"line",x:a.x,y:a.y+a.h},{Action:"close"}]},{FillColor:h,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x+a.w-d,y:a.y},{Action:"line",x:a.x+a.w,y:a.y+d},{Action:"line",
x:a.x+a.w-.8*d,y:a.y+.8*d},{Action:"close"}]}]}});lucid.plugin.initBlockClass({className:"UMLClassBlock",name:"Class",searchKeywords:["uml","class"],defaultSize:{w:360,h:240},variants:{UMLClassBlockSimple:{tooltip:"Simple Class",searchKeywords:["uml","class","simple"],defaultProperties:function(){return{Simple:1}},defaultSize:{w:160,h:120}},UMLInterfaceBlock:{searchKeywords:["uml","interface"],defaultProperties:function(){return{Attributes:0,Title:'<span style="font-weight:bold;">&lt;&lt;interface&gt;&gt;<br/>Interface</span>',
TitleHeight:52}},defaultSize:{w:360,h:240},tooltip:"Interface"},UMLInterfaceBlockSimple:{searchKeywords:["uml","interface","simple"],defaultProperties:function(){return{Title:'<span style="font-weight:bold;">&lt;&lt;interface&gt;&gt;<br/>Interface</span>',Simple:1}},defaultSize:{w:160,h:120},tooltip:"Simple Interface"}},onInit:function(b){function c(){if(!lucid.plugin.getProperty(b,"Simple")){var a=lucid.text.getSize(b,"Title"),c=lucid.plugin.getProperty(b,"Attributes")?lucid.text.getSize(b,"Text1"):
null,h=lucid.text.getSize(b,"Text2"),a=a?a.h+16:0,c=c?c.h+16:8,e=h?h.h+16:0,g=lucid.plugin.snapToGrid(b,a+c+e,1,"ceil"),h=lucid.plugin.getProperty(b,"BoundingBox");g>h.h&&(h.h=g);c=(h.h-a)*c/(c+e)/h.h;lucid.plugin.setPropertyIfChanged(b,"TitleHeight",a);lucid.plugin.setPropertyIfChanged(b,"Text1Percent",c);lucid.plugin.setPropertyIfChanged(b,"BoundingBox",h)}}lucid.plugin.registerProperty(b,"TitleHeight",26);lucid.plugin.registerProperty(b,"Text1Percent",.4);lucid.plugin.registerProperty(b,"Simple",
0);lucid.plugin.registerProperty(b,"Attributes",1);lucid.plugin.setProperty(b,"TextAlign","left");lucid.plugin.setProperty(b,"TitleHeight",26);lucid.plugin.setProperty(b,"defaultHeight",240,!0);lucid.plugin.addBlockTextArea(b,{id:"Title",value:'<span style="font-weight:bold;">Class</span>',getBoundingBox:function(a){if(lucid.plugin.getProperty(b,"Simple"))return lucid.math.Box.pad(a,-8);var c=lucid.plugin.getProperty(b,"TitleHeight");return{x:a.x+8,y:a.y,w:a.w-16,h:c}},wantReturn:!1,readOnly:!1,align:"center"});
lucid.plugin.addBlockTextArea(b,{id:"Text1",value:"+ attribute1:type = defaultValue<br />+ attribute2:type<br />- attribute3:type",getBoundingBox:function(a){if(lucid.plugin.getProperty(b,"Simple")||!lucid.plugin.getProperty(b,"Attributes"))return null;var c=lucid.plugin.getProperty(b,"TitleHeight"),h=lucid.plugin.getProperty(b,"Text1Percent");return{x:a.x+12,y:a.y+c+8,w:a.w-24,h:a.h*h-16}},wantReturn:!0});lucid.plugin.addBlockTextArea(b,{id:"Text2",value:"+ operation1(params):returnType<br />- operation2(params)<br />- operation3()",
getBoundingBox:function(a){if(lucid.plugin.getProperty(b,"Simple"))return null;var c=lucid.plugin.getProperty(b,"TitleHeight");if(lucid.plugin.getProperty(b,"Attributes")){var h=lucid.plugin.getProperty(b,"Text1Percent");return{x:a.x+12,y:a.y+c+a.h*h+8,w:a.w-24,h:a.h*(1-h)-c-16}}return{x:a.x+12,y:a.y+c+8,w:a.w-24,h:a.h-c-16}},wantReturn:!0});lucid.plugin.hookPropertyPostSave(b,"Title",function(a,b){c()});lucid.plugin.hookPropertyPostSave(b,"Text1",function(a,b){c()});lucid.plugin.hookPropertyPostSave(b,
"Text2",function(a,b){c()})},getLinkPoints:function(b){return[{x:0,y:.5},{x:.5,y:1},{x:1,y:.5},{x:.5,y:0}]},getRenderDataKey:function(){return"FillColor LineColor LineWidth TitleHeight defaultHeight Text1Percent Simple Attributes".split(" ")},getRenderData:function(b,c){var a=b.BoundingBox,d=b.TitleHeight,h=b.defaultHeight,e=b.Text1Percent;"sample"==c&&(d*=2*a.h/h);h=[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x,y:a.y},{Action:"line",x:a.x+a.w,
y:a.y},{Action:"line",x:a.x+a.w,y:a.y+a.h},{Action:"line",x:a.x,y:a.y+a.h},{Action:"close"}]}];0==b.Simple&&(b.Attributes?h.push({StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x,y:Math.round(a.y+d)},{Action:"line",x:a.x+a.w,y:Math.round(a.y+d)},{Action:"move",x:a.x,y:Math.round(a.y+d+a.h*e)},{Action:"line",x:a.x+a.w,y:Math.round(a.y+d+a.h*e)}]}):h.push({StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x,y:Math.round(a.y+d)},{Action:"line",x:a.x+
a.w,y:Math.round(a.y+d)}]}));return h}});lucid.plugin.initBlockClass({className:"UMLActiveClassBlock",name:"Active Class",searchKeywords:["uml","active","class"],defaultSize:{w:160,h:120},onInit:function(b){lucid.plugin.registerProperty(b,"Side",.1);lucid.plugin.addBlockTextArea(b,{id:"Text",value:"Class",getBoundingBox:function(c){var a=lucid.plugin.getProperty(b,"Side");return{x:c.x+c.w*(a+.025),y:c.y,w:c.w*(1-2*(a+.025)),h:c.h}}})},spatialControls:function(b){return[{logAction:"chart.viewport.selection.spatialControls.uml.activeClass",
location:function(){var c=lucid.plugin.getProperty(b,"BoundingBox"),a=lucid.plugin.getProperty(b,"Side");return{x:c.x+c.w*a-5,y:c.y+c.h-5,w:10,h:10}},moved:function(c){var a=lucid.plugin.getProperty(b,"BoundingBox");lucid.plugin.setProperty(b,"Side",(c.x-a.x)/a.w)},path:function(){var c=lucid.plugin.getProperty(b,"BoundingBox");return[{x:c.x+5,y:c.y},{x:c.x+c.w/3,y:c.y}]},snap:2}]},getLinkPoints:function(){return[{x:.5,y:0},{x:.5,y:1},{x:0,y:.5},{x:1,y:.5}]},getRenderDataKey:function(){return["FillColor",
"LineColor","LineWidth","Side"]},getRenderData:function(b,c){var a=b.BoundingBox;return[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x,y:a.y},{Action:"line",x:a.x+a.w,y:a.y},{Action:"line",x:a.x+a.w,y:a.y+a.h},{Action:"line",x:a.x,y:a.y+a.h},{Action:"close"}]},{StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x+a.w*b.Side,y:a.y},{Action:"line",x:a.x+a.w*b.Side,y:a.y+a.h},{Action:"move",x:a.x+a.w*(1-b.Side),y:a.y},{Action:"line",
x:a.x+a.w*(1-b.Side),y:a.y+a.h}]}]}});lucid.plugin.initBlockClass({className:"UMLMultiplicityBlock",name:"Multiplicity",searchKeywords:["uml","entity"],defaultSize:{w:160,h:120},onInit:function(b){lucid.plugin.addBlockTextArea(b,{id:"Text",value:"Class",getBoundingBox:function(c){return F(c,function(a){return{x:a.x+20,y:a.y+.1*a.h,w:a.w-40-.1*a.w,h:a.h-.1*a.h}},function(a){return{x:a.x,y:a.y,w:a.w,h:a.h,fitShape:lucid.plugin.getProperty(b,"InsetMargin")||0,hideOverflow:!0}})}});1<B()&&(lucid.plugin.registerProperty(b,
"TextWrap","fit"),lucid.plugin.registerProperty(b,"InsetMargin",5))},getLinkPoints:function(){return[{x:.5,y:0},{x:.5,y:1},{x:0,y:.5},{x:1,y:.5}]},getRenderDataKey:function(){return["FillColor","LineColor","LineWidth"]},getRenderData:function(b,c){var a=b.BoundingBox,d=.1*Math.min(a.h,a.w);"sample"==c&&(d*=2);return[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x+d,y:a.y},{Action:"line",x:a.x+a.w,y:a.y},{Action:"line",x:a.x+a.w,y:a.y+a.h-d},{Action:"line",
x:a.x+d,y:a.y+a.h-d},{Action:"close"}]},{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x,y:a.y+d},{Action:"line",x:a.x+a.w-d,y:a.y+d},{Action:"line",x:a.x+a.w-d,y:a.y+a.h},{Action:"line",x:a.x,y:a.y+a.h},{Action:"close"}]}]}});var ac={Generalization:function(b,c,a,d,h,e){a={StrokeColor:a,LineWidth:d,FillColor:"#ffffff",NoRounding:!0,Actions:[]};c=Math.atan2(c.y,c.x);a.Actions.push({Action:"move",x:b.x,y:b.y});a.Actions.push({Action:"line",x:b.x+25*
Math.cos(c+.83*Math.PI),y:b.y+25*Math.sin(c+.83*Math.PI)});a.Actions.push({Action:"line",x:b.x+25*Math.cos(c-.83*Math.PI),y:b.y+25*Math.sin(c-.83*Math.PI)});a.Actions.push({Action:"close"});return[a]},"Big Open Arrow":function(b,c,a,d,h,e){a={StrokeColor:a,LineWidth:d,NoRounding:!0,Actions:[]};c=Math.atan2(c.y,c.x);a.Actions.push({Action:"move",x:b.x+21*Math.cos(c+.83*Math.PI),y:b.y+21*Math.sin(c+.83*Math.PI)});a.Actions.push({Action:"line",x:b.x,y:b.y});a.Actions.push({Action:"line",x:b.x+21*Math.cos(c-
.83*Math.PI),y:b.y+21*Math.sin(c-.83*Math.PI)});return[a]},Asynch1:function(b,c,a,d,h,e){a={StrokeColor:a,LineWidth:d,NoRounding:!0,Actions:[]};c=Math.atan2(c.y,c.x);a.Actions.push({Action:"move",x:b.x+21*Math.cos(c+.83*Math.PI),y:b.y+21*Math.sin(c+.83*Math.PI)});a.Actions.push({Action:"line",x:b.x,y:b.y});return[a]},Asynch2:function(b,c,a,d,h,e){a={StrokeColor:a,LineWidth:d,NoRounding:!0,Actions:[]};c=Math.atan2(c.y,c.x);a.Actions.push({Action:"move",x:b.x+21*Math.cos(c-.83*Math.PI),y:b.y+21*Math.sin(c-
.83*Math.PI)});a.Actions.push({Action:"line",x:b.x,y:b.y});return[a]},Aggregation:function(b,c,a,d,h,e){a={StrokeColor:a,LineWidth:d,FillColor:"#ffffff",NoRounding:!0,Actions:[]};d=Math.atan2(c.y,c.x);a.Actions.push({Action:"move",x:b.x,y:b.y});a.Actions.push({Action:"line",x:b.x+21*Math.cos(d+.75*Math.PI),y:b.y+21*Math.sin(d+.75*Math.PI)});a.Actions.push({Action:"line",x:b.x-30*c.x,y:b.y-30*c.y});a.Actions.push({Action:"line",x:b.x+21*Math.cos(d-.75*Math.PI),y:b.y+21*Math.sin(d-.75*Math.PI)});a.Actions.push({Action:"close"});
return[a]},Composition:function(b,c,a,d,h,e){b=ac.Aggregation(b,c,a,d,h,e);b[0].FillColor=h;return b},BlockEnd:function(b,c,a,d,h,e){a={StrokeColor:a,LineWidth:d,FillColor:"#ffffff",NoRounding:!0,Actions:[]};c=Math.atan2(c.y,c.x);a.Actions.push({Action:"move",x:b.x+15*Math.cos(c+.5*Math.PI),y:b.y+15*Math.sin(c+.5*Math.PI)});a.Actions.push({Action:"line",x:b.x-30*Math.cos(c)+15*Math.cos(c+.5*Math.PI),y:b.y-30*Math.sin(c)+15*Math.sin(c+.5*Math.PI)});a.Actions.push({Action:"line",x:b.x-30*Math.cos(c)+
15*Math.cos(c-.5*Math.PI),y:b.y-30*Math.sin(c)+15*Math.sin(c-.5*Math.PI)});a.Actions.push({Action:"line",x:b.x+15*Math.cos(c-.5*Math.PI),y:b.y+15*Math.sin(c-.5*Math.PI)});a.Actions.push({Action:"close"});return[a]},BlockEndFill:function(b,c,a,d,h,e){a={StrokeColor:a,LineWidth:d,FillColor:"#000000",NoRounding:!0,Actions:[]};c=Math.atan2(c.y,c.x);a.Actions.push({Action:"move",x:b.x+15*Math.cos(c+.5*Math.PI),y:b.y+15*Math.sin(c+.5*Math.PI)});a.Actions.push({Action:"line",x:b.x-30*Math.cos(c)+15*Math.cos(c+
.5*Math.PI),y:b.y-30*Math.sin(c)+15*Math.sin(c+.5*Math.PI)});a.Actions.push({Action:"line",x:b.x-30*Math.cos(c)+15*Math.cos(c-.5*Math.PI),y:b.y-30*Math.sin(c)+15*Math.sin(c-.5*Math.PI)});a.Actions.push({Action:"line",x:b.x+15*Math.cos(c-.5*Math.PI),y:b.y+15*Math.sin(c-.5*Math.PI)});a.Actions.push({Action:"close"});return[a]},CircleOpen:function(b,c,a,d,h,e){a={StrokeColor:a,LineWidth:d,FillColor:"#ffffff",NoRounding:!0,Actions:[]};a.Actions.push({Action:"move",x:b.x-15*c.x+15,y:b.y-15*c.y});a.Actions.push({Action:"curve",
Control:lucid.math.ellipseArcControlPoints(b.x-15*c.x-15,b.y-15*c.y-15,30,30,0,2*Math.PI)});a.Actions.push({Action:"close"});return[a]},CircleClosed:function(b,c,a,d,h,e){a={StrokeColor:a,LineWidth:d,FillColor:"#000000",NoRounding:!0,Actions:[]};a.Actions.push({Action:"move",x:b.x-15*c.x+15,y:b.y-15*c.y});a.Actions.push({Action:"curve",Control:lucid.math.ellipseArcControlPoints(b.x-15*c.x-15,b.y-15*c.y-15,30,30,0,2*Math.PI)});a.Actions.push({Action:"close"});return[a]},Nesting:function(b,c,a,d,h,
e){a={StrokeColor:a,LineWidth:d,FillColor:"#ffffff",NoRounding:!0,Actions:[]};d=Math.atan2(c.y,c.x);a.Actions.push({Action:"move",x:b.x-15*c.x+15,y:b.y-15*c.y});a.Actions.push({Action:"curve",Control:lucid.math.ellipseArcControlPoints(b.x-15*c.x-15,b.y-15*c.y-15,30,30,0,2*Math.PI)});a.Actions.push({Action:"close"});a.Actions.push({Action:"move",x:b.x,y:b.y});a.Actions.push({Action:"line",x:b.x-30*c.x,y:b.y-30*c.y});a.Actions.push({Action:"close"});a.Actions.push({Action:"move",x:b.x+21*Math.cos(d+
.75*Math.PI),y:b.y+21*Math.sin(d+.75*Math.PI)});a.Actions.push({Action:"line",x:b.x+21*Math.cos(d-.75*Math.PI),y:b.y+21*Math.sin(d-.75*Math.PI)});a.Actions.push({Action:"close"});return[a]}};lucid.line.addEndpointStyles("uml",ac,.8);lucid.plugin.initBlockClass({className:"UMLConstraintBlock",name:"Constraint",searchKeywords:["uml","constraint"],defaultSize:{w:160,h:40},onInit:function(b){lucid.plugin.addBlockTextArea(b,{id:"Text",value:"Constraint",getBoundingBox:function(b){var a=.13*(b.h>b.w?b.w:
b.h);return{x:b.x+1.5*a,y:b.y,w:b.w-3*a,h:b.h}}})},getLinkPoints:function(b){return[{x:0,y:.5},{x:1,y:.5}]},getRenderDataKey:function(){return["LineColor","LineWidth"]},disabledPropertyControls:["FillColor"],getRenderData:function(b,c){var a=b.BoundingBox,d=.13*(a.h>a.w?a.w:a.h);"sample"==c&&(a.h=a.w,a.x=2,a.y=2,d=.2*(a.h>a.w?a.w:a.h));return[{StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x+2*d,y:a.y},{Action:"curve",Control:lucid.math.ellipseArcControlPoints(a.x+d,a.y,
2*d,2*d,1.5*Math.PI,Math.PI)},{Action:"line",x:a.x+d,y:a.y+a.h/2-d},{Action:"curve",Control:lucid.math.ellipseArcControlPoints(a.x-d,a.y+a.h/2-2*d,2*d,2*d,0,.5*Math.PI)},{Action:"curve",Control:lucid.math.ellipseArcControlPoints(a.x-d,a.y+a.h/2,2*d,2*d,1.5*Math.PI,2*Math.PI)},{Action:"line",x:a.x+d,y:a.y+a.h-d},{Action:"curve",Control:lucid.math.ellipseArcControlPoints(a.x+d,a.y+a.h-2*d,2*d,2*d,Math.PI,.5*Math.PI)},{Action:"move",x:a.x+a.w-2*d,y:a.y+a.h},{Action:"curve",Control:lucid.math.ellipseArcControlPoints(a.x+
a.w-3*d,a.y+a.h-2*d,2*d,2*d,.5*Math.PI,0)},{Action:"line",x:a.x+a.w-d,y:a.y+a.h/2+d},{Action:"curve",Control:lucid.math.ellipseArcControlPoints(a.x+a.w-d,a.y+a.h/2,2*d,2*d,Math.PI,1.5*Math.PI)},{Action:"curve",Control:lucid.math.ellipseArcControlPoints(a.x+a.w-d,a.y+a.h/2-2*d,2*d,2*d,.5*Math.PI,Math.PI)},{Action:"line",x:a.x+a.w-d,y:a.y+d},{Action:"curve",Control:lucid.math.ellipseArcControlPoints(a.x+a.w-3*d,a.y,2*d,2*d,2*Math.PI,1.5*Math.PI)}]}]}});lucid.plugin.initBlockClass({className:"UMLOptionLoopBlock",
name:"Option Loop",searchKeywords:["uml","package"],defaultSize:{w:700,h:500},container:!0,defaultProperties:function(){return{Magnetize:!1}},minWidth:110,minHeight:80,variants:{UMLStateName:{searchKeywords:["uml","state","name"],tooltip:"",defaultProperties:function(){return{Title:"State Name",TitleWidth:115,Text:"",Magnetize:!1}}}},onInit:function(b){lucid.plugin.setProperty(b,"DisableAutoLink",!0);lucid.plugin.registerProperty(b,"TitleHeight",30);lucid.plugin.registerProperty(b,"TitleWidth",100);
lucid.plugin.setProperty(b,"TextAlign","left");lucid.plugin.addBlockTextArea(b,{id:"Title",value:"Loop",getBoundingBox:function(c){var a=lucid.plugin.getProperty(b,"TitleHeight"),d=lucid.plugin.getProperty(b,"TitleWidth");return{x:c.x+8,y:c.y,w:d-18,h:a}}});lucid.plugin.addBlockTextArea(b,{id:"Text",value:"[Condition]",getBoundingBox:function(c){var a=lucid.plugin.getProperty(b,"TitleHeight"),d=lucid.text.getSize(b,"Text",{x:c.x+12,y:c.y+a+8,h:a,w:1E4}),d=Math.min(Math.max(80,lucid.plugin.snapToGrid(b,
d.w+8,1,"ceil")),c.w-24);return{x:c.x+12,y:c.y+a+8,w:d,h:a}}})},spatialControls:function(b){return[{logAction:"chart.viewport.selection.spatialControls.uml.optionLoop",location:function(){var c=lucid.plugin.getProperty(b,"BoundingBox"),a=lucid.plugin.getProperty(b,"TitleHeight"),d=lucid.plugin.getProperty(b,"TitleWidth");return{x:c.x+d-5,y:c.y+a-5,w:10,h:10}},moved:function(c){var a=lucid.plugin.getProperty(b,"BoundingBox");lucid.plugin.setProperty(b,"TitleWidth",c.x-a.x)},area:function(){var c=lucid.plugin.getProperty(b,
"BoundingBox");return{x:c.x+80,y:c.y,w:c.w-80,h:c.h/2-5}},snap:4}]},getOffsetProperties:function(b,c,a){c=lucid.plugin.defaultOffsetProperties(b,c,a);if(!lucid.plugin.isPermanentObject(b))return c;a=c[b].BoundingBox;var d=lucid.plugin.getProperty(b,"TitleWidth"),h=a.w;d>a.w&&(c[b].TitleWidth=a.w);a=lucid.text.getBoundingBox(b,"Text");a.w=h-16;a=lucid.text.getSize(b,"Text",a);lucid.plugin.snapToGrid(b,a.w+8,1,"ceil");return c},onResize:function(b){},getRenderDataKey:function(){return"FillColor LineColor LineWidth TitleWidth TitleHeight lineWidth".split(" ")},
getRenderData:function(b,c){var a=b.BoundingBox,d=b.TitleHeight,h=b.TitleWidth,e=10;"sample"==c&&(d*=4*a.h/500,h*=4*a.w/700,e=2);return[{FillColor:b.FillColor,StrokeColor:null,LineWidth:b.lineWidth,Actions:[{Action:"move",x:a.x,y:a.y},{Action:"line",x:a.x+h,y:a.y},{Action:"line",x:a.x+h,y:a.y+d-e},{Action:"line",x:a.x+h-e,y:a.y+d},{Action:"line",x:a.x,y:a.y+d},{Action:"close"}]},{FillColor:null,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x,y:a.y},{Action:"line",x:a.x+
a.w,y:a.y},{Action:"line",x:a.x+a.w,y:a.y+a.h},{Action:"line",x:a.x,y:a.y+a.h},{Action:"close"}]},{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,NoRounding:!0,Actions:[{Action:"move",x:a.x+h,y:a.y},{Action:"line",x:a.x+h,y:a.y+d-e},{Action:"line",x:a.x+h-e,y:a.y+d},{Action:"line",x:a.x,y:a.y+d}]}]}});lucid.plugin.initBlockClass({className:"UMLAlternativeBlock",name:"Alternative",searchKeywords:[],defaultSize:{w:700,h:500},container:!0,defaultProperties:function(){return{Magnetize:!1}},
minWidth:110,minHeight:120,onInit:function(b){lucid.plugin.registerProperty(b,"TitleHeight",30);lucid.plugin.registerProperty(b,"TitleWidth",100);lucid.plugin.registerProperty(b,"Boundary",.5);lucid.plugin.setProperty(b,"TextAlign","left");lucid.plugin.setProperty(b,"DisableAutoLink",!0);lucid.plugin.addBlockTextArea(b,{id:"Title",value:"Alternative",getBoundingBox:function(c){var a=lucid.plugin.getProperty(b,"TitleHeight"),d=lucid.plugin.getProperty(b,"TitleWidth");return{x:c.x+8,y:c.y,w:d-18,h:a}}});
lucid.plugin.addBlockTextArea(b,{id:"Text",value:"[Condition]",getBoundingBox:function(c){var a=lucid.plugin.getProperty(b,"TitleHeight"),d=lucid.text.getSize(b,"Text",{x:c.x+12,y:c.y+a+8,h:a,w:1E4}),d=Math.min(Math.max(80,lucid.plugin.snapToGrid(b,d.w+8,1,"ceil")),c.w-24);return{x:c.x+12,y:c.y+a+8,w:d,h:a}}});lucid.plugin.addBlockTextArea(b,{id:"Else",value:"[Else]",getBoundingBox:function(c){var a=lucid.plugin.getProperty(b,"TitleHeight"),d=lucid.plugin.getProperty(b,"Boundary"),h=lucid.text.getSize(b,
"Else",{x:c.x+12,y:c.y+c.h*d+8,h:a,w:1E4}),h=Math.min(Math.max(80,lucid.plugin.snapToGrid(b,h.w+8,1,"ceil")),c.w-24);return{x:c.x+12,y:c.y+c.h*d+8,w:h,h:a}}})},spatialControls:function(b){return[{logAction:"chart.viewport.selection.spatialControls.uml.alternativeTitleWidth",location:function(){var c=lucid.plugin.getProperty(b,"BoundingBox"),a=lucid.plugin.getProperty(b,"TitleHeight"),d=lucid.plugin.getProperty(b,"TitleWidth");return{x:c.x+d-5,y:c.y+a-5,w:10,h:10}},moved:function(c){var a=lucid.plugin.getProperty(b,
"BoundingBox");lucid.plugin.setProperty(b,"TitleWidth",c.x-a.x)},area:function(){var c=lucid.plugin.getProperty(b,"BoundingBox");return{x:c.x+80,y:c.y,w:c.w-80,h:c.h/2-5}},snap:4},{logAction:"chart.viewport.selection.spatialControls.uml.alternativeSplit",location:function(){var c=lucid.plugin.getProperty(b,"BoundingBox"),a=lucid.plugin.getProperty(b,"Boundary");return{x:c.x-5,y:c.y+c.h*a-5,w:10,h:10}},moved:function(c){var a=lucid.plugin.getProperty(b,"BoundingBox");lucid.plugin.setProperty(b,"Boundary",
(c.y-a.y)/a.h)},area:function(){var c=lucid.plugin.getProperty(b,"BoundingBox");return{x:c.x,y:c.y+80,w:10,h:c.h-120}},snap:4}]},getOffsetProperties:function(b,c,a){c=lucid.plugin.defaultOffsetProperties(b,c,a);if(!lucid.plugin.isPermanentObject(b))return c;a=c[b].BoundingBox;var d=lucid.plugin.getProperty(b,"TitleWidth"),h=a.w;d>a.w&&(c[b].TitleWidth=a.w);d=lucid.plugin.getProperty(b,"Boundary");d*=a.h;80>d?c[b].Boundary=80/a.h:d>a.h-40&&(c[b].Boundary=(a.h-40)/a.h);a=lucid.text.getBoundingBox(b,
"Text");a.w=h-16;lucid.text.getSize(b,"Text",a);return c},onResize:function(b){},getRenderDataKey:function(){return"FillColor LineColor LineWidth TitleWidth TitleHeight Boundary lineWidth".split(" ")},getRenderData:function(b,c){var a=b.BoundingBox,d=b.TitleHeight,h=b.TitleWidth,e=10,g=[20,15];"sample"==c&&(d*=4*a.h/500,h*=4*a.w/700,e=2,g=[2,2]);for(var l=[],n=a.x,p=a.y+a.h*b.Boundary;n<a.x+a.w;)l.push({Action:"move",x:Math.min(n,a.x+a.w),y:p}),n+=g[0],l.push({Action:"line",x:Math.min(n,a.x+a.w),
y:p}),n+=g[1];return[{FillColor:b.FillColor,StrokeColor:null,LineWidth:b.lineWidth,Actions:[{Action:"move",x:a.x,y:a.y},{Action:"line",x:a.x+h,y:a.y},{Action:"line",x:a.x+h,y:a.y+d-e},{Action:"line",x:a.x+h-e,y:a.y+d},{Action:"line",x:a.x,y:a.y+d},{Action:"close"}]},{FillColor:null,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x,y:a.y},{Action:"line",x:a.x+a.w,y:a.y},{Action:"line",x:a.x+a.w,y:a.y+a.h},{Action:"line",x:a.x,y:a.y+a.h},{Action:"close"}]},{FillColor:b.FillColor,
StrokeColor:b.LineColor,LineWidth:b.LineWidth,NoRounding:!0,Actions:[{Action:"move",x:a.x+h,y:a.y},{Action:"line",x:a.x+h,y:a.y+d-e},{Action:"line",x:a.x+h-e,y:a.y+d},{Action:"line",x:a.x,y:a.y+d}]},{StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:l}]}});plugin.uml.sequence.AlternativeBlock2={boundaryDashPattern:{draw:20,space:15},defaultHeight:500,defaultWidth:700,labelPaddingLeft:12,labelPaddingTop:8,sampleCornerCut:2,sampleDashPattern:{draw:2,space:2},titleCornerCut:10,titleTabMinimumWidth:80,
titleTextPadding:8};plugin.uml.sequence.AlternativeBlock2.onInit=function(b){plugin.uml.sequence.AlternativeBlock2.setInitialProperties(b);plugin.uml.sequence.AlternativeBlock2.createTitleTextArea(b);plugin.uml.sequence.AlternativeBlock2.createTitleConditionTextArea(b);plugin.uml.sequence.AlternativeBlock2.registerBoundariesProperty(b)};plugin.uml.sequence.AlternativeBlock2.setInitialProperties=function(b){lucid.plugin.setProperty(b,"TextAlign","left");lucid.plugin.setProperty(b,"DisableAutoLink",
!0);lucid.plugin.setProperty(b,"TitleHeight",30);lucid.plugin.setProperty(b,"TitleWidth",100)};plugin.uml.sequence.AlternativeBlock2.createTitleTextArea=function(b){lucid.plugin.addBlockTextArea(b,{id:"Title",value:"Alternative",getBoundingBox:function(c){var a=lucid.plugin.getProperty(b,"TitleHeight"),d=lucid.plugin.getProperty(b,"TitleWidth"),h=plugin.uml.sequence.AlternativeBlock2.titleTextPadding;return{x:c.x+h,y:c.y,w:d-(h+plugin.uml.sequence.AlternativeBlock2.titleCornerCut),h:a}}})};plugin.uml.sequence.AlternativeBlock2.createTitleConditionTextArea=
function(b){lucid.plugin.addBlockTextArea(b,{id:"Condition",value:"[Condition]",getBoundingBox:function(c){var a=lucid.plugin.getProperty(b,"TitleHeight");return plugin.uml.sequence.AlternativeBlock2.measureTextAreaBB(b,"Condition",c.x+plugin.uml.sequence.AlternativeBlock2.labelPaddingLeft,c.y+a+plugin.uml.sequence.AlternativeBlock2.labelPaddingTop,c.w,a)}})};plugin.uml.sequence.AlternativeBlock2.registerBoundariesProperty=function(b){lucid.plugin.registerProperty(b,"Boundaries",[{height:.5,text:"[Else]"}],
null,function(c,a,d){c=c||[];a=a||[];var h=Math.min(c.length,a.length);for(d=0;d<h;d++)lucid.plugin.setPropertyIfChanged(b,"Else"+d,a[d].text);for(d=h;d<c.length;d++)lucid.plugin.deleteBlockTextArea(b,"Else"+d);for(d=h;d<a.length;d++)plugin.uml.sequence.AlternativeBlock2.createBoundaryTextArea(b,"Else"+d,a[d].text,d)})};plugin.uml.sequence.AlternativeBlock2.createBoundaryTextArea=function(b,c,a,d){var h=plugin.uml.sequence.AlternativeBlock2.labelPaddingLeft,e=plugin.uml.sequence.AlternativeBlock2.labelPaddingTop;
lucid.plugin.addBlockTextArea(b,{id:c,value:a,getBoundingBox:function(a){var l=lucid.plugin.getProperty(b,"Boundaries"),g=lucid.plugin.getProperty(b,"TitleHeight");if(d<l.length)return plugin.uml.sequence.AlternativeBlock2.measureTextAreaBB(b,c,a.x+h,a.y+a.h*l[d].height+e,a.w,g)}})};plugin.uml.sequence.AlternativeBlock2.measureTextAreaBB=function(b,c,a,d,h,e){c=lucid.text.getSize(b,c,{x:a,y:d,w:1E4,h:e});b=Math.min(Math.max(80,lucid.plugin.snapToGrid(b,c.w+8,1,"ceil")),h-2*plugin.uml.sequence.AlternativeBlock2.labelPaddingLeft);
return{x:a,y:d,w:b,h:e}};plugin.uml.sequence.AlternativeBlock2.spatialControls=function(b){var c=[],c=c.concat(plugin.uml.sequence.AlternativeBlock2.getTitleSpatialControls(b));return c=c.concat(plugin.uml.sequence.AlternativeBlock2.getBoundariesSpatialControls(b))};plugin.uml.sequence.AlternativeBlock2.getTitleSpatialControls=function(b){var c=plugin.uml.sequence.AlternativeBlock2.titleTabMinimumWidth;return{area:function(){var a=lucid.plugin.getProperty(b,"BoundingBox"),d=lucid.plugin.getProperty(b,
"TitleHeight");return{x:a.x+c,y:a.y+d/2,w:a.w-c,h:0}},location:function(){var a=lucid.plugin.getProperty(b,"BoundingBox"),c=lucid.plugin.getProperty(b,"TitleHeight"),h=lucid.plugin.getProperty(b,"TitleWidth");return{x:a.x+h-5,y:a.y+c/2-5,w:10,h:10}},logAction:"chart.viewport.selection.spatialControls.uml.alternativeTitleWidth",moved:function(a){var c=lucid.plugin.getProperty(b,"BoundingBox");lucid.plugin.setProperty(b,"TitleWidth",a.x-c.x)},snap:4}};plugin.uml.sequence.AlternativeBlock2.getBoundariesSpatialControls=
function(b){for(var c=[],a=lucid.plugin.getProperty(b,"Boundaries").length,d=0;d<a;d++)c=c.concat(plugin.uml.sequence.AlternativeBlock2.getBoundarySpatialControls(b,a,d,10));return c};plugin.uml.sequence.AlternativeBlock2.getBoundarySpatialControls=function(b,c,a,d){return{area:function(){var c=lucid.plugin.getProperty(b,"BoundingBox"),d=lucid.plugin.getProperty(b,"Boundaries"),g=lucid.plugin.getProperty(b,"TitleHeight"),d=plugin.uml.sequence.AlternativeBlock2.getUpperAndLowerBounds(c,d,a,g);return{x:c.x,
y:d.upperBound,w:0,h:d.lowerBound-d.upperBound}},location:function(){var c=lucid.plugin.getProperty(b,"BoundingBox"),e=lucid.plugin.getProperty(b,"Boundaries")[a];return{x:c.x,y:c.y+c.h*e.height-d/2,w:d,h:d}},logAction:"chart.viewport.selection.spatialControls.uml.alternativeSplit",moved:function(c){var d=lucid.plugin.getProperty(b,"BoundingBox"),g=lucid.plugin.getProperty(b,"Boundaries");g[a].height=(c.y-d.y)/d.h;lucid.plugin.setProperty(b,"Boundaries",g)},snap:4}};plugin.uml.sequence.AlternativeBlock2.getOffsetProperties=
function(b,c,a){c=lucid.plugin.defaultOffsetProperties(b,c,a);if(lucid.plugin.isPermanentObject(b)){a=c[b].BoundingBox;var d=lucid.plugin.getProperty(b,"Boundaries"),h=lucid.plugin.getProperty(b,"TitleHeight");lucid.plugin.getProperty(b,"TitleWidth")>a.w&&(c[b].TitleWidth=a.w);for(var e=0;e<d.length;e++){var g=plugin.uml.sequence.AlternativeBlock2.getUpperAndLowerBounds(a,d,e,h),l=d[e],n=a.y+l.height*a.h;n>g.lowerBound?l.height=(g.lowerBound-a.y)/a.h:n<g.upperBound&&(l.height=(g.upperBound-a.y)/a.h)}c[b].Boundaries=
d}return c};plugin.uml.sequence.AlternativeBlock2.getUpperAndLowerBounds=function(b,c,a,d){var h=plugin.uml.sequence.AlternativeBlock2.labelPaddingTop,h=h+d+h;return{upperBound:0===a?b.y+d+h:b.y+b.h*c[a-1].height+h,lowerBound:a==c.length-1?b.y+b.h-h:b.y+b.h*c[a+1].height-h}};plugin.uml.sequence.AlternativeBlock2.getRenderDataKey=function(){return"Boundaries FillColor LineColor LineWidth TitleHeight TitleWidth".split(" ")};plugin.uml.sequence.AlternativeBlock2.getRenderData=function(b,c){var a=b.Boundaries,
d=b.BoundingBox,h=b.FillColor,e=b.LineColor,g=b.LineWidth,l=b.TitleHeight,n=b.TitleWidth,p=plugin.uml.sequence.AlternativeBlock2.titleCornerCut,z=plugin.uml.sequence.AlternativeBlock2.boundaryDashPattern;"sample"==c&&(p=plugin.uml.sequence.AlternativeBlock2.sampleCornerCut,z=plugin.uml.sequence.AlternativeBlock2.sampleDashPattern,n*=d.w/plugin.uml.sequence.AlternativeBlock2.defaultWidth*4,l*=d.h/plugin.uml.sequence.AlternativeBlock2.defaultHeight*4);var t=[],t=t.concat(plugin.uml.sequence.AlternativeBlock2.getTitleTabRenderData({x:d.x,
y:d.y,w:n,h:l},p,h,e,g)),t=t.concat(plugin.uml.sequence.AlternativeBlock2.getBlockOutlineRenderData(d,e,g));return t=t.concat(plugin.uml.sequence.AlternativeBlock2.getBoundariesRenderData(d,a,z,e,g))};plugin.uml.sequence.AlternativeBlock2.getTitleTabRenderData=function(b,c,a,d,h){return[{FillColor:a,StrokeColor:null,LineWidth:h,Actions:[{Action:"move",x:b.x,y:b.y},{Action:"line",x:b.x+b.w,y:b.y},{Action:"line",x:b.x+b.w,y:b.y+b.h-c},{Action:"line",x:b.x+b.w-c,y:b.y+b.h},{Action:"line",x:b.x,y:b.y+
b.h},{Action:"close"}]},{FillColor:null,StrokeColor:d,LineWidth:h,NoRounding:!0,Actions:[{Action:"move",x:b.x+b.w,y:b.y},{Action:"line",x:b.x+b.w,y:b.y+b.h-c},{Action:"line",x:b.x+b.w-c,y:b.y+b.h},{Action:"line",x:b.x,y:b.y+b.h}]}]};plugin.uml.sequence.AlternativeBlock2.getBlockOutlineRenderData=function(b,c,a){return{FillColor:null,StrokeColor:c,LineWidth:a,Actions:[{Action:"move",x:b.x,y:b.y},{Action:"line",x:b.x+b.w,y:b.y},{Action:"line",x:b.x+b.w,y:b.y+b.h},{Action:"line",x:b.x,y:b.y+b.h},{Action:"close"}]}};
plugin.uml.sequence.AlternativeBlock2.getBoundariesRenderData=function(b,c,a,d,h){var e=b.x+b.w;return c.map(function(c){var g=b.x;c=b.y+b.h*c.height;for(var n=[];g<e;)n.push({Action:"move",x:Math.min(g,e),y:c}),g+=a.draw,n.push({Action:"line",x:Math.min(g,e),y:c}),g+=a.space;return{FillColor:null,StrokeColor:d,LineWidth:h,Actions:n}})};lucid.plugin.initBlockClass({className:"UMLAlternativeBlock2",name:"Alternative",searchKeywords:["uml","package","alternative"],defaultSize:{w:plugin.uml.sequence.AlternativeBlock2.defaultWidth,
h:plugin.uml.sequence.AlternativeBlock2.defaultHeight},container:!0,defaultProperties:function(){return{Magnetize:!1}},minWidth:110,minHeight:120,onInit:plugin.uml.sequence.AlternativeBlock2.onInit,spatialControls:plugin.uml.sequence.AlternativeBlock2.spatialControls,getOffsetProperties:plugin.uml.sequence.AlternativeBlock2.getOffsetProperties,getRenderDataKey:plugin.uml.sequence.AlternativeBlock2.getRenderDataKey,getRenderData:plugin.uml.sequence.AlternativeBlock2.getRenderData});lucid.plugin.initBlockClass({className:"UMLSeqEntityBlock",
name:"Entity",searchKeywords:["uml","entity","sequence"],defaultSize:{w:100,h:120},onInit:function(b){lucid.plugin.addBlockTextArea(b,{id:"Text",value:"Entity",getBoundingBox:function(b){return{x:b.x-40,y:b.y+b.h-20,w:b.w+80,h:20}}})},getLinkPoints:function(b){b=lucid.plugin.getProperty(b,"BoundingBox");b=(b.h/2-10)/b.h;return[{x:.5,y:0},{x:.5,y:1},{x:0,y:b},{x:1,y:b}]},getRenderDataKey:function(){return["FillColor","LineColor","LineWidth"]},getRenderData:function(b,c){var a=b.BoundingBox,d=20;"sample"==
c&&(d=2);return[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x+a.w/2,y:a.y+a.h-d},{Action:"curve",Control:lucid.math.ellipseArcControlPoints(a.x,a.y,a.w,a.h-d,.5*Math.PI,2.5*Math.PI)},{Action:"close"}]},{StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x,y:a.y+a.h-d},{Action:"line",x:a.x+a.w,y:a.y+a.h-d}]}]}});lucid.plugin.initBlockClass({className:"UMLBoundaryBlock",name:"Boundary",searchKeywords:["uml","boundary"],defaultSize:{w:120,
h:120},onInit:function(b){lucid.plugin.addBlockTextArea(b,{id:"Text",value:"Boundary",getBoundingBox:function(b){return{x:b.x-20,y:b.y+b.h-20,w:b.w+60,h:20}}})},getLinkPoints:function(b){return[{x:.5,y:0},{x:.5,y:1},{x:0,y:.5},{x:1,y:.5}]},getRenderDataKey:function(){return["FillColor","LineColor","LineWidth"]},getRenderData:function(b,c){var a=b.BoundingBox,d=20;"sample"==c&&(d=2);return[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x+a.w,y:a.y+
a.h/2-d/2},{Action:"curve",Control:lucid.math.ellipseArcControlPoints(a.x+d,a.y,a.w-d,a.h-d,0,2*Math.PI)},{Action:"close"}]},{NoRounding:!0,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x,y:a.y},{Action:"line",x:a.x,y:a.y+a.h-d},{Action:"move",x:a.x,y:a.y+a.h/2-d/2},{Action:"line",x:a.x+d,y:a.y+a.h/2-d/2}]}]}});lucid.plugin.initBlockClass({className:"UMLControlBlock",name:"Control",searchKeywords:["uml","control"],defaultSize:{w:100,h:120},onInit:function(b){lucid.plugin.addBlockTextArea(b,
{id:"Text",value:"Control",getBoundingBox:function(b){return{x:b.x-40,y:b.y+b.h-20,w:b.w+80,h:20}}})},getLinkPoints:function(b){return[{x:.5,y:0},{x:.5,y:1},{x:0,y:.5},{x:1,y:.5}]},getRenderDataKey:function(){return["FillColor","LineColor","LineWidth"]},getRenderData:function(b,c){var a=b.BoundingBox,d=20;"sample"==c&&(d=2);return[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x+a.w,y:a.y+a.h/2-d/2},{Action:"curve",Control:lucid.math.ellipseArcControlPoints(a.x,
a.y,a.w,a.h-d,0,2*Math.PI)},{Action:"close"}]},{NoRounding:!0,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x+.6*a.w,y:a.y-.05*a.h},{Action:"line",x:a.x+a.w/2,y:a.y},{Action:"line",x:a.x+.6*a.w,y:a.y+.06*a.h}]}]}});lucid.plugin.initBlockClass({className:"UMLPackageBlock",name:"Package",searchKeywords:["uml","package"],defaultSize:{w:360,h:240},onInit:function(b){lucid.plugin.registerProperty(b,"TitleHeight",26);lucid.plugin.setProperty(b,"TextAlign","left");lucid.plugin.addBlockTextArea(b,
{id:"Title",value:"Package",getBoundingBox:function(c){var a=lucid.plugin.getProperty(b,"TitleHeight");return{x:c.x+8,y:c.y,w:.6*c.w-24,h:a}}});lucid.plugin.addBlockTextArea(b,{id:"Text",value:"Attributes",getBoundingBox:function(c){var a=lucid.plugin.getProperty(b,"TitleHeight");return{x:c.x+12,y:c.y+a+8,w:c.w-24,h:c.h-a-16}}})},getLinkPoints:function(b){return[{x:0,y:.5},{x:0,y:.75},{x:.25,y:1},{x:.5,y:1},{x:.75,y:1},{x:1,y:.75},{x:1,y:.5}]},afterEditText:function(b){var c=lucid.text.getSize(b,
"Title"),a=lucid.text.getSize(b,"Text"),d=lucid.plugin.getProperty(b,"BoundingBox"),a=lucid.plugin.snapToGrid(b,c.h+a.h+32,1,"ceil");a>d.h&&(d.h=a);lucid.plugin.setProperty(b,"TitleHeight",c.h+16);lucid.plugin.setProperty(b,"BoundingBox",d)},getRenderDataKey:function(){return["FillColor","LineColor","LineWidth","TitleHeight"]},getRenderData:function(b,c){var a=b.BoundingBox,d=b.TitleHeight;"sample"==c&&(d*=2*a.h/240);return[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",
x:Math.round(a.x+.63*a.w),y:Math.round(a.y+d)},{Action:"line",x:a.x+a.w,y:Math.round(a.y+d)},{Action:"line",x:a.x+a.w,y:a.y+a.h},{Action:"line",x:a.x,y:a.y+a.h},{Action:"line",x:a.x,y:a.y},{Action:"line",x:Math.round(a.x+.6*a.w),y:a.y},{Action:"close"},{Action:"move",x:a.x,y:Math.round(a.y+d)},{Action:"line",x:Math.round(a.x+.63*a.w),y:Math.round(a.y+d)}]}]}});lucid.plugin.createNextBlockGroup("UMLClassBlock UMLActiveClassBlock UMLClassBlockSimple UMLInterfaceBlock UMLInterfaceBlockSimple UMLMultiplicityBlock".split(" "));
lucid.plugin.initBlockClass({className:"UMLActorBlock",name:"Actor",searchKeywords:"uml actor guy man stick figure".split(" "),defaultSize:{w:80,h:180},onInit:function(b){lucid.plugin.addBlockTextArea(b,{id:"Text",value:"Actor",getBoundingBox:function(b){return{x:b.x-80,y:b.y+b.h-22,w:b.w+160,h:22}}})},getLinkPoints:function(b){return[{x:.5,y:0},{x:.5,y:1},{x:0,y:.5},{x:1,y:.5}]},getRenderDataKey:function(){return["FillColor","LineColor","LineWidth"]},getRenderData:function(b,c){var a=b.BoundingBox;
"sample"!=c&&(a.h-=22);var d=Math.min(a.w/2,a.h/4),a=[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x+a.w/2+d/2,y:a.y+d/2},{Action:"curve",Control:lucid.math.ellipseArcControlPoints(a.x+a.w/2-d/2,a.y,d,d,0,2*Math.PI)},{Action:"close"}]},{Actions:[{Action:"move",x:a.x,y:a.y},{Action:"line",x:a.x+a.w,y:a.y},{Action:"line",x:a.x+a.w,y:a.y+a.h},{Action:"line",x:a.x,y:a.y+a.h},{Action:"close"}]},{StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",
x:a.x+a.w/2,y:a.y+d},{Action:"line",x:a.x+a.w/2,y:a.y+.6*a.h},{Action:"line",x:a.x+a.w,y:a.y+a.h},{Action:"move",x:a.x+a.w/2,y:a.y+.6*a.h},{Action:"line",x:a.x,y:a.y+a.h},{Action:"move",x:a.x,y:a.y+1.5*d},{Action:"line",x:a.x+a.w,y:a.y+1.5*d}]}];"sample"==c&&a.splice(1,1);return a},lineDrawnProperties:function(b,c){return{Endpoint2:{Style:"None"}}}});lucid.plugin.initBlockClass({className:"UMLUseCaseBlock",name:"Use Case",defaultSize:{w:160,h:120},searchKeywords:["uml","use","case"],unthemed:{TextStyle:!0},
variants:{UMLUseCaseExt:{searchKeywords:["uml","use","case","extension"],defaultProperties:function(){return{HasExtensionPoints:1,TextWrap:!1,InsetMargin:null}},defaultSize:{w:200,h:160},tooltip:"Use Case (w/Extension Points)"}},onInit:function(b){lucid.plugin.registerProperty(b,"HasExtensionPoints",0);lucid.plugin.addBlockTextArea(b,{id:"Text",value:"Use Case",getBoundingBox:function(c){return lucid.plugin.getProperty(b,"HasExtensionPoints")?{x:c.x+.15*c.w,y:c.y+.1*c.h,w:.7*c.w,h:.4*c.h}:F(c,function(a){return{x:a.x+
.15*a.w,y:a.y+.2*a.h,w:.7*a.w,h:.6*a.h}},function(a){return{x:a.x,y:a.y,w:a.w,h:a.h,fitShape:lucid.plugin.getProperty(b,"InsetMargin")||0,hideOverflow:!0}})}});1<B()&&(lucid.plugin.registerProperty(b,"TextWrap","fit"),lucid.plugin.registerProperty(b,"InsetMargin",5));lucid.plugin.addBlockTextArea(b,{id:"ExtensionPoints",value:"Point 1",getBoundingBox:function(c){return lucid.plugin.getProperty(b,"HasExtensionPoints")?{x:c.x+.15*c.w,y:c.y+.5*c.h+24,w:.7*c.w,h:.35*c.h-24}:null},wantReturn:!0});lucid.plugin.addBlockTextArea(b,
{id:"ExtensionPointLabel",value:'<span style="font-weight:bold;">Extension Points</span>',getBoundingBox:function(c){return lucid.plugin.getProperty(b,"HasExtensionPoints")?{x:c.x,y:c.y+.5*c.h,w:c.w,h:24}:null},wantReturn:!1,readOnly:!0})},getLinkPoints:function(b){return[{x:.5,y:0},{x:.5,y:1},{x:0,y:.5},{x:1,y:.5}]},getRenderDataKey:function(){return["FillColor","LineColor","LineWidth","HasExtensionPoints"]},getRenderData:function(b,c){var a=b.BoundingBox,d=[{FillColor:b.FillColor,StrokeColor:b.LineColor,
LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x+a.w,y:a.y+a.h/2},{Action:"curve",Control:lucid.math.ellipseArcControlPoints(a.x,a.y,a.w,a.h,0,2*Math.PI)},{Action:"close"}]}];b.HasExtensionPoints&&(d[0].Actions.push({Action:"move",x:a.x,y:a.y+a.h/2}),d[0].Actions.push({Action:"line",x:a.x+a.w,y:a.y+a.h/2}));return d},lineDrawnProperties:function(b,c){return{Endpoint2:{Style:"Open Arrow"},StrokeStyle:"dashed"}}});lucid.plugin.createNextBlockGroup(["UMLActorBlock","UMLUseCaseBlock","UMLUseCaseExt"]);
lucid.plugin.initBlockClass({className:"UMLStateBlock",name:"State/Activity",defaultSize:{w:160,h:80},searchKeywords:["uml","state"],variatons:{UMLStateBlockCmp:{searchKeywords:["uml","state","composite"],defaultProperties:function(){return{Composite:1}},defaultSize:{w:160,h:120},tooltip:"Composite State"},UMLStateBlockExt:{searchKeywords:["uml","state","external"],defaultProperties:function(){return{Rake:1,State:"Activity"}},tooltip:"Off-Page Activity"}},onInit:function(b){lucid.plugin.registerProperty(b,
"TitleHeight",44);lucid.plugin.registerProperty(b,"Composite",0);lucid.plugin.registerProperty(b,"Rake",0);lucid.plugin.addBlockTextArea(b,{id:"State",value:"State",getBoundingBox:function(c){if(lucid.plugin.getProperty(b,"Composite")){var a=lucid.plugin.getProperty(b,"TitleHeight");c={x:c.x+.2*c.w,y:c.y,w:.6*c.w,h:a}}else c=lucid.math.Box.pad(c,-8);lucid.plugin.getProperty(b,"Rake")&&(c.x+=30,c.w-=30);return c}});lucid.plugin.addBlockTextArea(b,{id:"Action",value:"Action",getBoundingBox:function(c){if(lucid.plugin.getProperty(b,
"Composite")){var a=lucid.plugin.getProperty(b,"TitleHeight");return{x:c.x+.1*c.w,y:c.y+a+16,w:.8*c.w,h:c.h-a-32}}return null}})},getLinkPoints:function(b){return[{x:.5,y:0},{x:.5,y:1},{x:0,y:.5},{x:1,y:.5}]},afterEditText:function(b){if(lucid.plugin.getProperty(b,"Composite")){var c=lucid.text.getSize(b,"State"),a=lucid.text.getSize(b,"Action"),d=lucid.plugin.getProperty(b,"BoundingBox"),a=lucid.plugin.snapToGrid(b,c.h+a.h+48,1,"ceil");a>d.h&&(d.h=a);lucid.plugin.setProperty(b,"TitleHeight",c.h+
32);lucid.plugin.setProperty(b,"BoundingBox",d)}},getRenderDataKey:function(){return"FillColor LineColor LineWidth TitleHeight Composite Rake".split(" ")},getRenderData:function(b,c){var a=b.BoundingBox,d=.2*(a.h>a.w?a.w:a.h),h=b.TitleHeight;"sample"==c&&(h*=a.h/80,d*=1.5);d=[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x+d,y:a.y},{Action:"curve",Control:lucid.math.ellipseArcControlPoints(a.x,a.y,2*d,2*d,1.5*Math.PI,Math.PI)},{Action:"line",x:a.x,
y:a.y+a.h-d},{Action:"curve",Control:lucid.math.ellipseArcControlPoints(a.x,a.y+a.h-2*d,2*d,2*d,Math.PI,.5*Math.PI)},{Action:"line",x:a.x+a.w-d,y:a.y+a.h},{Action:"curve",Control:lucid.math.ellipseArcControlPoints(a.x+a.w-2*d,a.y+a.h-2*d,2*d,2*d,.5*Math.PI,0)},{Action:"line",x:a.x+a.w,y:a.y+d},{Action:"curve",Control:lucid.math.ellipseArcControlPoints(a.x+a.w-2*d,a.y,2*d,2*d,2*Math.PI,1.5*Math.PI)},{Action:"close"}]},{StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x,y:Math.round(a.y+
h)},{Action:"line",x:a.x+a.w,y:Math.round(a.y+h)}]}];b.Composite||d.splice(1,1);if(b.Rake){var h=b.Composite?h/2:a.h/2,e=20,g=8;"sample"==c&&(e=.4*a.h,g=.15*a.w);d.push({NoRounding:!0,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x+e/2+g,y:a.y+h-e/2},{Action:"line",x:a.x+e/2+g,y:a.y+h+e/2},{Action:"move",x:a.x+g,y:a.y+h+e/2},{Action:"line",x:a.x+g,y:a.y+h},{Action:"line",x:a.x+g+e,y:a.y+h},{Action:"line",x:a.x+g+e,y:a.y+h+e/2}]})}return d}});lucid.plugin.initBlockClass({className:"UMLStartBlock",
name:"Start",searchKeywords:["uml","start"],defaultSize:{w:40,h:40},getLinkPoints:function(b){return[{x:.5,y:0},{x:.5,y:1},{x:0,y:.5},{x:1,y:.5}]},getRenderDataKey:function(){return["LineColor","LineWidth"]},disabledPropertyControls:["FillColor"],getRenderData:function(b,c){var a=b.BoundingBox;"sample"==c&&(a={x:Math.round(a.x+.25*a.w),y:Math.round(a.y+.25*a.h),w:Math.round(.5*a.w),h:Math.round(.5*a.h)});return[{FillColor:"#000000",StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",
x:a.x+a.w,y:a.y+a.h/2},{Action:"curve",Control:lucid.math.ellipseArcControlPoints(a.x,a.y,a.w,a.h,0,2*Math.PI)},{Action:"close"}]}]}});lucid.plugin.initBlockClass({className:"UMLEndBlock",name:"End",searchKeywords:["uml","end"],defaultSize:{w:40,h:40},getLinkPoints:function(b){return[{x:.5,y:0},{x:.5,y:1},{x:0,y:.5},{x:1,y:.5}]},getRenderDataKey:function(){return["FillColor","LineColor","LineWidth"]},getRenderData:function(b,c){var a=b.BoundingBox;"sample"==c&&(a={x:Math.round(a.x+.25*a.w),y:Math.round(a.y+
.25*a.h),w:Math.round(.5*a.w),h:Math.round(.5*a.h)});return[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x+a.w,y:a.y+a.h/2},{Action:"curve",Control:lucid.math.ellipseArcControlPoints(a.x,a.y,a.w,a.h,0,2*Math.PI)},{Action:"close"}]},{FillColor:"#000000",StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x+.8*a.w,y:a.y+a.h/2},{Action:"curve",Control:lucid.math.ellipseArcControlPoints(a.x+.2*a.w,a.y+.2*a.h,.6*a.w,.6*a.h,0,2*Math.PI)},
{Action:"close"}]}]}});lucid.plugin.initBlockClass({className:"UMLDecisionBlock",name:"Branch/Merge",searchKeywords:["uml","decision","decide"],defaultSize:{w:40,h:40},onInit:function(b){},getLinkPoints:function(){return[{x:.5,y:0},{x:.5,y:1},{x:0,y:.5},{x:1,y:.5}]},lineDrawnProperties:function(b,c){var a="Option";1==c&&(a="Yes");2==c&&(a="No");return{TextAreas:{Text:{Location:.5,Side:0,Value:a}}}},getRenderDataKey:function(){return["FillColor","LineColor","LineWidth"]},getRenderData:function(b,c){var a=
b.BoundingBox;"sample"==c&&(a=lucid.math.Box.pad(a,-a.w/5));var d=a.x+a.w/2,h=a.y+a.h/2;return[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:d,y:a.y},{Action:"line",x:a.x+a.w,y:h},{Action:"line",x:d,y:a.y+a.h},{Action:"line",x:a.x,y:h},{Action:"close"}]}]}});lucid.plugin.initBlockClass({className:"UMLVForkJoinBlock",name:"Vertical Fork/Join",searchKeywords:["uml","fork","vertical","join"],defaultSize:{w:20,h:160},onInit:function(b){},getLinkPoints:function(){return[{x:0,
y:.25},{x:0,y:.5},{x:0,y:.75},{x:1,y:.25},{x:1,y:.5},{x:1,y:.75}]},getRenderDataKey:function(){return["LineColor","LineWidth"]},disabledPropertyControls:["FillColor"],getRenderData:function(b,c){var a=b.BoundingBox;return[{FillColor:"#000000",StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x,y:a.y},{Action:"line",x:a.x+a.w,y:a.y},{Action:"line",x:a.x+a.w,y:a.y+a.h},{Action:"line",x:a.x,y:a.y+a.h},{Action:"close"}]}]}});lucid.plugin.initBlockClass({className:"UMLHForkJoinBlock",
name:"Horizontal Fork/Join",searchKeywords:["uml","fork","horizontal","join"],defaultSize:{w:160,h:20},onInit:function(b){},getLinkPoints:function(){return[{x:.25,y:0},{x:.5,y:0},{x:.75,y:0},{x:.25,y:1},{x:.5,y:1},{x:.75,y:1}]},getRenderDataKey:function(){return["LineColor","LineWidth"]},disabledPropertyControls:["FillColor"],getRenderData:function(b,c){var a=b.BoundingBox;return[{FillColor:"#000000",StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x,y:a.y},{Action:"line",
x:a.x+a.w,y:a.y},{Action:"line",x:a.x+a.w,y:a.y+a.h},{Action:"line",x:a.x,y:a.y+a.h},{Action:"close"}]}]}});lucid.plugin.initBlockClass({className:"UMLHistoryStateBlock",name:"History Pseudostate",searchKeywords:["uml","flow","history"],defaultSize:{w:40,h:40},onInit:function(b){},getLinkPoints:function(){return[{x:.5,y:0},{x:.5,y:1},{x:0,y:.5},{x:1,y:.5}]},getRenderDataKey:function(){return["FillColor","LineColor","LineWidth"]},getRenderData:function(b,c){var a=b.BoundingBox;"sample"==c&&(a=lucid.math.Box.pad(a,
-a.w/4));return[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x+a.w,y:a.y+a.h/2},{Action:"curve",Control:lucid.math.ellipseArcControlPoints(a.x,a.y,a.w,a.h,0,2*Math.PI)},{Action:"close"}]},{FillColor:null,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x+.35*a.w,y:a.y+.28*a.h},{Action:"line",x:a.x+.35*a.w,y:a.y+.72*a.h},{Action:"move",x:a.x+.65*a.w,y:a.y+.72*a.h},{Action:"line",x:a.x+.65*a.w,y:a.y+.28*a.h},{Action:"move",
x:a.x+.35*a.w,y:a.y+.5*a.h},{Action:"line",x:a.x+.65*a.w,y:a.y+.5*a.h}]}]}});lucid.plugin.initBlockClass({className:"UMLFlowFinalBlock",name:"Flow Final",searchKeywords:["uml","flow","final"],defaultSize:{w:40,h:40},onInit:function(b){},getLinkPoints:function(){return[{x:.5,y:0},{x:.5,y:1},{x:0,y:.5},{x:1,y:.5}]},getRenderDataKey:function(){return["FillColor","LineColor","LineWidth"]},getRenderData:function(b,c){var a=b.BoundingBox;"sample"==c&&(a=lucid.math.Box.pad(a,-a.w/4));return[{FillColor:b.FillColor,
StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x+a.w,y:a.y+a.h/2},{Action:"curve",Control:lucid.math.ellipseArcControlPoints(a.x,a.y,a.w,a.h,0,2*Math.PI)},{Action:"close"}]},{FillColor:null,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x+.1464*a.w,y:a.y+.1464*a.h},{Action:"line",x:a.x+.8536*a.w,y:a.y+.8536*a.h},{Action:"move",x:a.x+.8536*a.w,y:a.y+.1464*a.h},{Action:"line",x:a.x+.1464*a.w,y:a.y+.8536*a.h}]}]}});lucid.plugin.initBlockClass({className:"UMLObjectBlock",
name:"Object",searchKeywords:["uml","object"],defaultSize:{w:160,h:80},variants:{UMLObjectBlockSeq:{searchKeywords:["uml","object","sequence"],defaultProperties:function(){return{Sequence:1,Text:'<span style="text-decoration:underline;">an Object</span>'}},defaultSize:{w:160,h:120},tooltip:"UML Object"}},onInit:function(b){lucid.plugin.registerProperty("Sequence",0);lucid.plugin.addBlockTextArea(b,{id:"Text",value:"UMLObject",getBoundingBox:function(c){return F(c,function(a){return{x:a.x+20,y:a.y,
w:a.w-40,h:a.h}},function(a){return{x:a.x,y:a.y,w:a.w,h:a.h,fitShape:lucid.plugin.getProperty(b,"InsetMargin")||0,hideOverflow:!0}})}});1<B()&&(lucid.plugin.registerProperty(b,"TextWrap","fit"),lucid.plugin.registerProperty(b,"InsetMargin",5))},allowPromptNextBlock:function(b){return!lucid.plugin.getProperty(b,"Sequence")},lineDrawnProperties:function(b,c){return lucid.plugin.getProperty(b,"Sequence")?{Endpoint2:{Style:"None"},StrokeStyle:"dashed"}:{}},getLinkPoints:function(){return[{x:.5,y:0},{x:.5,
y:1},{x:0,y:.5},{x:1,y:.5}]},getRenderDataKey:function(){return["FillColor","LineColor","LineWidth"]},getRenderData:function(b,c){var a=b.BoundingBox;return[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x,y:a.y},{Action:"line",x:a.x+a.w,y:a.y},{Action:"line",x:a.x+a.w,y:a.y+a.h},{Action:"line",x:a.x,y:a.y+a.h},{Action:"close"}]}]}});lucid.plugin.createNextBlockGroup("UMLStartBlock UMLStateBlock UMLStateBlockCmp UMLStateBlockExt UMLObjectBlock UMLDecisionBlock UMLHForkJoinBlock UMLVForkJoinBlock UMLFlowFinalBlock UMLEndBlock UMLHistoryStateBlock UMLSendSignalBlock UMLReceiveSignalBlock".split(" "));
lucid.plugin.initBlockClass({className:"UMLEntityBlock",name:"Entity",searchKeywords:["uml","entity"],defaultSize:{w:160,h:120},onInit:function(b){lucid.plugin.registerProperty("Sequence",0);lucid.plugin.addBlockTextArea(b,{id:"Text",value:"Entity",getBoundingBox:function(c){return F(c,function(a){return{x:a.x+20,y:a.y,w:a.w-40,h:a.h}},function(a){return{x:a.x,y:a.y,w:a.w,h:a.h,fitShape:lucid.plugin.getProperty(b,"InsetMargin")||0,hideOverflow:!0}})}});1<B()&&(lucid.plugin.registerProperty(b,"TextWrap",
"fit"),lucid.plugin.registerProperty(b,"InsetMargin",5))},getLinkPoints:function(){return[{x:.5,y:0},{x:.5,y:1},{x:0,y:.5},{x:1,y:.5}]},getRenderDataKey:function(){return["FillColor","LineColor","LineWidth"]},getRenderData:function(b,c){var a=b.BoundingBox;return[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x,y:a.y},{Action:"line",x:a.x+a.w,y:a.y},{Action:"line",x:a.x+a.w,y:a.y+a.h},{Action:"line",x:a.x,y:a.y+a.h},{Action:"close"}]}]}});lucid.plugin.initBlockClass({className:"UMLWeakEntityBlock",
name:"Weak Entity",searchKeywords:["uml","weak","entity"],defaultSize:{w:160,h:120},onInit:function(b){lucid.plugin.registerProperty("Sequence",0);lucid.plugin.addBlockTextArea(b,{id:"Text",value:"Weak Entity",getBoundingBox:function(c){return F(c,function(a){return{x:a.x+20,y:a.y,w:a.w-40,h:a.h}},function(a){return{x:a.x,y:a.y,w:a.w,h:a.h,fitShape:lucid.plugin.getProperty(b,"InsetMargin")||0,hideOverflow:!0}})}});1<B()&&(lucid.plugin.registerProperty(b,"TextWrap","fit"),lucid.plugin.registerProperty(b,
"InsetMargin",5))},getLinkPoints:function(){return[{x:.5,y:0},{x:.5,y:1},{x:0,y:.5},{x:1,y:.5}]},getRenderDataKey:function(){return["FillColor","LineColor","LineWidth"]},getRenderData:function(b,c){var a=b.BoundingBox,d=.05*Math.min(a.h,a.w);"sample"==c&&(d*=5);return[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x,y:a.y},{Action:"line",x:a.x+a.w,y:a.y},{Action:"line",x:a.x+a.w,y:a.y+a.h},{Action:"line",x:a.x,y:a.y+a.h},{Action:"close"}]},{FillColor:b.FillColor,
StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x+d,y:a.y+d},{Action:"line",x:a.x+a.w-d,y:a.y+d},{Action:"line",x:a.x+a.w-d,y:a.y+a.h-d},{Action:"line",x:a.x+d,y:a.y+a.h-d},{Action:"close"}]},{FillColor:null,StrokeColor:null,LineWidth:null,Actions:[{Action:"move",x:a.x+d,y:a.y+d},{Action:"line",x:a.x+a.w-d,y:a.y+d},{Action:"line",x:a.x+a.w-d,y:a.y+a.h-d},{Action:"line",x:a.x+d,y:a.y+a.h-d},{Action:"close"}]}]}});lucid.plugin.initBlockClass({className:"UMLAttributeBlock",
name:"Attribute",defaultSize:{w:160,h:120},searchKeywords:["uml","attribute","weak"],onInit:function(b){lucid.plugin.addBlockTextArea(b,{id:"Text",value:"Attribute",getBoundingBox:function(c){return F(c,function(a){return{x:a.x+.15*a.w,y:a.y+.2*a.h,w:.7*a.w,h:.6*a.h}},function(a){return{x:a.x,y:a.y,w:a.w,h:a.h,fitShape:lucid.plugin.getProperty(b,"InsetMargin")||0,hideOverflow:!0}})}});1<B()&&(lucid.plugin.registerProperty(b,"TextWrap","fit"),lucid.plugin.registerProperty(b,"InsetMargin",5))},getLinkPoints:function(b){return[{x:.5,
y:0},{x:.5,y:1},{x:0,y:.5},{x:1,y:.5}]},getRenderDataKey:function(){return["FillColor","LineColor","LineWidth"]},getRenderData:function(b,c){var a=b.BoundingBox;return[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x+a.w,y:a.y+a.h/2},{Action:"curve",Control:lucid.math.ellipseArcControlPoints(a.x,a.y,a.w,a.h,0,2*Math.PI)},{Action:"close"}]}]}});lucid.plugin.initBlockClass({className:"UMLMultivaluedAttributeBlock",name:"Multi Valued Attribute",defaultSize:{w:160,
h:120},searchKeywords:["uml","attribute","weak"],onInit:function(b){lucid.plugin.addBlockTextArea(b,{id:"Text",value:"Multivalued Attribute",getBoundingBox:function(c){return F(c,function(a){return{x:a.x+.15*a.w,y:a.y+.2*a.h,w:.7*a.w,h:.6*a.h}},function(a){return{x:a.x,y:a.y,w:a.w,h:a.h,fitShape:lucid.plugin.getProperty(b,"InsetMargin")||0,hideOverflow:!0}})}});1<B()&&(lucid.plugin.registerProperty(b,"TextWrap","fit"),lucid.plugin.registerProperty(b,"InsetMargin",5))},getLinkPoints:function(b){return[{x:.5,
y:0},{x:.5,y:1},{x:0,y:.5},{x:1,y:.5}]},getRenderDataKey:function(){return["FillColor","LineColor","LineWidth"]},getRenderData:function(b,c){var a=b.BoundingBox,d=.05*Math.min(a.h,a.w);"sample"==c&&(d*=5);return[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x+a.w,y:a.y+a.h/2},{Action:"curve",Control:lucid.math.ellipseArcControlPoints(a.x,a.y,a.w,a.h,0,2*Math.PI)},{Action:"close"}]},{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,
Actions:[{Action:"move",x:a.x+a.w-d,y:a.y+a.h/2},{Action:"curve",Control:lucid.math.ellipseArcControlPoints(a.x+d,a.y+d,a.w-2*d,a.h-2*d,0,2*Math.PI)},{Action:"close"}]},{FillColor:null,StrokeColor:null,LineWidth:null,Actions:[{Action:"move",x:a.x+a.w-d,y:a.y+a.h/2},{Action:"curve",Control:lucid.math.ellipseArcControlPoints(a.x+d,a.y+d,a.w-2*d,a.h-2*d,0,2*Math.PI)},{Action:"close"}]}]}});lucid.plugin.initBlockClass({className:"UMLRelationshipBlock",name:"Relationship",searchKeywords:["uml","entity",
"relationship"],defaultSize:{w:160,h:140},onInit:function(b){lucid.plugin.addBlockTextArea(b,{id:"Text",value:"Relationship",getBoundingBox:function(c){return F(c,function(a){return{x:a.x+.25*a.w,y:a.y+.25*a.h,w:.5*a.w,h:.5*a.h}},function(a){return{x:a.x,y:a.y,w:a.w,h:a.h,fitShape:lucid.plugin.getProperty(b,"InsetMargin")||0,hideOverflow:!0}})}});1<B()&&(lucid.plugin.registerProperty(b,"TextWrap","fit"),lucid.plugin.registerProperty(b,"InsetMargin",5))},getLinkPoints:function(){return[{x:.5,y:0},
{x:.5,y:1},{x:0,y:.5},{x:1,y:.5}]},getRenderDataKey:function(){return["FillColor","LineColor","LineWidth"]},getRenderData:function(b,c){var a=b.BoundingBox;return[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x+.5*a.w,y:a.y},{Action:"line",x:a.x+a.w,y:a.y+.5*a.h},{Action:"line",x:a.x+.5*a.w,y:a.y+a.h},{Action:"line",x:a.x,y:a.y+.5*a.h},{Action:"close"}]}]}});lucid.plugin.initBlockClass({className:"UMLWeakRelationshipBlock",name:"Weak Relationship",
searchKeywords:["uml","weak","entity","relationship"],defaultSize:{w:160,h:140},onInit:function(b){lucid.plugin.addBlockTextArea(b,{id:"Text",value:"Weak Relationship",getBoundingBox:function(c){return F(c,function(a){return{x:a.x+.25*a.w,y:a.y+.25*a.h,w:.5*a.w,h:.5*a.h}},function(a){return{x:a.x,y:a.y,w:a.w,h:a.h,fitShape:lucid.plugin.getProperty(b,"InsetMargin")||0,hideOverflow:!0}})}});1<B()&&(lucid.plugin.registerProperty(b,"TextWrap","fit"),lucid.plugin.registerProperty(b,"InsetMargin",5))},
getLinkPoints:function(){return[{x:.5,y:0},{x:.5,y:1},{x:0,y:.5},{x:1,y:.5}]},getRenderDataKey:function(){return["FillColor","LineColor","LineWidth"]},getRenderData:function(b,c){var a=b.BoundingBox,d=.05*a.w,h=.05*a.h;"sample"==c&&(d*=5,h*=5);return[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x+.5*a.w,y:a.y},{Action:"line",x:a.x+a.w,y:a.y+.5*a.h},{Action:"line",x:a.x+.5*a.w,y:a.y+a.h},{Action:"line",x:a.x,y:a.y+.5*a.h},{Action:"close"}]},{FillColor:b.FillColor,
StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x+.5*a.w,y:a.y+h},{Action:"line",x:a.x+a.w-d,y:a.y+.5*a.h},{Action:"line",x:a.x+.5*a.w,y:a.y+a.h-h},{Action:"line",x:a.x+d,y:a.y+.5*a.h},{Action:"close"}]},{FillColor:null,StrokeColor:null,LineWidth:null,Actions:[{Action:"move",x:a.x+.5*a.w,y:a.y+h},{Action:"line",x:a.x+a.w-d,y:a.y+.5*a.h},{Action:"line",x:a.x+.5*a.w,y:a.y+a.h-h},{Action:"line",x:a.x+d,y:a.y+.5*a.h},{Action:"close"}]}]}});lucid.plugin.createNextBlockGroup("UMLEntityBlock UMLWeakEntityBlock UMLAttributeBlock UMLMultivaluedAttributeBlock UMLRelationshipBlock UMLWeakRelationshipBlock".split(" "));
lucid.plugin.initBlockClass({className:"UMLDeletionBlock",name:"Deletion",searchKeywords:["uml","deletion","delete"],defaultSize:{w:80,h:80},onInit:function(b){},getLinkPoints:function(){return[{x:0,y:.5},{x:.5,y:0},{x:1,y:.5},{x:.5,y:1}]},disabledPropertyControls:["FillColor"],getRenderDataKey:function(){return["LineColor","LineWidth"]},getRenderData:function(b,c){var a=b.BoundingBox,d=8;"sample"==c&&(a={x:Math.round(a.x+.25*a.w),y:Math.round(a.y+.25*a.h),w:Math.round(.5*a.w),h:Math.round(.5*a.h)},
d=2);return[{Actions:[{Action:"move",x:a.x,y:a.y},{Action:"line",x:a.x+a.w,y:a.y},{Action:"line",x:a.x+a.w,y:a.y+a.h},{Action:"line",x:a.x,y:a.y+a.h},{Action:"close"}]},{StrokeColor:b.LineColor,LineWidth:d,Actions:[{Action:"move",x:a.x+.1*a.w,y:a.y+.1*a.h},{Action:"line",x:a.x+.9*a.w,y:a.y+.9*a.h},{Action:"move",x:a.x+.9*a.w,y:a.y+.1*a.h},{Action:"line",x:a.x+.1*a.w,y:a.y+.9*a.h}]}]}});lucid.plugin.initBlockClass({className:"UMLActivationBlock",name:"Activation",searchKeywords:["uml","activation",
"activate","active"],defaultSize:{w:40,h:120},vLock:!0,hLock:!0,rLock:!0,onInit:function(b){lucid.plugin.setProperty(b,"DisableAutoLink",!0)},getLinkPoints:function(){return[]},lineDrawnProperties:function(b,c){return{TextAreas:{Message:{Location:.5,Side:-1,Value:"Message"}}}},lineDrawn:function(b,c,a,d){d&&lucid.plugin.editLineTextArea(c,"Message")},spatialControls:function(b){function c(a,c){function e(e,n){var p=lucid.plugin.getProperty(e,n);if(p&&p.Block==b){p.LinkY=(p.LinkY*l.h-a)/(l.h+c);if(0>
p.LinkY||1<p.LinkY)p.LinkX=null,p.LinkY=null,p.Block=null;g[e][n]=p}}var g={},l=lucid.plugin.getProperty(b,"BoundingBox");g[b]={BoundingBox:{x:l.x,y:l.y+a,w:l.w,h:l.h+c}};for(var n=lucid.plugin.getConnectedLines(b),p=0;p<n.length;p++)g[n[p]]={},e(n[p],"Endpoint1"),e(n[p],"Endpoint2");return g}function a(a){return{logAction:"chart.viewport.selection.spatialControls.uml.activation",location:function(){var c=lucid.plugin.getProperty(b,"BoundingBox");return{x:c.x+c.w/2-5,y:c.y+(a?0:c.h)-5,w:10,h:10}},
moved:function(h){var e=lucid.plugin.getProperty(b,"BoundingBox");h=a?e.y-h.y:h.y-(e.y+e.h);h=a?c(-h,h):c(0,h);for(var g in h)for(var l in h[g])lucid.plugin.setProperty(g,l,h[g][l])},path:function(){var a=lucid.plugin.getProperty(b,"BoundingBox");return[{x:a.x+a.w/2,y:1E8},{x:a.x+a.w/2,y:-1E8}]},cursor:function(){return a?"n-resize":"s-resize"},snap:1}}return[a(!0),a(!1)]},getRenderDataKey:function(){return["FillColor","LineColor","LineWidth"]},getRenderData:function(b,c){var a=b.BoundingBox;return[{FillColor:b.FillColor,
StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x,y:a.y},{Action:"line",x:a.x+a.w,y:a.y},{Action:"line",x:a.x+a.w,y:a.y+a.h},{Action:"line",x:a.x,y:a.y+a.h},{Action:"close"}]}]}});lucid.plugin.initBlockClass({className:"UMLNodeBlock",name:"Node",searchKeywords:["uml","node","component"],defaultSize:{w:360,h:360},variants:{UMLNodeDeployment:{searchKeywords:["uml","object","deployment"],defaultProperties:function(){return{Title:'<span style="font-weight:bold;">Node</span>'}},
tooltip:"UML Node"},UMLNodeDeploymentInstance:{searchKeywords:["uml","object","deployment"],defaultProperties:function(){return{Title:'<span style="text-decoration:underline;">Node Instance</span>'}},tooltip:"UML Node Instance"}},onInit:function(b){lucid.plugin.registerProperty("TitleHeight",26);lucid.plugin.setProperty("TextAlign","left");lucid.plugin.setProperty(b,"DisableAutoLink",!0);lucid.plugin.addBlockTextArea(b,{id:"Title",value:"Node",getBoundingBox:function(b){return{x:b.x+8,y:b.y+.1*b.h+
8,w:.7*b.w,h:26}}})},getLinkPoints:function(){return[{x:0,y:.25},{x:0,y:.5},{x:0,y:.75},{x:.25,y:1},{x:.5,y:1},{x:.75,y:1},{x:1,y:.75},{x:1,y:.5},{x:1,y:.25},{x:.75,y:0},{x:.5,y:0},{x:.25,y:0}]},afterEditText:function(b){var c=lucid.text.getSize(b,"Title")+8;lucid.plugin.setProperty(b,"TitleHeight",c)},lineDrawnProperties:function(b,c){return{TextAreas:{Connection:{Location:.5,Side:0,Value:"Connection"}}}},lineDrawn:function(b,c,a,d){d&&lucid.plugin.editLineTextArea(c,"Connection")},getRenderDataKey:function(){return["FillColor",
"LineColor","LineWidth"]},getRenderData:function(b,c){var a=b.BoundingBox,d=.1*(a.w<a.h?a.w:a.h);return[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x,y:a.y+d},{Action:"line",x:a.x+1.2*d,y:a.y},{Action:"line",x:a.x+a.w,y:a.y},{Action:"line",x:a.x+a.w,y:a.y+a.h-1.2*d},{Action:"line",x:a.x+a.w-d,y:a.y+a.h},{Action:"line",x:a.x,y:a.y+a.h},{Action:"close"}]},{FillColor:lucid.color.darken(b.FillColor,.1),StrokeColor:b.LineColor,LineWidth:b.LineWidth,
Actions:[{Action:"move",x:a.x,y:a.y+d},{Action:"line",x:a.x+1.2*d,y:a.y},{Action:"line",x:a.x+a.w,y:a.y},{Action:"line",x:a.x+a.w-d,y:a.y+d},{Action:"close"}]},{FillColor:lucid.color.darken(b.FillColor,.2),StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x+a.w-d,y:a.y+d},{Action:"line",x:a.x+a.w,y:a.y},{Action:"line",x:a.x+a.w,y:a.y+a.h-1.2*d},{Action:"line",x:a.x+a.w-d,y:a.y+a.h},{Action:"close"}]}]}});lucid.plugin.initBlockClass({className:"UMLComponentBlock",name:"Component",
searchKeywords:["uml","component"],defaultSize:{w:160,h:120},onInit:function(b){lucid.plugin.addBlockTextArea(b,{id:"Title",value:"Component",getBoundingBox:function(b){return{x:b.x+.2*b.w,y:b.y+.1*b.h,w:.7*b.w,h:.8*b.h}}})},variants:{UMLComponentDeployment:{searchKeywords:["uml","object","deployment","component"],defaultProperties:function(){return{Title:'<span style="font-weight:bold;">Component</span>'}},tooltip:"UML Node"},UMLComponentDeploymentInstance:{searchKeywords:["uml","object","deployment",
"component"],defaultProperties:function(){return{Title:'<span style="text-decoration:underline;">Component Instance</span>'}},tooltip:"UML Node Instance"}},getLinkPoints:function(){return[{x:0,y:.25},{x:0,y:.75},{x:.25,y:1},{x:.5,y:1},{x:.75,y:1},{x:1,y:.75},{x:1,y:.5},{x:1,y:.25},{x:.75,y:0},{x:.5,y:0},{x:.25,y:0}]},getRenderDataKey:function(){return["FillColor","LineColor","LineWidth"]},getRenderData:function(b,c){var a=b.BoundingBox,d=40,h=20;"sample"==c&&(h*=a.h/120,d=2*h);return[{FillColor:b.FillColor,
StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x+.5*d,y:a.y},{Action:"line",x:a.x+a.w,y:a.y},{Action:"line",x:a.x+a.w,y:a.y+a.h},{Action:"line",x:a.x+.5*d,y:a.y+a.h},{Action:"close"}]},{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x,y:a.y+.25*a.h-.5*h},{Action:"line",x:a.x+d,y:a.y+.25*a.h-.5*h},{Action:"line",x:a.x+d,y:a.y+.25*a.h+.5*h},{Action:"line",x:a.x,y:a.y+.25*a.h+.5*h},{Action:"close"}]},{FillColor:b.FillColor,StrokeColor:b.LineColor,
LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x,y:a.y+.75*a.h-.5*h},{Action:"line",x:a.x+d,y:a.y+.75*a.h-.5*h},{Action:"line",x:a.x+d,y:a.y+.75*a.h+.5*h},{Action:"line",x:a.x,y:a.y+.75*a.h+.5*h},{Action:"close"}]}]}});lucid.plugin.initBlockClass({className:"UMLComponentBoxBlock",name:"Component Box",searchKeywords:["uml","component","box"],defaultSize:{w:160,h:120},onInit:function(b){lucid.plugin.addBlockTextArea(b,{id:"Title",value:"Component Box",getBoundingBox:function(c){return F(c,function(a){return{x:a.x+
20,y:a.y,w:a.w-40,h:a.h}},function(a){return{x:a.x,y:a.y,w:a.w,h:a.h,fitShape:lucid.plugin.getProperty(b,"InsetMargin")||0,hideOverflow:!0}})}});1<B()&&(lucid.plugin.registerProperty(b,"TextWrap","fit"),lucid.plugin.registerProperty(b,"InsetMargin",5))},getLinkPoints:function(){return[{x:0,y:.25},{x:0,y:.5},{x:0,y:.75},{x:.25,y:1},{x:.5,y:1},{x:.75,y:1},{x:1,y:.75},{x:1,y:.5},{x:1,y:.25},{x:.75,y:0},{x:.5,y:0},{x:.25,y:0}]},getRenderData:function(b,c){var a=b.BoundingBox;if("sample"==c)var d=5,h=
1;else d=20,h=10;var e=a.y+h,h=a.x+a.w-h,g=h-d/2;return[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[r(a,0,0),v(a,0,1),v(a,1,1),v(a,1,0),E()]},{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:1,NoRounding:!0,Actions:[G(h,e),y(h-3*d/4,e),y(h-3*d/4,e+d),y(h,e+d),E()]},{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:1,NoRounding:!0,Actions:[G(g,e+d/6),y(g-d/2,e+d/6),y(g-d/2,e+d/3),y(g,e+d/3),E(),G(g,e+2*d/3),y(g-d/2,e+2*d/3),y(g-d/2,e+5*d/6),y(g,e+5*
d/6),E()]}]}});lucid.plugin.initBlockClass({className:"UMLComponentInterfaceBlock",name:"Start",searchKeywords:["uml","interface","component"],defaultSize:{w:40,h:40},onInit:function(b){},getLinkPoints:function(){return[{x:.5,y:0},{x:.5,y:1},{x:0,y:.5},{x:1,y:.5}]},getRenderDataKey:function(){return["FillColor","LineColor","LineWidth"]},getRenderData:function(b,c){var a=b.BoundingBox;"sample"==c&&(a={x:Math.round(a.x+.25*a.w),y:Math.round(a.y+.25*a.h),w:Math.round(.5*a.w),h:Math.round(.5*a.h)});return[{FillColor:b.FillColor,
StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x+a.w,y:a.y+a.h/2},{Action:"curve",Control:lucid.math.ellipseArcControlPoints(a.x,a.y,a.w,a.h,0,2*Math.PI)},{Action:"close"}]}]}});lucid.plugin.initBlockClass({className:"UMLAssemblyConnectorBlock",name:"Assembly",searchKeywords:["uml","assembly","connector"],defaultSize:{w:50,h:40},onInit:function(b){},getLinkPoints:function(){return[{x:0,y:.5},{x:1,y:.5}]},getRenderData:function(b,c){var a=b.BoundingBox;return[{StrokeColor:b.LineColor,
LineWidth:b.LineWidth,Actions:[r(a,0,.5),v(a,.5-.35*.8,.5),r(a,.5,1),U(a,.1,0,.8,1,.5,-.5),r(a,.9,.5),v(a,1,.5)]},{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[r(a,.5,.15),U(a,.5-.35*.8,.15,.7*.8,.7,-.5,1.5),E()]},{Actions:[r(a,.5,1),U(a,.1,0,.8,1,.5,-1.5),E()]}]}});lucid.plugin.initBlockClass({className:"UMLProvidedInterfaceBlock",name:"Provided Interface",searchKeywords:["uml","interface","provided"],defaultSize:{w:50,h:40},getLinkPoints:function(){return[{x:0,y:.5}]},
getRenderData:function(b,c){var a=b.BoundingBox;return[{StrokeColor:b.LineColor,LineWidth:b.LineWidth,FillColor:b.FillColor,Actions:[r(a,0,.5),v(a,.2,.5),r(a,1,.5),U(a,.2,0,.8,1,0,2),E()]}]}});lucid.plugin.initBlockClass({className:"UMLRequiredInterfaceBlock",name:"Required Interface",searchKeywords:["uml","interface","required"],defaultSize:{w:30,h:40},getLinkPoints:function(){return[{x:1,y:.5}]},getRenderData:function(b,c){var a=b.BoundingBox;return[{StrokeColor:b.LineColor,LineWidth:b.LineWidth,
Actions:[r(a,2/3,.5),v(a,1,.5),r(a,0,0),U(a,-2/3,0,4/3,1,-.5,.5)]},{Actions:[r(a,0,0),U(a,-2/3,0,4/3,1,-.5,.5),E()]}]}});lucid.plugin.initBlockClass({className:"UMLAcceptTimeEventActionBlock",name:"Accept Time Event Action",searchKeywords:["uml","time","event","action"],defaultSize:{w:40,h:60},onInit:function(b){lucid.plugin.addBlockTextArea(b,{id:"Title",value:"Frequency",getBoundingBox:function(b,a){return{x:b.x-b.w,y:b.y+b.h+5,w:3*b.w,h:30}}})},getLinkPoints:function(){return[{x:.5,y:.5}]},getRenderData:function(b,
c){var a=b.BoundingBox;return[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[r(a,0,0),v(a,1,0),v(a,0,1),v(a,1,1),E()]}]}});lucid.plugin.initBlockClass({className:"UMLInterruptingEdgeBlock",name:"Interrupting Edge",searchKeywords:["uml","interrupt","edge"],defaultSize:{w:40,h:20},getLinkPoints:function(){return[]},disabledPropertyControls:["FillColor"],getRenderDataKey:function(){return["LineColor","LineWidth"]},getRenderData:function(b,c){var a=b.BoundingBox;return[{StrokeColor:b.LineColor,
LineWidth:b.LineWidth,Actions:[r(a,0,0),v(a,1,0),v(a,0,.9),v(a,1,.9)]},{StrokeColor:b.LineColor,LineWidth:b.LineWidth,NoRounding:!0,Actions:[r(a,.9,.8),v(a,1,.9),v(a,.9,1)]},{Actions:[r(a,0,0),v(a,1,0),v(a,1,1),v(a,0,1),E()]}]}});lucid.plugin.initBlockClass({className:"UMLOffPageLinkBlock",name:"Off-Page Link",searchKeywords:["uml","offpage","off","page","link"],defaultSize:{w:120,h:120},defaultText:"Off-Page Link",onInit:function(b){lucid.plugin.addBlockTextArea(b,{id:"Text",value:"Off-Page Link",
getBoundingBox:function(c){return F(c,function(a){return{x:a.x+10,y:a.y,w:a.w-20,h:.8*a.h}},function(a){return{x:a.x,y:a.y,w:a.w,h:a.h,fitShape:lucid.plugin.getProperty(b,"InsetMargin")||0,hideOverflow:!0}})}});1<B()&&(lucid.plugin.registerProperty(b,"TextWrap","fit"),lucid.plugin.registerProperty(b,"InsetMargin",5))},getLinkPoints:function(){return[{x:.5,y:0},{x:.5,y:1},{x:0,y:.5},{x:1,y:.5}]},onCreate:function(b){lucid.plugin.selectBlockLink(b)},getRenderData:function(b,c){var a=b.BoundingBox;return[{FillColor:b.FillColor,
StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x,y:a.y},{Action:"line",x:a.x+a.w,y:a.y},{Action:"line",x:a.x+a.w,y:a.y+.6*a.h},{Action:"line",x:a.x+a.w/2,y:a.y+a.h},{Action:"line",x:a.x,y:a.y+.6*a.h},{Action:"close"}]}]}});lucid.plugin.initBlockClass({className:"UMLExpansionNodeBlock",name:"Expansion Node",searchKeywords:["uml","expansion","node"],defaultSize:{w:80,h:20},getLinkPoints:function(){return[{x:.5,y:0},{x:.5,y:1},{x:0,y:.5},{x:1,y:.5}]},getRenderData:function(b,
c){var a=b.BoundingBox;return[{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[r(a,0,0),v(a,1,0),v(a,1,1),v(a,0,1),E()]},{FillColor:b.FillColor,StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[r(a,.25,0),v(a,.25,1),r(a,.5,0),v(a,.5,1),r(a,.75,0),v(a,.75,1)]}]}});lucid.plugin.initBlockClass(function(){return{className:"UMLMultidimensionalSwimlane",container:!0,name:"Multidimensional Swim Lane",searchKeywords:["uml","container","swimlane","multidimensional","lane"],
defaultSize:{w:1140,h:840},rLock:!0,vLock:!0,hLock:!0,onInit:function(b){var c=function(c){return function(h,e){if(h!=e){var g=lucid.plugin.getBlockTextAreas(b);e.forEach(function(b){lucid.array.contains(g,c+"_"+b.id)||a(b.id,c,c)});if(h){var l=h.map(function(a){return a.id}),n=e.map(function(a){return a.id});l.forEach(function(a){lucid.array.contains(n,a)||(lucid.plugin.setProperty(b,c+"_"+a,c),lucid.plugin.deleteBlockTextArea(b,c+"_"+a))})}var l=lucid.plugin.getProperty(b,"Rows"),p=lucid.plugin.getProperty(b,
"Columns");if(l&&p){for(var l=l.length,p=p.length,z=[],t=0;t<p;t++)z.push("Column_"+t);for(t=0;t<l;t++)z.push("Row_"+t);lucid.plugin.setBlockTextAreasOrder(b,z)}}}},a=function(a,c,e){lucid.plugin.addBlockTextArea(b,{id:c+"_"+a,rotation:"Row"==e?-Math.PI/2:0,value:c,getBoundingBox:function(c){var h=lucid.plugin.getProperty(b,"BoundingBox"),g=lucid.plugin.getProperty(b,"TitleHeight"),p=lucid.plugin.getProperty(b,"TitleWidth");if("Row"==e){c=lucid.plugin.getProperty(b,"Rows");for(var z=null,g=h.y+g,
t=0;t<c.length;t++){if(c[t].id==a){z=c[t];break}g+=c[t].height}return z?{x:h.x+p/2-z.height/2,y:g+z.height/2-p/2,w:z.height,h:p}:null}h=lucid.plugin.getProperty(b,"Columns");z=null;p=c.x+p;for(t=0;t<h.length;t++){if(h[t].id==a){z=h[t];break}p+=h[t].width}return z?{x:p,y:c.y,w:z.width,h:g}:null}})};lucid.plugin.getProperty(b,"BoundingBox");lucid.plugin.registerProperty(b,"Rows",[{id:0,height:400},{id:1,height:400}],null,c("Row"));lucid.plugin.registerProperty(b,"Columns",[{id:0,width:550},{id:1,width:550}],
null,c("Column"));lucid.plugin.registerProperty(b,"TitleHeight",40);lucid.plugin.registerProperty(b,"TitleWidth",40);lucid.plugin.registerProxyProperty(b,"RowCount",function(){return lucid.plugin.getProperty(b,"Rows").length},qb.bind(null,b));lucid.plugin.registerProxyProperty(b,"ColumnCount",function(){return lucid.plugin.getProperty(b,"Columns").length},Na.bind(null,b));lucid.plugin.hookPropertyPostSave(b,"Rows",function(){lucid.plugin.proxyPropertyChanged(b,"RowCount")});lucid.plugin.hookPropertyPostSave(b,
"Columns",function(){lucid.plugin.proxyPropertyChanged(b,"ColumnCount")})},getLinkPoints:function(b){return[]},getRenderData:function(b,c){var a=b.BoundingBox,d=b.Rows,h=b.Columns,e=b.TitleHeight,g=b.TitleWidth;"preview"==c&&(d.forEach(function(b){b.height=(a.h-e)/d.length}),h.forEach(function(b){b.width=(a.w-g)/h.length}),lucid.plugin.setProperty(b.id,"Rows",d),lucid.plugin.setProperty(b.id,"Columns",h));if("sample"==c){var l=function(a){return{StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:a}};
return[l([{Action:"move",x:a.x,y:a.y},{Action:"line",x:a.x,y:a.y+a.h},{Action:"line",x:a.x+a.w,y:a.y+a.h},{Action:"line",x:a.x+a.w,y:a.y},{Action:"close"}]),l([{Action:"move",x:a.x,y:a.y+.2*a.h},{Action:"line",x:a.x+a.w,y:a.y+.2*a.h}]),l([{Action:"move",x:a.x+.2*a.w,y:a.y},{Action:"line",x:a.x+.2*a.w,y:a.y+a.h}]),l([{Action:"move",x:a.x+.6*a.w,y:a.y},{Action:"line",x:a.x+.6*a.w,y:a.y+a.h}]),l([{Action:"move",x:a.x,y:a.y+.6*a.h},{Action:"line",x:a.x+a.w,y:a.y+.6*a.h}])]}var n=[{LineWidth:b.LineWidth,
FillColor:b.FillColor,Actions:[{Action:"move",x:a.x+g,y:a.y+e},{Action:"line",x:a.x,y:a.y+e},{Action:"line",x:a.x,y:a.y+a.h},{Action:"line",x:a.x+g,y:a.y+a.h},{Action:"close"}]},{StrokeColor:b.LineColor,LineWidth:b.LineWidth,NoRounding:!0,Actions:[{Action:"move",x:a.x+g,y:a.y+e},{Action:"line",x:a.x+g,y:a.y+a.h}]},{FillColor:b.FillColor,Actions:[{Action:"move",x:a.x+g,y:a.y+e},{Action:"line",x:a.x+g,y:a.y},{Action:"line",x:a.x+a.w,y:a.y},{Action:"line",x:a.x+a.w,y:a.y+e},{Action:"close"}]},{StrokeColor:b.LineColor,
LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x+g,y:a.y+e},{Action:"line",x:a.x+a.w,y:a.y+e}]},{StrokeColor:b.LineColor,LineWidth:b.LineWidth,Actions:[{Action:"move",x:a.x+g,y:a.y+e},{Action:"line",x:a.x+g,y:a.y},{Action:"line",x:a.x+a.w,y:a.y},{Action:"line",x:a.x+a.w,y:a.y+a.h},{Action:"line",x:a.x,y:a.y+a.h},{Action:"line",x:a.x,y:a.y+e},{Action:"line",x:a.x+g,y:a.y+e}]}],p=a.y+e;d.slice(0,-1).forEach(function(c){n.push({LineWidth:b.LineWidth,StrokeColor:b.LineColor,Actions:[{Action:"move",
x:a.x,y:p+c.height},{Action:"line",x:a.x+a.w,y:p+c.height}]});p+=c.height});var z=a.x+g;h.slice(0,-1).forEach(function(c){n.push({LineWidth:b.LineWidth,StrokeColor:b.LineColor,Actions:[{Action:"move",x:z+c.width,y:a.y},{Action:"line",x:z+c.width,y:a.y+a.h}]});z+=c.width});return n},spatialControls:function(b){for(var c=function(){var a=lucid.plugin.getProperty(b,"Rows"),c=lucid.plugin.getProperty(b,"Columns"),d=lucid.plugin.getProperty(b,"BoundingBox"),e=lucid.plugin.getProperty(b,"TitleHeight"),
h=lucid.plugin.getProperty(b,"TitleWidth"),a=e+a.reduce(function(a,b){return a+b.height},0),c=h+c.reduce(function(a,b){return a+b.width},0);if(d.w!=c||d.h!=a)d.w=c,d.h=a,lucid.plugin.setProperty(b,"BoundingBox",d)},a=function(a){var d=lucid.plugin.getProperty(b,"BoundingBox"),e=lucid.plugin.getProperty(b,"TitleHeight"),h=lucid.plugin.getProperty(b,"Rows"),g=h.slice(0,a).reduce(function(a,b){return a+b.height},d.y+e),m=g+h[a].height;return{logAction:"chart.viewport.selection.spatialControls.uml.multidimensionalSwimlaneWidth",
snap:!0,color:"none",location:function(){var a=lucid.plugin.getProperty(b,"TitleWidth");return{x:d.x+a,y:m-10,w:d.w-a,h:20}},moved:function(d){var e=lucid.object.copy(h);e[a].height=d.y-g;d=lucid.plugin.getContained(b);var n=e[a].height-h[a].height;if(0!=n)for(var p=0;p<d.length;p++){var r=lucid.plugin.getProperty(d[p],"BoundingBox");r&&r.y>m&&(r.y+=n,lucid.plugin.setProperty(d[p],"BoundingBox",r))}lucid.plugin.setProperty(b,"Rows",e);c()},path:function(){return[{x:d.x,y:g+20},{x:d.x,y:m+1E3}]},cursor:function(){return"s-resize"}}},
d=function(a){var d=lucid.plugin.getProperty(b,"BoundingBox"),e=lucid.plugin.getProperty(b,"TitleWidth"),h=lucid.plugin.getProperty(b,"Columns"),g=h.slice(0,a).reduce(function(a,b){return a+b.width},d.x+e),m=g+h[a].width;return{logAction:"chart.viewport.selection.spatialControls.uml.multidimensionalSwimlaneWidth",snap:!0,color:"none",location:function(){var a=lucid.plugin.getProperty(b,"TitleHeight");return{x:m-10,y:d.y+a,w:20,h:d.h-a}},moved:function(d){var e=lucid.object.copy(h);e[a].width=d.x-
g;d=lucid.plugin.getContained(b);var n=e[a].width-h[a].width;if(0!=n)for(var p=0;p<d.length;p++){var r=lucid.plugin.getProperty(d[p],"BoundingBox");r&&r.x>m&&(r.x+=n,lucid.plugin.setProperty(d[p],"BoundingBox",r))}lucid.plugin.setProperty(b,"Columns",e);c()},path:function(){return[{x:g+20,y:d.y},{x:m+1E3,y:d.y}]},cursor:function(){return"e-resize"}}},h=[],e=lucid.plugin.getProperty(b,"Rows").length,g=0;g<e;g++)h.push(a(g));a=lucid.plugin.getProperty(b,"Columns").length;for(g=0;g<a;g++)h.push(d(g));
h.push({logAction:"chart.viewport.selection.spatialControls.uml.multidimensionalSwimlaneColumnHeader",snap:!0,color:"none",location:function(){var a=lucid.plugin.getProperty(b,"BoundingBox"),c=lucid.plugin.getProperty(b,"TitleHeight"),d=lucid.plugin.getProperty(b,"TitleWidth");return{x:a.x+d,y:a.y+c-10,w:a.w-d,h:20}},moved:function(a){var d=lucid.plugin.getProperty(b,"BoundingBox"),e=lucid.plugin.getProperty(b,"TitleHeight"),d=a.y-d.y;lucid.plugin.setProperty(b,"TitleHeight",d);a=lucid.plugin.getContained(b);
e=d-e;if(0!=e)for(d=0;d<a.length;d++){var h=lucid.plugin.getProperty(a[d],"BoundingBox");h&&(h.y+=e,lucid.plugin.setProperty(a[d],"BoundingBox",h))}c()},path:function(){var a=lucid.plugin.getProperty(b,"BoundingBox");return[{x:a.x,y:a.y+20},{x:a.x,y:a.y+1E3}]},cursor:function(){return"s-resize"}});h.push({logAction:"chart.viewport.selection.spatialControls.uml.multidimensionalSwimlaneRowHeader",snap:!0,color:"none",location:function(){var a=lucid.plugin.getProperty(b,"BoundingBox"),c=lucid.plugin.getProperty(b,
"TitleHeight"),d=lucid.plugin.getProperty(b,"TitleWidth");return{x:a.x+d-10,y:a.y+c,w:20,h:a.h-c}},moved:function(a){var d=lucid.plugin.getProperty(b,"BoundingBox"),e=lucid.plugin.getProperty(b,"TitleWidth"),d=a.x-d.x;lucid.plugin.setProperty(b,"TitleWidth",d);a=lucid.plugin.getContained(b);e=d-e;if(0!=e)for(d=0;d<a.length;d++){var h=lucid.plugin.getProperty(a[d],"BoundingBox");h&&(h.x+=e,lucid.plugin.setProperty(a[d],"BoundingBox",h))}c()},path:function(){var a=lucid.plugin.getProperty(b,"BoundingBox");
return[{x:a.x+20,y:a.y},{x:a.x+1E3,y:a.y}]},cursor:function(){return"e-resize"}});return h}}}());lucid.plugin.registerStepperControl("UMLMultidimensionalSwimlane","RowCount",function(){return 1},function(){return 1},function(){return 50});lucid.plugin.registerStepperControl("UMLMultidimensionalSwimlane","ColumnCount",function(){return 1},function(){return 1},function(){return 50});lucid.plugin.createNextBlockGroup(["UMLSeqEntityBlock","UMLBoundaryBlock","UMLControlBlock"]);lucid.plugin.createNextBlockGroup(["UMLComponentBlock",
"UMLComponentInterfaceBlock"]);lucid.plugin.initBlockClass(rb());lucid.plugin.initBlockClass(rb(!0));lucid.plugin.addContextMenuItems(function(){var b=function(a,b,c){if(!a||1!=a.length)return!1;void 0===c&&(c=1);var d=lucid.plugin.getBlockClassName(a[0]),e=lucid.plugin.getProperty(a[0],"Lanes");return d&&-1<d.toLowerCase().indexOf("umlmultilane")&&e&&e.length>=c&&(b?!lucid.plugin.getProperty(a[0],"Vertical"):!!lucid.plugin.getProperty(a[0],"Vertical"))},c=function(a,b){var c=b.Lanes,d=b.BoundingBox,
e=b.Rotation,h=d.w,g=d.x;if(e)for(a=lucid.math.Point.rotate(a,lucid.math.Box.center(d),-e),e=c.length-1;0<=e;e--){d=h*c[e].p;if(a.x>g&&a.x<g+d)break;g+=d}else for(e=0;e<c.length;e++){d=h*c[e].p;if(a.x>g&&a.x<g+d)break;g+=d}return e},a=function(a,b,c){for(var d=b.BoundingBox,e={x:d.x,y:d.y,w:d.w*b.Lanes[a].p,h:d.h},h=0;h<a;h++)e.x+=d.w*b.Lanes[h].p;c&&(e.w=d.w-(e.x-d.x));return e},d=function(b,c,d,e){var h=d.Lanes,g=d.BoundingBox,m=[],r=lucid.math.Box.rotate(g,d.Rotation||0),v={x:r.x+r.w/2,y:r.y+r.h/
2};if(b>h.length)return m;var x=a(b,d,e);d.Vertical||(x.x+=2*(g.x+g.w/2-(x.x+x.w/2)));lucid.array.forEach(c,function(a){var b=lucid.plugin.getProperty(a,"BoundingBox");if(b){var c=lucid.plugin.getProperty(a,"Rotation")||0,b=lucid.math.Box.rotate(b,c);d.Vertical||(b=lucid.math.Box.rotate(b,Math.PI/2,v));lucid.math.Box.within(b,x)&&m.push(a)}});return m},h=function(a,b,c,d){for(a=0;a<c.length;a++){var e=lucid.plugin.getProperty(c[a],"BoundingBox");e&&(d.Vertical?e.x+=b:e.y+=b,lucid.plugin.setProperty(c[a],
"BoundingBox",e))}},e=function(b,c,e,g){var m=g.Lanes;if(c>e){var r=c;c=e;e=r}var w=lucid.plugin.getContained(b),r=d(c,w,g),w=d(e,w,g),v=a(c,g),y=a(e,g);h(b,y.w,r,g);h(b,-v.w,w,g);c<m.length&&e<m.length&&(r=m[c],m[c]=m[e],m[e]=r);lucid.plugin.setProperty(b,"Lanes",m)},g=function(a,b,d){if(1==b.length&&b[0]){var h=lucid.plugin.getAllProperties(b[0]),g=h.Lanes.length-1;h.Vertical?(a=c(a,h),"r"===d&&a<g?e(b[0],a,a+1,h):"l"===d&&0<a&&e(b[0],a,a-1,h)):(a=c(a,h),"u"===d&&0<a?e(b[0],a,a-1,h):"d"===d&&a<
g&&e(b[0],a,a+1,h))}};return[{external:!0,label:"Insert Lane Before",logAction:"chart.viewport.context.uml.multiswimlane.insertLaneBefore",action:function(a,b){if(1==b.length&&b[0]){var d=lucid.plugin.getAllProperties(b[0]);50>d.Lanes.length&&(d=c(a,d),plugin.common.Swimlane.updateLanes("add",b[0],d,!0,!0))}},visible:function(a){return(b(a,!1,1)||b(a,!0,1))&&50>lucid.plugin.getProperty(a[0],"Lanes").length}},{external:!0,label:"Insert Lane After",logAction:"chart.viewport.context.uml.multiswimlane.insertLaneAfter",
action:function(a,b){if(1==b.length&&b[0]){var d=lucid.plugin.getAllProperties(b[0]);50>d.Lanes.length&&(d=c(a,d),plugin.common.Swimlane.updateLanes("add",b[0],d,!1,!0))}},visible:function(a){return(b(a,!1,1)||b(a,!0,1))&&50>lucid.plugin.getProperty(a[0],"Lanes").length}},{external:!0,label:"Move Lane To Left",logAction:"chart.viewport.context.uml.multiswimlane.moveLaneLeft",action:function(a,b){g(a,b,"l")},visible:function(a){return b(a,!1,2)}},{external:!0,label:"Move Lane To Right",logAction:"chart.viewport.context.uml.multiswimlane.moveLaneRight",
action:function(a,b){g(a,b,"r")},visible:function(a){return b(a,!1,2)}},{external:!0,label:"Move Lane Up",logAction:"chart.viewport.context.uml.multiswimlane.moveLaneUp",action:function(a,b){g(a,b,"u")},visible:function(a){return b(a,!0,2)}},{external:!0,label:"Move Lane Down",logAction:"chart.viewport.context.uml.multiswimlane.moveLaneDown",action:function(a,b){g(a,b,"d")},visible:function(a){return b(a,!0,2)}},{external:!0,label:"Remove Lane",logAction:"chart.viewport.context.uml.multiswimlane.removeLane",
action:function(b,e){if(1==e.length&&e[0]){var g=lucid.plugin.getAllProperties(e[0]);if(1<g.Lanes.length){for(var m=c(b,g),r=g.Lanes,v=a(m,g),w=[],y=g.BoundingBox.w*(1-r[m].p),B=lucid.plugin.getContained(e[0]),x=d(m,B,g),D=0;D<x.length;D++)lucid.plugin.deleteItem(x[D]);m+1<r.length&&(B=d(m+1,B,g,!0),h(e[0],-v.w,B,g));for(D=0;D<r.length;D++)D!=m&&(r[D].p=g.BoundingBox.w*r[D].p/y,w.push(r[D]));lucid.plugin.setProperty(e[0],"Lanes",w);g.Vertical||(g.BoundingBox.x+=(g.BoundingBox.w-y)/2,g.BoundingBox.y-=
(g.BoundingBox.w-y)/2);g.BoundingBox.w=y;lucid.plugin.setProperty(e[0],"Lane_"+r[m].tid,"Lane");lucid.plugin.setProperty(e[0],"BoundingBox",g.BoundingBox)}}},visible:function(a){if(1!=a.length||!a[0])return!1;var b=lucid.plugin.getBlockClassName(a[0]);return b&&-1<b.toLowerCase().indexOf("umlmultilane")&&1<lucid.plugin.getProperty(a[0],"Lanes").length}}]}());lucid.plugin.registerErrorableTextAreaControl(void 0,"Markup",function(b){if(1==b.length)return lucid.plugin.getProperty(b[0].getId(),"Markup").UML_Sequence},
sb,function(){var b=lucid.plugin.getSingleSelectedGroup();return b&&lucid.plugin.getProperty(b.getId(),"Markup")?[b]:[]});lucid.plugin.onActiveSelectionChange(function(b){return lucid.newEditor&&Y(b)?!1:tb(b)});lucid.plugin.onActivate(function(){lucid.line.enableEndpointStyles("uml");lucid.plugin.allowShadowSharing("UMLActivationBlock",!0);lucid.plugin.allowShadowSharing("UMLActiveClassBlock",!0);lucid.plugin.allowShadowSharing("UMLActorBlock",!0);lucid.plugin.allowShadowSharing("UMLAlternativeBlock",
!1);lucid.plugin.allowShadowSharing("UMLAttributeBlock",!0);lucid.plugin.allowShadowSharing("UMLAssemblyConnectorBlock",!0);lucid.plugin.allowShadowSharing("UMLBoundaryBlock",!1);lucid.plugin.allowShadowSharing("UMLCircleContainerBlock",!0);lucid.plugin.allowShadowSharing("UMLClassBlock",!0);lucid.plugin.allowShadowSharing("UMLComponentBlock",!0);lucid.plugin.allowShadowSharing("UMLComponentBoxBlock",!0);lucid.plugin.allowShadowSharing("UMLComponentInterfaceBlock",!0);lucid.plugin.allowShadowSharing("UMLConstraintBlock",
!1);lucid.plugin.allowShadowSharing("UMLControlBlock",!1);lucid.plugin.allowShadowSharing("UMLDecisionBlock",!0);lucid.plugin.allowShadowSharing("UMLEndBlock",!0);lucid.plugin.allowShadowSharing("UMLEntityBlock",!0);lucid.plugin.allowShadowSharing("UMLExpansionNodeBlock",!0);lucid.plugin.allowShadowSharing("UMLFlowFinalBlock",!0);lucid.plugin.allowShadowSharing("UMLHForkJoinBlock",!0);lucid.plugin.allowShadowSharing("UMLHistoryStateBlock",!0);lucid.plugin.allowShadowSharing("UMLInterruptingEdgeBlock",
!0);lucid.plugin.allowShadowSharing("UMLMultiplicityBlock",!0);lucid.plugin.allowShadowSharing("UMLMultivaluedAttributeBlock",!0);lucid.plugin.allowShadowSharing("UMLNodeBlock",!0);lucid.plugin.allowShadowSharing("UMLNoteBlock",!0);lucid.plugin.allowShadowSharing("UMLObjectBlock",!0);lucid.plugin.allowShadowSharing("UMLOptionLoopBlock",!1);lucid.plugin.allowShadowSharing("UMLPackageBlock",!0);lucid.plugin.allowShadowSharing("UMLProvidedInterfaceBlock",!0);lucid.plugin.allowShadowSharing("UMLReceiveSignalBlock",
!0);lucid.plugin.allowShadowSharing("UMLRectangleContainerBlock",!0);lucid.plugin.allowShadowSharing("UMLRelationshipBlock",!0);lucid.plugin.allowShadowSharing("UMLRequiredInterfaceBlock",!0);lucid.plugin.allowShadowSharing("UMLSendSignalBlock",!0);lucid.plugin.allowShadowSharing("UMLSeqEntityBlock",!1);lucid.plugin.allowShadowSharing("UMLStartBlock",!0);lucid.plugin.allowShadowSharing("UMLTextBlock",!0);lucid.plugin.allowShadowSharing("UMLUseCaseBlock",!0);lucid.plugin.allowShadowSharing("UMLVForkJoinBlock",
!0);lucid.plugin.allowShadowSharing("UMLWeakEntityBlock",!0);lucid.plugin.allowShadowSharing("UMLWeakRelationshipBlock",!0);lucid.plugin.allowShadowSharing("UMLMultidimensionalSwimlane",!0)});lucid.plugin.onDeactivate(function(){lucid.line.disableEndpointStyles("uml")});lucid.plugin.createToolGroups({"UML Class Dgm":["UMLClassBlock","UMLActiveClassBlock",{className:"UMLClassBlock",variant:"UMLClassBlockSimple"},{className:"UMLClassBlock",variant:"UMLInterfaceBlock"},{className:"UMLClassBlock",variant:"UMLInterfaceBlockSimple"},
"UMLMultiplicityBlock","UMLPackageBlock","UMLConstraintBlock","UMLNoteBlock","UMLTextBlock"],"UML Use Case":["UMLActorBlock","UMLUseCaseBlock",{className:"UMLUseCaseBlock",variant:"UMLUseCaseExt"},"UMLCircleContainerBlock","UMLRectangleContainerBlock","UMLNoteBlock","UMLTextBlock"],"UML State/Activity":[{className:"UMLOptionLoopBlock",variant:"UMLStateName"},"UMLStartBlock","UMLStateBlock",{className:"UMLStateBlock",variant:"UMLStateBlockCmp"},{className:"UMLStateBlock",variant:"UMLStateBlockExt"},
"UMLDecisionBlock","UMLHForkJoinBlock","UMLVForkJoinBlock","UMLFlowFinalBlock","UMLHistoryStateBlock","UMLEndBlock","UMLRectangleContainerBlock","UMLSwimLaneBlock","UMLNoteBlock","UMLTextBlock","UMLObjectBlock","UMLSendSignalBlock","UMLReceiveSignalBlock","UMLAcceptTimeEventActionBlock","UMLInterruptingEdgeBlock","UMLOffPageLinkBlock","UMLExpansionNodeBlock","UMLMultiLanePoolBlock","UMLMultiLanePoolRotatedBlock","UMLMultidimensionalSwimlane"],"UML Sequence":[{className:"UMLObjectBlock",variant:"UMLObjectBlockSeq"},
"UMLActivationBlock","UMLDeletionBlock","UMLNoteBlock","UMLPackageBlock","UMLConstraintBlock","UMLOptionLoopBlock","UMLAlternativeBlock2","UMLSeqEntityBlock","UMLBoundaryBlock","UMLControlBlock",{label:"Use Markup",action:lucid.newEditor?sb:tb}],"UML Component":"UMLComponentBlock UMLNodeBlock UMLComponentInterfaceBlock UMLPackageBlock UMLNoteBlock UMLComponentBoxBlock UMLAssemblyConnectorBlock UMLProvidedInterfaceBlock UMLRequiredInterfaceBlock".split(" "),"UML Deployment":[{className:"UMLNodeBlock",
variant:"UMLNodeDeployment"},{className:"UMLComponentBlock",variant:"UMLComponentDeployment"},"UMLObjectBlock","UMLPackageBlock","UMLNoteBlock","UMLConstraintBlock",{className:"UMLNodeBlock",variant:"UMLNodeDeploymentInstance"},{className:"UMLComponentBlock",variant:"UMLComponentDeploymentInstance"}],"UML Entity Relationship":"UMLEntityBlock UMLWeakEntityBlock UMLAttributeBlock UMLMultivaluedAttributeBlock UMLRelationshipBlock UMLWeakRelationshipBlock".split(" ")})})();
//# sourceMappingURL=/js/plugins/v2/source-maps/uml.js.map
};
